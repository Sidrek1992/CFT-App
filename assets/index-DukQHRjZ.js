(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();function R2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Hd={exports:{}},vl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C1;function Qw(){if(C1)return vl;C1=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:e,type:r,key:l,ref:a!==void 0?a:null,props:o}}return vl.Fragment=t,vl.jsx=n,vl.jsxs=n,vl}var b1;function Zw(){return b1||(b1=1,Hd.exports=Qw()),Hd.exports}var E=Zw(),Gd={exports:{}},ut={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N1;function eA(){if(N1)return ut;N1=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),y=Symbol.iterator;function T(W){return W===null||typeof W!="object"?null:(W=y&&W[y]||W["@@iterator"],typeof W=="function"?W:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,A={};function k(W,N,G){this.props=W,this.context=N,this.refs=A,this.updater=G||w}k.prototype.isReactComponent={},k.prototype.setState=function(W,N){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,N,"setState")},k.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function I(){}I.prototype=k.prototype;function b(W,N,G){this.props=W,this.context=N,this.refs=A,this.updater=G||w}var P=b.prototype=new I;P.constructor=b,S(P,k.prototype),P.isPureReactComponent=!0;var F=Array.isArray;function Y(){}var D={H:null,A:null,T:null,S:null},Q=Object.prototype.hasOwnProperty;function B(W,N,G){var U=G.ref;return{$$typeof:e,type:W,key:N,ref:U!==void 0?U:null,props:G}}function ae(W,N){return B(W.type,N,W.props)}function ie(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function Z(W){var N={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(G){return N[G]})}var le=/\/+/g;function Te(W,N){return typeof W=="object"&&W!==null&&W.key!=null?Z(""+W.key):N.toString(36)}function ye(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(Y,Y):(W.status="pending",W.then(function(N){W.status==="pending"&&(W.status="fulfilled",W.value=N)},function(N){W.status==="pending"&&(W.status="rejected",W.reason=N)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function H(W,N,G,U,V){var q=typeof W;(q==="undefined"||q==="boolean")&&(W=null);var se=!1;if(W===null)se=!0;else switch(q){case"bigint":case"string":case"number":se=!0;break;case"object":switch(W.$$typeof){case e:case t:se=!0;break;case m:return se=W._init,H(se(W._payload),N,G,U,V)}}if(se)return V=V(W),se=U===""?"."+Te(W,0):U,F(V)?(G="",se!=null&&(G=se.replace(le,"$&/")+"/"),H(V,N,G,"",function(we){return we})):V!=null&&(ie(V)&&(V=ae(V,G+(V.key==null||W&&W.key===V.key?"":(""+V.key).replace(le,"$&/")+"/")+se)),N.push(V)),1;se=0;var ge=U===""?".":U+":";if(F(W))for(var ve=0;ve<W.length;ve++)U=W[ve],q=ge+Te(U,ve),se+=H(U,N,G,q,V);else if(ve=T(W),typeof ve=="function")for(W=ve.call(W),ve=0;!(U=W.next()).done;)U=U.value,q=ge+Te(U,ve++),se+=H(U,N,G,q,V);else if(q==="object"){if(typeof W.then=="function")return H(ye(W),N,G,U,V);throw N=String(W),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.")}return se}function ee(W,N,G){if(W==null)return W;var U=[],V=0;return H(W,U,"","",function(q){return N.call(G,q,V++)}),U}function Ce(W){if(W._status===-1){var N=W._result;N=N(),N.then(function(G){(W._status===0||W._status===-1)&&(W._status=1,W._result=G)},function(G){(W._status===0||W._status===-1)&&(W._status=2,W._result=G)}),W._status===-1&&(W._status=0,W._result=N)}if(W._status===1)return W._result.default;throw W._result}var re=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var N=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(N))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)},Fe={map:ee,forEach:function(W,N,G){ee(W,function(){N.apply(this,arguments)},G)},count:function(W){var N=0;return ee(W,function(){N++}),N},toArray:function(W){return ee(W,function(N){return N})||[]},only:function(W){if(!ie(W))throw Error("React.Children.only expected to receive a single React element child.");return W}};return ut.Activity=v,ut.Children=Fe,ut.Component=k,ut.Fragment=n,ut.Profiler=a,ut.PureComponent=b,ut.StrictMode=r,ut.Suspense=d,ut.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,ut.__COMPILER_RUNTIME={__proto__:null,c:function(W){return D.H.useMemoCache(W)}},ut.cache=function(W){return function(){return W.apply(null,arguments)}},ut.cacheSignal=function(){return null},ut.cloneElement=function(W,N,G){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var U=S({},W.props),V=W.key;if(N!=null)for(q in N.key!==void 0&&(V=""+N.key),N)!Q.call(N,q)||q==="key"||q==="__self"||q==="__source"||q==="ref"&&N.ref===void 0||(U[q]=N[q]);var q=arguments.length-2;if(q===1)U.children=G;else if(1<q){for(var se=Array(q),ge=0;ge<q;ge++)se[ge]=arguments[ge+2];U.children=se}return B(W.type,V,U)},ut.createContext=function(W){return W={$$typeof:l,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:o,_context:W},W},ut.createElement=function(W,N,G){var U,V={},q=null;if(N!=null)for(U in N.key!==void 0&&(q=""+N.key),N)Q.call(N,U)&&U!=="key"&&U!=="__self"&&U!=="__source"&&(V[U]=N[U]);var se=arguments.length-2;if(se===1)V.children=G;else if(1<se){for(var ge=Array(se),ve=0;ve<se;ve++)ge[ve]=arguments[ve+2];V.children=ge}if(W&&W.defaultProps)for(U in se=W.defaultProps,se)V[U]===void 0&&(V[U]=se[U]);return B(W,q,V)},ut.createRef=function(){return{current:null}},ut.forwardRef=function(W){return{$$typeof:u,render:W}},ut.isValidElement=ie,ut.lazy=function(W){return{$$typeof:m,_payload:{_status:-1,_result:W},_init:Ce}},ut.memo=function(W,N){return{$$typeof:f,type:W,compare:N===void 0?null:N}},ut.startTransition=function(W){var N=D.T,G={};D.T=G;try{var U=W(),V=D.S;V!==null&&V(G,U),typeof U=="object"&&U!==null&&typeof U.then=="function"&&U.then(Y,re)}catch(q){re(q)}finally{N!==null&&G.types!==null&&(N.types=G.types),D.T=N}},ut.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},ut.use=function(W){return D.H.use(W)},ut.useActionState=function(W,N,G){return D.H.useActionState(W,N,G)},ut.useCallback=function(W,N){return D.H.useCallback(W,N)},ut.useContext=function(W){return D.H.useContext(W)},ut.useDebugValue=function(){},ut.useDeferredValue=function(W,N){return D.H.useDeferredValue(W,N)},ut.useEffect=function(W,N){return D.H.useEffect(W,N)},ut.useEffectEvent=function(W){return D.H.useEffectEvent(W)},ut.useId=function(){return D.H.useId()},ut.useImperativeHandle=function(W,N,G){return D.H.useImperativeHandle(W,N,G)},ut.useInsertionEffect=function(W,N){return D.H.useInsertionEffect(W,N)},ut.useLayoutEffect=function(W,N){return D.H.useLayoutEffect(W,N)},ut.useMemo=function(W,N){return D.H.useMemo(W,N)},ut.useOptimistic=function(W,N){return D.H.useOptimistic(W,N)},ut.useReducer=function(W,N,G){return D.H.useReducer(W,N,G)},ut.useRef=function(W){return D.H.useRef(W)},ut.useState=function(W){return D.H.useState(W)},ut.useSyncExternalStore=function(W,N,G){return D.H.useSyncExternalStore(W,N,G)},ut.useTransition=function(){return D.H.useTransition()},ut.version="19.2.4",ut}var k1;function Bh(){return k1||(k1=1,Gd.exports=eA()),Gd.exports}var Re=Bh();const D2=R2(Re);var Vd={exports:{}},yl={},zd={exports:{}},qd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R1;function tA(){return R1||(R1=1,(function(e){function t(H,ee){var Ce=H.length;H.push(ee);e:for(;0<Ce;){var re=Ce-1>>>1,Fe=H[re];if(0<a(Fe,ee))H[re]=ee,H[Ce]=Fe,Ce=re;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var ee=H[0],Ce=H.pop();if(Ce!==ee){H[0]=Ce;e:for(var re=0,Fe=H.length,W=Fe>>>1;re<W;){var N=2*(re+1)-1,G=H[N],U=N+1,V=H[U];if(0>a(G,Ce))U<Fe&&0>a(V,G)?(H[re]=V,H[U]=Ce,re=U):(H[re]=G,H[N]=Ce,re=N);else if(U<Fe&&0>a(V,Ce))H[re]=V,H[U]=Ce,re=U;else break e}}return ee}function a(H,ee){var Ce=H.sortIndex-ee.sortIndex;return Ce!==0?Ce:H.id-ee.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var d=[],f=[],m=1,v=null,y=3,T=!1,w=!1,S=!1,A=!1,k=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function P(H){for(var ee=n(f);ee!==null;){if(ee.callback===null)r(f);else if(ee.startTime<=H)r(f),ee.sortIndex=ee.expirationTime,t(d,ee);else break;ee=n(f)}}function F(H){if(S=!1,P(H),!w)if(n(d)!==null)w=!0,Y||(Y=!0,Z());else{var ee=n(f);ee!==null&&ye(F,ee.startTime-H)}}var Y=!1,D=-1,Q=5,B=-1;function ae(){return A?!0:!(e.unstable_now()-B<Q)}function ie(){if(A=!1,Y){var H=e.unstable_now();B=H;var ee=!0;try{e:{w=!1,S&&(S=!1,I(D),D=-1),T=!0;var Ce=y;try{t:{for(P(H),v=n(d);v!==null&&!(v.expirationTime>H&&ae());){var re=v.callback;if(typeof re=="function"){v.callback=null,y=v.priorityLevel;var Fe=re(v.expirationTime<=H);if(H=e.unstable_now(),typeof Fe=="function"){v.callback=Fe,P(H),ee=!0;break t}v===n(d)&&r(d),P(H)}else r(d);v=n(d)}if(v!==null)ee=!0;else{var W=n(f);W!==null&&ye(F,W.startTime-H),ee=!1}}break e}finally{v=null,y=Ce,T=!1}ee=void 0}}finally{ee?Z():Y=!1}}}var Z;if(typeof b=="function")Z=function(){b(ie)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,Te=le.port2;le.port1.onmessage=ie,Z=function(){Te.postMessage(null)}}else Z=function(){k(ie,0)};function ye(H,ee){D=k(function(){H(e.unstable_now())},ee)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(H){H.callback=null},e.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<H?Math.floor(1e3/H):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(H){switch(y){case 1:case 2:case 3:var ee=3;break;default:ee=y}var Ce=y;y=ee;try{return H()}finally{y=Ce}},e.unstable_requestPaint=function(){A=!0},e.unstable_runWithPriority=function(H,ee){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var Ce=y;y=H;try{return ee()}finally{y=Ce}},e.unstable_scheduleCallback=function(H,ee,Ce){var re=e.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?re+Ce:re):Ce=re,H){case 1:var Fe=-1;break;case 2:Fe=250;break;case 5:Fe=1073741823;break;case 4:Fe=1e4;break;default:Fe=5e3}return Fe=Ce+Fe,H={id:m++,callback:ee,priorityLevel:H,startTime:Ce,expirationTime:Fe,sortIndex:-1},Ce>re?(H.sortIndex=Ce,t(f,H),n(d)===null&&H===n(f)&&(S?(I(D),D=-1):S=!0,ye(F,Ce-re))):(H.sortIndex=Fe,t(d,H),w||T||(w=!0,Y||(Y=!0,Z()))),H},e.unstable_shouldYield=ae,e.unstable_wrapCallback=function(H){var ee=y;return function(){var Ce=y;y=ee;try{return H.apply(this,arguments)}finally{y=Ce}}}})(qd)),qd}var D1;function nA(){return D1||(D1=1,zd.exports=tA()),zd.exports}var jd={exports:{}},Vn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M1;function rA(){if(M1)return Vn;M1=1;var e=Bh();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(d,f,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:d,containerInfo:f,implementation:m}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Vn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Vn.createPortal=function(d,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return o(d,f,null,m)},Vn.flushSync=function(d){var f=l.T,m=r.p;try{if(l.T=null,r.p=2,d)return d()}finally{l.T=f,r.p=m,r.d.f()}},Vn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(d,f))},Vn.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},Vn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var m=f.as,v=u(m,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,T=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?r.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:y,fetchPriority:T}):m==="script"&&r.d.X(d,{crossOrigin:v,integrity:y,fetchPriority:T,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Vn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=u(f.as,f.crossOrigin);r.d.M(d,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(d)},Vn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,v=u(m,f.crossOrigin);r.d.L(d,m,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Vn.preloadModule=function(d,f){if(typeof d=="string")if(f){var m=u(f.as,f.crossOrigin);r.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(d)},Vn.requestFormReset=function(d){r.d.r(d)},Vn.unstable_batchedUpdates=function(d,f){return d(f)},Vn.useFormState=function(d,f,m){return l.H.useFormState(d,f,m)},Vn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Vn.version="19.2.4",Vn}var I1;function aA(){if(I1)return jd.exports;I1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),jd.exports=rA(),jd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F1;function iA(){if(F1)return yl;F1=1;var e=nA(),t=Bh(),n=aA();function r(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function l(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function u(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function d(i){if(o(i)!==i)throw Error(r(188))}function f(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(r(188));return s!==i?null:i}for(var c=i,h=s;;){var g=c.return;if(g===null)break;var _=g.alternate;if(_===null){if(h=g.return,h!==null){c=h;continue}break}if(g.child===_.child){for(_=g.child;_;){if(_===c)return d(g),i;if(_===h)return d(g),s;_=_.sibling}throw Error(r(188))}if(c.return!==h.return)c=g,h=_;else{for(var C=!1,M=g.child;M;){if(M===c){C=!0,c=g,h=_;break}if(M===h){C=!0,h=g,c=_;break}M=M.sibling}if(!C){for(M=_.child;M;){if(M===c){C=!0,c=_,h=g;break}if(M===h){C=!0,h=_,c=g;break}M=M.sibling}if(!C)throw Error(r(189))}}if(c.alternate!==h)throw Error(r(190))}if(c.tag!==3)throw Error(r(188));return c.stateNode.current===c?i:s}function m(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=m(i),s!==null)return s;i=i.sibling}return null}var v=Object.assign,y=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),b=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),ae=Symbol.for("react.memo_cache_sentinel"),ie=Symbol.iterator;function Z(i){return i===null||typeof i!="object"?null:(i=ie&&i[ie]||i["@@iterator"],typeof i=="function"?i:null)}var le=Symbol.for("react.client.reference");function Te(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===le?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case S:return"Fragment";case k:return"Profiler";case A:return"StrictMode";case F:return"Suspense";case Y:return"SuspenseList";case B:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case w:return"Portal";case b:return i.displayName||"Context";case I:return(i._context.displayName||"Context")+".Consumer";case P:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case D:return s=i.displayName||null,s!==null?s:Te(i.type)||"Memo";case Q:s=i._payload,i=i._init;try{return Te(i(s))}catch{}}return null}var ye=Array.isArray,H=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ce={pending:!1,data:null,method:null,action:null},re=[],Fe=-1;function W(i){return{current:i}}function N(i){0>Fe||(i.current=re[Fe],re[Fe]=null,Fe--)}function G(i,s){Fe++,re[Fe]=i.current,i.current=s}var U=W(null),V=W(null),q=W(null),se=W(null);function ge(i,s){switch(G(q,s),G(V,i),G(U,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?Wg(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=Wg(s),i=Kg(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}N(U),G(U,i)}function ve(){N(U),N(V),N(q)}function we(i){i.memoizedState!==null&&G(se,i);var s=U.current,c=Kg(s,i.type);s!==c&&(G(V,i),G(U,c))}function Je(i){V.current===i&&(N(U),N(V)),se.current===i&&(N(se),ml._currentValue=Ce)}var J,wt;function rt(i){if(J===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);J=s&&s[1]||"",wt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+J+i+wt}var vt=!1;function at(i,s){if(!i||vt)return"";vt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(xe){var me=xe}Reflect.construct(i,[],be)}else{try{be.call()}catch(xe){me=xe}i.call(be.prototype)}}else{try{throw Error()}catch(xe){me=xe}(be=i())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(xe){if(xe&&me&&typeof xe.stack=="string")return[xe.stack,me.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=h.DetermineComponentFrameRoot(),C=_[0],M=_[1];if(C&&M){var K=C.split(`
`),ue=M.split(`
`);for(g=h=0;h<K.length&&!K[h].includes("DetermineComponentFrameRoot");)h++;for(;g<ue.length&&!ue[g].includes("DetermineComponentFrameRoot");)g++;if(h===K.length||g===ue.length)for(h=K.length-1,g=ue.length-1;1<=h&&0<=g&&K[h]!==ue[g];)g--;for(;1<=h&&0<=g;h--,g--)if(K[h]!==ue[g]){if(h!==1||g!==1)do if(h--,g--,0>g||K[h]!==ue[g]){var Ee=`
`+K[h].replace(" at new "," at ");return i.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",i.displayName)),Ee}while(1<=h&&0<=g);break}}}finally{vt=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?rt(c):""}function Ge(i,s){switch(i.tag){case 26:case 27:case 5:return rt(i.type);case 16:return rt("Lazy");case 13:return i.child!==s&&s!==null?rt("Suspense Fallback"):rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return at(i.type,!1);case 11:return at(i.type.render,!1);case 1:return at(i.type,!0);case 31:return rt("Activity");default:return""}}function Ft(i){try{var s="",c=null;do s+=Ge(i,c),c=i,i=i.return;while(i);return s}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var tn=Object.prototype.hasOwnProperty,Tn=e.unstable_scheduleCallback,Cn=e.unstable_cancelCallback,Qr=e.unstable_shouldYield,Qn=e.unstable_requestPaint,Mt=e.unstable_now,Hn=e.unstable_getCurrentPriorityLevel,te=e.unstable_ImmediatePriority,Pe=e.unstable_UserBlockingPriority,Me=e.unstable_NormalPriority,Ye=e.unstable_LowPriority,Le=e.unstable_IdlePriority,pt=e.log,Ne=e.unstable_setDisableYieldValue,Oe=null,je=null;function Qe(i){if(typeof pt=="function"&&Ne(i),je&&typeof je.setStrictMode=="function")try{je.setStrictMode(Oe,i)}catch{}}var lt=Math.clz32?Math.clz32:ma,gr=Math.log,bn=Math.LN2;function ma(i){return i>>>=0,i===0?32:31-(gr(i)/bn|0)|0}var Zr=256,ni=262144,Ca=4194304;function ir(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ea(i,s,c){var h=i.pendingLanes;if(h===0)return 0;var g=0,_=i.suspendedLanes,C=i.pingedLanes;i=i.warmLanes;var M=h&134217727;return M!==0?(h=M&~_,h!==0?g=ir(h):(C&=M,C!==0?g=ir(C):c||(c=M&~i,c!==0&&(g=ir(c))))):(M=h&~_,M!==0?g=ir(M):C!==0?g=ir(C):c||(c=h&~i,c!==0&&(g=ir(c)))),g===0?0:s!==0&&s!==g&&(s&_)===0&&(_=g&-g,c=s&-s,_>=c||_===32&&(c&4194048)!==0)?s:g}function ta(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function bo(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yt(){var i=Ca;return Ca<<=1,(Ca&62914560)===0&&(Ca=4194304),i}function Gn(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function na(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Mf(i,s,c,h,g,_){var C=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var M=i.entanglements,K=i.expirationTimes,ue=i.hiddenUpdates;for(c=C&~c;0<c;){var Ee=31-lt(c),be=1<<Ee;M[Ee]=0,K[Ee]=-1;var me=ue[Ee];if(me!==null)for(ue[Ee]=null,Ee=0;Ee<me.length;Ee++){var xe=me[Ee];xe!==null&&(xe.lane&=-536870913)}c&=~be}h!==0&&fc(i,h,0),_!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=_&~(C&~s))}function fc(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var h=31-lt(s);i.entangledLanes|=s,i.entanglements[h]=i.entanglements[h]|1073741824|c&261930}function Ts(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var h=31-lt(c),g=1<<h;g&s|i[h]&s&&(i[h]|=s),c&=~g}}function dc(i,s){var c=s&-s;return c=(c&42)!==0?1:No(c),(c&(i.suspendedLanes|s))!==0?0:c}function No(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function ko(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function R(){var i=ee.p;return i!==0?i:(i=window.event,i===void 0?32:y1(i.type))}function j(i,s){var c=ee.p;try{return ee.p=i,s()}finally{ee.p=c}}var L=Math.random().toString(36).slice(2),O="__reactFiber$"+L,z="__reactProps$"+L,X="__reactContainer$"+L,fe="__reactEvents$"+L,Se="__reactListeners$"+L,de="__reactHandles$"+L,he="__reactResources$"+L,pe="__reactMarker$"+L;function De(i){delete i[O],delete i[z],delete i[fe],delete i[Se],delete i[de]}function Ue(i){var s=i[O];if(s)return s;for(var c=i.parentNode;c;){if(s=c[X]||c[O]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=r1(i);i!==null;){if(c=i[O])return c;i=r1(i)}return s}i=c,c=i.parentNode}return null}function ze(i){if(i=i[O]||i[X]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function Ie(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(r(33))}function Ve(i){var s=i[he];return s||(s=i[he]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function We(i){i[pe]=!0}var Yt=new Set,Xt={};function Zt(i,s){Rr(i,s),Rr(i+"Capture",s)}function Rr(i,s){for(Xt[i]=s,i=0;i<s.length;i++)Yt.add(s[i])}var Bi=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ri={},pa={};function Ro(i){return tn.call(pa,i)?!0:tn.call(ri,i)?!1:Bi.test(i)?pa[i]=!0:(ri[i]=!0,!1)}function sr(i,s,c){if(Ro(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function hc(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function ba(i,s,c,h){if(h===null)i.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+h)}}function Dr(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Gm(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function jT(i,s,c){var h=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var g=h.get,_=h.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return g.call(this)},set:function(C){c=""+C,_.call(this,C)}}),Object.defineProperty(i,s,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(C){c=""+C},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function If(i){if(!i._valueTracker){var s=Gm(i)?"checked":"value";i._valueTracker=jT(i,s,""+i[s])}}function Vm(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),h="";return i&&(h=Gm(i)?i.checked?"true":"false":i.value),i=h,i!==c?(s.setValue(i),!0):!1}function mc(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var YT=/[\n"\\]/g;function Mr(i){return i.replace(YT,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ff(i,s,c,h,g,_,C,M){i.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?i.type=C:i.removeAttribute("type"),s!=null?C==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+Dr(s)):i.value!==""+Dr(s)&&(i.value=""+Dr(s)):C!=="submit"&&C!=="reset"||i.removeAttribute("value"),s!=null?Lf(i,C,Dr(s)):c!=null?Lf(i,C,Dr(c)):h!=null&&i.removeAttribute("value"),g==null&&_!=null&&(i.defaultChecked=!!_),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?i.name=""+Dr(M):i.removeAttribute("name")}function zm(i,s,c,h,g,_,C,M){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(i.type=_),s!=null||c!=null){if(!(_!=="submit"&&_!=="reset"||s!=null)){If(i);return}c=c!=null?""+Dr(c):"",s=s!=null?""+Dr(s):c,M||s===i.value||(i.value=s),i.defaultValue=s}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=M?i.checked:!!h,i.defaultChecked=!!h,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(i.name=C),If(i)}function Lf(i,s,c){s==="number"&&mc(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Ss(i,s,c,h){if(i=i.options,s){s={};for(var g=0;g<c.length;g++)s["$"+c[g]]=!0;for(c=0;c<i.length;c++)g=s.hasOwnProperty("$"+i[c].value),i[c].selected!==g&&(i[c].selected=g),g&&h&&(i[c].defaultSelected=!0)}else{for(c=""+Dr(c),s=null,g=0;g<i.length;g++){if(i[g].value===c){i[g].selected=!0,h&&(i[g].defaultSelected=!0);return}s!==null||i[g].disabled||(s=i[g])}s!==null&&(s.selected=!0)}}function qm(i,s,c){if(s!=null&&(s=""+Dr(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+Dr(c):""}function jm(i,s,c,h){if(s==null){if(h!=null){if(c!=null)throw Error(r(92));if(ye(h)){if(1<h.length)throw Error(r(93));h=h[0]}c=h}c==null&&(c=""),s=c}c=Dr(s),i.defaultValue=c,h=i.textContent,h===c&&h!==""&&h!==null&&(i.value=h),If(i)}function ws(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var XT=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ym(i,s,c){var h=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":h?i.setProperty(s,c):typeof c!="number"||c===0||XT.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function Xm(i,s,c){if(s!=null&&typeof s!="object")throw Error(r(62));if(i=i.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var g in s)h=s[g],s.hasOwnProperty(g)&&c[g]!==h&&Ym(i,g,h)}else for(var _ in s)s.hasOwnProperty(_)&&Ym(i,_,s[_])}function Of(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var JT=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),WT=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pc(i){return WT.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Na(){}var Pf=null;function Uf(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var As=null,Cs=null;function Jm(i){var s=ze(i);if(s&&(i=s.stateNode)){var c=i[z]||null;e:switch(i=s.stateNode,s.type){case"input":if(Ff(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Mr(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var h=c[s];if(h!==i&&h.form===i.form){var g=h[z]||null;if(!g)throw Error(r(90));Ff(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<c.length;s++)h=c[s],h.form===i.form&&Vm(h)}break e;case"textarea":qm(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&Ss(i,!!c.multiple,s,!1)}}}var Bf=!1;function Wm(i,s,c){if(Bf)return i(s,c);Bf=!0;try{var h=i(s);return h}finally{if(Bf=!1,(As!==null||Cs!==null)&&(nu(),As&&(s=As,i=Cs,Cs=As=null,Jm(s),i)))for(s=0;s<i.length;s++)Jm(i[s])}}function Do(i,s){var c=i.stateNode;if(c===null)return null;var h=c[z]||null;if(h===null)return null;c=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(r(231,s,typeof c));return c}var ka=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hf=!1;if(ka)try{var Mo={};Object.defineProperty(Mo,"passive",{get:function(){Hf=!0}}),window.addEventListener("test",Mo,Mo),window.removeEventListener("test",Mo,Mo)}catch{Hf=!1}var ai=null,Gf=null,xc=null;function Km(){if(xc)return xc;var i,s=Gf,c=s.length,h,g="value"in ai?ai.value:ai.textContent,_=g.length;for(i=0;i<c&&s[i]===g[i];i++);var C=c-i;for(h=1;h<=C&&s[c-h]===g[_-h];h++);return xc=g.slice(i,1<h?1-h:void 0)}function gc(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function vc(){return!0}function $m(){return!1}function or(i){function s(c,h,g,_,C){this._reactName=c,this._targetInst=g,this.type=h,this.nativeEvent=_,this.target=C,this.currentTarget=null;for(var M in i)i.hasOwnProperty(M)&&(c=i[M],this[M]=c?c(_):_[M]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?vc:$m,this.isPropagationStopped=$m,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=vc)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=vc)},persist:function(){},isPersistent:vc}),s}var Hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yc=or(Hi),Io=v({},Hi,{view:0,detail:0}),KT=or(Io),Vf,zf,Fo,_c=v({},Io,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jf,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Fo&&(Fo&&i.type==="mousemove"?(Vf=i.screenX-Fo.screenX,zf=i.screenY-Fo.screenY):zf=Vf=0,Fo=i),Vf)},movementY:function(i){return"movementY"in i?i.movementY:zf}}),Qm=or(_c),$T=v({},_c,{dataTransfer:0}),QT=or($T),ZT=v({},Io,{relatedTarget:0}),qf=or(ZT),eS=v({},Hi,{animationName:0,elapsedTime:0,pseudoElement:0}),tS=or(eS),nS=v({},Hi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),rS=or(nS),aS=v({},Hi,{data:0}),Zm=or(aS),iS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lS(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=oS[i])?!!s[i]:!1}function jf(){return lS}var cS=v({},Io,{key:function(i){if(i.key){var s=iS[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=gc(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?sS[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jf,charCode:function(i){return i.type==="keypress"?gc(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?gc(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),uS=or(cS),fS=v({},_c,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ep=or(fS),dS=v({},Io,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jf}),hS=or(dS),mS=v({},Hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),pS=or(mS),xS=v({},_c,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),gS=or(xS),vS=v({},Hi,{newState:0,oldState:0}),yS=or(vS),_S=[9,13,27,32],Yf=ka&&"CompositionEvent"in window,Lo=null;ka&&"documentMode"in document&&(Lo=document.documentMode);var ES=ka&&"TextEvent"in window&&!Lo,tp=ka&&(!Yf||Lo&&8<Lo&&11>=Lo),np=" ",rp=!1;function ap(i,s){switch(i){case"keyup":return _S.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ip(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var bs=!1;function TS(i,s){switch(i){case"compositionend":return ip(s);case"keypress":return s.which!==32?null:(rp=!0,np);case"textInput":return i=s.data,i===np&&rp?null:i;default:return null}}function SS(i,s){if(bs)return i==="compositionend"||!Yf&&ap(i,s)?(i=Km(),xc=Gf=ai=null,bs=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return tp&&s.locale!=="ko"?null:s.data;default:return null}}var wS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sp(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!wS[i.type]:s==="textarea"}function op(i,s,c,h){As?Cs?Cs.push(h):Cs=[h]:As=h,s=cu(s,"onChange"),0<s.length&&(c=new yc("onChange","change",null,c,h),i.push({event:c,listeners:s}))}var Oo=null,Po=null;function AS(i){zg(i,0)}function Ec(i){var s=Ie(i);if(Vm(s))return i}function lp(i,s){if(i==="change")return s}var cp=!1;if(ka){var Xf;if(ka){var Jf="oninput"in document;if(!Jf){var up=document.createElement("div");up.setAttribute("oninput","return;"),Jf=typeof up.oninput=="function"}Xf=Jf}else Xf=!1;cp=Xf&&(!document.documentMode||9<document.documentMode)}function fp(){Oo&&(Oo.detachEvent("onpropertychange",dp),Po=Oo=null)}function dp(i){if(i.propertyName==="value"&&Ec(Po)){var s=[];op(s,Po,i,Uf(i)),Wm(AS,s)}}function CS(i,s,c){i==="focusin"?(fp(),Oo=s,Po=c,Oo.attachEvent("onpropertychange",dp)):i==="focusout"&&fp()}function bS(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Ec(Po)}function NS(i,s){if(i==="click")return Ec(s)}function kS(i,s){if(i==="input"||i==="change")return Ec(s)}function RS(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var vr=typeof Object.is=="function"?Object.is:RS;function Uo(i,s){if(vr(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),h=Object.keys(s);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var g=c[h];if(!tn.call(s,g)||!vr(i[g],s[g]))return!1}return!0}function hp(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function mp(i,s){var c=hp(i);i=0;for(var h;c;){if(c.nodeType===3){if(h=i+c.textContent.length,i<=s&&h>=s)return{node:c,offset:s-i};i=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=hp(c)}}function pp(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?pp(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function xp(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=mc(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=mc(i.document)}return s}function Wf(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var DS=ka&&"documentMode"in document&&11>=document.documentMode,Ns=null,Kf=null,Bo=null,$f=!1;function gp(i,s,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;$f||Ns==null||Ns!==mc(h)||(h=Ns,"selectionStart"in h&&Wf(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Bo&&Uo(Bo,h)||(Bo=h,h=cu(Kf,"onSelect"),0<h.length&&(s=new yc("onSelect","select",null,s,c),i.push({event:s,listeners:h}),s.target=Ns)))}function Gi(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var ks={animationend:Gi("Animation","AnimationEnd"),animationiteration:Gi("Animation","AnimationIteration"),animationstart:Gi("Animation","AnimationStart"),transitionrun:Gi("Transition","TransitionRun"),transitionstart:Gi("Transition","TransitionStart"),transitioncancel:Gi("Transition","TransitionCancel"),transitionend:Gi("Transition","TransitionEnd")},Qf={},vp={};ka&&(vp=document.createElement("div").style,"AnimationEvent"in window||(delete ks.animationend.animation,delete ks.animationiteration.animation,delete ks.animationstart.animation),"TransitionEvent"in window||delete ks.transitionend.transition);function Vi(i){if(Qf[i])return Qf[i];if(!ks[i])return i;var s=ks[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in vp)return Qf[i]=s[c];return i}var yp=Vi("animationend"),_p=Vi("animationiteration"),Ep=Vi("animationstart"),MS=Vi("transitionrun"),IS=Vi("transitionstart"),FS=Vi("transitioncancel"),Tp=Vi("transitionend"),Sp=new Map,Zf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Zf.push("scrollEnd");function ra(i,s){Sp.set(i,s),Zt(s,[i])}var Tc=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Ir=[],Rs=0,e0=0;function Sc(){for(var i=Rs,s=e0=Rs=0;s<i;){var c=Ir[s];Ir[s++]=null;var h=Ir[s];Ir[s++]=null;var g=Ir[s];Ir[s++]=null;var _=Ir[s];if(Ir[s++]=null,h!==null&&g!==null){var C=h.pending;C===null?g.next=g:(g.next=C.next,C.next=g),h.pending=g}_!==0&&wp(c,g,_)}}function wc(i,s,c,h){Ir[Rs++]=i,Ir[Rs++]=s,Ir[Rs++]=c,Ir[Rs++]=h,e0|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function t0(i,s,c,h){return wc(i,s,c,h),Ac(i)}function zi(i,s){return wc(i,null,null,s),Ac(i)}function wp(i,s,c){i.lanes|=c;var h=i.alternate;h!==null&&(h.lanes|=c);for(var g=!1,_=i.return;_!==null;)_.childLanes|=c,h=_.alternate,h!==null&&(h.childLanes|=c),_.tag===22&&(i=_.stateNode,i===null||i._visibility&1||(g=!0)),i=_,_=_.return;return i.tag===3?(_=i.stateNode,g&&s!==null&&(g=31-lt(c),i=_.hiddenUpdates,h=i[g],h===null?i[g]=[s]:h.push(s),s.lane=c|536870912),_):null}function Ac(i){if(50<ol)throw ol=0,ud=null,Error(r(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var Ds={};function LS(i,s,c,h){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yr(i,s,c,h){return new LS(i,s,c,h)}function n0(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ra(i,s){var c=i.alternate;return c===null?(c=yr(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function Ap(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Cc(i,s,c,h,g,_){var C=0;if(h=i,typeof i=="function")n0(i)&&(C=1);else if(typeof i=="string")C=Hw(i,c,U.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case B:return i=yr(31,c,s,g),i.elementType=B,i.lanes=_,i;case S:return qi(c.children,g,_,s);case A:C=8,g|=24;break;case k:return i=yr(12,c,s,g|2),i.elementType=k,i.lanes=_,i;case F:return i=yr(13,c,s,g),i.elementType=F,i.lanes=_,i;case Y:return i=yr(19,c,s,g),i.elementType=Y,i.lanes=_,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case b:C=10;break e;case I:C=9;break e;case P:C=11;break e;case D:C=14;break e;case Q:C=16,h=null;break e}C=29,c=Error(r(130,i===null?"null":typeof i,"")),h=null}return s=yr(C,c,s,g),s.elementType=i,s.type=h,s.lanes=_,s}function qi(i,s,c,h){return i=yr(7,i,h,s),i.lanes=c,i}function r0(i,s,c){return i=yr(6,i,null,s),i.lanes=c,i}function Cp(i){var s=yr(18,null,null,0);return s.stateNode=i,s}function a0(i,s,c){return s=yr(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var bp=new WeakMap;function Fr(i,s){if(typeof i=="object"&&i!==null){var c=bp.get(i);return c!==void 0?c:(s={value:i,source:s,stack:Ft(s)},bp.set(i,s),s)}return{value:i,source:s,stack:Ft(s)}}var Ms=[],Is=0,bc=null,Ho=0,Lr=[],Or=0,ii=null,xa=1,ga="";function Da(i,s){Ms[Is++]=Ho,Ms[Is++]=bc,bc=i,Ho=s}function Np(i,s,c){Lr[Or++]=xa,Lr[Or++]=ga,Lr[Or++]=ii,ii=i;var h=xa;i=ga;var g=32-lt(h)-1;h&=~(1<<g),c+=1;var _=32-lt(s)+g;if(30<_){var C=g-g%5;_=(h&(1<<C)-1).toString(32),h>>=C,g-=C,xa=1<<32-lt(s)+g|c<<g|h,ga=_+i}else xa=1<<_|c<<g|h,ga=i}function i0(i){i.return!==null&&(Da(i,1),Np(i,1,0))}function s0(i){for(;i===bc;)bc=Ms[--Is],Ms[Is]=null,Ho=Ms[--Is],Ms[Is]=null;for(;i===ii;)ii=Lr[--Or],Lr[Or]=null,ga=Lr[--Or],Lr[Or]=null,xa=Lr[--Or],Lr[Or]=null}function kp(i,s){Lr[Or++]=xa,Lr[Or++]=ga,Lr[Or++]=ii,xa=s.id,ga=s.overflow,ii=i}var In=null,Jt=null,At=!1,si=null,Pr=!1,o0=Error(r(519));function oi(i){var s=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Go(Fr(s,i)),o0}function Rp(i){var s=i.stateNode,c=i.type,h=i.memoizedProps;switch(s[O]=i,s[z]=h,c){case"dialog":Et("cancel",s),Et("close",s);break;case"iframe":case"object":case"embed":Et("load",s);break;case"video":case"audio":for(c=0;c<cl.length;c++)Et(cl[c],s);break;case"source":Et("error",s);break;case"img":case"image":case"link":Et("error",s),Et("load",s);break;case"details":Et("toggle",s);break;case"input":Et("invalid",s),zm(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Et("invalid",s);break;case"textarea":Et("invalid",s),jm(s,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||h.suppressHydrationWarning===!0||Xg(s.textContent,c)?(h.popover!=null&&(Et("beforetoggle",s),Et("toggle",s)),h.onScroll!=null&&Et("scroll",s),h.onScrollEnd!=null&&Et("scrollend",s),h.onClick!=null&&(s.onclick=Na),s=!0):s=!1,s||oi(i,!0)}function Dp(i){for(In=i.return;In;)switch(In.tag){case 5:case 31:case 13:Pr=!1;return;case 27:case 3:Pr=!0;return;default:In=In.return}}function Fs(i){if(i!==In)return!1;if(!At)return Dp(i),At=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||Ad(i.type,i.memoizedProps)),c=!c),c&&Jt&&oi(i),Dp(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));Jt=n1(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));Jt=n1(i)}else s===27?(s=Jt,Ei(i.type)?(i=Rd,Rd=null,Jt=i):Jt=s):Jt=In?Br(i.stateNode.nextSibling):null;return!0}function ji(){Jt=In=null,At=!1}function l0(){var i=si;return i!==null&&(fr===null?fr=i:fr.push.apply(fr,i),si=null),i}function Go(i){si===null?si=[i]:si.push(i)}var c0=W(null),Yi=null,Ma=null;function li(i,s,c){G(c0,s._currentValue),s._currentValue=c}function Ia(i){i._currentValue=c0.current,N(c0)}function u0(i,s,c){for(;i!==null;){var h=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),i===c)break;i=i.return}}function f0(i,s,c,h){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var _=g.dependencies;if(_!==null){var C=g.child;_=_.firstContext;e:for(;_!==null;){var M=_;_=g;for(var K=0;K<s.length;K++)if(M.context===s[K]){_.lanes|=c,M=_.alternate,M!==null&&(M.lanes|=c),u0(_.return,c,i),h||(C=null);break e}_=M.next}}else if(g.tag===18){if(C=g.return,C===null)throw Error(r(341));C.lanes|=c,_=C.alternate,_!==null&&(_.lanes|=c),u0(C,c,i),C=null}else C=g.child;if(C!==null)C.return=g;else for(C=g;C!==null;){if(C===i){C=null;break}if(g=C.sibling,g!==null){g.return=C.return,C=g;break}C=C.return}g=C}}function Ls(i,s,c,h){i=null;for(var g=s,_=!1;g!==null;){if(!_){if((g.flags&524288)!==0)_=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var C=g.alternate;if(C===null)throw Error(r(387));if(C=C.memoizedProps,C!==null){var M=g.type;vr(g.pendingProps.value,C.value)||(i!==null?i.push(M):i=[M])}}else if(g===se.current){if(C=g.alternate,C===null)throw Error(r(387));C.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(ml):i=[ml])}g=g.return}i!==null&&f0(s,i,c,h),s.flags|=262144}function Nc(i){for(i=i.firstContext;i!==null;){if(!vr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Xi(i){Yi=i,Ma=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Fn(i){return Mp(Yi,i)}function kc(i,s){return Yi===null&&Xi(i),Mp(i,s)}function Mp(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Ma===null){if(i===null)throw Error(r(308));Ma=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Ma=Ma.next=s;return c}var OS=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,h){i.push(h)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},PS=e.unstable_scheduleCallback,US=e.unstable_NormalPriority,pn={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function d0(){return{controller:new OS,data:new Map,refCount:0}}function Vo(i){i.refCount--,i.refCount===0&&PS(US,function(){i.controller.abort()})}var zo=null,h0=0,Os=0,Ps=null;function BS(i,s){if(zo===null){var c=zo=[];h0=0,Os=xd(),Ps={status:"pending",value:void 0,then:function(h){c.push(h)}}}return h0++,s.then(Ip,Ip),s}function Ip(){if(--h0===0&&zo!==null){Ps!==null&&(Ps.status="fulfilled");var i=zo;zo=null,Os=0,Ps=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function HS(i,s){var c=[],h={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return i.then(function(){h.status="fulfilled",h.value=s;for(var g=0;g<c.length;g++)(0,c[g])(s)},function(g){for(h.status="rejected",h.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),h}var Fp=H.S;H.S=function(i,s){gg=Mt(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&BS(i,s),Fp!==null&&Fp(i,s)};var Ji=W(null);function m0(){var i=Ji.current;return i!==null?i:jt.pooledCache}function Rc(i,s){s===null?G(Ji,Ji.current):G(Ji,s.pool)}function Lp(){var i=m0();return i===null?null:{parent:pn._currentValue,pool:i}}var Us=Error(r(460)),p0=Error(r(474)),Dc=Error(r(542)),Mc={then:function(){}};function Op(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Pp(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(Na,Na),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Bp(i),i;default:if(typeof s.status=="string")s.then(Na,Na);else{if(i=jt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=s,i.status="pending",i.then(function(h){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=h}},function(h){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,Bp(i),i}throw Ki=s,Us}}function Wi(i){try{var s=i._init;return s(i._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Ki=c,Us):c}}var Ki=null;function Up(){if(Ki===null)throw Error(r(459));var i=Ki;return Ki=null,i}function Bp(i){if(i===Us||i===Dc)throw Error(r(483))}var Bs=null,qo=0;function Ic(i){var s=qo;return qo+=1,Bs===null&&(Bs=[]),Pp(Bs,i,s)}function jo(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Fc(i,s){throw s.$$typeof===y?Error(r(525)):(i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function Hp(i){function s(oe,ne){if(i){var ce=oe.deletions;ce===null?(oe.deletions=[ne],oe.flags|=16):ce.push(ne)}}function c(oe,ne){if(!i)return null;for(;ne!==null;)s(oe,ne),ne=ne.sibling;return null}function h(oe){for(var ne=new Map;oe!==null;)oe.key!==null?ne.set(oe.key,oe):ne.set(oe.index,oe),oe=oe.sibling;return ne}function g(oe,ne){return oe=Ra(oe,ne),oe.index=0,oe.sibling=null,oe}function _(oe,ne,ce){return oe.index=ce,i?(ce=oe.alternate,ce!==null?(ce=ce.index,ce<ne?(oe.flags|=67108866,ne):ce):(oe.flags|=67108866,ne)):(oe.flags|=1048576,ne)}function C(oe){return i&&oe.alternate===null&&(oe.flags|=67108866),oe}function M(oe,ne,ce,Ae){return ne===null||ne.tag!==6?(ne=r0(ce,oe.mode,Ae),ne.return=oe,ne):(ne=g(ne,ce),ne.return=oe,ne)}function K(oe,ne,ce,Ae){var Ze=ce.type;return Ze===S?Ee(oe,ne,ce.props.children,Ae,ce.key):ne!==null&&(ne.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===Q&&Wi(Ze)===ne.type)?(ne=g(ne,ce.props),jo(ne,ce),ne.return=oe,ne):(ne=Cc(ce.type,ce.key,ce.props,null,oe.mode,Ae),jo(ne,ce),ne.return=oe,ne)}function ue(oe,ne,ce,Ae){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==ce.containerInfo||ne.stateNode.implementation!==ce.implementation?(ne=a0(ce,oe.mode,Ae),ne.return=oe,ne):(ne=g(ne,ce.children||[]),ne.return=oe,ne)}function Ee(oe,ne,ce,Ae,Ze){return ne===null||ne.tag!==7?(ne=qi(ce,oe.mode,Ae,Ze),ne.return=oe,ne):(ne=g(ne,ce),ne.return=oe,ne)}function be(oe,ne,ce){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=r0(""+ne,oe.mode,ce),ne.return=oe,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case T:return ce=Cc(ne.type,ne.key,ne.props,null,oe.mode,ce),jo(ce,ne),ce.return=oe,ce;case w:return ne=a0(ne,oe.mode,ce),ne.return=oe,ne;case Q:return ne=Wi(ne),be(oe,ne,ce)}if(ye(ne)||Z(ne))return ne=qi(ne,oe.mode,ce,null),ne.return=oe,ne;if(typeof ne.then=="function")return be(oe,Ic(ne),ce);if(ne.$$typeof===b)return be(oe,kc(oe,ne),ce);Fc(oe,ne)}return null}function me(oe,ne,ce,Ae){var Ze=ne!==null?ne.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return Ze!==null?null:M(oe,ne,""+ce,Ae);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case T:return ce.key===Ze?K(oe,ne,ce,Ae):null;case w:return ce.key===Ze?ue(oe,ne,ce,Ae):null;case Q:return ce=Wi(ce),me(oe,ne,ce,Ae)}if(ye(ce)||Z(ce))return Ze!==null?null:Ee(oe,ne,ce,Ae,null);if(typeof ce.then=="function")return me(oe,ne,Ic(ce),Ae);if(ce.$$typeof===b)return me(oe,ne,kc(oe,ce),Ae);Fc(oe,ce)}return null}function xe(oe,ne,ce,Ae,Ze){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return oe=oe.get(ce)||null,M(ne,oe,""+Ae,Ze);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case T:return oe=oe.get(Ae.key===null?ce:Ae.key)||null,K(ne,oe,Ae,Ze);case w:return oe=oe.get(Ae.key===null?ce:Ae.key)||null,ue(ne,oe,Ae,Ze);case Q:return Ae=Wi(Ae),xe(oe,ne,ce,Ae,Ze)}if(ye(Ae)||Z(Ae))return oe=oe.get(ce)||null,Ee(ne,oe,Ae,Ze,null);if(typeof Ae.then=="function")return xe(oe,ne,ce,Ic(Ae),Ze);if(Ae.$$typeof===b)return xe(oe,ne,ce,kc(ne,Ae),Ze);Fc(ne,Ae)}return null}function Xe(oe,ne,ce,Ae){for(var Ze=null,Nt=null,Ke=ne,ht=ne=0,St=null;Ke!==null&&ht<ce.length;ht++){Ke.index>ht?(St=Ke,Ke=null):St=Ke.sibling;var kt=me(oe,Ke,ce[ht],Ae);if(kt===null){Ke===null&&(Ke=St);break}i&&Ke&&kt.alternate===null&&s(oe,Ke),ne=_(kt,ne,ht),Nt===null?Ze=kt:Nt.sibling=kt,Nt=kt,Ke=St}if(ht===ce.length)return c(oe,Ke),At&&Da(oe,ht),Ze;if(Ke===null){for(;ht<ce.length;ht++)Ke=be(oe,ce[ht],Ae),Ke!==null&&(ne=_(Ke,ne,ht),Nt===null?Ze=Ke:Nt.sibling=Ke,Nt=Ke);return At&&Da(oe,ht),Ze}for(Ke=h(Ke);ht<ce.length;ht++)St=xe(Ke,oe,ht,ce[ht],Ae),St!==null&&(i&&St.alternate!==null&&Ke.delete(St.key===null?ht:St.key),ne=_(St,ne,ht),Nt===null?Ze=St:Nt.sibling=St,Nt=St);return i&&Ke.forEach(function(Ci){return s(oe,Ci)}),At&&Da(oe,ht),Ze}function tt(oe,ne,ce,Ae){if(ce==null)throw Error(r(151));for(var Ze=null,Nt=null,Ke=ne,ht=ne=0,St=null,kt=ce.next();Ke!==null&&!kt.done;ht++,kt=ce.next()){Ke.index>ht?(St=Ke,Ke=null):St=Ke.sibling;var Ci=me(oe,Ke,kt.value,Ae);if(Ci===null){Ke===null&&(Ke=St);break}i&&Ke&&Ci.alternate===null&&s(oe,Ke),ne=_(Ci,ne,ht),Nt===null?Ze=Ci:Nt.sibling=Ci,Nt=Ci,Ke=St}if(kt.done)return c(oe,Ke),At&&Da(oe,ht),Ze;if(Ke===null){for(;!kt.done;ht++,kt=ce.next())kt=be(oe,kt.value,Ae),kt!==null&&(ne=_(kt,ne,ht),Nt===null?Ze=kt:Nt.sibling=kt,Nt=kt);return At&&Da(oe,ht),Ze}for(Ke=h(Ke);!kt.done;ht++,kt=ce.next())kt=xe(Ke,oe,ht,kt.value,Ae),kt!==null&&(i&&kt.alternate!==null&&Ke.delete(kt.key===null?ht:kt.key),ne=_(kt,ne,ht),Nt===null?Ze=kt:Nt.sibling=kt,Nt=kt);return i&&Ke.forEach(function($w){return s(oe,$w)}),At&&Da(oe,ht),Ze}function zt(oe,ne,ce,Ae){if(typeof ce=="object"&&ce!==null&&ce.type===S&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case T:e:{for(var Ze=ce.key;ne!==null;){if(ne.key===Ze){if(Ze=ce.type,Ze===S){if(ne.tag===7){c(oe,ne.sibling),Ae=g(ne,ce.props.children),Ae.return=oe,oe=Ae;break e}}else if(ne.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===Q&&Wi(Ze)===ne.type){c(oe,ne.sibling),Ae=g(ne,ce.props),jo(Ae,ce),Ae.return=oe,oe=Ae;break e}c(oe,ne);break}else s(oe,ne);ne=ne.sibling}ce.type===S?(Ae=qi(ce.props.children,oe.mode,Ae,ce.key),Ae.return=oe,oe=Ae):(Ae=Cc(ce.type,ce.key,ce.props,null,oe.mode,Ae),jo(Ae,ce),Ae.return=oe,oe=Ae)}return C(oe);case w:e:{for(Ze=ce.key;ne!==null;){if(ne.key===Ze)if(ne.tag===4&&ne.stateNode.containerInfo===ce.containerInfo&&ne.stateNode.implementation===ce.implementation){c(oe,ne.sibling),Ae=g(ne,ce.children||[]),Ae.return=oe,oe=Ae;break e}else{c(oe,ne);break}else s(oe,ne);ne=ne.sibling}Ae=a0(ce,oe.mode,Ae),Ae.return=oe,oe=Ae}return C(oe);case Q:return ce=Wi(ce),zt(oe,ne,ce,Ae)}if(ye(ce))return Xe(oe,ne,ce,Ae);if(Z(ce)){if(Ze=Z(ce),typeof Ze!="function")throw Error(r(150));return ce=Ze.call(ce),tt(oe,ne,ce,Ae)}if(typeof ce.then=="function")return zt(oe,ne,Ic(ce),Ae);if(ce.$$typeof===b)return zt(oe,ne,kc(oe,ce),Ae);Fc(oe,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,ne!==null&&ne.tag===6?(c(oe,ne.sibling),Ae=g(ne,ce),Ae.return=oe,oe=Ae):(c(oe,ne),Ae=r0(ce,oe.mode,Ae),Ae.return=oe,oe=Ae),C(oe)):c(oe,ne)}return function(oe,ne,ce,Ae){try{qo=0;var Ze=zt(oe,ne,ce,Ae);return Bs=null,Ze}catch(Ke){if(Ke===Us||Ke===Dc)throw Ke;var Nt=yr(29,Ke,null,oe.mode);return Nt.lanes=Ae,Nt.return=oe,Nt}finally{}}}var $i=Hp(!0),Gp=Hp(!1),ci=!1;function x0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function g0(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function ui(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function fi(i,s,c){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(It&2)!==0){var g=h.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),h.pending=s,s=Ac(i),wp(i,null,c),s}return wc(i,h,s,c),Ac(i)}function Yo(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var h=s.lanes;h&=i.pendingLanes,c|=h,s.lanes=c,Ts(i,c)}}function v0(i,s){var c=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var g=null,_=null;if(c=c.firstBaseUpdate,c!==null){do{var C={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};_===null?g=_=C:_=_.next=C,c=c.next}while(c!==null);_===null?g=_=s:_=_.next=s}else g=_=s;c={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:_,shared:h.shared,callbacks:h.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var y0=!1;function Xo(){if(y0){var i=Ps;if(i!==null)throw i}}function Jo(i,s,c,h){y0=!1;var g=i.updateQueue;ci=!1;var _=g.firstBaseUpdate,C=g.lastBaseUpdate,M=g.shared.pending;if(M!==null){g.shared.pending=null;var K=M,ue=K.next;K.next=null,C===null?_=ue:C.next=ue,C=K;var Ee=i.alternate;Ee!==null&&(Ee=Ee.updateQueue,M=Ee.lastBaseUpdate,M!==C&&(M===null?Ee.firstBaseUpdate=ue:M.next=ue,Ee.lastBaseUpdate=K))}if(_!==null){var be=g.baseState;C=0,Ee=ue=K=null,M=_;do{var me=M.lane&-536870913,xe=me!==M.lane;if(xe?(Tt&me)===me:(h&me)===me){me!==0&&me===Os&&(y0=!0),Ee!==null&&(Ee=Ee.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var Xe=i,tt=M;me=s;var zt=c;switch(tt.tag){case 1:if(Xe=tt.payload,typeof Xe=="function"){be=Xe.call(zt,be,me);break e}be=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=tt.payload,me=typeof Xe=="function"?Xe.call(zt,be,me):Xe,me==null)break e;be=v({},be,me);break e;case 2:ci=!0}}me=M.callback,me!==null&&(i.flags|=64,xe&&(i.flags|=8192),xe=g.callbacks,xe===null?g.callbacks=[me]:xe.push(me))}else xe={lane:me,tag:M.tag,payload:M.payload,callback:M.callback,next:null},Ee===null?(ue=Ee=xe,K=be):Ee=Ee.next=xe,C|=me;if(M=M.next,M===null){if(M=g.shared.pending,M===null)break;xe=M,M=xe.next,xe.next=null,g.lastBaseUpdate=xe,g.shared.pending=null}}while(!0);Ee===null&&(K=be),g.baseState=K,g.firstBaseUpdate=ue,g.lastBaseUpdate=Ee,_===null&&(g.shared.lanes=0),xi|=C,i.lanes=C,i.memoizedState=be}}function Vp(i,s){if(typeof i!="function")throw Error(r(191,i));i.call(s)}function zp(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)Vp(c[i],s)}var Hs=W(null),Lc=W(0);function qp(i,s){i=Va,G(Lc,i),G(Hs,s),Va=i|s.baseLanes}function _0(){G(Lc,Va),G(Hs,Hs.current)}function E0(){Va=Lc.current,N(Hs),N(Lc)}var _r=W(null),Ur=null;function di(i){var s=i.alternate;G(un,un.current&1),G(_r,i),Ur===null&&(s===null||Hs.current!==null||s.memoizedState!==null)&&(Ur=i)}function T0(i){G(un,un.current),G(_r,i),Ur===null&&(Ur=i)}function jp(i){i.tag===22?(G(un,un.current),G(_r,i),Ur===null&&(Ur=i)):hi()}function hi(){G(un,un.current),G(_r,_r.current)}function Er(i){N(_r),Ur===i&&(Ur=null),N(un)}var un=W(0);function Oc(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Nd(c)||kd(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Fa=0,ft=null,Gt=null,xn=null,Pc=!1,Gs=!1,Qi=!1,Uc=0,Wo=0,Vs=null,GS=0;function an(){throw Error(r(321))}function S0(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!vr(i[c],s[c]))return!1;return!0}function w0(i,s,c,h,g,_){return Fa=_,ft=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,H.H=i===null||i.memoizedState===null?Nx:B0,Qi=!1,_=c(h,g),Qi=!1,Gs&&(_=Xp(s,c,h,g)),Yp(i),_}function Yp(i){H.H=Qo;var s=Gt!==null&&Gt.next!==null;if(Fa=0,xn=Gt=ft=null,Pc=!1,Wo=0,Vs=null,s)throw Error(r(300));i===null||gn||(i=i.dependencies,i!==null&&Nc(i)&&(gn=!0))}function Xp(i,s,c,h){ft=i;var g=0;do{if(Gs&&(Vs=null),Wo=0,Gs=!1,25<=g)throw Error(r(301));if(g+=1,xn=Gt=null,i.updateQueue!=null){var _=i.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}H.H=kx,_=s(c,h)}while(Gs);return _}function VS(){var i=H.H,s=i.useState()[0];return s=typeof s.then=="function"?Ko(s):s,i=i.useState()[0],(Gt!==null?Gt.memoizedState:null)!==i&&(ft.flags|=1024),s}function A0(){var i=Uc!==0;return Uc=0,i}function C0(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function b0(i){if(Pc){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Pc=!1}Fa=0,xn=Gt=ft=null,Gs=!1,Wo=Uc=0,Vs=null}function Zn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?ft.memoizedState=xn=i:xn=xn.next=i,xn}function fn(){if(Gt===null){var i=ft.alternate;i=i!==null?i.memoizedState:null}else i=Gt.next;var s=xn===null?ft.memoizedState:xn.next;if(s!==null)xn=s,Gt=i;else{if(i===null)throw ft.alternate===null?Error(r(467)):Error(r(310));Gt=i,i={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},xn===null?ft.memoizedState=xn=i:xn=xn.next=i}return xn}function Bc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ko(i){var s=Wo;return Wo+=1,Vs===null&&(Vs=[]),i=Pp(Vs,i,s),s=ft,(xn===null?s.memoizedState:xn.next)===null&&(s=s.alternate,H.H=s===null||s.memoizedState===null?Nx:B0),i}function Hc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Ko(i);if(i.$$typeof===b)return Fn(i)}throw Error(r(438,String(i)))}function N0(i){var s=null,c=ft.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var h=ft.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=Bc(),ft.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),h=0;h<i;h++)c[h]=ae;return s.index++,c}function La(i,s){return typeof s=="function"?s(i):s}function Gc(i){var s=fn();return k0(s,Gt,i)}function k0(i,s,c){var h=i.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=c;var g=i.baseQueue,_=h.pending;if(_!==null){if(g!==null){var C=g.next;g.next=_.next,_.next=C}s.baseQueue=g=_,h.pending=null}if(_=i.baseState,g===null)i.memoizedState=_;else{s=g.next;var M=C=null,K=null,ue=s,Ee=!1;do{var be=ue.lane&-536870913;if(be!==ue.lane?(Tt&be)===be:(Fa&be)===be){var me=ue.revertLane;if(me===0)K!==null&&(K=K.next={lane:0,revertLane:0,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),be===Os&&(Ee=!0);else if((Fa&me)===me){ue=ue.next,me===Os&&(Ee=!0);continue}else be={lane:0,revertLane:ue.revertLane,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},K===null?(M=K=be,C=_):K=K.next=be,ft.lanes|=me,xi|=me;be=ue.action,Qi&&c(_,be),_=ue.hasEagerState?ue.eagerState:c(_,be)}else me={lane:be,revertLane:ue.revertLane,gesture:ue.gesture,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},K===null?(M=K=me,C=_):K=K.next=me,ft.lanes|=be,xi|=be;ue=ue.next}while(ue!==null&&ue!==s);if(K===null?C=_:K.next=M,!vr(_,i.memoizedState)&&(gn=!0,Ee&&(c=Ps,c!==null)))throw c;i.memoizedState=_,i.baseState=C,i.baseQueue=K,h.lastRenderedState=_}return g===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function R0(i){var s=fn(),c=s.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=i;var h=c.dispatch,g=c.pending,_=s.memoizedState;if(g!==null){c.pending=null;var C=g=g.next;do _=i(_,C.action),C=C.next;while(C!==g);vr(_,s.memoizedState)||(gn=!0),s.memoizedState=_,s.baseQueue===null&&(s.baseState=_),c.lastRenderedState=_}return[_,h]}function Jp(i,s,c){var h=ft,g=fn(),_=At;if(_){if(c===void 0)throw Error(r(407));c=c()}else c=s();var C=!vr((Gt||g).memoizedState,c);if(C&&(g.memoizedState=c,gn=!0),g=g.queue,I0($p.bind(null,h,g,i),[i]),g.getSnapshot!==s||C||xn!==null&&xn.memoizedState.tag&1){if(h.flags|=2048,zs(9,{destroy:void 0},Kp.bind(null,h,g,c,s),null),jt===null)throw Error(r(349));_||(Fa&127)!==0||Wp(h,s,c)}return c}function Wp(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=ft.updateQueue,s===null?(s=Bc(),ft.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function Kp(i,s,c,h){s.value=c,s.getSnapshot=h,Qp(s)&&Zp(i)}function $p(i,s,c){return c(function(){Qp(s)&&Zp(i)})}function Qp(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!vr(i,c)}catch{return!0}}function Zp(i){var s=zi(i,2);s!==null&&dr(s,i,2)}function D0(i){var s=Zn();if(typeof i=="function"){var c=i;if(i=c(),Qi){Qe(!0);try{c()}finally{Qe(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:La,lastRenderedState:i},s}function ex(i,s,c,h){return i.baseState=c,k0(i,Gt,typeof h=="function"?h:La)}function zS(i,s,c,h,g){if(qc(i))throw Error(r(485));if(i=s.action,i!==null){var _={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){_.listeners.push(C)}};H.T!==null?c(!0):_.isTransition=!1,h(_),c=s.pending,c===null?(_.next=s.pending=_,tx(s,_)):(_.next=c.next,s.pending=c.next=_)}}function tx(i,s){var c=s.action,h=s.payload,g=i.state;if(s.isTransition){var _=H.T,C={};H.T=C;try{var M=c(g,h),K=H.S;K!==null&&K(C,M),nx(i,s,M)}catch(ue){M0(i,s,ue)}finally{_!==null&&C.types!==null&&(_.types=C.types),H.T=_}}else try{_=c(g,h),nx(i,s,_)}catch(ue){M0(i,s,ue)}}function nx(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){rx(i,s,h)},function(h){return M0(i,s,h)}):rx(i,s,c)}function rx(i,s,c){s.status="fulfilled",s.value=c,ax(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,tx(i,c)))}function M0(i,s,c){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=c,ax(s),s=s.next;while(s!==h)}i.action=null}function ax(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function ix(i,s){return s}function sx(i,s){if(At){var c=jt.formState;if(c!==null){e:{var h=ft;if(At){if(Jt){t:{for(var g=Jt,_=Pr;g.nodeType!==8;){if(!_){g=null;break t}if(g=Br(g.nextSibling),g===null){g=null;break t}}_=g.data,g=_==="F!"||_==="F"?g:null}if(g){Jt=Br(g.nextSibling),h=g.data==="F!";break e}}oi(h)}h=!1}h&&(s=c[0])}}return c=Zn(),c.memoizedState=c.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ix,lastRenderedState:s},c.queue=h,c=Ax.bind(null,ft,h),h.dispatch=c,h=D0(!1),_=U0.bind(null,ft,!1,h.queue),h=Zn(),g={state:s,dispatch:null,action:i,pending:null},h.queue=g,c=zS.bind(null,ft,g,_,c),g.dispatch=c,h.memoizedState=i,[s,c,!1]}function ox(i){var s=fn();return lx(s,Gt,i)}function lx(i,s,c){if(s=k0(i,s,ix)[0],i=Gc(La)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=Ko(s)}catch(C){throw C===Us?Dc:C}else h=s;s=fn();var g=s.queue,_=g.dispatch;return c!==s.memoizedState&&(ft.flags|=2048,zs(9,{destroy:void 0},qS.bind(null,g,c),null)),[h,_,i]}function qS(i,s){i.action=s}function cx(i){var s=fn(),c=Gt;if(c!==null)return lx(s,c,i);fn(),s=s.memoizedState,c=fn();var h=c.queue.dispatch;return c.memoizedState=i,[s,h,!1]}function zs(i,s,c,h){return i={tag:i,create:c,deps:h,inst:s,next:null},s=ft.updateQueue,s===null&&(s=Bc(),ft.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(h=c.next,c.next=i,i.next=h,s.lastEffect=i),i}function ux(){return fn().memoizedState}function Vc(i,s,c,h){var g=Zn();ft.flags|=i,g.memoizedState=zs(1|s,{destroy:void 0},c,h===void 0?null:h)}function zc(i,s,c,h){var g=fn();h=h===void 0?null:h;var _=g.memoizedState.inst;Gt!==null&&h!==null&&S0(h,Gt.memoizedState.deps)?g.memoizedState=zs(s,_,c,h):(ft.flags|=i,g.memoizedState=zs(1|s,_,c,h))}function fx(i,s){Vc(8390656,8,i,s)}function I0(i,s){zc(2048,8,i,s)}function jS(i){ft.flags|=4;var s=ft.updateQueue;if(s===null)s=Bc(),ft.updateQueue=s,s.events=[i];else{var c=s.events;c===null?s.events=[i]:c.push(i)}}function dx(i){var s=fn().memoizedState;return jS({ref:s,nextImpl:i}),function(){if((It&2)!==0)throw Error(r(440));return s.impl.apply(void 0,arguments)}}function hx(i,s){return zc(4,2,i,s)}function mx(i,s){return zc(4,4,i,s)}function px(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function xx(i,s,c){c=c!=null?c.concat([i]):null,zc(4,4,px.bind(null,s,i),c)}function F0(){}function gx(i,s){var c=fn();s=s===void 0?null:s;var h=c.memoizedState;return s!==null&&S0(s,h[1])?h[0]:(c.memoizedState=[i,s],i)}function vx(i,s){var c=fn();s=s===void 0?null:s;var h=c.memoizedState;if(s!==null&&S0(s,h[1]))return h[0];if(h=i(),Qi){Qe(!0);try{i()}finally{Qe(!1)}}return c.memoizedState=[h,s],h}function L0(i,s,c){return c===void 0||(Fa&1073741824)!==0&&(Tt&261930)===0?i.memoizedState=s:(i.memoizedState=c,i=yg(),ft.lanes|=i,xi|=i,c)}function yx(i,s,c,h){return vr(c,s)?c:Hs.current!==null?(i=L0(i,c,h),vr(i,s)||(gn=!0),i):(Fa&42)===0||(Fa&1073741824)!==0&&(Tt&261930)===0?(gn=!0,i.memoizedState=c):(i=yg(),ft.lanes|=i,xi|=i,s)}function _x(i,s,c,h,g){var _=ee.p;ee.p=_!==0&&8>_?_:8;var C=H.T,M={};H.T=M,U0(i,!1,s,c);try{var K=g(),ue=H.S;if(ue!==null&&ue(M,K),K!==null&&typeof K=="object"&&typeof K.then=="function"){var Ee=HS(K,h);$o(i,s,Ee,wr(i))}else $o(i,s,h,wr(i))}catch(be){$o(i,s,{then:function(){},status:"rejected",reason:be},wr())}finally{ee.p=_,C!==null&&M.types!==null&&(C.types=M.types),H.T=C}}function YS(){}function O0(i,s,c,h){if(i.tag!==5)throw Error(r(476));var g=Ex(i).queue;_x(i,g,s,Ce,c===null?YS:function(){return Tx(i),c(h)})}function Ex(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Ce,baseState:Ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:La,lastRenderedState:Ce},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:La,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function Tx(i){var s=Ex(i);s.next===null&&(s=i.alternate.memoizedState),$o(i,s.next.queue,{},wr())}function P0(){return Fn(ml)}function Sx(){return fn().memoizedState}function wx(){return fn().memoizedState}function XS(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=wr();i=ui(c);var h=fi(s,i,c);h!==null&&(dr(h,s,c),Yo(h,s,c)),s={cache:d0()},i.payload=s;return}s=s.return}}function JS(i,s,c){var h=wr();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},qc(i)?Cx(s,c):(c=t0(i,s,c,h),c!==null&&(dr(c,i,h),bx(c,s,h)))}function Ax(i,s,c){var h=wr();$o(i,s,c,h)}function $o(i,s,c,h){var g={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(qc(i))Cx(s,g);else{var _=i.alternate;if(i.lanes===0&&(_===null||_.lanes===0)&&(_=s.lastRenderedReducer,_!==null))try{var C=s.lastRenderedState,M=_(C,c);if(g.hasEagerState=!0,g.eagerState=M,vr(M,C))return wc(i,s,g,0),jt===null&&Sc(),!1}catch{}finally{}if(c=t0(i,s,g,h),c!==null)return dr(c,i,h),bx(c,s,h),!0}return!1}function U0(i,s,c,h){if(h={lane:2,revertLane:xd(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},qc(i)){if(s)throw Error(r(479))}else s=t0(i,c,h,2),s!==null&&dr(s,i,2)}function qc(i){var s=i.alternate;return i===ft||s!==null&&s===ft}function Cx(i,s){Gs=Pc=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function bx(i,s,c){if((c&4194048)!==0){var h=s.lanes;h&=i.pendingLanes,c|=h,s.lanes=c,Ts(i,c)}}var Qo={readContext:Fn,use:Hc,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useLayoutEffect:an,useInsertionEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useSyncExternalStore:an,useId:an,useHostTransitionStatus:an,useFormState:an,useActionState:an,useOptimistic:an,useMemoCache:an,useCacheRefresh:an};Qo.useEffectEvent=an;var Nx={readContext:Fn,use:Hc,useCallback:function(i,s){return Zn().memoizedState=[i,s===void 0?null:s],i},useContext:Fn,useEffect:fx,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,Vc(4194308,4,px.bind(null,s,i),c)},useLayoutEffect:function(i,s){return Vc(4194308,4,i,s)},useInsertionEffect:function(i,s){Vc(4,2,i,s)},useMemo:function(i,s){var c=Zn();s=s===void 0?null:s;var h=i();if(Qi){Qe(!0);try{i()}finally{Qe(!1)}}return c.memoizedState=[h,s],h},useReducer:function(i,s,c){var h=Zn();if(c!==void 0){var g=c(s);if(Qi){Qe(!0);try{c(s)}finally{Qe(!1)}}}else g=s;return h.memoizedState=h.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},h.queue=i,i=i.dispatch=JS.bind(null,ft,i),[h.memoizedState,i]},useRef:function(i){var s=Zn();return i={current:i},s.memoizedState=i},useState:function(i){i=D0(i);var s=i.queue,c=Ax.bind(null,ft,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:F0,useDeferredValue:function(i,s){var c=Zn();return L0(c,i,s)},useTransition:function(){var i=D0(!1);return i=_x.bind(null,ft,i.queue,!0,!1),Zn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var h=ft,g=Zn();if(At){if(c===void 0)throw Error(r(407));c=c()}else{if(c=s(),jt===null)throw Error(r(349));(Tt&127)!==0||Wp(h,s,c)}g.memoizedState=c;var _={value:c,getSnapshot:s};return g.queue=_,fx($p.bind(null,h,_,i),[i]),h.flags|=2048,zs(9,{destroy:void 0},Kp.bind(null,h,_,c,s),null),c},useId:function(){var i=Zn(),s=jt.identifierPrefix;if(At){var c=ga,h=xa;c=(h&~(1<<32-lt(h)-1)).toString(32)+c,s="_"+s+"R_"+c,c=Uc++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=GS++,s="_"+s+"r_"+c.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:P0,useFormState:sx,useActionState:sx,useOptimistic:function(i){var s=Zn();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=U0.bind(null,ft,!0,c),c.dispatch=s,[i,s]},useMemoCache:N0,useCacheRefresh:function(){return Zn().memoizedState=XS.bind(null,ft)},useEffectEvent:function(i){var s=Zn(),c={impl:i};return s.memoizedState=c,function(){if((It&2)!==0)throw Error(r(440));return c.impl.apply(void 0,arguments)}}},B0={readContext:Fn,use:Hc,useCallback:gx,useContext:Fn,useEffect:I0,useImperativeHandle:xx,useInsertionEffect:hx,useLayoutEffect:mx,useMemo:vx,useReducer:Gc,useRef:ux,useState:function(){return Gc(La)},useDebugValue:F0,useDeferredValue:function(i,s){var c=fn();return yx(c,Gt.memoizedState,i,s)},useTransition:function(){var i=Gc(La)[0],s=fn().memoizedState;return[typeof i=="boolean"?i:Ko(i),s]},useSyncExternalStore:Jp,useId:Sx,useHostTransitionStatus:P0,useFormState:ox,useActionState:ox,useOptimistic:function(i,s){var c=fn();return ex(c,Gt,i,s)},useMemoCache:N0,useCacheRefresh:wx};B0.useEffectEvent=dx;var kx={readContext:Fn,use:Hc,useCallback:gx,useContext:Fn,useEffect:I0,useImperativeHandle:xx,useInsertionEffect:hx,useLayoutEffect:mx,useMemo:vx,useReducer:R0,useRef:ux,useState:function(){return R0(La)},useDebugValue:F0,useDeferredValue:function(i,s){var c=fn();return Gt===null?L0(c,i,s):yx(c,Gt.memoizedState,i,s)},useTransition:function(){var i=R0(La)[0],s=fn().memoizedState;return[typeof i=="boolean"?i:Ko(i),s]},useSyncExternalStore:Jp,useId:Sx,useHostTransitionStatus:P0,useFormState:cx,useActionState:cx,useOptimistic:function(i,s){var c=fn();return Gt!==null?ex(c,Gt,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:N0,useCacheRefresh:wx};kx.useEffectEvent=dx;function H0(i,s,c,h){s=i.memoizedState,c=c(h,s),c=c==null?s:v({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var G0={enqueueSetState:function(i,s,c){i=i._reactInternals;var h=wr(),g=ui(h);g.payload=s,c!=null&&(g.callback=c),s=fi(i,g,h),s!==null&&(dr(s,i,h),Yo(s,i,h))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var h=wr(),g=ui(h);g.tag=1,g.payload=s,c!=null&&(g.callback=c),s=fi(i,g,h),s!==null&&(dr(s,i,h),Yo(s,i,h))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=wr(),h=ui(c);h.tag=2,s!=null&&(h.callback=s),s=fi(i,h,c),s!==null&&(dr(s,i,c),Yo(s,i,c))}};function Rx(i,s,c,h,g,_,C){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,_,C):s.prototype&&s.prototype.isPureReactComponent?!Uo(c,h)||!Uo(g,_):!0}function Dx(i,s,c,h){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,h),s.state!==i&&G0.enqueueReplaceState(s,s.state,null)}function Zi(i,s){var c=s;if("ref"in s){c={};for(var h in s)h!=="ref"&&(c[h]=s[h])}if(i=i.defaultProps){c===s&&(c=v({},c));for(var g in i)c[g]===void 0&&(c[g]=i[g])}return c}function Mx(i){Tc(i)}function Ix(i){console.error(i)}function Fx(i){Tc(i)}function jc(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function Lx(i,s,c){try{var h=i.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function V0(i,s,c){return c=ui(c),c.tag=3,c.payload={element:null},c.callback=function(){jc(i,s)},c}function Ox(i){return i=ui(i),i.tag=3,i}function Px(i,s,c,h){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var _=h.value;i.payload=function(){return g(_)},i.callback=function(){Lx(s,c,h)}}var C=c.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(i.callback=function(){Lx(s,c,h),typeof g!="function"&&(gi===null?gi=new Set([this]):gi.add(this));var M=h.stack;this.componentDidCatch(h.value,{componentStack:M!==null?M:""})})}function WS(i,s,c,h,g){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=c.alternate,s!==null&&Ls(s,c,g,!0),c=_r.current,c!==null){switch(c.tag){case 31:case 13:return Ur===null?ru():c.alternate===null&&sn===0&&(sn=3),c.flags&=-257,c.flags|=65536,c.lanes=g,h===Mc?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([h]):s.add(h),hd(i,h,g)),!1;case 22:return c.flags|=65536,h===Mc?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([h]):c.add(h)),hd(i,h,g)),!1}throw Error(r(435,c.tag))}return hd(i,h,g),ru(),!1}if(At)return s=_r.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,h!==o0&&(i=Error(r(422),{cause:h}),Go(Fr(i,c)))):(h!==o0&&(s=Error(r(423),{cause:h}),Go(Fr(s,c))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,h=Fr(h,c),g=V0(i.stateNode,h,g),v0(i,g),sn!==4&&(sn=2)),!1;var _=Error(r(520),{cause:h});if(_=Fr(_,c),sl===null?sl=[_]:sl.push(_),sn!==4&&(sn=2),s===null)return!0;h=Fr(h,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=g&-g,c.lanes|=i,i=V0(c.stateNode,h,i),v0(c,i),!1;case 1:if(s=c.type,_=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(gi===null||!gi.has(_))))return c.flags|=65536,g&=-g,c.lanes|=g,g=Ox(g),Px(g,i,c,h),v0(c,g),!1}c=c.return}while(c!==null);return!1}var z0=Error(r(461)),gn=!1;function Ln(i,s,c,h){s.child=i===null?Gp(s,null,c,h):$i(s,i.child,c,h)}function Ux(i,s,c,h,g){c=c.render;var _=s.ref;if("ref"in h){var C={};for(var M in h)M!=="ref"&&(C[M]=h[M])}else C=h;return Xi(s),h=w0(i,s,c,C,_,g),M=A0(),i!==null&&!gn?(C0(i,s,g),Oa(i,s,g)):(At&&M&&i0(s),s.flags|=1,Ln(i,s,h,g),s.child)}function Bx(i,s,c,h,g){if(i===null){var _=c.type;return typeof _=="function"&&!n0(_)&&_.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=_,Hx(i,s,_,h,g)):(i=Cc(c.type,null,h,s,s.mode,g),i.ref=s.ref,i.return=s,s.child=i)}if(_=i.child,!$0(i,g)){var C=_.memoizedProps;if(c=c.compare,c=c!==null?c:Uo,c(C,h)&&i.ref===s.ref)return Oa(i,s,g)}return s.flags|=1,i=Ra(_,h),i.ref=s.ref,i.return=s,s.child=i}function Hx(i,s,c,h,g){if(i!==null){var _=i.memoizedProps;if(Uo(_,h)&&i.ref===s.ref)if(gn=!1,s.pendingProps=h=_,$0(i,g))(i.flags&131072)!==0&&(gn=!0);else return s.lanes=i.lanes,Oa(i,s,g)}return q0(i,s,c,h,g)}function Gx(i,s,c,h){var g=h.children,_=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((s.flags&128)!==0){if(_=_!==null?_.baseLanes|c:c,i!==null){for(h=s.child=i.child,g=0;h!==null;)g=g|h.lanes|h.childLanes,h=h.sibling;h=g&~_}else h=0,s.child=null;return Vx(i,s,_,c,h)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Rc(s,_!==null?_.cachePool:null),_!==null?qp(s,_):_0(),jp(s);else return h=s.lanes=536870912,Vx(i,s,_!==null?_.baseLanes|c:c,c,h)}else _!==null?(Rc(s,_.cachePool),qp(s,_),hi(),s.memoizedState=null):(i!==null&&Rc(s,null),_0(),hi());return Ln(i,s,g,c),s.child}function Zo(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function Vx(i,s,c,h,g){var _=m0();return _=_===null?null:{parent:pn._currentValue,pool:_},s.memoizedState={baseLanes:c,cachePool:_},i!==null&&Rc(s,null),_0(),jp(s),i!==null&&Ls(i,s,h,!0),s.childLanes=g,null}function Yc(i,s){return s=Jc({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function zx(i,s,c){return $i(s,i.child,null,c),i=Yc(s,s.pendingProps),i.flags|=2,Er(s),s.memoizedState=null,i}function KS(i,s,c){var h=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(At){if(h.mode==="hidden")return i=Yc(s,h),s.lanes=536870912,Zo(null,i);if(T0(s),(i=Jt)?(i=t1(i,Pr),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:ii!==null?{id:xa,overflow:ga}:null,retryLane:536870912,hydrationErrors:null},c=Cp(i),c.return=s,s.child=c,In=s,Jt=null)):i=null,i===null)throw oi(s);return s.lanes=536870912,null}return Yc(s,h)}var _=i.memoizedState;if(_!==null){var C=_.dehydrated;if(T0(s),g)if(s.flags&256)s.flags&=-257,s=zx(i,s,c);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(r(558));else if(gn||Ls(i,s,c,!1),g=(c&i.childLanes)!==0,gn||g){if(h=jt,h!==null&&(C=dc(h,c),C!==0&&C!==_.retryLane))throw _.retryLane=C,zi(i,C),dr(h,i,C),z0;ru(),s=zx(i,s,c)}else i=_.treeContext,Jt=Br(C.nextSibling),In=s,At=!0,si=null,Pr=!1,i!==null&&kp(s,i),s=Yc(s,h),s.flags|=4096;return s}return i=Ra(i.child,{mode:h.mode,children:h.children}),i.ref=s.ref,s.child=i,i.return=s,i}function Xc(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(r(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function q0(i,s,c,h,g){return Xi(s),c=w0(i,s,c,h,void 0,g),h=A0(),i!==null&&!gn?(C0(i,s,g),Oa(i,s,g)):(At&&h&&i0(s),s.flags|=1,Ln(i,s,c,g),s.child)}function qx(i,s,c,h,g,_){return Xi(s),s.updateQueue=null,c=Xp(s,h,c,g),Yp(i),h=A0(),i!==null&&!gn?(C0(i,s,_),Oa(i,s,_)):(At&&h&&i0(s),s.flags|=1,Ln(i,s,c,_),s.child)}function jx(i,s,c,h,g){if(Xi(s),s.stateNode===null){var _=Ds,C=c.contextType;typeof C=="object"&&C!==null&&(_=Fn(C)),_=new c(h,_),s.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=G0,s.stateNode=_,_._reactInternals=s,_=s.stateNode,_.props=h,_.state=s.memoizedState,_.refs={},x0(s),C=c.contextType,_.context=typeof C=="object"&&C!==null?Fn(C):Ds,_.state=s.memoizedState,C=c.getDerivedStateFromProps,typeof C=="function"&&(H0(s,c,C,h),_.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(C=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),C!==_.state&&G0.enqueueReplaceState(_,_.state,null),Jo(s,h,_,g),Xo(),_.state=s.memoizedState),typeof _.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(i===null){_=s.stateNode;var M=s.memoizedProps,K=Zi(c,M);_.props=K;var ue=_.context,Ee=c.contextType;C=Ds,typeof Ee=="object"&&Ee!==null&&(C=Fn(Ee));var be=c.getDerivedStateFromProps;Ee=typeof be=="function"||typeof _.getSnapshotBeforeUpdate=="function",M=s.pendingProps!==M,Ee||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(M||ue!==C)&&Dx(s,_,h,C),ci=!1;var me=s.memoizedState;_.state=me,Jo(s,h,_,g),Xo(),ue=s.memoizedState,M||me!==ue||ci?(typeof be=="function"&&(H0(s,c,be,h),ue=s.memoizedState),(K=ci||Rx(s,c,K,h,me,ue,C))?(Ee||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(s.flags|=4194308)):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=ue),_.props=h,_.state=ue,_.context=C,h=K):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{_=s.stateNode,g0(i,s),C=s.memoizedProps,Ee=Zi(c,C),_.props=Ee,be=s.pendingProps,me=_.context,ue=c.contextType,K=Ds,typeof ue=="object"&&ue!==null&&(K=Fn(ue)),M=c.getDerivedStateFromProps,(ue=typeof M=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(C!==be||me!==K)&&Dx(s,_,h,K),ci=!1,me=s.memoizedState,_.state=me,Jo(s,h,_,g),Xo();var xe=s.memoizedState;C!==be||me!==xe||ci||i!==null&&i.dependencies!==null&&Nc(i.dependencies)?(typeof M=="function"&&(H0(s,c,M,h),xe=s.memoizedState),(Ee=ci||Rx(s,c,Ee,h,me,xe,K)||i!==null&&i.dependencies!==null&&Nc(i.dependencies))?(ue||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(h,xe,K),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(h,xe,K)),typeof _.componentDidUpdate=="function"&&(s.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof _.componentDidUpdate!="function"||C===i.memoizedProps&&me===i.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||C===i.memoizedProps&&me===i.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=xe),_.props=h,_.state=xe,_.context=K,h=Ee):(typeof _.componentDidUpdate!="function"||C===i.memoizedProps&&me===i.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||C===i.memoizedProps&&me===i.memoizedState||(s.flags|=1024),h=!1)}return _=h,Xc(i,s),h=(s.flags&128)!==0,_||h?(_=s.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:_.render(),s.flags|=1,i!==null&&h?(s.child=$i(s,i.child,null,g),s.child=$i(s,null,c,g)):Ln(i,s,c,g),s.memoizedState=_.state,i=s.child):i=Oa(i,s,g),i}function Yx(i,s,c,h){return ji(),s.flags|=256,Ln(i,s,c,h),s.child}var j0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Y0(i){return{baseLanes:i,cachePool:Lp()}}function X0(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=Sr),i}function Xx(i,s,c){var h=s.pendingProps,g=!1,_=(s.flags&128)!==0,C;if((C=_)||(C=i!==null&&i.memoizedState===null?!1:(un.current&2)!==0),C&&(g=!0,s.flags&=-129),C=(s.flags&32)!==0,s.flags&=-33,i===null){if(At){if(g?di(s):hi(),(i=Jt)?(i=t1(i,Pr),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:ii!==null?{id:xa,overflow:ga}:null,retryLane:536870912,hydrationErrors:null},c=Cp(i),c.return=s,s.child=c,In=s,Jt=null)):i=null,i===null)throw oi(s);return kd(i)?s.lanes=32:s.lanes=536870912,null}var M=h.children;return h=h.fallback,g?(hi(),g=s.mode,M=Jc({mode:"hidden",children:M},g),h=qi(h,g,c,null),M.return=s,h.return=s,M.sibling=h,s.child=M,h=s.child,h.memoizedState=Y0(c),h.childLanes=X0(i,C,c),s.memoizedState=j0,Zo(null,h)):(di(s),J0(s,M))}var K=i.memoizedState;if(K!==null&&(M=K.dehydrated,M!==null)){if(_)s.flags&256?(di(s),s.flags&=-257,s=W0(i,s,c)):s.memoizedState!==null?(hi(),s.child=i.child,s.flags|=128,s=null):(hi(),M=h.fallback,g=s.mode,h=Jc({mode:"visible",children:h.children},g),M=qi(M,g,c,null),M.flags|=2,h.return=s,M.return=s,h.sibling=M,s.child=h,$i(s,i.child,null,c),h=s.child,h.memoizedState=Y0(c),h.childLanes=X0(i,C,c),s.memoizedState=j0,s=Zo(null,h));else if(di(s),kd(M)){if(C=M.nextSibling&&M.nextSibling.dataset,C)var ue=C.dgst;C=ue,h=Error(r(419)),h.stack="",h.digest=C,Go({value:h,source:null,stack:null}),s=W0(i,s,c)}else if(gn||Ls(i,s,c,!1),C=(c&i.childLanes)!==0,gn||C){if(C=jt,C!==null&&(h=dc(C,c),h!==0&&h!==K.retryLane))throw K.retryLane=h,zi(i,h),dr(C,i,h),z0;Nd(M)||ru(),s=W0(i,s,c)}else Nd(M)?(s.flags|=192,s.child=i.child,s=null):(i=K.treeContext,Jt=Br(M.nextSibling),In=s,At=!0,si=null,Pr=!1,i!==null&&kp(s,i),s=J0(s,h.children),s.flags|=4096);return s}return g?(hi(),M=h.fallback,g=s.mode,K=i.child,ue=K.sibling,h=Ra(K,{mode:"hidden",children:h.children}),h.subtreeFlags=K.subtreeFlags&65011712,ue!==null?M=Ra(ue,M):(M=qi(M,g,c,null),M.flags|=2),M.return=s,h.return=s,h.sibling=M,s.child=h,Zo(null,h),h=s.child,M=i.child.memoizedState,M===null?M=Y0(c):(g=M.cachePool,g!==null?(K=pn._currentValue,g=g.parent!==K?{parent:K,pool:K}:g):g=Lp(),M={baseLanes:M.baseLanes|c,cachePool:g}),h.memoizedState=M,h.childLanes=X0(i,C,c),s.memoizedState=j0,Zo(i.child,h)):(di(s),c=i.child,i=c.sibling,c=Ra(c,{mode:"visible",children:h.children}),c.return=s,c.sibling=null,i!==null&&(C=s.deletions,C===null?(s.deletions=[i],s.flags|=16):C.push(i)),s.child=c,s.memoizedState=null,c)}function J0(i,s){return s=Jc({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function Jc(i,s){return i=yr(22,i,null,s),i.lanes=0,i}function W0(i,s,c){return $i(s,i.child,null,c),i=J0(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function Jx(i,s,c){i.lanes|=s;var h=i.alternate;h!==null&&(h.lanes|=s),u0(i.return,s,c)}function K0(i,s,c,h,g,_){var C=i.memoizedState;C===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:g,treeForkCount:_}:(C.isBackwards=s,C.rendering=null,C.renderingStartTime=0,C.last=h,C.tail=c,C.tailMode=g,C.treeForkCount=_)}function Wx(i,s,c){var h=s.pendingProps,g=h.revealOrder,_=h.tail;h=h.children;var C=un.current,M=(C&2)!==0;if(M?(C=C&1|2,s.flags|=128):C&=1,G(un,C),Ln(i,s,h,c),h=At?Ho:0,!M&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Jx(i,c,s);else if(i.tag===19)Jx(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(g){case"forwards":for(c=s.child,g=null;c!==null;)i=c.alternate,i!==null&&Oc(i)===null&&(g=c),c=c.sibling;c=g,c===null?(g=s.child,s.child=null):(g=c.sibling,c.sibling=null),K0(s,!1,g,c,_,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,g=s.child,s.child=null;g!==null;){if(i=g.alternate,i!==null&&Oc(i)===null){s.child=g;break}i=g.sibling,g.sibling=c,c=g,g=i}K0(s,!0,c,null,_,h);break;case"together":K0(s,!1,null,null,void 0,h);break;default:s.memoizedState=null}return s.child}function Oa(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),xi|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(Ls(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,c=Ra(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=Ra(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function $0(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Nc(i)))}function $S(i,s,c){switch(s.tag){case 3:ge(s,s.stateNode.containerInfo),li(s,pn,i.memoizedState.cache),ji();break;case 27:case 5:we(s);break;case 4:ge(s,s.stateNode.containerInfo);break;case 10:li(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,T0(s),null;break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(di(s),s.flags|=128,null):(c&s.child.childLanes)!==0?Xx(i,s,c):(di(s),i=Oa(i,s,c),i!==null?i.sibling:null);di(s);break;case 19:var g=(i.flags&128)!==0;if(h=(c&s.childLanes)!==0,h||(Ls(i,s,c,!1),h=(c&s.childLanes)!==0),g){if(h)return Wx(i,s,c);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),G(un,un.current),h)break;return null;case 22:return s.lanes=0,Gx(i,s,c,s.pendingProps);case 24:li(s,pn,i.memoizedState.cache)}return Oa(i,s,c)}function Kx(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)gn=!0;else{if(!$0(i,c)&&(s.flags&128)===0)return gn=!1,$S(i,s,c);gn=(i.flags&131072)!==0}else gn=!1,At&&(s.flags&1048576)!==0&&Np(s,Ho,s.index);switch(s.lanes=0,s.tag){case 16:e:{var h=s.pendingProps;if(i=Wi(s.elementType),s.type=i,typeof i=="function")n0(i)?(h=Zi(i,h),s.tag=1,s=jx(null,s,i,h,c)):(s.tag=0,s=q0(null,s,i,h,c));else{if(i!=null){var g=i.$$typeof;if(g===P){s.tag=11,s=Ux(null,s,i,h,c);break e}else if(g===D){s.tag=14,s=Bx(null,s,i,h,c);break e}}throw s=Te(i)||i,Error(r(306,s,""))}}return s;case 0:return q0(i,s,s.type,s.pendingProps,c);case 1:return h=s.type,g=Zi(h,s.pendingProps),jx(i,s,h,g,c);case 3:e:{if(ge(s,s.stateNode.containerInfo),i===null)throw Error(r(387));h=s.pendingProps;var _=s.memoizedState;g=_.element,g0(i,s),Jo(s,h,null,c);var C=s.memoizedState;if(h=C.cache,li(s,pn,h),h!==_.cache&&f0(s,[pn],c,!0),Xo(),h=C.element,_.isDehydrated)if(_={element:h,isDehydrated:!1,cache:C.cache},s.updateQueue.baseState=_,s.memoizedState=_,s.flags&256){s=Yx(i,s,h,c);break e}else if(h!==g){g=Fr(Error(r(424)),s),Go(g),s=Yx(i,s,h,c);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Jt=Br(i.firstChild),In=s,At=!0,si=null,Pr=!0,c=Gp(s,null,h,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(ji(),h===g){s=Oa(i,s,c);break e}Ln(i,s,h,c)}s=s.child}return s;case 26:return Xc(i,s),i===null?(c=o1(s.type,null,s.pendingProps,null))?s.memoizedState=c:At||(c=s.type,i=s.pendingProps,h=uu(q.current).createElement(c),h[O]=s,h[z]=i,On(h,c,i),We(h),s.stateNode=h):s.memoizedState=o1(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return we(s),i===null&&At&&(h=s.stateNode=a1(s.type,s.pendingProps,q.current),In=s,Pr=!0,g=Jt,Ei(s.type)?(Rd=g,Jt=Br(h.firstChild)):Jt=g),Ln(i,s,s.pendingProps.children,c),Xc(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&At&&((g=h=Jt)&&(h=bw(h,s.type,s.pendingProps,Pr),h!==null?(s.stateNode=h,In=s,Jt=Br(h.firstChild),Pr=!1,g=!0):g=!1),g||oi(s)),we(s),g=s.type,_=s.pendingProps,C=i!==null?i.memoizedProps:null,h=_.children,Ad(g,_)?h=null:C!==null&&Ad(g,C)&&(s.flags|=32),s.memoizedState!==null&&(g=w0(i,s,VS,null,null,c),ml._currentValue=g),Xc(i,s),Ln(i,s,h,c),s.child;case 6:return i===null&&At&&((i=c=Jt)&&(c=Nw(c,s.pendingProps,Pr),c!==null?(s.stateNode=c,In=s,Jt=null,i=!0):i=!1),i||oi(s)),null;case 13:return Xx(i,s,c);case 4:return ge(s,s.stateNode.containerInfo),h=s.pendingProps,i===null?s.child=$i(s,null,h,c):Ln(i,s,h,c),s.child;case 11:return Ux(i,s,s.type,s.pendingProps,c);case 7:return Ln(i,s,s.pendingProps,c),s.child;case 8:return Ln(i,s,s.pendingProps.children,c),s.child;case 12:return Ln(i,s,s.pendingProps.children,c),s.child;case 10:return h=s.pendingProps,li(s,s.type,h.value),Ln(i,s,h.children,c),s.child;case 9:return g=s.type._context,h=s.pendingProps.children,Xi(s),g=Fn(g),h=h(g),s.flags|=1,Ln(i,s,h,c),s.child;case 14:return Bx(i,s,s.type,s.pendingProps,c);case 15:return Hx(i,s,s.type,s.pendingProps,c);case 19:return Wx(i,s,c);case 31:return KS(i,s,c);case 22:return Gx(i,s,c,s.pendingProps);case 24:return Xi(s),h=Fn(pn),i===null?(g=m0(),g===null&&(g=jt,_=d0(),g.pooledCache=_,_.refCount++,_!==null&&(g.pooledCacheLanes|=c),g=_),s.memoizedState={parent:h,cache:g},x0(s),li(s,pn,g)):((i.lanes&c)!==0&&(g0(i,s),Jo(s,null,null,c),Xo()),g=i.memoizedState,_=s.memoizedState,g.parent!==h?(g={parent:h,cache:h},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),li(s,pn,h)):(h=_.cache,li(s,pn,h),h!==g.cache&&f0(s,[pn],c,!0))),Ln(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function Pa(i){i.flags|=4}function Q0(i,s,c,h,g){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(g&335544128)===g)if(i.stateNode.complete)i.flags|=8192;else if(Sg())i.flags|=8192;else throw Ki=Mc,p0}else i.flags&=-16777217}function $x(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!d1(s))if(Sg())i.flags|=8192;else throw Ki=Mc,p0}function Wc(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?yt():536870912,i.lanes|=s,Xs|=s)}function el(i,s){if(!At)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function Wt(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,h=0;if(s)for(var g=i.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=h,i.childLanes=c,s}function QS(i,s,c){var h=s.pendingProps;switch(s0(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(s),null;case 1:return Wt(s),null;case 3:return c=s.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),Ia(pn),ve(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(Fs(s)?Pa(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,l0())),Wt(s),null;case 26:var g=s.type,_=s.memoizedState;return i===null?(Pa(s),_!==null?(Wt(s),$x(s,_)):(Wt(s),Q0(s,g,null,h,c))):_?_!==i.memoizedState?(Pa(s),Wt(s),$x(s,_)):(Wt(s),s.flags&=-16777217):(i=i.memoizedProps,i!==h&&Pa(s),Wt(s),Q0(s,g,i,h,c)),null;case 27:if(Je(s),c=q.current,g=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==h&&Pa(s);else{if(!h){if(s.stateNode===null)throw Error(r(166));return Wt(s),null}i=U.current,Fs(s)?Rp(s):(i=a1(g,h,c),s.stateNode=i,Pa(s))}return Wt(s),null;case 5:if(Je(s),g=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==h&&Pa(s);else{if(!h){if(s.stateNode===null)throw Error(r(166));return Wt(s),null}if(_=U.current,Fs(s))Rp(s);else{var C=uu(q.current);switch(_){case 1:_=C.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:_=C.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":_=C.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":_=C.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":_=C.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof h.is=="string"?C.createElement("select",{is:h.is}):C.createElement("select"),h.multiple?_.multiple=!0:h.size&&(_.size=h.size);break;default:_=typeof h.is=="string"?C.createElement(g,{is:h.is}):C.createElement(g)}}_[O]=s,_[z]=h;e:for(C=s.child;C!==null;){if(C.tag===5||C.tag===6)_.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===s)break e;for(;C.sibling===null;){if(C.return===null||C.return===s)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}s.stateNode=_;e:switch(On(_,g,h),g){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Pa(s)}}return Wt(s),Q0(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,c),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==h&&Pa(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(r(166));if(i=q.current,Fs(s)){if(i=s.stateNode,c=s.memoizedProps,h=null,g=In,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}i[O]=s,i=!!(i.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||Xg(i.nodeValue,c)),i||oi(s,!0)}else i=uu(i).createTextNode(h),i[O]=s,s.stateNode=i}return Wt(s),null;case 31:if(c=s.memoizedState,i===null||i.memoizedState!==null){if(h=Fs(s),c!==null){if(i===null){if(!h)throw Error(r(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(557));i[O]=s}else ji(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Wt(s),i=!1}else c=l0(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=c),i=!0;if(!i)return s.flags&256?(Er(s),s):(Er(s),null);if((s.flags&128)!==0)throw Error(r(558))}return Wt(s),null;case 13:if(h=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=Fs(s),h!==null&&h.dehydrated!==null){if(i===null){if(!g)throw Error(r(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(r(317));g[O]=s}else ji(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Wt(s),g=!1}else g=l0(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(Er(s),s):(Er(s),null)}return Er(s),(s.flags&128)!==0?(s.lanes=c,s):(c=h!==null,i=i!==null&&i.memoizedState!==null,c&&(h=s.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool),_=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(_=h.memoizedState.cachePool.pool),_!==g&&(h.flags|=2048)),c!==i&&c&&(s.child.flags|=8192),Wc(s,s.updateQueue),Wt(s),null);case 4:return ve(),i===null&&_d(s.stateNode.containerInfo),Wt(s),null;case 10:return Ia(s.type),Wt(s),null;case 19:if(N(un),h=s.memoizedState,h===null)return Wt(s),null;if(g=(s.flags&128)!==0,_=h.rendering,_===null)if(g)el(h,!1);else{if(sn!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(_=Oc(i),_!==null){for(s.flags|=128,el(h,!1),i=_.updateQueue,s.updateQueue=i,Wc(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)Ap(c,i),c=c.sibling;return G(un,un.current&1|2),At&&Da(s,h.treeForkCount),s.child}i=i.sibling}h.tail!==null&&Mt()>eu&&(s.flags|=128,g=!0,el(h,!1),s.lanes=4194304)}else{if(!g)if(i=Oc(_),i!==null){if(s.flags|=128,g=!0,i=i.updateQueue,s.updateQueue=i,Wc(s,i),el(h,!0),h.tail===null&&h.tailMode==="hidden"&&!_.alternate&&!At)return Wt(s),null}else 2*Mt()-h.renderingStartTime>eu&&c!==536870912&&(s.flags|=128,g=!0,el(h,!1),s.lanes=4194304);h.isBackwards?(_.sibling=s.child,s.child=_):(i=h.last,i!==null?i.sibling=_:s.child=_,h.last=_)}return h.tail!==null?(i=h.tail,h.rendering=i,h.tail=i.sibling,h.renderingStartTime=Mt(),i.sibling=null,c=un.current,G(un,g?c&1|2:c&1),At&&Da(s,h.treeForkCount),i):(Wt(s),null);case 22:case 23:return Er(s),E0(),h=s.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(c&536870912)!==0&&(s.flags&128)===0&&(Wt(s),s.subtreeFlags&6&&(s.flags|=8192)):Wt(s),c=s.updateQueue,c!==null&&Wc(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==c&&(s.flags|=2048),i!==null&&N(Ji),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Ia(pn),Wt(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function ZS(i,s){switch(s0(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Ia(pn),ve(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Je(s),null;case 31:if(s.memoizedState!==null){if(Er(s),s.alternate===null)throw Error(r(340));ji()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(Er(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));ji()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return N(un),null;case 4:return ve(),null;case 10:return Ia(s.type),null;case 22:case 23:return Er(s),E0(),i!==null&&N(Ji),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Ia(pn),null;case 25:return null;default:return null}}function Qx(i,s){switch(s0(s),s.tag){case 3:Ia(pn),ve();break;case 26:case 27:case 5:Je(s);break;case 4:ve();break;case 31:s.memoizedState!==null&&Er(s);break;case 13:Er(s);break;case 19:N(un);break;case 10:Ia(s.type);break;case 22:case 23:Er(s),E0(),i!==null&&N(Ji);break;case 24:Ia(pn)}}function tl(i,s){try{var c=s.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&i)===i){h=void 0;var _=c.create,C=c.inst;h=_(),C.destroy=h}c=c.next}while(c!==g)}}catch(M){Ot(s,s.return,M)}}function mi(i,s,c){try{var h=s.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var _=g.next;h=_;do{if((h.tag&i)===i){var C=h.inst,M=C.destroy;if(M!==void 0){C.destroy=void 0,g=s;var K=c,ue=M;try{ue()}catch(Ee){Ot(g,K,Ee)}}}h=h.next}while(h!==_)}}catch(Ee){Ot(s,s.return,Ee)}}function Zx(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{zp(s,c)}catch(h){Ot(i,i.return,h)}}}function eg(i,s,c){c.props=Zi(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(h){Ot(i,s,h)}}function nl(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof c=="function"?i.refCleanup=c(h):c.current=h}}catch(g){Ot(i,s,g)}}function va(i,s){var c=i.ref,h=i.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(g){Ot(i,s,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){Ot(i,s,g)}else c.current=null}function tg(i){var s=i.type,c=i.memoizedProps,h=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(g){Ot(i,i.return,g)}}function Z0(i,s,c){try{var h=i.stateNode;Ew(h,i.type,c,s),h[z]=s}catch(g){Ot(i,i.return,g)}}function ng(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ei(i.type)||i.tag===4}function ed(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||ng(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ei(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function td(i,s,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Na));else if(h!==4&&(h===27&&Ei(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for(td(i,s,c),i=i.sibling;i!==null;)td(i,s,c),i=i.sibling}function Kc(i,s,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(h!==4&&(h===27&&Ei(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(Kc(i,s,c),i=i.sibling;i!==null;)Kc(i,s,c),i=i.sibling}function rg(i){var s=i.stateNode,c=i.memoizedProps;try{for(var h=i.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);On(s,h,c),s[O]=i,s[z]=c}catch(_){Ot(i,i.return,_)}}var Ua=!1,vn=!1,nd=!1,ag=typeof WeakSet=="function"?WeakSet:Set,Nn=null;function ew(i,s){if(i=i.containerInfo,Sd=gu,i=xp(i),Wf(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var g=h.anchorOffset,_=h.focusNode;h=h.focusOffset;try{c.nodeType,_.nodeType}catch{c=null;break e}var C=0,M=-1,K=-1,ue=0,Ee=0,be=i,me=null;t:for(;;){for(var xe;be!==c||g!==0&&be.nodeType!==3||(M=C+g),be!==_||h!==0&&be.nodeType!==3||(K=C+h),be.nodeType===3&&(C+=be.nodeValue.length),(xe=be.firstChild)!==null;)me=be,be=xe;for(;;){if(be===i)break t;if(me===c&&++ue===g&&(M=C),me===_&&++Ee===h&&(K=C),(xe=be.nextSibling)!==null)break;be=me,me=be.parentNode}be=xe}c=M===-1||K===-1?null:{start:M,end:K}}else c=null}c=c||{start:0,end:0}}else c=null;for(wd={focusedElem:i,selectionRange:c},gu=!1,Nn=s;Nn!==null;)if(s=Nn,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,Nn=i;else for(;Nn!==null;){switch(s=Nn,_=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(c=0;c<i.length;c++)g=i[c],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&_!==null){i=void 0,c=s,g=_.memoizedProps,_=_.memoizedState,h=c.stateNode;try{var Xe=Zi(c.type,g);i=h.getSnapshotBeforeUpdate(Xe,_),h.__reactInternalSnapshotBeforeUpdate=i}catch(tt){Ot(c,c.return,tt)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)bd(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":bd(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=s.sibling,i!==null){i.return=s.return,Nn=i;break}Nn=s.return}}function ig(i,s,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:Ha(i,c),h&4&&tl(5,c);break;case 1:if(Ha(i,c),h&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(C){Ot(c,c.return,C)}else{var g=Zi(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(g,s,i.__reactInternalSnapshotBeforeUpdate)}catch(C){Ot(c,c.return,C)}}h&64&&Zx(c),h&512&&nl(c,c.return);break;case 3:if(Ha(i,c),h&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{zp(i,s)}catch(C){Ot(c,c.return,C)}}break;case 27:s===null&&h&4&&rg(c);case 26:case 5:Ha(i,c),s===null&&h&4&&tg(c),h&512&&nl(c,c.return);break;case 12:Ha(i,c);break;case 31:Ha(i,c),h&4&&lg(i,c);break;case 13:Ha(i,c),h&4&&cg(i,c),h&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=cw.bind(null,c),kw(i,c))));break;case 22:if(h=c.memoizedState!==null||Ua,!h){s=s!==null&&s.memoizedState!==null||vn,g=Ua;var _=vn;Ua=h,(vn=s)&&!_?Ga(i,c,(c.subtreeFlags&8772)!==0):Ha(i,c),Ua=g,vn=_}break;case 30:break;default:Ha(i,c)}}function sg(i){var s=i.alternate;s!==null&&(i.alternate=null,sg(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&De(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var en=null,lr=!1;function Ba(i,s,c){for(c=c.child;c!==null;)og(i,s,c),c=c.sibling}function og(i,s,c){if(je&&typeof je.onCommitFiberUnmount=="function")try{je.onCommitFiberUnmount(Oe,c)}catch{}switch(c.tag){case 26:vn||va(c,s),Ba(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:vn||va(c,s);var h=en,g=lr;Ei(c.type)&&(en=c.stateNode,lr=!1),Ba(i,s,c),fl(c.stateNode),en=h,lr=g;break;case 5:vn||va(c,s);case 6:if(h=en,g=lr,en=null,Ba(i,s,c),en=h,lr=g,en!==null)if(lr)try{(en.nodeType===9?en.body:en.nodeName==="HTML"?en.ownerDocument.body:en).removeChild(c.stateNode)}catch(_){Ot(c,s,_)}else try{en.removeChild(c.stateNode)}catch(_){Ot(c,s,_)}break;case 18:en!==null&&(lr?(i=en,Zg(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),to(i)):Zg(en,c.stateNode));break;case 4:h=en,g=lr,en=c.stateNode.containerInfo,lr=!0,Ba(i,s,c),en=h,lr=g;break;case 0:case 11:case 14:case 15:mi(2,c,s),vn||mi(4,c,s),Ba(i,s,c);break;case 1:vn||(va(c,s),h=c.stateNode,typeof h.componentWillUnmount=="function"&&eg(c,s,h)),Ba(i,s,c);break;case 21:Ba(i,s,c);break;case 22:vn=(h=vn)||c.memoizedState!==null,Ba(i,s,c),vn=h;break;default:Ba(i,s,c)}}function lg(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{to(i)}catch(c){Ot(s,s.return,c)}}}function cg(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{to(i)}catch(c){Ot(s,s.return,c)}}function tw(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new ag),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new ag),s;default:throw Error(r(435,i.tag))}}function $c(i,s){var c=tw(i);s.forEach(function(h){if(!c.has(h)){c.add(h);var g=uw.bind(null,i,h);h.then(g,g)}})}function cr(i,s){var c=s.deletions;if(c!==null)for(var h=0;h<c.length;h++){var g=c[h],_=i,C=s,M=C;e:for(;M!==null;){switch(M.tag){case 27:if(Ei(M.type)){en=M.stateNode,lr=!1;break e}break;case 5:en=M.stateNode,lr=!1;break e;case 3:case 4:en=M.stateNode.containerInfo,lr=!0;break e}M=M.return}if(en===null)throw Error(r(160));og(_,C,g),en=null,lr=!1,_=g.alternate,_!==null&&(_.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)ug(s,i),s=s.sibling}var aa=null;function ug(i,s){var c=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:cr(s,i),ur(i),h&4&&(mi(3,i,i.return),tl(3,i),mi(5,i,i.return));break;case 1:cr(s,i),ur(i),h&512&&(vn||c===null||va(c,c.return)),h&64&&Ua&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var g=aa;if(cr(s,i),ur(i),h&512&&(vn||c===null||va(c,c.return)),h&4){var _=c!==null?c.memoizedState:null;if(h=i.memoizedState,c===null)if(h===null)if(i.stateNode===null){e:{h=i.type,c=i.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":_=g.getElementsByTagName("title")[0],(!_||_[pe]||_[O]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=g.createElement(h),g.head.insertBefore(_,g.querySelector("head > title"))),On(_,h,c),_[O]=i,We(_),h=_;break e;case"link":var C=u1("link","href",g).get(h+(c.href||""));if(C){for(var M=0;M<C.length;M++)if(_=C[M],_.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&_.getAttribute("rel")===(c.rel==null?null:c.rel)&&_.getAttribute("title")===(c.title==null?null:c.title)&&_.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){C.splice(M,1);break t}}_=g.createElement(h),On(_,h,c),g.head.appendChild(_);break;case"meta":if(C=u1("meta","content",g).get(h+(c.content||""))){for(M=0;M<C.length;M++)if(_=C[M],_.getAttribute("content")===(c.content==null?null:""+c.content)&&_.getAttribute("name")===(c.name==null?null:c.name)&&_.getAttribute("property")===(c.property==null?null:c.property)&&_.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&_.getAttribute("charset")===(c.charSet==null?null:c.charSet)){C.splice(M,1);break t}}_=g.createElement(h),On(_,h,c),g.head.appendChild(_);break;default:throw Error(r(468,h))}_[O]=i,We(_),h=_}i.stateNode=h}else f1(g,i.type,i.stateNode);else i.stateNode=c1(g,h,i.memoizedProps);else _!==h?(_===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):_.count--,h===null?f1(g,i.type,i.stateNode):c1(g,h,i.memoizedProps)):h===null&&i.stateNode!==null&&Z0(i,i.memoizedProps,c.memoizedProps)}break;case 27:cr(s,i),ur(i),h&512&&(vn||c===null||va(c,c.return)),c!==null&&h&4&&Z0(i,i.memoizedProps,c.memoizedProps);break;case 5:if(cr(s,i),ur(i),h&512&&(vn||c===null||va(c,c.return)),i.flags&32){g=i.stateNode;try{ws(g,"")}catch(Xe){Ot(i,i.return,Xe)}}h&4&&i.stateNode!=null&&(g=i.memoizedProps,Z0(i,g,c!==null?c.memoizedProps:g)),h&1024&&(nd=!0);break;case 6:if(cr(s,i),ur(i),h&4){if(i.stateNode===null)throw Error(r(162));h=i.memoizedProps,c=i.stateNode;try{c.nodeValue=h}catch(Xe){Ot(i,i.return,Xe)}}break;case 3:if(hu=null,g=aa,aa=fu(s.containerInfo),cr(s,i),aa=g,ur(i),h&4&&c!==null&&c.memoizedState.isDehydrated)try{to(s.containerInfo)}catch(Xe){Ot(i,i.return,Xe)}nd&&(nd=!1,fg(i));break;case 4:h=aa,aa=fu(i.stateNode.containerInfo),cr(s,i),ur(i),aa=h;break;case 12:cr(s,i),ur(i);break;case 31:cr(s,i),ur(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,$c(i,h)));break;case 13:cr(s,i),ur(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Zc=Mt()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,$c(i,h)));break;case 22:g=i.memoizedState!==null;var K=c!==null&&c.memoizedState!==null,ue=Ua,Ee=vn;if(Ua=ue||g,vn=Ee||K,cr(s,i),vn=Ee,Ua=ue,ur(i),h&8192)e:for(s=i.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(c===null||K||Ua||vn||es(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){K=c=s;try{if(_=K.stateNode,g)C=_.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{M=K.stateNode;var be=K.memoizedProps.style,me=be!=null&&be.hasOwnProperty("display")?be.display:null;M.style.display=me==null||typeof me=="boolean"?"":(""+me).trim()}}catch(Xe){Ot(K,K.return,Xe)}}}else if(s.tag===6){if(c===null){K=s;try{K.stateNode.nodeValue=g?"":K.memoizedProps}catch(Xe){Ot(K,K.return,Xe)}}}else if(s.tag===18){if(c===null){K=s;try{var xe=K.stateNode;g?e1(xe,!0):e1(K.stateNode,!1)}catch(Xe){Ot(K,K.return,Xe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=i.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,$c(i,c))));break;case 19:cr(s,i),ur(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,$c(i,h)));break;case 30:break;case 21:break;default:cr(s,i),ur(i)}}function ur(i){var s=i.flags;if(s&2){try{for(var c,h=i.return;h!==null;){if(ng(h)){c=h;break}h=h.return}if(c==null)throw Error(r(160));switch(c.tag){case 27:var g=c.stateNode,_=ed(i);Kc(i,_,g);break;case 5:var C=c.stateNode;c.flags&32&&(ws(C,""),c.flags&=-33);var M=ed(i);Kc(i,M,C);break;case 3:case 4:var K=c.stateNode.containerInfo,ue=ed(i);td(i,ue,K);break;default:throw Error(r(161))}}catch(Ee){Ot(i,i.return,Ee)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function fg(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;fg(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ha(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)ig(i,s.alternate,s),s=s.sibling}function es(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:mi(4,s,s.return),es(s);break;case 1:va(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&eg(s,s.return,c),es(s);break;case 27:fl(s.stateNode);case 26:case 5:va(s,s.return),es(s);break;case 22:s.memoizedState===null&&es(s);break;case 30:es(s);break;default:es(s)}i=i.sibling}}function Ga(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,g=i,_=s,C=_.flags;switch(_.tag){case 0:case 11:case 15:Ga(g,_,c),tl(4,_);break;case 1:if(Ga(g,_,c),h=_,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(ue){Ot(h,h.return,ue)}if(h=_,g=h.updateQueue,g!==null){var M=h.stateNode;try{var K=g.shared.hiddenCallbacks;if(K!==null)for(g.shared.hiddenCallbacks=null,g=0;g<K.length;g++)Vp(K[g],M)}catch(ue){Ot(h,h.return,ue)}}c&&C&64&&Zx(_),nl(_,_.return);break;case 27:rg(_);case 26:case 5:Ga(g,_,c),c&&h===null&&C&4&&tg(_),nl(_,_.return);break;case 12:Ga(g,_,c);break;case 31:Ga(g,_,c),c&&C&4&&lg(g,_);break;case 13:Ga(g,_,c),c&&C&4&&cg(g,_);break;case 22:_.memoizedState===null&&Ga(g,_,c),nl(_,_.return);break;case 30:break;default:Ga(g,_,c)}s=s.sibling}}function rd(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Vo(c))}function ad(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Vo(i))}function ia(i,s,c,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)dg(i,s,c,h),s=s.sibling}function dg(i,s,c,h){var g=s.flags;switch(s.tag){case 0:case 11:case 15:ia(i,s,c,h),g&2048&&tl(9,s);break;case 1:ia(i,s,c,h);break;case 3:ia(i,s,c,h),g&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Vo(i)));break;case 12:if(g&2048){ia(i,s,c,h),i=s.stateNode;try{var _=s.memoizedProps,C=_.id,M=_.onPostCommit;typeof M=="function"&&M(C,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(K){Ot(s,s.return,K)}}else ia(i,s,c,h);break;case 31:ia(i,s,c,h);break;case 13:ia(i,s,c,h);break;case 23:break;case 22:_=s.stateNode,C=s.alternate,s.memoizedState!==null?_._visibility&2?ia(i,s,c,h):rl(i,s):_._visibility&2?ia(i,s,c,h):(_._visibility|=2,qs(i,s,c,h,(s.subtreeFlags&10256)!==0||!1)),g&2048&&rd(C,s);break;case 24:ia(i,s,c,h),g&2048&&ad(s.alternate,s);break;default:ia(i,s,c,h)}}function qs(i,s,c,h,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var _=i,C=s,M=c,K=h,ue=C.flags;switch(C.tag){case 0:case 11:case 15:qs(_,C,M,K,g),tl(8,C);break;case 23:break;case 22:var Ee=C.stateNode;C.memoizedState!==null?Ee._visibility&2?qs(_,C,M,K,g):rl(_,C):(Ee._visibility|=2,qs(_,C,M,K,g)),g&&ue&2048&&rd(C.alternate,C);break;case 24:qs(_,C,M,K,g),g&&ue&2048&&ad(C.alternate,C);break;default:qs(_,C,M,K,g)}s=s.sibling}}function rl(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,h=s,g=h.flags;switch(h.tag){case 22:rl(c,h),g&2048&&rd(h.alternate,h);break;case 24:rl(c,h),g&2048&&ad(h.alternate,h);break;default:rl(c,h)}s=s.sibling}}var al=8192;function js(i,s,c){if(i.subtreeFlags&al)for(i=i.child;i!==null;)hg(i,s,c),i=i.sibling}function hg(i,s,c){switch(i.tag){case 26:js(i,s,c),i.flags&al&&i.memoizedState!==null&&Gw(c,aa,i.memoizedState,i.memoizedProps);break;case 5:js(i,s,c);break;case 3:case 4:var h=aa;aa=fu(i.stateNode.containerInfo),js(i,s,c),aa=h;break;case 22:i.memoizedState===null&&(h=i.alternate,h!==null&&h.memoizedState!==null?(h=al,al=16777216,js(i,s,c),al=h):js(i,s,c));break;default:js(i,s,c)}}function mg(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function il(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var h=s[c];Nn=h,xg(h,i)}mg(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)pg(i),i=i.sibling}function pg(i){switch(i.tag){case 0:case 11:case 15:il(i),i.flags&2048&&mi(9,i,i.return);break;case 3:il(i);break;case 12:il(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,Qc(i)):il(i);break;default:il(i)}}function Qc(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var h=s[c];Nn=h,xg(h,i)}mg(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:mi(8,s,s.return),Qc(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,Qc(s));break;default:Qc(s)}i=i.sibling}}function xg(i,s){for(;Nn!==null;){var c=Nn;switch(c.tag){case 0:case 11:case 15:mi(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Vo(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,Nn=h;else e:for(c=i;Nn!==null;){h=Nn;var g=h.sibling,_=h.return;if(sg(h),h===c){Nn=null;break e}if(g!==null){g.return=_,Nn=g;break e}Nn=_}}}var nw={getCacheForType:function(i){var s=Fn(pn),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c},cacheSignal:function(){return Fn(pn).controller.signal}},rw=typeof WeakMap=="function"?WeakMap:Map,It=0,jt=null,_t=null,Tt=0,Lt=0,Tr=null,pi=!1,Ys=!1,id=!1,Va=0,sn=0,xi=0,ts=0,sd=0,Sr=0,Xs=0,sl=null,fr=null,od=!1,Zc=0,gg=0,eu=1/0,tu=null,gi=null,Sn=0,vi=null,Js=null,za=0,ld=0,cd=null,vg=null,ol=0,ud=null;function wr(){return(It&2)!==0&&Tt!==0?Tt&-Tt:H.T!==null?xd():R()}function yg(){if(Sr===0)if((Tt&536870912)===0||At){var i=ni;ni<<=1,(ni&3932160)===0&&(ni=262144),Sr=i}else Sr=536870912;return i=_r.current,i!==null&&(i.flags|=32),Sr}function dr(i,s,c){(i===jt&&(Lt===2||Lt===9)||i.cancelPendingCommit!==null)&&(Ws(i,0),yi(i,Tt,Sr,!1)),na(i,c),((It&2)===0||i!==jt)&&(i===jt&&((It&2)===0&&(ts|=c),sn===4&&yi(i,Tt,Sr,!1)),ya(i))}function _g(i,s,c){if((It&6)!==0)throw Error(r(327));var h=!c&&(s&127)===0&&(s&i.expiredLanes)===0||ta(i,s),g=h?sw(i,s):dd(i,s,!0),_=h;do{if(g===0){Ys&&!h&&yi(i,s,0,!1);break}else{if(c=i.current.alternate,_&&!aw(c)){g=dd(i,s,!1),_=!1;continue}if(g===2){if(_=s,i.errorRecoveryDisabledLanes&_)var C=0;else C=i.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){s=C;e:{var M=i;g=sl;var K=M.current.memoizedState.isDehydrated;if(K&&(Ws(M,C).flags|=256),C=dd(M,C,!1),C!==2){if(id&&!K){M.errorRecoveryDisabledLanes|=_,ts|=_,g=4;break e}_=fr,fr=g,_!==null&&(fr===null?fr=_:fr.push.apply(fr,_))}g=C}if(_=!1,g!==2)continue}}if(g===1){Ws(i,0),yi(i,s,0,!0);break}e:{switch(h=i,_=g,_){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:yi(h,s,Sr,!pi);break e;case 2:fr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(g=Zc+300-Mt(),10<g)){if(yi(h,s,Sr,!pi),ea(h,0,!0)!==0)break e;za=s,h.timeoutHandle=$g(Eg.bind(null,h,c,fr,tu,od,s,Sr,ts,Xs,pi,_,"Throttled",-0,0),g);break e}Eg(h,c,fr,tu,od,s,Sr,ts,Xs,pi,_,null,-0,0)}}break}while(!0);ya(i)}function Eg(i,s,c,h,g,_,C,M,K,ue,Ee,be,me,xe){if(i.timeoutHandle=-1,be=s.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Na},hg(s,_,be);var Xe=(_&62914560)===_?Zc-Mt():(_&4194048)===_?gg-Mt():0;if(Xe=Vw(be,Xe),Xe!==null){za=_,i.cancelPendingCommit=Xe(kg.bind(null,i,s,_,c,h,g,C,M,K,Ee,be,null,me,xe)),yi(i,_,C,!ue);return}}kg(i,s,_,c,h,g,C,M,K)}function aw(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var g=c[h],_=g.getSnapshot;g=g.value;try{if(!vr(_(),g))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function yi(i,s,c,h){s&=~sd,s&=~ts,i.suspendedLanes|=s,i.pingedLanes&=~s,h&&(i.warmLanes|=s),h=i.expirationTimes;for(var g=s;0<g;){var _=31-lt(g),C=1<<_;h[_]=-1,g&=~C}c!==0&&fc(i,c,s)}function nu(){return(It&6)===0?(ll(0),!1):!0}function fd(){if(_t!==null){if(Lt===0)var i=_t.return;else i=_t,Ma=Yi=null,b0(i),Bs=null,qo=0,i=_t;for(;i!==null;)Qx(i.alternate,i),i=i.return;_t=null}}function Ws(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,ww(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),za=0,fd(),jt=i,_t=c=Ra(i.current,null),Tt=s,Lt=0,Tr=null,pi=!1,Ys=ta(i,s),id=!1,Xs=Sr=sd=ts=xi=sn=0,fr=sl=null,od=!1,(s&8)!==0&&(s|=s&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=s;0<h;){var g=31-lt(h),_=1<<g;s|=i[g],h&=~_}return Va=s,Sc(),c}function Tg(i,s){ft=null,H.H=Qo,s===Us||s===Dc?(s=Up(),Lt=3):s===p0?(s=Up(),Lt=4):Lt=s===z0?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Tr=s,_t===null&&(sn=1,jc(i,Fr(s,i.current)))}function Sg(){var i=_r.current;return i===null?!0:(Tt&4194048)===Tt?Ur===null:(Tt&62914560)===Tt||(Tt&536870912)!==0?i===Ur:!1}function wg(){var i=H.H;return H.H=Qo,i===null?Qo:i}function Ag(){var i=H.A;return H.A=nw,i}function ru(){sn=4,pi||(Tt&4194048)!==Tt&&_r.current!==null||(Ys=!0),(xi&134217727)===0&&(ts&134217727)===0||jt===null||yi(jt,Tt,Sr,!1)}function dd(i,s,c){var h=It;It|=2;var g=wg(),_=Ag();(jt!==i||Tt!==s)&&(tu=null,Ws(i,s)),s=!1;var C=sn;e:do try{if(Lt!==0&&_t!==null){var M=_t,K=Tr;switch(Lt){case 8:fd(),C=6;break e;case 3:case 2:case 9:case 6:_r.current===null&&(s=!0);var ue=Lt;if(Lt=0,Tr=null,Ks(i,M,K,ue),c&&Ys){C=0;break e}break;default:ue=Lt,Lt=0,Tr=null,Ks(i,M,K,ue)}}iw(),C=sn;break}catch(Ee){Tg(i,Ee)}while(!0);return s&&i.shellSuspendCounter++,Ma=Yi=null,It=h,H.H=g,H.A=_,_t===null&&(jt=null,Tt=0,Sc()),C}function iw(){for(;_t!==null;)Cg(_t)}function sw(i,s){var c=It;It|=2;var h=wg(),g=Ag();jt!==i||Tt!==s?(tu=null,eu=Mt()+500,Ws(i,s)):Ys=ta(i,s);e:do try{if(Lt!==0&&_t!==null){s=_t;var _=Tr;t:switch(Lt){case 1:Lt=0,Tr=null,Ks(i,s,_,1);break;case 2:case 9:if(Op(_)){Lt=0,Tr=null,bg(s);break}s=function(){Lt!==2&&Lt!==9||jt!==i||(Lt=7),ya(i)},_.then(s,s);break e;case 3:Lt=7;break e;case 4:Lt=5;break e;case 7:Op(_)?(Lt=0,Tr=null,bg(s)):(Lt=0,Tr=null,Ks(i,s,_,7));break;case 5:var C=null;switch(_t.tag){case 26:C=_t.memoizedState;case 5:case 27:var M=_t;if(C?d1(C):M.stateNode.complete){Lt=0,Tr=null;var K=M.sibling;if(K!==null)_t=K;else{var ue=M.return;ue!==null?(_t=ue,au(ue)):_t=null}break t}}Lt=0,Tr=null,Ks(i,s,_,5);break;case 6:Lt=0,Tr=null,Ks(i,s,_,6);break;case 8:fd(),sn=6;break e;default:throw Error(r(462))}}ow();break}catch(Ee){Tg(i,Ee)}while(!0);return Ma=Yi=null,H.H=h,H.A=g,It=c,_t!==null?0:(jt=null,Tt=0,Sc(),sn)}function ow(){for(;_t!==null&&!Qr();)Cg(_t)}function Cg(i){var s=Kx(i.alternate,i,Va);i.memoizedProps=i.pendingProps,s===null?au(i):_t=s}function bg(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=qx(c,s,s.pendingProps,s.type,void 0,Tt);break;case 11:s=qx(c,s,s.pendingProps,s.type.render,s.ref,Tt);break;case 5:b0(s);default:Qx(c,s),s=_t=Ap(s,Va),s=Kx(c,s,Va)}i.memoizedProps=i.pendingProps,s===null?au(i):_t=s}function Ks(i,s,c,h){Ma=Yi=null,b0(s),Bs=null,qo=0;var g=s.return;try{if(WS(i,g,s,c,Tt)){sn=1,jc(i,Fr(c,i.current)),_t=null;return}}catch(_){if(g!==null)throw _t=g,_;sn=1,jc(i,Fr(c,i.current)),_t=null;return}s.flags&32768?(At||h===1?i=!0:Ys||(Tt&536870912)!==0?i=!1:(pi=i=!0,(h===2||h===9||h===3||h===6)&&(h=_r.current,h!==null&&h.tag===13&&(h.flags|=16384))),Ng(s,i)):au(s)}function au(i){var s=i;do{if((s.flags&32768)!==0){Ng(s,pi);return}i=s.return;var c=QS(s.alternate,s,Va);if(c!==null){_t=c;return}if(s=s.sibling,s!==null){_t=s;return}_t=s=i}while(s!==null);sn===0&&(sn=5)}function Ng(i,s){do{var c=ZS(i.alternate,i);if(c!==null){c.flags&=32767,_t=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){_t=i;return}_t=i=c}while(i!==null);sn=6,_t=null}function kg(i,s,c,h,g,_,C,M,K){i.cancelPendingCommit=null;do iu();while(Sn!==0);if((It&6)!==0)throw Error(r(327));if(s!==null){if(s===i.current)throw Error(r(177));if(_=s.lanes|s.childLanes,_|=e0,Mf(i,c,_,C,M,K),i===jt&&(_t=jt=null,Tt=0),Js=s,vi=i,za=c,ld=_,cd=g,vg=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,fw(Me,function(){return Fg(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=H.T,H.T=null,g=ee.p,ee.p=2,C=It,It|=4;try{ew(i,s,c)}finally{It=C,ee.p=g,H.T=h}}Sn=1,Rg(),Dg(),Mg()}}function Rg(){if(Sn===1){Sn=0;var i=vi,s=Js,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=H.T,H.T=null;var h=ee.p;ee.p=2;var g=It;It|=4;try{ug(s,i);var _=wd,C=xp(i.containerInfo),M=_.focusedElem,K=_.selectionRange;if(C!==M&&M&&M.ownerDocument&&pp(M.ownerDocument.documentElement,M)){if(K!==null&&Wf(M)){var ue=K.start,Ee=K.end;if(Ee===void 0&&(Ee=ue),"selectionStart"in M)M.selectionStart=ue,M.selectionEnd=Math.min(Ee,M.value.length);else{var be=M.ownerDocument||document,me=be&&be.defaultView||window;if(me.getSelection){var xe=me.getSelection(),Xe=M.textContent.length,tt=Math.min(K.start,Xe),zt=K.end===void 0?tt:Math.min(K.end,Xe);!xe.extend&&tt>zt&&(C=zt,zt=tt,tt=C);var oe=mp(M,tt),ne=mp(M,zt);if(oe&&ne&&(xe.rangeCount!==1||xe.anchorNode!==oe.node||xe.anchorOffset!==oe.offset||xe.focusNode!==ne.node||xe.focusOffset!==ne.offset)){var ce=be.createRange();ce.setStart(oe.node,oe.offset),xe.removeAllRanges(),tt>zt?(xe.addRange(ce),xe.extend(ne.node,ne.offset)):(ce.setEnd(ne.node,ne.offset),xe.addRange(ce))}}}}for(be=[],xe=M;xe=xe.parentNode;)xe.nodeType===1&&be.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<be.length;M++){var Ae=be[M];Ae.element.scrollLeft=Ae.left,Ae.element.scrollTop=Ae.top}}gu=!!Sd,wd=Sd=null}finally{It=g,ee.p=h,H.T=c}}i.current=s,Sn=2}}function Dg(){if(Sn===2){Sn=0;var i=vi,s=Js,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=H.T,H.T=null;var h=ee.p;ee.p=2;var g=It;It|=4;try{ig(i,s.alternate,s)}finally{It=g,ee.p=h,H.T=c}}Sn=3}}function Mg(){if(Sn===4||Sn===3){Sn=0,Qn();var i=vi,s=Js,c=za,h=vg;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Sn=5:(Sn=0,Js=vi=null,Ig(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(gi=null),ko(c),s=s.stateNode,je&&typeof je.onCommitFiberRoot=="function")try{je.onCommitFiberRoot(Oe,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=H.T,g=ee.p,ee.p=2,H.T=null;try{for(var _=i.onRecoverableError,C=0;C<h.length;C++){var M=h[C];_(M.value,{componentStack:M.stack})}}finally{H.T=s,ee.p=g}}(za&3)!==0&&iu(),ya(i),g=i.pendingLanes,(c&261930)!==0&&(g&42)!==0?i===ud?ol++:(ol=0,ud=i):ol=0,ll(0)}}function Ig(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Vo(s)))}function iu(){return Rg(),Dg(),Mg(),Fg()}function Fg(){if(Sn!==5)return!1;var i=vi,s=ld;ld=0;var c=ko(za),h=H.T,g=ee.p;try{ee.p=32>c?32:c,H.T=null,c=cd,cd=null;var _=vi,C=za;if(Sn=0,Js=vi=null,za=0,(It&6)!==0)throw Error(r(331));var M=It;if(It|=4,pg(_.current),dg(_,_.current,C,c),It=M,ll(0,!1),je&&typeof je.onPostCommitFiberRoot=="function")try{je.onPostCommitFiberRoot(Oe,_)}catch{}return!0}finally{ee.p=g,H.T=h,Ig(i,s)}}function Lg(i,s,c){s=Fr(c,s),s=V0(i.stateNode,s,2),i=fi(i,s,2),i!==null&&(na(i,2),ya(i))}function Ot(i,s,c){if(i.tag===3)Lg(i,i,c);else for(;s!==null;){if(s.tag===3){Lg(s,i,c);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(gi===null||!gi.has(h))){i=Fr(c,i),c=Ox(2),h=fi(s,c,2),h!==null&&(Px(c,h,s,i),na(h,2),ya(h));break}}s=s.return}}function hd(i,s,c){var h=i.pingCache;if(h===null){h=i.pingCache=new rw;var g=new Set;h.set(s,g)}else g=h.get(s),g===void 0&&(g=new Set,h.set(s,g));g.has(c)||(id=!0,g.add(c),i=lw.bind(null,i,s,c),s.then(i,i))}function lw(i,s,c){var h=i.pingCache;h!==null&&h.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,jt===i&&(Tt&c)===c&&(sn===4||sn===3&&(Tt&62914560)===Tt&&300>Mt()-Zc?(It&2)===0&&Ws(i,0):sd|=c,Xs===Tt&&(Xs=0)),ya(i)}function Og(i,s){s===0&&(s=yt()),i=zi(i,s),i!==null&&(na(i,s),ya(i))}function cw(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),Og(i,c)}function uw(i,s){var c=0;switch(i.tag){case 31:case 13:var h=i.stateNode,g=i.memoizedState;g!==null&&(c=g.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(r(314))}h!==null&&h.delete(s),Og(i,c)}function fw(i,s){return Tn(i,s)}var su=null,$s=null,md=!1,ou=!1,pd=!1,_i=0;function ya(i){i!==$s&&i.next===null&&($s===null?su=$s=i:$s=$s.next=i),ou=!0,md||(md=!0,hw())}function ll(i,s){if(!pd&&ou){pd=!0;do for(var c=!1,h=su;h!==null;){if(i!==0){var g=h.pendingLanes;if(g===0)var _=0;else{var C=h.suspendedLanes,M=h.pingedLanes;_=(1<<31-lt(42|i)+1)-1,_&=g&~(C&~M),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(c=!0,Hg(h,_))}else _=Tt,_=ea(h,h===jt?_:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(_&3)===0||ta(h,_)||(c=!0,Hg(h,_));h=h.next}while(c);pd=!1}}function dw(){Pg()}function Pg(){ou=md=!1;var i=0;_i!==0&&Sw()&&(i=_i);for(var s=Mt(),c=null,h=su;h!==null;){var g=h.next,_=Ug(h,s);_===0?(h.next=null,c===null?su=g:c.next=g,g===null&&($s=c)):(c=h,(i!==0||(_&3)!==0)&&(ou=!0)),h=g}Sn!==0&&Sn!==5||ll(i),_i!==0&&(_i=0)}function Ug(i,s){for(var c=i.suspendedLanes,h=i.pingedLanes,g=i.expirationTimes,_=i.pendingLanes&-62914561;0<_;){var C=31-lt(_),M=1<<C,K=g[C];K===-1?((M&c)===0||(M&h)!==0)&&(g[C]=bo(M,s)):K<=s&&(i.expiredLanes|=M),_&=~M}if(s=jt,c=Tt,c=ea(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,c===0||i===s&&(Lt===2||Lt===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&Cn(h),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||ta(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(h!==null&&Cn(h),ko(c)){case 2:case 8:c=Pe;break;case 32:c=Me;break;case 268435456:c=Le;break;default:c=Me}return h=Bg.bind(null,i),c=Tn(c,h),i.callbackPriority=s,i.callbackNode=c,s}return h!==null&&h!==null&&Cn(h),i.callbackPriority=2,i.callbackNode=null,2}function Bg(i,s){if(Sn!==0&&Sn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(iu()&&i.callbackNode!==c)return null;var h=Tt;return h=ea(i,i===jt?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(_g(i,h,s),Ug(i,Mt()),i.callbackNode!=null&&i.callbackNode===c?Bg.bind(null,i):null)}function Hg(i,s){if(iu())return null;_g(i,s,!0)}function hw(){Aw(function(){(It&6)!==0?Tn(te,dw):Pg()})}function xd(){if(_i===0){var i=Os;i===0&&(i=Zr,Zr<<=1,(Zr&261888)===0&&(Zr=256)),_i=i}return _i}function Gg(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:pc(""+i)}function Vg(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function mw(i,s,c,h,g){if(s==="submit"&&c&&c.stateNode===g){var _=Gg((g[z]||null).action),C=h.submitter;C&&(s=(s=C[z]||null)?Gg(s.formAction):C.getAttribute("formAction"),s!==null&&(_=s,C=null));var M=new yc("action","action",null,h,g);i.push({event:M,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(_i!==0){var K=C?Vg(g,C):new FormData(g);O0(c,{pending:!0,data:K,method:g.method,action:_},null,K)}}else typeof _=="function"&&(M.preventDefault(),K=C?Vg(g,C):new FormData(g),O0(c,{pending:!0,data:K,method:g.method,action:_},_,K))},currentTarget:g}]})}}for(var gd=0;gd<Zf.length;gd++){var vd=Zf[gd],pw=vd.toLowerCase(),xw=vd[0].toUpperCase()+vd.slice(1);ra(pw,"on"+xw)}ra(yp,"onAnimationEnd"),ra(_p,"onAnimationIteration"),ra(Ep,"onAnimationStart"),ra("dblclick","onDoubleClick"),ra("focusin","onFocus"),ra("focusout","onBlur"),ra(MS,"onTransitionRun"),ra(IS,"onTransitionStart"),ra(FS,"onTransitionCancel"),ra(Tp,"onTransitionEnd"),Rr("onMouseEnter",["mouseout","mouseover"]),Rr("onMouseLeave",["mouseout","mouseover"]),Rr("onPointerEnter",["pointerout","pointerover"]),Rr("onPointerLeave",["pointerout","pointerover"]),Zt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Zt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Zt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Zt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Zt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Zt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cl));function zg(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var h=i[c],g=h.event;h=h.listeners;e:{var _=void 0;if(s)for(var C=h.length-1;0<=C;C--){var M=h[C],K=M.instance,ue=M.currentTarget;if(M=M.listener,K!==_&&g.isPropagationStopped())break e;_=M,g.currentTarget=ue;try{_(g)}catch(Ee){Tc(Ee)}g.currentTarget=null,_=K}else for(C=0;C<h.length;C++){if(M=h[C],K=M.instance,ue=M.currentTarget,M=M.listener,K!==_&&g.isPropagationStopped())break e;_=M,g.currentTarget=ue;try{_(g)}catch(Ee){Tc(Ee)}g.currentTarget=null,_=K}}}}function Et(i,s){var c=s[fe];c===void 0&&(c=s[fe]=new Set);var h=i+"__bubble";c.has(h)||(qg(s,i,2,!1),c.add(h))}function yd(i,s,c){var h=0;s&&(h|=4),qg(c,i,h,s)}var lu="_reactListening"+Math.random().toString(36).slice(2);function _d(i){if(!i[lu]){i[lu]=!0,Yt.forEach(function(c){c!=="selectionchange"&&(gw.has(c)||yd(c,!1,i),yd(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[lu]||(s[lu]=!0,yd("selectionchange",!1,s))}}function qg(i,s,c,h){switch(y1(s)){case 2:var g=jw;break;case 8:g=Yw;break;default:g=Ld}c=g.bind(null,s,c,i),g=void 0,!Hf||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),h?g!==void 0?i.addEventListener(s,c,{capture:!0,passive:g}):i.addEventListener(s,c,!0):g!==void 0?i.addEventListener(s,c,{passive:g}):i.addEventListener(s,c,!1)}function Ed(i,s,c,h,g){var _=h;if((s&1)===0&&(s&2)===0&&h!==null)e:for(;;){if(h===null)return;var C=h.tag;if(C===3||C===4){var M=h.stateNode.containerInfo;if(M===g)break;if(C===4)for(C=h.return;C!==null;){var K=C.tag;if((K===3||K===4)&&C.stateNode.containerInfo===g)return;C=C.return}for(;M!==null;){if(C=Ue(M),C===null)return;if(K=C.tag,K===5||K===6||K===26||K===27){h=_=C;continue e}M=M.parentNode}}h=h.return}Wm(function(){var ue=_,Ee=Uf(c),be=[];e:{var me=Sp.get(i);if(me!==void 0){var xe=yc,Xe=i;switch(i){case"keypress":if(gc(c)===0)break e;case"keydown":case"keyup":xe=uS;break;case"focusin":Xe="focus",xe=qf;break;case"focusout":Xe="blur",xe=qf;break;case"beforeblur":case"afterblur":xe=qf;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=Qm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=QT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=hS;break;case yp:case _p:case Ep:xe=tS;break;case Tp:xe=pS;break;case"scroll":case"scrollend":xe=KT;break;case"wheel":xe=gS;break;case"copy":case"cut":case"paste":xe=rS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=ep;break;case"toggle":case"beforetoggle":xe=yS}var tt=(s&4)!==0,zt=!tt&&(i==="scroll"||i==="scrollend"),oe=tt?me!==null?me+"Capture":null:me;tt=[];for(var ne=ue,ce;ne!==null;){var Ae=ne;if(ce=Ae.stateNode,Ae=Ae.tag,Ae!==5&&Ae!==26&&Ae!==27||ce===null||oe===null||(Ae=Do(ne,oe),Ae!=null&&tt.push(ul(ne,Ae,ce))),zt)break;ne=ne.return}0<tt.length&&(me=new xe(me,Xe,null,c,Ee),be.push({event:me,listeners:tt}))}}if((s&7)===0){e:{if(me=i==="mouseover"||i==="pointerover",xe=i==="mouseout"||i==="pointerout",me&&c!==Pf&&(Xe=c.relatedTarget||c.fromElement)&&(Ue(Xe)||Xe[X]))break e;if((xe||me)&&(me=Ee.window===Ee?Ee:(me=Ee.ownerDocument)?me.defaultView||me.parentWindow:window,xe?(Xe=c.relatedTarget||c.toElement,xe=ue,Xe=Xe?Ue(Xe):null,Xe!==null&&(zt=o(Xe),tt=Xe.tag,Xe!==zt||tt!==5&&tt!==27&&tt!==6)&&(Xe=null)):(xe=null,Xe=ue),xe!==Xe)){if(tt=Qm,Ae="onMouseLeave",oe="onMouseEnter",ne="mouse",(i==="pointerout"||i==="pointerover")&&(tt=ep,Ae="onPointerLeave",oe="onPointerEnter",ne="pointer"),zt=xe==null?me:Ie(xe),ce=Xe==null?me:Ie(Xe),me=new tt(Ae,ne+"leave",xe,c,Ee),me.target=zt,me.relatedTarget=ce,Ae=null,Ue(Ee)===ue&&(tt=new tt(oe,ne+"enter",Xe,c,Ee),tt.target=ce,tt.relatedTarget=zt,Ae=tt),zt=Ae,xe&&Xe)t:{for(tt=vw,oe=xe,ne=Xe,ce=0,Ae=oe;Ae;Ae=tt(Ae))ce++;Ae=0;for(var Ze=ne;Ze;Ze=tt(Ze))Ae++;for(;0<ce-Ae;)oe=tt(oe),ce--;for(;0<Ae-ce;)ne=tt(ne),Ae--;for(;ce--;){if(oe===ne||ne!==null&&oe===ne.alternate){tt=oe;break t}oe=tt(oe),ne=tt(ne)}tt=null}else tt=null;xe!==null&&jg(be,me,xe,tt,!1),Xe!==null&&zt!==null&&jg(be,zt,Xe,tt,!0)}}e:{if(me=ue?Ie(ue):window,xe=me.nodeName&&me.nodeName.toLowerCase(),xe==="select"||xe==="input"&&me.type==="file")var Nt=lp;else if(sp(me))if(cp)Nt=kS;else{Nt=bS;var Ke=CS}else xe=me.nodeName,!xe||xe.toLowerCase()!=="input"||me.type!=="checkbox"&&me.type!=="radio"?ue&&Of(ue.elementType)&&(Nt=lp):Nt=NS;if(Nt&&(Nt=Nt(i,ue))){op(be,Nt,c,Ee);break e}Ke&&Ke(i,me,ue),i==="focusout"&&ue&&me.type==="number"&&ue.memoizedProps.value!=null&&Lf(me,"number",me.value)}switch(Ke=ue?Ie(ue):window,i){case"focusin":(sp(Ke)||Ke.contentEditable==="true")&&(Ns=Ke,Kf=ue,Bo=null);break;case"focusout":Bo=Kf=Ns=null;break;case"mousedown":$f=!0;break;case"contextmenu":case"mouseup":case"dragend":$f=!1,gp(be,c,Ee);break;case"selectionchange":if(DS)break;case"keydown":case"keyup":gp(be,c,Ee)}var ht;if(Yf)e:{switch(i){case"compositionstart":var St="onCompositionStart";break e;case"compositionend":St="onCompositionEnd";break e;case"compositionupdate":St="onCompositionUpdate";break e}St=void 0}else bs?ap(i,c)&&(St="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(St="onCompositionStart");St&&(tp&&c.locale!=="ko"&&(bs||St!=="onCompositionStart"?St==="onCompositionEnd"&&bs&&(ht=Km()):(ai=Ee,Gf="value"in ai?ai.value:ai.textContent,bs=!0)),Ke=cu(ue,St),0<Ke.length&&(St=new Zm(St,i,null,c,Ee),be.push({event:St,listeners:Ke}),ht?St.data=ht:(ht=ip(c),ht!==null&&(St.data=ht)))),(ht=ES?TS(i,c):SS(i,c))&&(St=cu(ue,"onBeforeInput"),0<St.length&&(Ke=new Zm("onBeforeInput","beforeinput",null,c,Ee),be.push({event:Ke,listeners:St}),Ke.data=ht)),mw(be,i,ue,c,Ee)}zg(be,s)})}function ul(i,s,c){return{instance:i,listener:s,currentTarget:c}}function cu(i,s){for(var c=s+"Capture",h=[];i!==null;){var g=i,_=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||_===null||(g=Do(i,c),g!=null&&h.unshift(ul(i,g,_)),g=Do(i,s),g!=null&&h.push(ul(i,g,_))),i.tag===3)return h;i=i.return}return[]}function vw(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function jg(i,s,c,h,g){for(var _=s._reactName,C=[];c!==null&&c!==h;){var M=c,K=M.alternate,ue=M.stateNode;if(M=M.tag,K!==null&&K===h)break;M!==5&&M!==26&&M!==27||ue===null||(K=ue,g?(ue=Do(c,_),ue!=null&&C.unshift(ul(c,ue,K))):g||(ue=Do(c,_),ue!=null&&C.push(ul(c,ue,K)))),c=c.return}C.length!==0&&i.push({event:s,listeners:C})}var yw=/\r\n?/g,_w=/\u0000|\uFFFD/g;function Yg(i){return(typeof i=="string"?i:""+i).replace(yw,`
`).replace(_w,"")}function Xg(i,s){return s=Yg(s),Yg(i)===s}function Vt(i,s,c,h,g,_){switch(c){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||ws(i,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&ws(i,""+h);break;case"className":hc(i,"class",h);break;case"tabIndex":hc(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":hc(i,c,h);break;case"style":Xm(i,h,_);break;case"data":if(s!=="object"){hc(i,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=pc(""+h),i.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(c==="formAction"?(s!=="input"&&Vt(i,s,"name",g.name,g,null),Vt(i,s,"formEncType",g.formEncType,g,null),Vt(i,s,"formMethod",g.formMethod,g,null),Vt(i,s,"formTarget",g.formTarget,g,null)):(Vt(i,s,"encType",g.encType,g,null),Vt(i,s,"method",g.method,g,null),Vt(i,s,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=pc(""+h),i.setAttribute(c,h);break;case"onClick":h!=null&&(i.onclick=Na);break;case"onScroll":h!=null&&Et("scroll",i);break;case"onScrollEnd":h!=null&&Et("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(r(60));i.innerHTML=c}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}c=pc(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""+h):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":h===!0?i.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,h):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(c,h):i.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(c):i.setAttribute(c,h);break;case"popover":Et("beforetoggle",i),Et("toggle",i),sr(i,"popover",h);break;case"xlinkActuate":ba(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":ba(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":ba(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":ba(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":ba(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":ba(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":ba(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":ba(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":ba(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":sr(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=JT.get(c)||c,sr(i,c,h))}}function Td(i,s,c,h,g,_){switch(c){case"style":Xm(i,h,_);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(r(60));i.innerHTML=c}}break;case"children":typeof h=="string"?ws(i,h):(typeof h=="number"||typeof h=="bigint")&&ws(i,""+h);break;case"onScroll":h!=null&&Et("scroll",i);break;case"onScrollEnd":h!=null&&Et("scrollend",i);break;case"onClick":h!=null&&(i.onclick=Na);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),s=c.slice(2,g?c.length-7:void 0),_=i[z]||null,_=_!=null?_[c]:null,typeof _=="function"&&i.removeEventListener(s,_,g),typeof h=="function")){typeof _!="function"&&_!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,h,g);break e}c in i?i[c]=h:h===!0?i.setAttribute(c,""):sr(i,c,h)}}}function On(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Et("error",i),Et("load",i);var h=!1,g=!1,_;for(_ in c)if(c.hasOwnProperty(_)){var C=c[_];if(C!=null)switch(_){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Vt(i,s,_,C,c,null)}}g&&Vt(i,s,"srcSet",c.srcSet,c,null),h&&Vt(i,s,"src",c.src,c,null);return;case"input":Et("invalid",i);var M=_=C=g=null,K=null,ue=null;for(h in c)if(c.hasOwnProperty(h)){var Ee=c[h];if(Ee!=null)switch(h){case"name":g=Ee;break;case"type":C=Ee;break;case"checked":K=Ee;break;case"defaultChecked":ue=Ee;break;case"value":_=Ee;break;case"defaultValue":M=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(r(137,s));break;default:Vt(i,s,h,Ee,c,null)}}zm(i,_,M,K,ue,C,g,!1);return;case"select":Et("invalid",i),h=C=_=null;for(g in c)if(c.hasOwnProperty(g)&&(M=c[g],M!=null))switch(g){case"value":_=M;break;case"defaultValue":C=M;break;case"multiple":h=M;default:Vt(i,s,g,M,c,null)}s=_,c=C,i.multiple=!!h,s!=null?Ss(i,!!h,s,!1):c!=null&&Ss(i,!!h,c,!0);return;case"textarea":Et("invalid",i),_=g=h=null;for(C in c)if(c.hasOwnProperty(C)&&(M=c[C],M!=null))switch(C){case"value":h=M;break;case"defaultValue":g=M;break;case"children":_=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(r(91));break;default:Vt(i,s,C,M,c,null)}jm(i,h,g,_);return;case"option":for(K in c)if(c.hasOwnProperty(K)&&(h=c[K],h!=null))switch(K){case"selected":i.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Vt(i,s,K,h,c,null)}return;case"dialog":Et("beforetoggle",i),Et("toggle",i),Et("cancel",i),Et("close",i);break;case"iframe":case"object":Et("load",i);break;case"video":case"audio":for(h=0;h<cl.length;h++)Et(cl[h],i);break;case"image":Et("error",i),Et("load",i);break;case"details":Et("toggle",i);break;case"embed":case"source":case"link":Et("error",i),Et("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in c)if(c.hasOwnProperty(ue)&&(h=c[ue],h!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Vt(i,s,ue,h,c,null)}return;default:if(Of(s)){for(Ee in c)c.hasOwnProperty(Ee)&&(h=c[Ee],h!==void 0&&Td(i,s,Ee,h,c,void 0));return}}for(M in c)c.hasOwnProperty(M)&&(h=c[M],h!=null&&Vt(i,s,M,h,c,null))}function Ew(i,s,c,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,_=null,C=null,M=null,K=null,ue=null,Ee=null;for(xe in c){var be=c[xe];if(c.hasOwnProperty(xe)&&be!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":K=be;default:h.hasOwnProperty(xe)||Vt(i,s,xe,null,h,be)}}for(var me in h){var xe=h[me];if(be=c[me],h.hasOwnProperty(me)&&(xe!=null||be!=null))switch(me){case"type":_=xe;break;case"name":g=xe;break;case"checked":ue=xe;break;case"defaultChecked":Ee=xe;break;case"value":C=xe;break;case"defaultValue":M=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(r(137,s));break;default:xe!==be&&Vt(i,s,me,xe,h,be)}}Ff(i,C,M,K,ue,Ee,_,g);return;case"select":xe=C=M=me=null;for(_ in c)if(K=c[_],c.hasOwnProperty(_)&&K!=null)switch(_){case"value":break;case"multiple":xe=K;default:h.hasOwnProperty(_)||Vt(i,s,_,null,h,K)}for(g in h)if(_=h[g],K=c[g],h.hasOwnProperty(g)&&(_!=null||K!=null))switch(g){case"value":me=_;break;case"defaultValue":M=_;break;case"multiple":C=_;default:_!==K&&Vt(i,s,g,_,h,K)}s=M,c=C,h=xe,me!=null?Ss(i,!!c,me,!1):!!h!=!!c&&(s!=null?Ss(i,!!c,s,!0):Ss(i,!!c,c?[]:"",!1));return;case"textarea":xe=me=null;for(M in c)if(g=c[M],c.hasOwnProperty(M)&&g!=null&&!h.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:Vt(i,s,M,null,h,g)}for(C in h)if(g=h[C],_=c[C],h.hasOwnProperty(C)&&(g!=null||_!=null))switch(C){case"value":me=g;break;case"defaultValue":xe=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(r(91));break;default:g!==_&&Vt(i,s,C,g,h,_)}qm(i,me,xe);return;case"option":for(var Xe in c)if(me=c[Xe],c.hasOwnProperty(Xe)&&me!=null&&!h.hasOwnProperty(Xe))switch(Xe){case"selected":i.selected=!1;break;default:Vt(i,s,Xe,null,h,me)}for(K in h)if(me=h[K],xe=c[K],h.hasOwnProperty(K)&&me!==xe&&(me!=null||xe!=null))switch(K){case"selected":i.selected=me&&typeof me!="function"&&typeof me!="symbol";break;default:Vt(i,s,K,me,h,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var tt in c)me=c[tt],c.hasOwnProperty(tt)&&me!=null&&!h.hasOwnProperty(tt)&&Vt(i,s,tt,null,h,me);for(ue in h)if(me=h[ue],xe=c[ue],h.hasOwnProperty(ue)&&me!==xe&&(me!=null||xe!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(r(137,s));break;default:Vt(i,s,ue,me,h,xe)}return;default:if(Of(s)){for(var zt in c)me=c[zt],c.hasOwnProperty(zt)&&me!==void 0&&!h.hasOwnProperty(zt)&&Td(i,s,zt,void 0,h,me);for(Ee in h)me=h[Ee],xe=c[Ee],!h.hasOwnProperty(Ee)||me===xe||me===void 0&&xe===void 0||Td(i,s,Ee,me,h,xe);return}}for(var oe in c)me=c[oe],c.hasOwnProperty(oe)&&me!=null&&!h.hasOwnProperty(oe)&&Vt(i,s,oe,null,h,me);for(be in h)me=h[be],xe=c[be],!h.hasOwnProperty(be)||me===xe||me==null&&xe==null||Vt(i,s,be,me,h,xe)}function Jg(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Tw(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var g=c[h],_=g.transferSize,C=g.initiatorType,M=g.duration;if(_&&M&&Jg(C)){for(C=0,M=g.responseEnd,h+=1;h<c.length;h++){var K=c[h],ue=K.startTime;if(ue>M)break;var Ee=K.transferSize,be=K.initiatorType;Ee&&Jg(be)&&(K=K.responseEnd,C+=Ee*(K<M?1:(M-ue)/(K-ue)))}if(--h,s+=8*(_+C)/(g.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Sd=null,wd=null;function uu(i){return i.nodeType===9?i:i.ownerDocument}function Wg(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Kg(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Ad(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Cd=null;function Sw(){var i=window.event;return i&&i.type==="popstate"?i===Cd?!1:(Cd=i,!0):(Cd=null,!1)}var $g=typeof setTimeout=="function"?setTimeout:void 0,ww=typeof clearTimeout=="function"?clearTimeout:void 0,Qg=typeof Promise=="function"?Promise:void 0,Aw=typeof queueMicrotask=="function"?queueMicrotask:typeof Qg<"u"?function(i){return Qg.resolve(null).then(i).catch(Cw)}:$g;function Cw(i){setTimeout(function(){throw i})}function Ei(i){return i==="head"}function Zg(i,s){var c=s,h=0;do{var g=c.nextSibling;if(i.removeChild(c),g&&g.nodeType===8)if(c=g.data,c==="/$"||c==="/&"){if(h===0){i.removeChild(g),to(s);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")fl(i.ownerDocument.documentElement);else if(c==="head"){c=i.ownerDocument.head,fl(c);for(var _=c.firstChild;_;){var C=_.nextSibling,M=_.nodeName;_[pe]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&_.rel.toLowerCase()==="stylesheet"||c.removeChild(_),_=C}}else c==="body"&&fl(i.ownerDocument.body);c=g}while(c);to(s)}function e1(i,s){var c=i;i=0;do{var h=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(i===0)break;i--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||i++;c=h}while(c)}function bd(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":bd(c),De(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function bw(i,s,c,h){for(;i.nodeType===1;){var g=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[pe])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(_=i.getAttribute("rel"),_==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(_!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(_=i.getAttribute("src"),(_!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&_&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var _=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===_)return i}else return i;if(i=Br(i.nextSibling),i===null)break}return null}function Nw(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=Br(i.nextSibling),i===null))return null;return i}function t1(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=Br(i.nextSibling),i===null))return null;return i}function Nd(i){return i.data==="$?"||i.data==="$~"}function kd(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function kw(i,s){var c=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||c.readyState!=="loading")s();else{var h=function(){s(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function Br(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var Rd=null;function n1(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"||c==="/&"){if(s===0)return Br(i.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}i=i.nextSibling}return null}function r1(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return i;s--}else c!=="/$"&&c!=="/&"||s++}i=i.previousSibling}return null}function a1(i,s,c){switch(s=uu(c),i){case"html":if(i=s.documentElement,!i)throw Error(r(452));return i;case"head":if(i=s.head,!i)throw Error(r(453));return i;case"body":if(i=s.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function fl(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);De(i)}var Hr=new Map,i1=new Set;function fu(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var qa=ee.d;ee.d={f:Rw,r:Dw,D:Mw,C:Iw,L:Fw,m:Lw,X:Pw,S:Ow,M:Uw};function Rw(){var i=qa.f(),s=nu();return i||s}function Dw(i){var s=ze(i);s!==null&&s.tag===5&&s.type==="form"?Tx(s):qa.r(i)}var Qs=typeof document>"u"?null:document;function s1(i,s,c){var h=Qs;if(h&&typeof s=="string"&&s){var g=Mr(s);g='link[rel="'+i+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),i1.has(g)||(i1.add(g),i={rel:i,crossOrigin:c,href:s},h.querySelector(g)===null&&(s=h.createElement("link"),On(s,"link",i),We(s),h.head.appendChild(s)))}}function Mw(i){qa.D(i),s1("dns-prefetch",i,null)}function Iw(i,s){qa.C(i,s),s1("preconnect",i,s)}function Fw(i,s,c){qa.L(i,s,c);var h=Qs;if(h&&i&&s){var g='link[rel="preload"][as="'+Mr(s)+'"]';s==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+Mr(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+Mr(c.imageSizes)+'"]')):g+='[href="'+Mr(i)+'"]';var _=g;switch(s){case"style":_=Zs(i);break;case"script":_=eo(i)}Hr.has(_)||(i=v({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),Hr.set(_,i),h.querySelector(g)!==null||s==="style"&&h.querySelector(dl(_))||s==="script"&&h.querySelector(hl(_))||(s=h.createElement("link"),On(s,"link",i),We(s),h.head.appendChild(s)))}}function Lw(i,s){qa.m(i,s);var c=Qs;if(c&&i){var h=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Mr(h)+'"][href="'+Mr(i)+'"]',_=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=eo(i)}if(!Hr.has(_)&&(i=v({rel:"modulepreload",href:i},s),Hr.set(_,i),c.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(hl(_)))return}h=c.createElement("link"),On(h,"link",i),We(h),c.head.appendChild(h)}}}function Ow(i,s,c){qa.S(i,s,c);var h=Qs;if(h&&i){var g=Ve(h).hoistableStyles,_=Zs(i);s=s||"default";var C=g.get(_);if(!C){var M={loading:0,preload:null};if(C=h.querySelector(dl(_)))M.loading=5;else{i=v({rel:"stylesheet",href:i,"data-precedence":s},c),(c=Hr.get(_))&&Dd(i,c);var K=C=h.createElement("link");We(K),On(K,"link",i),K._p=new Promise(function(ue,Ee){K.onload=ue,K.onerror=Ee}),K.addEventListener("load",function(){M.loading|=1}),K.addEventListener("error",function(){M.loading|=2}),M.loading|=4,du(C,s,h)}C={type:"stylesheet",instance:C,count:1,state:M},g.set(_,C)}}}function Pw(i,s){qa.X(i,s);var c=Qs;if(c&&i){var h=Ve(c).hoistableScripts,g=eo(i),_=h.get(g);_||(_=c.querySelector(hl(g)),_||(i=v({src:i,async:!0},s),(s=Hr.get(g))&&Md(i,s),_=c.createElement("script"),We(_),On(_,"link",i),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},h.set(g,_))}}function Uw(i,s){qa.M(i,s);var c=Qs;if(c&&i){var h=Ve(c).hoistableScripts,g=eo(i),_=h.get(g);_||(_=c.querySelector(hl(g)),_||(i=v({src:i,async:!0,type:"module"},s),(s=Hr.get(g))&&Md(i,s),_=c.createElement("script"),We(_),On(_,"link",i),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},h.set(g,_))}}function o1(i,s,c,h){var g=(g=q.current)?fu(g):null;if(!g)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Zs(c.href),c=Ve(g).hoistableStyles,h=c.get(s),h||(h={type:"style",instance:null,count:0,state:null},c.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Zs(c.href);var _=Ve(g).hoistableStyles,C=_.get(i);if(C||(g=g.ownerDocument||g,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(i,C),(_=g.querySelector(dl(i)))&&!_._p&&(C.instance=_,C.state.loading=5),Hr.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Hr.set(i,c),_||Bw(g,i,c,C.state))),s&&h===null)throw Error(r(528,""));return C}if(s&&h!==null)throw Error(r(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=eo(c),c=Ve(g).hoistableScripts,h=c.get(s),h||(h={type:"script",instance:null,count:0,state:null},c.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function Zs(i){return'href="'+Mr(i)+'"'}function dl(i){return'link[rel="stylesheet"]['+i+"]"}function l1(i){return v({},i,{"data-precedence":i.precedence,precedence:null})}function Bw(i,s,c,h){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=i.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),On(s,"link",c),We(s),i.head.appendChild(s))}function eo(i){return'[src="'+Mr(i)+'"]'}function hl(i){return"script[async]"+i}function c1(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var h=i.querySelector('style[data-href~="'+Mr(c.href)+'"]');if(h)return s.instance=h,We(h),h;var g=v({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),We(h),On(h,"style",g),du(h,c.precedence,i),s.instance=h;case"stylesheet":g=Zs(c.href);var _=i.querySelector(dl(g));if(_)return s.state.loading|=4,s.instance=_,We(_),_;h=l1(c),(g=Hr.get(g))&&Dd(h,g),_=(i.ownerDocument||i).createElement("link"),We(_);var C=_;return C._p=new Promise(function(M,K){C.onload=M,C.onerror=K}),On(_,"link",h),s.state.loading|=4,du(_,c.precedence,i),s.instance=_;case"script":return _=eo(c.src),(g=i.querySelector(hl(_)))?(s.instance=g,We(g),g):(h=c,(g=Hr.get(_))&&(h=v({},c),Md(h,g)),i=i.ownerDocument||i,g=i.createElement("script"),We(g),On(g,"link",h),i.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,du(h,c.precedence,i));return s.instance}function du(i,s,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,_=g,C=0;C<h.length;C++){var M=h[C];if(M.dataset.precedence===s)_=M;else if(_!==g)break}_?_.parentNode.insertBefore(i,_.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function Dd(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function Md(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var hu=null;function u1(i,s,c){if(hu===null){var h=new Map,g=hu=new Map;g.set(c,h)}else g=hu,h=g.get(c),h||(h=new Map,g.set(c,h));if(h.has(i))return h;for(h.set(i,null),c=c.getElementsByTagName(i),g=0;g<c.length;g++){var _=c[g];if(!(_[pe]||_[O]||i==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var C=_.getAttribute(s)||"";C=i+C;var M=h.get(C);M?M.push(_):h.set(C,[_])}}return h}function f1(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function Hw(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function d1(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function Gw(i,s,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var g=Zs(h.href),_=s.querySelector(dl(g));if(_){s=_._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=mu.bind(i),s.then(i,i)),c.state.loading|=4,c.instance=_,We(_);return}_=s.ownerDocument||s,h=l1(h),(g=Hr.get(g))&&Dd(h,g),_=_.createElement("link"),We(_);var C=_;C._p=new Promise(function(M,K){C.onload=M,C.onerror=K}),On(_,"link",h),c.instance=_}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(i.count++,c=mu.bind(i),s.addEventListener("load",c),s.addEventListener("error",c))}}var Id=0;function Vw(i,s){return i.stylesheets&&i.count===0&&xu(i,i.stylesheets),0<i.count||0<i.imgCount?function(c){var h=setTimeout(function(){if(i.stylesheets&&xu(i,i.stylesheets),i.unsuspend){var _=i.unsuspend;i.unsuspend=null,_()}},6e4+s);0<i.imgBytes&&Id===0&&(Id=62500*Tw());var g=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&xu(i,i.stylesheets),i.unsuspend)){var _=i.unsuspend;i.unsuspend=null,_()}},(i.imgBytes>Id?50:800)+s);return i.unsuspend=c,function(){i.unsuspend=null,clearTimeout(h),clearTimeout(g)}}:null}function mu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)xu(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var pu=null;function xu(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,pu=new Map,s.forEach(zw,i),pu=null,mu.call(i))}function zw(i,s){if(!(s.state.loading&4)){var c=pu.get(i);if(c)var h=c.get(null);else{c=new Map,pu.set(i,c);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<g.length;_++){var C=g[_];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(c.set(C.dataset.precedence,C),h=C)}h&&c.set(null,h)}g=s.instance,C=g.getAttribute("data-precedence"),_=c.get(C)||h,_===h&&c.set(null,g),c.set(C,g),this.count++,h=mu.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),_?_.parentNode.insertBefore(g,_.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),s.state.loading|=4}}var ml={$$typeof:b,Provider:null,Consumer:null,_currentValue:Ce,_currentValue2:Ce,_threadCount:0};function qw(i,s,c,h,g,_,C,M,K){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Gn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gn(0),this.hiddenUpdates=Gn(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=_,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function h1(i,s,c,h,g,_,C,M,K,ue,Ee,be){return i=new qw(i,s,c,C,K,ue,Ee,be,M),s=1,_===!0&&(s|=24),_=yr(3,null,null,s),i.current=_,_.stateNode=i,s=d0(),s.refCount++,i.pooledCache=s,s.refCount++,_.memoizedState={element:h,isDehydrated:c,cache:s},x0(_),i}function m1(i){return i?(i=Ds,i):Ds}function p1(i,s,c,h,g,_){g=m1(g),h.context===null?h.context=g:h.pendingContext=g,h=ui(s),h.payload={element:c},_=_===void 0?null:_,_!==null&&(h.callback=_),c=fi(i,h,s),c!==null&&(dr(c,i,s),Yo(c,i,s))}function x1(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function Fd(i,s){x1(i,s),(i=i.alternate)&&x1(i,s)}function g1(i){if(i.tag===13||i.tag===31){var s=zi(i,67108864);s!==null&&dr(s,i,67108864),Fd(i,67108864)}}function v1(i){if(i.tag===13||i.tag===31){var s=wr();s=No(s);var c=zi(i,s);c!==null&&dr(c,i,s),Fd(i,s)}}var gu=!0;function jw(i,s,c,h){var g=H.T;H.T=null;var _=ee.p;try{ee.p=2,Ld(i,s,c,h)}finally{ee.p=_,H.T=g}}function Yw(i,s,c,h){var g=H.T;H.T=null;var _=ee.p;try{ee.p=8,Ld(i,s,c,h)}finally{ee.p=_,H.T=g}}function Ld(i,s,c,h){if(gu){var g=Od(h);if(g===null)Ed(i,s,h,vu,c),_1(i,h);else if(Jw(g,i,s,c,h))h.stopPropagation();else if(_1(i,h),s&4&&-1<Xw.indexOf(i)){for(;g!==null;){var _=ze(g);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var C=ir(_.pendingLanes);if(C!==0){var M=_;for(M.pendingLanes|=2,M.entangledLanes|=2;C;){var K=1<<31-lt(C);M.entanglements[1]|=K,C&=~K}ya(_),(It&6)===0&&(eu=Mt()+500,ll(0))}}break;case 31:case 13:M=zi(_,2),M!==null&&dr(M,_,2),nu(),Fd(_,2)}if(_=Od(h),_===null&&Ed(i,s,h,vu,c),_===g)break;g=_}g!==null&&h.stopPropagation()}else Ed(i,s,h,null,c)}}function Od(i){return i=Uf(i),Pd(i)}var vu=null;function Pd(i){if(vu=null,i=Ue(i),i!==null){var s=o(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=l(s),i!==null)return i;i=null}else if(c===31){if(i=u(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return vu=i,null}function y1(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Hn()){case te:return 2;case Pe:return 8;case Me:case Ye:return 32;case Le:return 268435456;default:return 32}default:return 32}}var Ud=!1,Ti=null,Si=null,wi=null,pl=new Map,xl=new Map,Ai=[],Xw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _1(i,s){switch(i){case"focusin":case"focusout":Ti=null;break;case"dragenter":case"dragleave":Si=null;break;case"mouseover":case"mouseout":wi=null;break;case"pointerover":case"pointerout":pl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":xl.delete(s.pointerId)}}function gl(i,s,c,h,g,_){return i===null||i.nativeEvent!==_?(i={blockedOn:s,domEventName:c,eventSystemFlags:h,nativeEvent:_,targetContainers:[g]},s!==null&&(s=ze(s),s!==null&&g1(s)),i):(i.eventSystemFlags|=h,s=i.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),i)}function Jw(i,s,c,h,g){switch(s){case"focusin":return Ti=gl(Ti,i,s,c,h,g),!0;case"dragenter":return Si=gl(Si,i,s,c,h,g),!0;case"mouseover":return wi=gl(wi,i,s,c,h,g),!0;case"pointerover":var _=g.pointerId;return pl.set(_,gl(pl.get(_)||null,i,s,c,h,g)),!0;case"gotpointercapture":return _=g.pointerId,xl.set(_,gl(xl.get(_)||null,i,s,c,h,g)),!0}return!1}function E1(i){var s=Ue(i.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=l(c),s!==null){i.blockedOn=s,j(i.priority,function(){v1(c)});return}}else if(s===31){if(s=u(c),s!==null){i.blockedOn=s,j(i.priority,function(){v1(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function yu(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=Od(i.nativeEvent);if(c===null){c=i.nativeEvent;var h=new c.constructor(c.type,c);Pf=h,c.target.dispatchEvent(h),Pf=null}else return s=ze(c),s!==null&&g1(s),i.blockedOn=c,!1;s.shift()}return!0}function T1(i,s,c){yu(i)&&c.delete(s)}function Ww(){Ud=!1,Ti!==null&&yu(Ti)&&(Ti=null),Si!==null&&yu(Si)&&(Si=null),wi!==null&&yu(wi)&&(wi=null),pl.forEach(T1),xl.forEach(T1)}function _u(i,s){i.blockedOn===s&&(i.blockedOn=null,Ud||(Ud=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ww)))}var Eu=null;function S1(i){Eu!==i&&(Eu=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Eu===i&&(Eu=null);for(var s=0;s<i.length;s+=3){var c=i[s],h=i[s+1],g=i[s+2];if(typeof h!="function"){if(Pd(h||c)===null)continue;break}var _=ze(c);_!==null&&(i.splice(s,3),s-=3,O0(_,{pending:!0,data:g,method:c.method,action:h},h,g))}}))}function to(i){function s(K){return _u(K,i)}Ti!==null&&_u(Ti,i),Si!==null&&_u(Si,i),wi!==null&&_u(wi,i),pl.forEach(s),xl.forEach(s);for(var c=0;c<Ai.length;c++){var h=Ai[c];h.blockedOn===i&&(h.blockedOn=null)}for(;0<Ai.length&&(c=Ai[0],c.blockedOn===null);)E1(c),c.blockedOn===null&&Ai.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var g=c[h],_=c[h+1],C=g[z]||null;if(typeof _=="function")C||S1(c);else if(C){var M=null;if(_&&_.hasAttribute("formAction")){if(g=_,C=_[z]||null)M=C.formAction;else if(Pd(g)!==null)continue}else M=C.action;typeof M=="function"?c[h+1]=M:(c.splice(h,3),h-=3),S1(c)}}}function w1(){function i(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(C){return g=C})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,g=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function Bd(i){this._internalRoot=i}Tu.prototype.render=Bd.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));var c=s.current,h=wr();p1(c,h,i,s,null,null)},Tu.prototype.unmount=Bd.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;p1(i.current,2,null,i,null,null),nu(),s[X]=null}};function Tu(i){this._internalRoot=i}Tu.prototype.unstable_scheduleHydration=function(i){if(i){var s=R();i={blockedOn:null,target:i,priority:s};for(var c=0;c<Ai.length&&s!==0&&s<Ai[c].priority;c++);Ai.splice(c,0,i),c===0&&E1(i)}};var A1=t.version;if(A1!=="19.2.4")throw Error(r(527,A1,"19.2.4"));ee.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=f(s),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var Kw={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Su.isDisabled&&Su.supportsFiber)try{Oe=Su.inject(Kw),je=Su}catch{}}return yl.createRoot=function(i,s){if(!a(i))throw Error(r(299));var c=!1,h="",g=Mx,_=Ix,C=Fx;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(_=s.onCaughtError),s.onRecoverableError!==void 0&&(C=s.onRecoverableError)),s=h1(i,1,!1,null,null,c,h,null,g,_,C,w1),i[X]=s.current,_d(i),new Bd(s)},yl.hydrateRoot=function(i,s,c){if(!a(i))throw Error(r(299));var h=!1,g="",_=Mx,C=Ix,M=Fx,K=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(_=c.onUncaughtError),c.onCaughtError!==void 0&&(C=c.onCaughtError),c.onRecoverableError!==void 0&&(M=c.onRecoverableError),c.formState!==void 0&&(K=c.formState)),s=h1(i,1,!0,s,c??null,h,g,K,_,C,M,w1),s.context=m1(null),c=s.current,h=wr(),h=No(h),g=ui(h),g.callback=null,fi(c,g,h),c=h,s.current.lanes=c,na(s,c),ya(s),i[X]=s.current,_d(i),new Tu(s)},yl.version="19.2.4",yl}var L1;function sA(){if(L1)return Vd.exports;L1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Vd.exports=iA(),Vd.exports}var oA=sA();const lA=R2(oA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cA=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),uA=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),O1=e=>{const t=uA(e);return t.charAt(0).toUpperCase()+t.slice(1)},M2=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),fA=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var dA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hA=Re.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:l,...u},d)=>Re.createElement("svg",{ref:d,...dA,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:M2("lucide",a),...!o&&!fA(u)&&{"aria-hidden":"true"},...u},[...l.map(([f,m])=>Re.createElement(f,m)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=(e,t)=>{const n=Re.forwardRef(({className:r,...a},o)=>Re.createElement(hA,{ref:o,iconNode:t,className:M2(`lucide-${cA(O1(e))}`,`lucide-${e}`,r),...a}));return n.displayName=O1(e),n};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mA=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],I2=$e("arrow-up-down",mA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pA=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],xA=$e("badge-check",pA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gA=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],vA=$e("bookmark",gA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yA=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],ju=$e("briefcase",yA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _A=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],bl=$e("building-2",_A);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EA=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],TA=$e("chart-pie",EA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SA=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Yd=$e("check",SA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wA=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],F2=$e("chevron-down",wA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AA=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],CA=$e("chevron-left",AA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bA=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],NA=$e("chevron-right",bA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kA=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],RA=$e("chevron-up",kA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],uh=$e("circle-alert",DA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Hh=$e("circle-check",MA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],FA=$e("circle-user-round",IA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LA=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],OA=$e("cloud-upload",LA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PA=[["line",{x1:"15",x2:"15",y1:"12",y2:"18",key:"1p7wdc"}],["line",{x1:"12",x2:"18",y1:"15",y2:"15",key:"1nscbv"}],["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],P1=$e("copy-plus",PA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],BA=$e("copy",UA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],L2=$e("crown",HA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GA=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],O2=$e("database",GA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VA=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Yu=$e("download",VA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],qA=$e("ellipsis",zA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jA=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],YA=$e("eraser",jA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XA=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],JA=$e("eye",XA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WA=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],KA=$e("file-braces",WA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $A=[["path",{d:"M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34",key:"o6klzx"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z",key:"zhnas1"}]],QA=$e("file-pen",$A);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],P2=$e("file-spreadsheet",ZA);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eC=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],tC=$e("file-text",eC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nC=[["path",{d:"M2 9V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-1",key:"fm4g5t"}],["path",{d:"M2 13h10",key:"pgb2dq"}],["path",{d:"m9 16 3-3-3-3",key:"6m91ic"}]],rC=$e("folder-input",nC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=[["path",{d:"M2 7.5V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-1.5",key:"1yk7aj"}],["path",{d:"M2 13h10",key:"pgb2dq"}],["path",{d:"m5 10-3 3 3 3",key:"1r8ie0"}]],iC=$e("folder-output",aC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sC=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],oC=$e("funnel",sC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],fh=$e("info",lC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cC=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],uC=$e("layout-dashboard",cC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fC=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]],dC=$e("layout-list",fC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hC=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],mC=$e("layout-grid",hC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pC=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Bl=$e("mail",pC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xC=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],gC=$e("menu",xC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vC=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],U1=$e("paperclip",vC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yC=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],_C=$e("pen-line",yC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],TC=$e("pen",EC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],B1=$e("plus",SC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wC=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],U2=$e("refresh-cw",wC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AC=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Gh=$e("save",AC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CC=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],B2=$e("search",CC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bC=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Xu=$e("send",bC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NC=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],kC=$e("settings",NC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RC=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],DC=$e("shield",RC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MC=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],IC=$e("skip-forward",MC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Hl=$e("sparkles",FC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LC=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ju=$e("square-check-big",LC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OC=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Wu=$e("square",OC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ri=$e("trash-2",PC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Nl=$e("triangle-alert",UC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BC=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Vh=$e("upload",BC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HC=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],kl=$e("user-check",HC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GC=[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],H1=$e("user-cog",GC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VC=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],H2=$e("user-plus",VC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zC=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Rl=$e("user",zC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],jC=$e("users",qC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],xf=$e("x",YC);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ku={};Ku.version="0.18.5";var G2=1252,XC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],zh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},qh=function(e){XC.indexOf(e)!=-1&&(G2=zh[0]=e)};function JC(){qh(1252)}var oa=function(e){qh(e)};function jh(){oa(1200),JC()}function G1(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function WC(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}function V2(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var Sl=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return t==255&&n==254?WC(e.slice(2)):t==254&&n==255?V2(e.slice(2)):t==65279?e.slice(1):e},wu=function(t){return String.fromCharCode(t)},V1=function(t){return String.fromCharCode(t)},Gl,Ni="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Vl(e){for(var t="",n=0,r=0,a=0,o=0,l=0,u=0,d=0,f=0;f<e.length;)n=e.charCodeAt(f++),o=n>>2,r=e.charCodeAt(f++),l=(n&3)<<4|r>>4,a=e.charCodeAt(f++),u=(r&15)<<2|a>>6,d=a&63,isNaN(r)?u=d=64:isNaN(a)&&(d=64),t+=Ni.charAt(o)+Ni.charAt(l)+Ni.charAt(u)+Ni.charAt(d);return t}function kr(e){var t="",n=0,r=0,a=0,o=0,l=0,u=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)o=Ni.indexOf(e.charAt(f++)),l=Ni.indexOf(e.charAt(f++)),n=o<<2|l>>4,t+=String.fromCharCode(n),u=Ni.indexOf(e.charAt(f++)),r=(l&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(r)),d=Ni.indexOf(e.charAt(f++)),a=(u&3)<<6|d,d!==64&&(t+=String.fromCharCode(a));return t}var xt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),$a=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Di(e){return xt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function z1(e){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var br=function(t){return xt?$a(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function gf(e){if(typeof ArrayBuffer>"u")return br(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}function Li(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function KC(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Yh(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Yh(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var Rn=xt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:$a(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function $C(e){for(var t=[],n=0,r=e.length+250,a=Di(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)a[n++]=l;else if(l<2048)a[n++]=192|l>>6&31,a[n++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=e.charCodeAt(++o)&1023;a[n++]=240|l>>8&7,a[n++]=128|l>>2&63,a[n++]=128|u>>6&15|(l&3)<<4,a[n++]=128|u&63}else a[n++]=224|l>>12&15,a[n++]=128|l>>6&63,a[n++]=128|l&63;n>r&&(t.push(a.slice(0,n)),n=0,a=Di(65535),r=65530)}return t.push(a.slice(0,n)),Rn(t)}var rr=/\u0000/g,wl=/[\u0001-\u0006]/g;function uo(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function la(e,t){var n=""+e;return n.length>=t?n:on("0",t-n.length)+n}function Xh(e,t){var n=""+e;return n.length>=t?n:on(" ",t-n.length)+n}function $u(e,t){var n=""+e;return n.length>=t?n:n+on(" ",t-n.length)}function QC(e,t){var n=""+Math.round(e);return n.length>=t?n:on("0",t-n.length)+n}function ZC(e,t){var n=""+e;return n.length>=t?n:on("0",t-n.length)+n}var q1=Math.pow(2,32);function no(e,t){if(e>q1||e<-q1)return QC(e,t);var n=Math.round(e);return ZC(n,t)}function Qu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var j1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Xd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function e4(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Y1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},t4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Zu(e,t,n){for(var r=e<0?-1:1,a=e*r,o=0,l=1,u=0,d=1,f=0,m=0,v=Math.floor(a);f<t&&(v=Math.floor(a),u=v*l+o,m=v*f+d,!(a-v<5e-8));)a=1/(a-v),o=l,l=u,d=f,f=m;if(m>t&&(f>t?(m=d,u=o):(m=f,u=l)),!n)return[0,r*u,m];var y=Math.floor(r*u/m);return[y,r*u-y*m,m]}function as(e,t,n){if(e>2958465||e<0)return null;var r=e|0,a=Math.floor(86400*(e-r)),o=0,l=[],u={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(r+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++r,++u.D)),r===60)l=n?[1317,10,29]:[1900,2,29],o=3;else if(r===0)l=n?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var d=new Date(1900,0,1);d.setDate(d.getDate()+r-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],o=d.getDay(),r<60&&(o=(o+6)%7),n&&(o=o4(d,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var z2=new Date(1899,11,31,0,0,0),n4=z2.getTime(),r4=new Date(1900,2,1,0,0,0);function q2(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=r4&&(n+=1440*60*1e3),(n-(n4+(e.getTimezoneOffset()-z2.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Jh(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function a4(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function i4(e){var t=e<0?12:11,n=Jh(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function s4(e){var t=Jh(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function zl(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=i4(e):t===10?n=e.toFixed(10).substr(0,12):n=s4(e),Jh(a4(n.toUpperCase()))}function cs(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):zl(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Wr(14,q2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function o4(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function l4(e,t,n,r){var a="",o=0,l=0,u=n.y,d,f=0;switch(e){case 98:u=n.y+543;case 121:switch(t.length){case 1:case 2:d=u%100,f=2;break;default:d=u%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:d=n.m,f=t.length;break;case 3:return Xd[n.m-1][1];case 5:return Xd[n.m-1][0];default:return Xd[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=n.d,f=t.length;break;case 3:return j1[n.q][0];default:return j1[n.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(n.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=n.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=n.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?la(n.S,t.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,o=Math.round(l*(n.S+n.u)),o>=60*l&&(o=0),t==="s"?o===0?"0":""+o/l:(a=la(o,2+r),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=n.D*24+n.H;break;case"[m]":case"[mm]":d=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":d=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:d=u,f=1;break}var m=f>0?la(d,f):"";return m}function ki(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var j2=/%/g;function c4(e,t,n){var r=t.replace(j2,""),a=t.length-r.length;return Ya(e,r,n*Math.pow(10,2*a))+on("%",a)}function u4(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Ya(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function Y2(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Y2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),n=(t/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),n.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+o):n+="E+"+(l-o);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,f,m){return d+f+m.substr(0,(a+o)%a)+"."+m.substr(o)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var X2=/# (\?+)( ?)\/( ?)(\d+)/;function f4(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),o=Math.floor(a/r),l=a-o*r,u=r;return n+(o===0?"":""+o)+" "+(l===0?on(" ",e[1].length+1+e[4].length):Xh(l,e[1].length)+e[2]+"/"+e[3]+la(u,e[4].length))}function d4(e,t,n){return n+(t===0?"":""+t)+on(" ",e[1].length+2+e[4].length)}var J2=/^#*0*\.([0#]+)/,W2=/\).*[0#]/,K2=/\(###\) ###\\?-####/;function tr(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function X1(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function J1(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function h4(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function m4(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Vr(e,t,n){if(e.charCodeAt(0)===40&&!t.match(W2)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Vr("n",r,n):"("+Vr("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return u4(e,t,n);if(t.indexOf("%")!==-1)return c4(e,t,n);if(t.indexOf("E")!==-1)return Y2(t,n);if(t.charCodeAt(0)===36)return"$"+Vr(e,t.substr(t.charAt(1)==" "?2:1),n);var a,o,l,u,d=Math.abs(n),f=n<0?"-":"";if(t.match(/^00+$/))return f+no(d,t.length);if(t.match(/^[#?]+$/))return a=no(n,0),a==="0"&&(a=""),a.length>t.length?a:tr(t.substr(0,t.length-a.length))+a;if(o=t.match(X2))return f4(o,d,f);if(t.match(/^#+0+$/))return f+no(d,t.length-t.indexOf("0"));if(o=t.match(J2))return a=X1(n,o[1].length).replace(/^([^\.]+)$/,"$1."+tr(o[1])).replace(/\.$/,"."+tr(o[1])).replace(/\.(\d*)$/,function(w,S){return"."+S+on("0",tr(o[1]).length-S.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return f+X1(d,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return f+ki(no(d,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Vr(e,t,-n):ki(""+(Math.floor(n)+h4(n,o[1].length)))+"."+la(J1(n,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return Vr(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=uo(Vr(e,t.replace(/[\\-]/g,""),n)),l=0,uo(uo(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(t.match(K2))return a=Vr(e,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Zu(d,Math.pow(10,l)-1,!1),a=""+f,m=Ya("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+o[2]+"/"+o[3],m=$u(u[2],l),m.length<o[4].length&&(m=tr(o[4].substr(o[4].length-m.length))+m),a+=m,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Zu(d,Math.pow(10,l)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Xh(u[1],l)+o[2]+"/"+o[3]+$u(u[2],l):on(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=no(n,0),t.length<=a.length?a:tr(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=t.indexOf(".")-l,y=t.length-a.length-v;return tr(t.substr(0,v)+a+t.substr(t.length-y))}if(o=t.match(/^00,000\.([#0]*0)$/))return l=J1(n,o[1].length),n<0?"-"+Vr(e,t,-n):ki(m4(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?la(0,3-w.length):"")+w})+"."+la(l,o[1].length);switch(t){case"###,##0.00":return Vr(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var T=ki(no(d,0));return T!=="0"?f+T:"";case"###,###.00":return Vr(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Vr(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function p4(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Ya(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function x4(e,t,n){var r=t.replace(j2,""),a=t.length-r.length;return Ya(e,r,n*Math.pow(10,2*a))+on("%",a)}function $2(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+$2(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),n=(t/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!n.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+o):n+="E+"+(l-o),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,f,m){return d+f+m.substr(0,(a+o)%a)+"."+m.substr(o)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Ea(e,t,n){if(e.charCodeAt(0)===40&&!t.match(W2)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Ea("n",r,n):"("+Ea("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return p4(e,t,n);if(t.indexOf("%")!==-1)return x4(e,t,n);if(t.indexOf("E")!==-1)return $2(t,n);if(t.charCodeAt(0)===36)return"$"+Ea(e,t.substr(t.charAt(1)==" "?2:1),n);var a,o,l,u,d=Math.abs(n),f=n<0?"-":"";if(t.match(/^00+$/))return f+la(d,t.length);if(t.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>t.length?a:tr(t.substr(0,t.length-a.length))+a;if(o=t.match(X2))return d4(o,d,f);if(t.match(/^#+0+$/))return f+la(d,t.length-t.indexOf("0"));if(o=t.match(J2))return a=(""+n).replace(/^([^\.]+)$/,"$1."+tr(o[1])).replace(/\.$/,"."+tr(o[1])),a=a.replace(/\.(\d*)$/,function(w,S){return"."+S+on("0",tr(o[1]).length-S.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return f+ki(""+d);if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Ea(e,t,-n):ki(""+n)+"."+on("0",o[1].length);if(o=t.match(/^#,#*,#0/))return Ea(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=uo(Ea(e,t.replace(/[\\-]/g,""),n)),l=0,uo(uo(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(t.match(K2))return a=Ea(e,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=Zu(d,Math.pow(10,l)-1,!1),a=""+f,m=Ya("n",o[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+o[2]+"/"+o[3],m=$u(u[2],l),m.length<o[4].length&&(m=tr(o[4].substr(o[4].length-m.length))+m),a+=m,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=Zu(d,Math.pow(10,l)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Xh(u[1],l)+o[2]+"/"+o[3]+$u(u[2],l):on(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:tr(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=t.indexOf(".")-l,y=t.length-a.length-v;return tr(t.substr(0,v)+a+t.substr(t.length-y))}if(o=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Ea(e,t,-n):ki(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?la(0,3-w.length):"")+w})+"."+la(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var T=ki(""+d);return T!=="0"?f+T:"";default:if(t.match(/\.[0#?]*$/))return Ea(e,t.slice(0,t.lastIndexOf(".")),n)+tr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ya(e,t,n){return(n|0)===n?Ea(e,t,n):Vr(e,t,n)}function g4(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Q2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function _o(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Qu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(Q2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function v4(e,t,n,r){for(var a=[],o="",l=0,u="",d="t",f,m,v,y="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!Qu(e,l))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(v=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(v);a[a.length]={t:"t",v:o},++l;break;case"\\":var T=e.charAt(++l),w=T==="("||T===")"?T:"t";a[a.length]={t:w,v:T},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(f==null&&(f=as(t,n,e.charAt(l+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},d=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=as(t,n),f==null))return"";for(o=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&d.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),a[a.length]={t:u,v:o},d=u;break;case"A":case"a":case"":var S={t:u,v:u};if(f==null&&(f=as(t,n)),e.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(S.v=f.H>=12?"P":"A"),S.t="T",y="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(S.v=f.H>=12?"PM":"AM"),S.t="T",l+=5,y="h"):e.substr(l,5).toUpperCase()==="/"?(f!=null&&(S.v=f.H>=12?"":""),S.t="T",l+=5,y="h"):(S.t="t",++l),f==null&&S.t==="T")return"";a[a.length]=S,d=u;break;case"[":for(o=u;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(Q2)){if(f==null&&(f=as(t,n),f==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},d=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",_o(e)||(a[a.length]={t:"t",v:o}));break;case".":if(f!=null){for(o=u;++l<e.length&&(u=e.charAt(l))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;e.charAt(++l)===u;)o+=u;a[a.length]={t:u,v:o},d=u;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++l;break}var A=0,k=0,I;for(l=a.length-1,d="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=y,d="h",A<1&&(A=1);break;case"s":(I=a[l].v.match(/\.0+$/))&&(k=Math.max(k,I[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":d=a[l].t;break;case"m":d==="s"&&(a[l].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&a[l].v.match(/[Hh]/)&&(A=1),A<2&&a[l].v.match(/[Mm]/)&&(A=2),A<3&&a[l].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var b="",P;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=l4(a[l].t.charCodeAt(0),a[l].v,f,k),a[l].t="t";break;case"n":case"?":for(P=l+1;a[P]!=null&&((u=a[P].t)==="?"||u==="D"||(u===" "||u==="t")&&a[P+1]!=null&&(a[P+1].t==="?"||a[P+1].t==="t"&&a[P+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[P].v==="/"||a[P].v===" "&&a[P+1]!=null&&a[P+1].t=="?"));)a[l].v+=a[P].v,a[P]={v:"",t:";"},++P;b+=a[l].v,l=P-1;break;case"G":a[l].t="t",a[l].v=cs(t,n);break}var F="",Y,D;if(b.length>0){b.charCodeAt(0)==40?(Y=t<0&&b.charCodeAt(0)===45?-t:t,D=Ya("n",b,Y)):(Y=t<0&&r>1?-t:t,D=Ya("n",b,Y),Y<0&&a[0]&&a[0].t=="t"&&(D=D.substr(1),a[0].v="-"+a[0].v)),P=D.length-1;var Q=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){Q=l;break}var B=a.length;if(Q===a.length&&D.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(P>=a[l].v.length-1?(P-=a[l].v.length,a[l].v=D.substr(P+1,a[l].v.length)):P<0?a[l].v="":(a[l].v=D.substr(0,P+1),P=-1),a[l].t="t",B=l);P>=0&&B<a.length&&(a[B].v=D.substr(0,P+1)+a[B].v)}else if(Q!==a.length&&D.indexOf("E")===-1){for(P=D.indexOf(".")-1,l=Q;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(m=a[l].v.indexOf(".")>-1&&l===Q?a[l].v.indexOf(".")-1:a[l].v.length-1,F=a[l].v.substr(m+1);m>=0;--m)P>=0&&(a[l].v.charAt(m)==="0"||a[l].v.charAt(m)==="#")&&(F=D.charAt(P--)+F);a[l].v=F,a[l].t="t",B=l}for(P>=0&&B<a.length&&(a[B].v=D.substr(0,P+1)+a[B].v),P=D.indexOf(".")+1,l=Q;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==Q)){for(m=a[l].v.indexOf(".")>-1&&l===Q?a[l].v.indexOf(".")+1:0,F=a[l].v.substr(0,m);m<a[l].v.length;++m)P<D.length&&(F+=D.charAt(P++));a[l].v=F,a[l].t="t",B=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(Y=r>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=Ya(a[l].t,a[l].v,Y),a[l].t="t");var ae="";for(l=0;l!==a.length;++l)a[l]!=null&&(ae+=a[l].v);return ae}var W1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function K1(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function y4(e,t){var n=g4(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var o=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,o];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var l=n[0].match(W1),u=n[1].match(W1);return K1(t,l)?[r,n[0]]:K1(t,u)?[r,n[1]]:[r,n[l!=null&&u!=null?2:1]]}return[r,o]}function Wr(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:nt)[e],r==null&&(r=n.table&&n.table[Y1[e]]||nt[Y1[e]]),r==null&&(r=t4[e]||"General");break}if(Qu(r,0))return cs(t,n);t instanceof Date&&(t=q2(t,n.date1904));var a=y4(r,t);if(Qu(a[1]))return cs(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return v4(a[1],t,n,a[0])}function Xa(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(nt[n]==null){t<0&&(t=n);continue}if(nt[n]==e){t=n;break}}t<0&&(t=391)}return nt[t]=e,t}function vf(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Xa(e[t],t)}function Eo(){nt=e4()}var _4={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Z2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function E4(e){var t=typeof e=="number"?nt[e]:e;return t=t.replace(Z2,"(\\d+)"),new RegExp("^"+t+"$")}function T4(e,t,n){var r=-1,a=-1,o=-1,l=-1,u=-1,d=-1;(t.match(Z2)||[]).forEach(function(v,y){var T=parseInt(n[y+1],10);switch(v.toLowerCase().charAt(0)){case"y":r=T;break;case"d":o=T;break;case"h":l=T;break;case"s":d=T;break;case"m":l>=0?u=T:a=T;break}}),d>=0&&u==-1&&a>=0&&(u=a,a=-1);var f=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&u==-1&&d==-1?f:r==-1&&a==-1&&o==-1?m:f+"T"+m}var S4=(function(){var e={};e.version="1.2.0";function t(){for(var D=0,Q=new Array(256),B=0;B!=256;++B)D=B,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,Q[B]=D;return typeof Int32Array<"u"?new Int32Array(Q):Q}var n=t();function r(D){var Q=0,B=0,ae=0,ie=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ae=0;ae!=256;++ae)ie[ae]=D[ae];for(ae=0;ae!=256;++ae)for(B=D[ae],Q=256+ae;Q<4096;Q+=256)B=ie[Q]=B>>>8^D[B&255];var Z=[];for(ae=1;ae!=16;++ae)Z[ae-1]=typeof Int32Array<"u"?ie.subarray(ae*256,ae*256+256):ie.slice(ae*256,ae*256+256);return Z}var a=r(n),o=a[0],l=a[1],u=a[2],d=a[3],f=a[4],m=a[5],v=a[6],y=a[7],T=a[8],w=a[9],S=a[10],A=a[11],k=a[12],I=a[13],b=a[14];function P(D,Q){for(var B=Q^-1,ae=0,ie=D.length;ae<ie;)B=B>>>8^n[(B^D.charCodeAt(ae++))&255];return~B}function F(D,Q){for(var B=Q^-1,ae=D.length-15,ie=0;ie<ae;)B=b[D[ie++]^B&255]^I[D[ie++]^B>>8&255]^k[D[ie++]^B>>16&255]^A[D[ie++]^B>>>24]^S[D[ie++]]^w[D[ie++]]^T[D[ie++]]^y[D[ie++]]^v[D[ie++]]^m[D[ie++]]^f[D[ie++]]^d[D[ie++]]^u[D[ie++]]^l[D[ie++]]^o[D[ie++]]^n[D[ie++]];for(ae+=15;ie<ae;)B=B>>>8^n[(B^D[ie++])&255];return~B}function Y(D,Q){for(var B=Q^-1,ae=0,ie=D.length,Z=0,le=0;ae<ie;)Z=D.charCodeAt(ae++),Z<128?B=B>>>8^n[(B^Z)&255]:Z<2048?(B=B>>>8^n[(B^(192|Z>>6&31))&255],B=B>>>8^n[(B^(128|Z&63))&255]):Z>=55296&&Z<57344?(Z=(Z&1023)+64,le=D.charCodeAt(ae++)&1023,B=B>>>8^n[(B^(240|Z>>8&7))&255],B=B>>>8^n[(B^(128|Z>>2&63))&255],B=B>>>8^n[(B^(128|le>>6&15|(Z&3)<<4))&255],B=B>>>8^n[(B^(128|le&63))&255]):(B=B>>>8^n[(B^(224|Z>>12&15))&255],B=B>>>8^n[(B^(128|Z>>6&63))&255],B=B>>>8^n[(B^(128|Z&63))&255]);return~B}return e.table=n,e.bstr=P,e.buf=F,e.str=Y,e})(),et=(function(){var t={};t.version="1.2.1";function n(R,j){for(var L=R.split("/"),O=j.split("/"),z=0,X=0,fe=Math.min(L.length,O.length);z<fe;++z){if(X=L[z].length-O[z].length)return X;if(L[z]!=O[z])return L[z]<O[z]?-1:1}return L.length-O.length}function r(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:r(R.slice(0,-1));var j=R.lastIndexOf("/");return j===-1?R:R.slice(0,j+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var j=R.lastIndexOf("/");return j===-1?R:R.slice(j+1)}function o(R,j){typeof j=="string"&&(j=new Date(j));var L=j.getHours();L=L<<6|j.getMinutes(),L=L<<5|j.getSeconds()>>>1,R.write_shift(2,L);var O=j.getFullYear()-1980;O=O<<4|j.getMonth()+1,O=O<<5|j.getDate(),R.write_shift(2,O)}function l(R){var j=R.read_shift(2)&65535,L=R.read_shift(2)&65535,O=new Date,z=L&31;L>>>=5;var X=L&15;L>>>=4,O.setMilliseconds(0),O.setFullYear(L+1980),O.setMonth(X-1),O.setDate(z);var fe=j&31;j>>>=5;var Se=j&63;return j>>>=6,O.setHours(j),O.setMinutes(Se),O.setSeconds(fe<<1),O}function u(R){Un(R,0);for(var j={},L=0;R.l<=R.length-4;){var O=R.read_shift(2),z=R.read_shift(2),X=R.l+z,fe={};switch(O){case 21589:L=R.read_shift(1),L&1&&(fe.mtime=R.read_shift(4)),z>5&&(L&2&&(fe.atime=R.read_shift(4)),L&4&&(fe.ctime=R.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3));break}R.l=X,j[O]=fe}return j}var d;function f(){return d||(d={})}function m(R,j){if(R[0]==80&&R[1]==75)return Zr(R,j);if((R[0]|32)==109&&(R[1]|32)==105)return na(R,j);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var L=3,O=512,z=0,X=0,fe=0,Se=0,de=0,he=[],pe=R.slice(0,512);Un(pe,0);var De=v(pe);switch(L=De[0],L){case 3:O=512;break;case 4:O=4096;break;case 0:if(De[1]==0)return Zr(R,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}O!==512&&(pe=R.slice(0,O),Un(pe,28));var Ue=R.slice(0,O);y(pe,L);var ze=pe.read_shift(4,"i");if(L===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);pe.l+=4,fe=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),Se=pe.read_shift(4,"i"),z=pe.read_shift(4,"i"),de=pe.read_shift(4,"i"),X=pe.read_shift(4,"i");for(var Ie=-1,Ve=0;Ve<109&&(Ie=pe.read_shift(4,"i"),!(Ie<0));++Ve)he[Ve]=Ie;var We=T(R,O);A(de,X,We,O,he);var Yt=I(We,fe,he,O);Yt[fe].name="!Directory",z>0&&Se!==le&&(Yt[Se].name="!MiniFAT"),Yt[he[0]].name="!FAT",Yt.fat_addrs=he,Yt.ssz=O;var Xt={},Zt=[],Rr=[],Bi=[];b(fe,Yt,We,Zt,z,Xt,Rr,Se),w(Rr,Bi,Zt),Zt.shift();var ri={FileIndex:Rr,FullPaths:Bi};return j&&j.raw&&(ri.raw={header:Ue,sectors:We}),ri}function v(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(Te,"Header Signature: "),R.l+=16;var j=R.read_shift(2,"u");return[R.read_shift(2,"u"),j]}function y(R,j){var L=9;switch(R.l+=2,L=R.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function T(R,j){for(var L=Math.ceil(R.length/j)-1,O=[],z=1;z<L;++z)O[z-1]=R.slice(z*j,(z+1)*j);return O[L-1]=R.slice(L*j),O}function w(R,j,L){for(var O=0,z=0,X=0,fe=0,Se=0,de=L.length,he=[],pe=[];O<de;++O)he[O]=pe[O]=O,j[O]=L[O];for(;Se<pe.length;++Se)O=pe[Se],z=R[O].L,X=R[O].R,fe=R[O].C,he[O]===O&&(z!==-1&&he[z]!==z&&(he[O]=he[z]),X!==-1&&he[X]!==X&&(he[O]=he[X])),fe!==-1&&(he[fe]=O),z!==-1&&O!=he[O]&&(he[z]=he[O],pe.lastIndexOf(z)<Se&&pe.push(z)),X!==-1&&O!=he[O]&&(he[X]=he[O],pe.lastIndexOf(X)<Se&&pe.push(X));for(O=1;O<de;++O)he[O]===O&&(X!==-1&&he[X]!==X?he[O]=he[X]:z!==-1&&he[z]!==z&&(he[O]=he[z]));for(O=1;O<de;++O)if(R[O].type!==0){if(Se=O,Se!=he[Se])do Se=he[Se],j[O]=j[Se]+"/"+j[O];while(Se!==0&&he[Se]!==-1&&Se!=he[Se]);he[O]=-1}for(j[0]+="/",O=1;O<de;++O)R[O].type!==2&&(j[O]+="/")}function S(R,j,L){for(var O=R.start,z=R.size,X=[],fe=O;L&&z>0&&fe>=0;)X.push(j.slice(fe*Z,fe*Z+Z)),z-=Z,fe=rs(L,fe*4);return X.length===0?_e(0):Rn(X).slice(0,R.size)}function A(R,j,L,O,z){var X=le;if(R===le){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var fe=L[R],Se=(O>>>2)-1;if(!fe)return;for(var de=0;de<Se&&(X=rs(fe,de*4))!==le;++de)z.push(X);A(rs(fe,O-4),j-1,L,O,z)}}function k(R,j,L,O,z){var X=[],fe=[];z||(z=[]);var Se=O-1,de=0,he=0;for(de=j;de>=0;){z[de]=!0,X[X.length]=de,fe.push(R[de]);var pe=L[Math.floor(de*4/O)];if(he=de*4&Se,O<4+he)throw new Error("FAT boundary crossed: "+de+" 4 "+O);if(!R[pe])break;de=rs(R[pe],he)}return{nodes:X,data:lv([fe])}}function I(R,j,L,O){var z=R.length,X=[],fe=[],Se=[],de=[],he=O-1,pe=0,De=0,Ue=0,ze=0;for(pe=0;pe<z;++pe)if(Se=[],Ue=pe+j,Ue>=z&&(Ue-=z),!fe[Ue]){de=[];var Ie=[];for(De=Ue;De>=0;){Ie[De]=!0,fe[De]=!0,Se[Se.length]=De,de.push(R[De]);var Ve=L[Math.floor(De*4/O)];if(ze=De*4&he,O<4+ze)throw new Error("FAT boundary crossed: "+De+" 4 "+O);if(!R[Ve]||(De=rs(R[Ve],ze),Ie[De]))break}X[Ue]={nodes:Se,data:lv([de])}}return X}function b(R,j,L,O,z,X,fe,Se){for(var de=0,he=O.length?2:0,pe=j[R].data,De=0,Ue=0,ze;De<pe.length;De+=128){var Ie=pe.slice(De,De+128);Un(Ie,64),Ue=Ie.read_shift(2),ze=tm(Ie,0,Ue-he),O.push(ze);var Ve={name:ze,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},We=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);We!==0&&(Ve.ct=P(Ie,Ie.l-8));var Yt=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);Yt!==0&&(Ve.mt=P(Ie,Ie.l-8)),Ve.start=Ie.read_shift(4,"i"),Ve.size=Ie.read_shift(4,"i"),Ve.size<0&&Ve.start<0&&(Ve.size=Ve.type=0,Ve.start=le,Ve.name=""),Ve.type===5?(de=Ve.start,z>0&&de!==le&&(j[de].name="!StreamData")):Ve.size>=4096?(Ve.storage="fat",j[Ve.start]===void 0&&(j[Ve.start]=k(L,Ve.start,j.fat_addrs,j.ssz)),j[Ve.start].name=Ve.name,Ve.content=j[Ve.start].data.slice(0,Ve.size)):(Ve.storage="minifat",Ve.size<0?Ve.size=0:de!==le&&Ve.start!==le&&j[de]&&(Ve.content=S(Ve,j[de].data,(j[Se]||{}).data))),Ve.content&&Un(Ve.content,0),X[ze]=Ve,fe.push(Ve)}}function P(R,j){return new Date((Cr(R,j+4)/1e7*Math.pow(2,32)+Cr(R,j)/1e7-11644473600)*1e3)}function F(R,j){return f(),m(d.readFileSync(R),j)}function Y(R,j){var L=j&&j.type;switch(L||xt&&Buffer.isBuffer(R)&&(L="buffer"),L||"base64"){case"file":return F(R,j);case"base64":return m(br(kr(R)),j);case"binary":return m(br(R),j)}return m(R,j)}function D(R,j){var L=j||{},O=L.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=O+"/",R.FileIndex[0]={name:O,type:5}),L.CLSID&&(R.FileIndex[0].clsid=L.CLSID),Q(R)}function Q(R){var j="Sh33tJ5";if(!et.find(R,"/"+j)){var L=_e(4);L[0]=55,L[1]=L[3]=50,L[2]=54,R.FileIndex.push({name:j,type:2,content:L,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+j),B(R)}}function B(R,j){D(R);for(var L=!1,O=!1,z=R.FullPaths.length-1;z>=0;--z){var X=R.FileIndex[z];switch(X.type){case 0:O?L=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(X.R*X.L*X.C)&&(L=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!j)){var fe=new Date(1987,1,19),Se=0,de=Object.create?Object.create(null):{},he=[];for(z=0;z<R.FullPaths.length;++z)de[R.FullPaths[z]]=!0,R.FileIndex[z].type!==0&&he.push([R.FullPaths[z],R.FileIndex[z]]);for(z=0;z<he.length;++z){var pe=r(he[z][0]);O=de[pe],O||(he.push([pe,{name:a(pe).replace("/",""),type:1,clsid:H,ct:fe,mt:fe,content:null}]),de[pe]=!0)}for(he.sort(function(ze,Ie){return n(ze[0],Ie[0])}),R.FullPaths=[],R.FileIndex=[],z=0;z<he.length;++z)R.FullPaths[z]=he[z][0],R.FileIndex[z]=he[z][1];for(z=0;z<he.length;++z){var De=R.FileIndex[z],Ue=R.FullPaths[z];if(De.name=a(Ue).replace("/",""),De.L=De.R=De.C=-(De.color=1),De.size=De.content?De.content.length:0,De.start=0,De.clsid=De.clsid||H,z===0)De.C=he.length>1?1:-1,De.size=0,De.type=5;else if(Ue.slice(-1)=="/"){for(Se=z+1;Se<he.length&&r(R.FullPaths[Se])!=Ue;++Se);for(De.C=Se>=he.length?-1:Se,Se=z+1;Se<he.length&&r(R.FullPaths[Se])!=r(Ue);++Se);De.R=Se>=he.length?-1:Se,De.type=1}else r(R.FullPaths[z+1]||"")==r(Ue)&&(De.R=z+1),De.type=2}}}function ae(R,j){var L=j||{};if(L.fileType=="mad")return Mf(R,L);switch(B(R),L.fileType){case"zip":return Ca(R,L)}var O=(function(ze){for(var Ie=0,Ve=0,We=0;We<ze.FileIndex.length;++We){var Yt=ze.FileIndex[We];if(Yt.content){var Xt=Yt.content.length;Xt>0&&(Xt<4096?Ie+=Xt+63>>6:Ve+=Xt+511>>9)}}for(var Zt=ze.FullPaths.length+3>>2,Rr=Ie+7>>3,Bi=Ie+127>>7,ri=Rr+Ve+Zt+Bi,pa=ri+127>>7,Ro=pa<=109?0:Math.ceil((pa-109)/127);ri+pa+Ro+127>>7>pa;)Ro=++pa<=109?0:Math.ceil((pa-109)/127);var sr=[1,Ro,pa,Bi,Zt,Ve,Ie,0];return ze.FileIndex[0].size=Ie<<6,sr[7]=(ze.FileIndex[0].start=sr[0]+sr[1]+sr[2]+sr[3]+sr[4]+sr[5])+(sr[6]+7>>3),sr})(R),z=_e(O[7]<<9),X=0,fe=0;{for(X=0;X<8;++X)z.write_shift(1,ye[X]);for(X=0;X<8;++X)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),X=0;X<3;++X)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,O[2]),z.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:le),z.write_shift(4,O[3]),z.write_shift(-4,O[1]?O[0]-1:le),z.write_shift(4,O[1]),X=0;X<109;++X)z.write_shift(-4,X<O[2]?O[1]+X:-1)}if(O[1])for(fe=0;fe<O[1];++fe){for(;X<236+fe*127;++X)z.write_shift(-4,X<O[2]?O[1]+X:-1);z.write_shift(-4,fe===O[1]-1?le:fe+1)}var Se=function(ze){for(fe+=ze;X<fe-1;++X)z.write_shift(-4,X+1);ze&&(++X,z.write_shift(-4,le))};for(fe=X=0,fe+=O[1];X<fe;++X)z.write_shift(-4,ee.DIFSECT);for(fe+=O[2];X<fe;++X)z.write_shift(-4,ee.FATSECT);Se(O[3]),Se(O[4]);for(var de=0,he=0,pe=R.FileIndex[0];de<R.FileIndex.length;++de)pe=R.FileIndex[de],pe.content&&(he=pe.content.length,!(he<4096)&&(pe.start=fe,Se(he+511>>9)));for(Se(O[6]+7>>3);z.l&511;)z.write_shift(-4,ee.ENDOFCHAIN);for(fe=X=0,de=0;de<R.FileIndex.length;++de)pe=R.FileIndex[de],pe.content&&(he=pe.content.length,!(!he||he>=4096)&&(pe.start=fe,Se(he+63>>6)));for(;z.l&511;)z.write_shift(-4,ee.ENDOFCHAIN);for(X=0;X<O[4]<<2;++X){var De=R.FullPaths[X];if(!De||De.length===0){for(de=0;de<17;++de)z.write_shift(4,0);for(de=0;de<3;++de)z.write_shift(4,-1);for(de=0;de<12;++de)z.write_shift(4,0);continue}pe=R.FileIndex[X],X===0&&(pe.start=pe.size?pe.start-1:le);var Ue=X===0&&L.root||pe.name;if(he=2*(Ue.length+1),z.write_shift(64,Ue,"utf16le"),z.write_shift(2,he),z.write_shift(1,pe.type),z.write_shift(1,pe.color),z.write_shift(-4,pe.L),z.write_shift(-4,pe.R),z.write_shift(-4,pe.C),pe.clsid)z.write_shift(16,pe.clsid,"hex");else for(de=0;de<4;++de)z.write_shift(4,0);z.write_shift(4,pe.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,pe.start),z.write_shift(4,pe.size),z.write_shift(4,0)}for(X=1;X<R.FileIndex.length;++X)if(pe=R.FileIndex[X],pe.size>=4096)if(z.l=pe.start+1<<9,xt&&Buffer.isBuffer(pe.content))pe.content.copy(z,z.l,0,pe.size),z.l+=pe.size+511&-512;else{for(de=0;de<pe.size;++de)z.write_shift(1,pe.content[de]);for(;de&511;++de)z.write_shift(1,0)}for(X=1;X<R.FileIndex.length;++X)if(pe=R.FileIndex[X],pe.size>0&&pe.size<4096)if(xt&&Buffer.isBuffer(pe.content))pe.content.copy(z,z.l,0,pe.size),z.l+=pe.size+63&-64;else{for(de=0;de<pe.size;++de)z.write_shift(1,pe.content[de]);for(;de&63;++de)z.write_shift(1,0)}if(xt)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function ie(R,j){var L=R.FullPaths.map(function(de){return de.toUpperCase()}),O=L.map(function(de){var he=de.split("/");return he[he.length-(de.slice(-1)=="/"?2:1)]}),z=!1;j.charCodeAt(0)===47?(z=!0,j=L[0].slice(0,-1)+j):z=j.indexOf("/")!==-1;var X=j.toUpperCase(),fe=z===!0?L.indexOf(X):O.indexOf(X);if(fe!==-1)return R.FileIndex[fe];var Se=!X.match(wl);for(X=X.replace(rr,""),Se&&(X=X.replace(wl,"!")),fe=0;fe<L.length;++fe)if((Se?L[fe].replace(wl,"!"):L[fe]).replace(rr,"")==X||(Se?O[fe].replace(wl,"!"):O[fe]).replace(rr,"")==X)return R.FileIndex[fe];return null}var Z=64,le=-2,Te="d0cf11e0a1b11ae1",ye=[208,207,17,224,161,177,26,225],H="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:le,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:H,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ce(R,j,L){f();var O=ae(R,L);d.writeFileSync(j,O)}function re(R){for(var j=new Array(R.length),L=0;L<R.length;++L)j[L]=String.fromCharCode(R[L]);return j.join("")}function Fe(R,j){var L=ae(R,j);switch(j&&j.type||"buffer"){case"file":return f(),d.writeFileSync(j.filename,L),L;case"binary":return typeof L=="string"?L:re(L);case"base64":return Vl(typeof L=="string"?L:re(L));case"buffer":if(xt)return Buffer.isBuffer(L)?L:$a(L);case"array":return typeof L=="string"?br(L):L}return L}var W;function N(R){try{var j=R.InflateRaw,L=new j;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)W=R;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function G(R,j){if(!W)return bn(R,j);var L=W.InflateRaw,O=new L,z=O._processChunk(R.slice(R.l),O._finishFlushFlag);return R.l+=O.bytesRead,z}function U(R){return W?W.deflateRawSync(R):Le(R)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(R){var j=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(j>>16|j>>8|j)&255}for(var ve=typeof Uint8Array<"u",we=ve?new Uint8Array(256):[],Je=0;Je<256;++Je)we[Je]=ge(Je);function J(R,j){var L=we[R&255];return j<=8?L>>>8-j:(L=L<<8|we[R>>8&255],j<=16?L>>>16-j:(L=L<<8|we[R>>16&255],L>>>24-j))}function wt(R,j){var L=j&7,O=j>>>3;return(R[O]|(L<=6?0:R[O+1]<<8))>>>L&3}function rt(R,j){var L=j&7,O=j>>>3;return(R[O]|(L<=5?0:R[O+1]<<8))>>>L&7}function vt(R,j){var L=j&7,O=j>>>3;return(R[O]|(L<=4?0:R[O+1]<<8))>>>L&15}function at(R,j){var L=j&7,O=j>>>3;return(R[O]|(L<=3?0:R[O+1]<<8))>>>L&31}function Ge(R,j){var L=j&7,O=j>>>3;return(R[O]|(L<=1?0:R[O+1]<<8))>>>L&127}function Ft(R,j,L){var O=j&7,z=j>>>3,X=(1<<L)-1,fe=R[z]>>>O;return L<8-O||(fe|=R[z+1]<<8-O,L<16-O)||(fe|=R[z+2]<<16-O,L<24-O)||(fe|=R[z+3]<<24-O),fe&X}function tn(R,j,L){var O=j&7,z=j>>>3;return O<=5?R[z]|=(L&7)<<O:(R[z]|=L<<O&255,R[z+1]=(L&7)>>8-O),j+3}function Tn(R,j,L){var O=j&7,z=j>>>3;return L=(L&1)<<O,R[z]|=L,j+1}function Cn(R,j,L){var O=j&7,z=j>>>3;return L<<=O,R[z]|=L&255,L>>>=8,R[z+1]=L,j+8}function Qr(R,j,L){var O=j&7,z=j>>>3;return L<<=O,R[z]|=L&255,L>>>=8,R[z+1]=L&255,R[z+2]=L>>>8,j+16}function Qn(R,j){var L=R.length,O=2*L>j?2*L:j+5,z=0;if(L>=j)return R;if(xt){var X=z1(O);if(R.copy)R.copy(X);else for(;z<R.length;++z)X[z]=R[z];return X}else if(ve){var fe=new Uint8Array(O);if(fe.set)fe.set(R);else for(;z<L;++z)fe[z]=R[z];return fe}return R.length=O,R}function Mt(R){for(var j=new Array(R),L=0;L<R;++L)j[L]=0;return j}function Hn(R,j,L){var O=1,z=0,X=0,fe=0,Se=0,de=R.length,he=ve?new Uint16Array(32):Mt(32);for(X=0;X<32;++X)he[X]=0;for(X=de;X<L;++X)R[X]=0;de=R.length;var pe=ve?new Uint16Array(de):Mt(de);for(X=0;X<de;++X)he[z=R[X]]++,O<z&&(O=z),pe[X]=0;for(he[0]=0,X=1;X<=O;++X)he[X+16]=Se=Se+he[X-1]<<1;for(X=0;X<de;++X)Se=R[X],Se!=0&&(pe[X]=he[Se+16]++);var De=0;for(X=0;X<de;++X)if(De=R[X],De!=0)for(Se=J(pe[X],O)>>O-De,fe=(1<<O+4-De)-1;fe>=0;--fe)j[Se|fe<<De]=De&15|X<<4;return O}var te=ve?new Uint16Array(512):Mt(512),Pe=ve?new Uint16Array(32):Mt(32);if(!ve){for(var Me=0;Me<512;++Me)te[Me]=0;for(Me=0;Me<32;++Me)Pe[Me]=0}(function(){for(var R=[],j=0;j<32;j++)R.push(5);Hn(R,Pe,32);var L=[];for(j=0;j<=143;j++)L.push(8);for(;j<=255;j++)L.push(9);for(;j<=279;j++)L.push(7);for(;j<=287;j++)L.push(8);Hn(L,te,288)})();var Ye=(function(){for(var j=ve?new Uint8Array(32768):[],L=0,O=0;L<se.length-1;++L)for(;O<se[L+1];++O)j[O]=L;for(;O<32768;++O)j[O]=29;var z=ve?new Uint8Array(259):[];for(L=0,O=0;L<q.length-1;++L)for(;O<q[L+1];++O)z[O]=L;function X(Se,de){for(var he=0;he<Se.length;){var pe=Math.min(65535,Se.length-he),De=he+pe==Se.length;for(de.write_shift(1,+De),de.write_shift(2,pe),de.write_shift(2,~pe&65535);pe-- >0;)de[de.l++]=Se[he++]}return de.l}function fe(Se,de){for(var he=0,pe=0,De=ve?new Uint16Array(32768):[];pe<Se.length;){var Ue=Math.min(65535,Se.length-pe);if(Ue<10){for(he=tn(de,he,+(pe+Ue==Se.length)),he&7&&(he+=8-(he&7)),de.l=he/8|0,de.write_shift(2,Ue),de.write_shift(2,~Ue&65535);Ue-- >0;)de[de.l++]=Se[pe++];he=de.l*8;continue}he=tn(de,he,+(pe+Ue==Se.length)+2);for(var ze=0;Ue-- >0;){var Ie=Se[pe];ze=(ze<<5^Ie)&32767;var Ve=-1,We=0;if((Ve=De[ze])&&(Ve|=pe&-32768,Ve>pe&&(Ve-=32768),Ve<pe))for(;Se[Ve+We]==Se[pe+We]&&We<250;)++We;if(We>2){Ie=z[We],Ie<=22?he=Cn(de,he,we[Ie+1]>>1)-1:(Cn(de,he,3),he+=5,Cn(de,he,we[Ie-23]>>5),he+=3);var Yt=Ie<8?0:Ie-4>>2;Yt>0&&(Qr(de,he,We-q[Ie]),he+=Yt),Ie=j[pe-Ve],he=Cn(de,he,we[Ie]>>3),he-=3;var Xt=Ie<4?0:Ie-2>>1;Xt>0&&(Qr(de,he,pe-Ve-se[Ie]),he+=Xt);for(var Zt=0;Zt<We;++Zt)De[ze]=pe&32767,ze=(ze<<5^Se[pe])&32767,++pe;Ue-=We-1}else Ie<=143?Ie=Ie+48:he=Tn(de,he,1),he=Cn(de,he,we[Ie]),De[ze]=pe&32767,++pe}he=Cn(de,he,0)-1}return de.l=(he+7)/8|0,de.l}return function(de,he){return de.length<8?X(de,he):fe(de,he)}})();function Le(R){var j=_e(50+Math.floor(R.length*1.1)),L=Ye(R,j);return j.slice(0,L)}var pt=ve?new Uint16Array(32768):Mt(32768),Ne=ve?new Uint16Array(32768):Mt(32768),Oe=ve?new Uint16Array(128):Mt(128),je=1,Qe=1;function lt(R,j){var L=at(R,j)+257;j+=5;var O=at(R,j)+1;j+=5;var z=vt(R,j)+4;j+=4;for(var X=0,fe=ve?new Uint8Array(19):Mt(19),Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],de=1,he=ve?new Uint8Array(8):Mt(8),pe=ve?new Uint8Array(8):Mt(8),De=fe.length,Ue=0;Ue<z;++Ue)fe[V[Ue]]=X=rt(R,j),de<X&&(de=X),he[X]++,j+=3;var ze=0;for(he[0]=0,Ue=1;Ue<=de;++Ue)pe[Ue]=ze=ze+he[Ue-1]<<1;for(Ue=0;Ue<De;++Ue)(ze=fe[Ue])!=0&&(Se[Ue]=pe[ze]++);var Ie=0;for(Ue=0;Ue<De;++Ue)if(Ie=fe[Ue],Ie!=0){ze=we[Se[Ue]]>>8-Ie;for(var Ve=(1<<7-Ie)-1;Ve>=0;--Ve)Oe[ze|Ve<<Ie]=Ie&7|Ue<<3}var We=[];for(de=1;We.length<L+O;)switch(ze=Oe[Ge(R,j)],j+=ze&7,ze>>>=3){case 16:for(X=3+wt(R,j),j+=2,ze=We[We.length-1];X-- >0;)We.push(ze);break;case 17:for(X=3+rt(R,j),j+=3;X-- >0;)We.push(0);break;case 18:for(X=11+Ge(R,j),j+=7;X-- >0;)We.push(0);break;default:We.push(ze),de<ze&&(de=ze);break}var Yt=We.slice(0,L),Xt=We.slice(L);for(Ue=L;Ue<286;++Ue)Yt[Ue]=0;for(Ue=O;Ue<30;++Ue)Xt[Ue]=0;return je=Hn(Yt,pt,286),Qe=Hn(Xt,Ne,30),j}function gr(R,j){if(R[0]==3&&!(R[1]&3))return[Di(j),2];for(var L=0,O=0,z=z1(j||1<<18),X=0,fe=z.length>>>0,Se=0,de=0;(O&1)==0;){if(O=rt(R,L),L+=3,O>>>1)O>>1==1?(Se=9,de=5):(L=lt(R,L),Se=je,de=Qe);else{L&7&&(L+=8-(L&7));var he=R[L>>>3]|R[(L>>>3)+1]<<8;if(L+=32,he>0)for(!j&&fe<X+he&&(z=Qn(z,X+he),fe=z.length);he-- >0;)z[X++]=R[L>>>3],L+=8;continue}for(;;){!j&&fe<X+32767&&(z=Qn(z,X+32767),fe=z.length);var pe=Ft(R,L,Se),De=O>>>1==1?te[pe]:pt[pe];if(L+=De&15,De>>>=4,(De>>>8&255)===0)z[X++]=De;else{if(De==256)break;De-=257;var Ue=De<8?0:De-4>>2;Ue>5&&(Ue=0);var ze=X+q[De];Ue>0&&(ze+=Ft(R,L,Ue),L+=Ue),pe=Ft(R,L,de),De=O>>>1==1?Pe[pe]:Ne[pe],L+=De&15,De>>>=4;var Ie=De<4?0:De-2>>1,Ve=se[De];for(Ie>0&&(Ve+=Ft(R,L,Ie),L+=Ie),!j&&fe<ze&&(z=Qn(z,ze+100),fe=z.length);X<ze;)z[X]=z[X-Ve],++X}}}return j?[z,L+7>>>3]:[z.slice(0,X),L+7>>>3]}function bn(R,j){var L=R.slice(R.l||0),O=gr(L,j);return R.l+=O[1],O[0]}function ma(R,j){if(R)typeof console<"u"&&console.error(j);else throw new Error(j)}function Zr(R,j){var L=R;Un(L,0);var O=[],z=[],X={FileIndex:O,FullPaths:z};D(X,{root:j.root});for(var fe=L.length-4;(L[fe]!=80||L[fe+1]!=75||L[fe+2]!=5||L[fe+3]!=6)&&fe>=0;)--fe;L.l=fe+4,L.l+=4;var Se=L.read_shift(2);L.l+=6;var de=L.read_shift(4);for(L.l=de,fe=0;fe<Se;++fe){L.l+=20;var he=L.read_shift(4),pe=L.read_shift(4),De=L.read_shift(2),Ue=L.read_shift(2),ze=L.read_shift(2);L.l+=8;var Ie=L.read_shift(4),Ve=u(L.slice(L.l+De,L.l+De+Ue));L.l+=De+Ue+ze;var We=L.l;L.l=Ie+4,ni(L,he,pe,X,Ve),L.l=We}return X}function ni(R,j,L,O,z){R.l+=2;var X=R.read_shift(2),fe=R.read_shift(2),Se=l(R);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var de=R.read_shift(4),he=R.read_shift(4),pe=R.read_shift(4),De=R.read_shift(2),Ue=R.read_shift(2),ze="",Ie=0;Ie<De;++Ie)ze+=String.fromCharCode(R[R.l++]);if(Ue){var Ve=u(R.slice(R.l,R.l+Ue));(Ve[21589]||{}).mt&&(Se=Ve[21589].mt),((z||{})[21589]||{}).mt&&(Se=z[21589].mt)}R.l+=Ue;var We=R.slice(R.l,R.l+he);switch(fe){case 8:We=G(R,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var Yt=!1;X&8&&(de=R.read_shift(4),de==134695760&&(de=R.read_shift(4),Yt=!0),he=R.read_shift(4),pe=R.read_shift(4)),he!=j&&ma(Yt,"Bad compressed size: "+j+" != "+he),pe!=L&&ma(Yt,"Bad uncompressed size: "+L+" != "+pe),Ts(O,ze,We,{unsafe:!0,mt:Se})}function Ca(R,j){var L=j||{},O=[],z=[],X=_e(1),fe=L.compression?8:0,Se=0,de=0,he=0,pe=0,De=0,Ue=R.FullPaths[0],ze=Ue,Ie=R.FileIndex[0],Ve=[],We=0;for(de=1;de<R.FullPaths.length;++de)if(ze=R.FullPaths[de].slice(Ue.length),Ie=R.FileIndex[de],!(!Ie.size||!Ie.content||ze=="Sh33tJ5")){var Yt=pe,Xt=_e(ze.length);for(he=0;he<ze.length;++he)Xt.write_shift(1,ze.charCodeAt(he)&127);Xt=Xt.slice(0,Xt.l),Ve[De]=S4.buf(Ie.content,0);var Zt=Ie.content;fe==8&&(Zt=U(Zt)),X=_e(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,Se),X.write_shift(2,fe),Ie.mt?o(X,Ie.mt):X.write_shift(4,0),X.write_shift(-4,Ve[De]),X.write_shift(4,Zt.length),X.write_shift(4,Ie.content.length),X.write_shift(2,Xt.length),X.write_shift(2,0),pe+=X.length,O.push(X),pe+=Xt.length,O.push(Xt),pe+=Zt.length,O.push(Zt),X=_e(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,Se),X.write_shift(2,fe),X.write_shift(4,0),X.write_shift(-4,Ve[De]),X.write_shift(4,Zt.length),X.write_shift(4,Ie.content.length),X.write_shift(2,Xt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Yt),We+=X.l,z.push(X),We+=Xt.length,z.push(Xt),++De}return X=_e(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,De),X.write_shift(2,De),X.write_shift(4,We),X.write_shift(4,pe),X.write_shift(2,0),Rn([Rn(O),Rn(z),X])}var ir={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ea(R,j){if(R.ctype)return R.ctype;var L=R.name||"",O=L.match(/\.([^\.]+)$/);return O&&ir[O[1]]||j&&(O=(L=j).match(/[\.\\]([^\.\\])+$/),O&&ir[O[1]])?ir[O[1]]:"application/octet-stream"}function ta(R){for(var j=Vl(R),L=[],O=0;O<j.length;O+=76)L.push(j.slice(O,O+76));return L.join(`\r
`)+`\r
`}function bo(R){var j=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var pe=he.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],O=j.split(`\r
`),z=0;z<O.length;++z){var X=O[z];if(X.length==0){L.push("");continue}for(var fe=0;fe<X.length;){var Se=76,de=X.slice(fe,fe+Se);de.charAt(Se-1)=="="?Se--:de.charAt(Se-2)=="="?Se-=2:de.charAt(Se-3)=="="&&(Se-=3),de=X.slice(fe,fe+Se),fe+=Se,fe<X.length&&(de+="="),L.push(de)}}return L.join(`\r
`)}function yt(R){for(var j=[],L=0;L<R.length;++L){for(var O=R[L];L<=R.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+R[++L];j.push(O)}for(var z=0;z<j.length;++z)j[z]=j[z].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return br(j.join(`\r
`))}function Gn(R,j,L){for(var O="",z="",X="",fe,Se=0;Se<10;++Se){var de=j[Se];if(!de||de.match(/^\s*$/))break;var he=de.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":O=he[2].trim();break;case"content-type":X=he[2].trim();break;case"content-transfer-encoding":z=he[2].trim();break}}switch(++Se,z.toLowerCase()){case"base64":fe=br(kr(j.slice(Se).join("")));break;case"quoted-printable":fe=yt(j.slice(Se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var pe=Ts(R,O.slice(L.length),fe,{unsafe:!0});X&&(pe.ctype=X)}function na(R,j){if(re(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=j&&j.root||"",O=(xt&&Buffer.isBuffer(R)?R.toString("binary"):re(R)).split(`\r
`),z=0,X="";for(z=0;z<O.length;++z)if(X=O[z],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),L||(L=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),X.slice(0,L.length)!=L););var fe=(O[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var Se="--"+(fe[1]||""),de=[],he=[],pe={FileIndex:de,FullPaths:he};D(pe);var De,Ue=0;for(z=0;z<O.length;++z){var ze=O[z];ze!==Se&&ze!==Se+"--"||(Ue++&&Gn(pe,O.slice(De,z),L),De=z)}return pe}function Mf(R,j){var L=j||{},O=L.boundary||"SheetJS";O="------="+O;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],X=R.FullPaths[0],fe=X,Se=R.FileIndex[0],de=1;de<R.FullPaths.length;++de)if(fe=R.FullPaths[de].slice(X.length),Se=R.FileIndex[de],!(!Se.size||!Se.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(We){return"_x"+We.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(We){return"_u"+We.charCodeAt(0).toString(16)+"_"});for(var he=Se.content,pe=xt&&Buffer.isBuffer(he)?he.toString("binary"):re(he),De=0,Ue=Math.min(1024,pe.length),ze=0,Ie=0;Ie<=Ue;++Ie)(ze=pe.charCodeAt(Ie))>=32&&ze<128&&++De;var Ve=De>=Ue*4/5;z.push(O),z.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+fe),z.push("Content-Transfer-Encoding: "+(Ve?"quoted-printable":"base64")),z.push("Content-Type: "+ea(Se,fe)),z.push(""),z.push(Ve?bo(pe):ta(pe))}return z.push(O+`--\r
`),z.join(`\r
`)}function fc(R){var j={};return D(j,R),j}function Ts(R,j,L,O){var z=O&&O.unsafe;z||D(R);var X=!z&&et.find(R,j);if(!X){var fe=R.FullPaths[0];j.slice(0,fe.length)==fe?fe=j:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+j).replace("//","/")),X={name:a(j),type:2},R.FileIndex.push(X),R.FullPaths.push(fe),z||et.utils.cfb_gc(R)}return X.content=L,X.size=L?L.length:0,O&&(O.CLSID&&(X.clsid=O.CLSID),O.mt&&(X.mt=O.mt),O.ct&&(X.ct=O.ct)),X}function dc(R,j){D(R);var L=et.find(R,j);if(L){for(var O=0;O<R.FileIndex.length;++O)if(R.FileIndex[O]==L)return R.FileIndex.splice(O,1),R.FullPaths.splice(O,1),!0}return!1}function No(R,j,L){D(R);var O=et.find(R,j);if(O){for(var z=0;z<R.FileIndex.length;++z)if(R.FileIndex[z]==O)return R.FileIndex[z].name=a(L),R.FullPaths[z]=L,!0}return!1}function ko(R){B(R,!0)}return t.find=ie,t.read=Y,t.parse=m,t.write=Fe,t.writeFile=Ce,t.utils={cfb_new:fc,cfb_add:Ts,cfb_del:dc,cfb_mov:No,cfb_gc:ko,ReadShift:Dl,CheckField:E_,prep_blob:Un,bconcat:Rn,use_zlib:N,_deflateRaw:Le,_inflateRaw:bn,consts:ee},t})();function w4(e){return typeof e=="string"?gf(e):Array.isArray(e)?KC(e):e}function nc(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=gf(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r=n=="utf8"?Sa(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var a=new Blob([w4(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=Li(t)),u.write(t),u.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function A4(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function cn(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function $1(e,t){for(var n=[],r=cn(e),a=0;a!==r.length;++a)n[e[r[a]][t]]==null&&(n[e[r[a]][t]]=r[a]);return n}function yf(e){for(var t=[],n=cn(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function _f(e){for(var t=[],n=cn(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}function C4(e){for(var t=[],n=cn(e),r=0;r!==n.length;++r)t[e[n[r]]]==null&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}var ef=new Date(1899,11,30,0,0,0);function An(e,t){var n=e.getTime(),r=ef.getTime()+(e.getTimezoneOffset()-ef.getTimezoneOffset())*6e4;return(n-r)/(1440*60*1e3)}var e_=new Date,b4=ef.getTime()+(e_.getTimezoneOffset()-ef.getTimezoneOffset())*6e4,Q1=e_.getTimezoneOffset();function Ef(e){var t=new Date;return t.setTime(e*24*60*60*1e3+b4),t.getTimezoneOffset()!==Q1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Q1)*6e4),t}function N4(e){var t=0,n=0,r=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(n=1,o>3&&(r=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=n*parseInt(a[o],10)}return t}var Z1=new Date("2017-02-19T19:06:09.000Z"),t_=isNaN(Z1.getFullYear())?new Date("2/19/17"):Z1,k4=t_.getFullYear()==2017;function $t(e,t){var n=new Date(e);if(k4)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(t_.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function us(e,t){if(xt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Sa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Sa(V2(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Sa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Sa(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return n[o]||o})}catch{}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Qt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Qt(e[n]));return t}function on(e,t){for(var n="";n.length<t;)n+=e;return n}function ca(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return n=-n,o}),!isNaN(t=Number(r)))?t/n:t}var R4=["january","february","march","april","may","june","july","august","september","october","november","december"];function go(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),o=t.getDate();if(isNaN(o))return n;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&R4.indexOf(l)==-1)return n}else if(l.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||o>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}var D4=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(n,r,a){if(e||typeof r=="string")return n.split(r);for(var o=n.split(r),l=[o[0]],u=1;u<o.length;++u)l.push(a),l.push(o[u]);return l}})();function n_(e){return e?e.content&&e.type?us(e.content,!0):e.data?Sl(e.data):e.asNodeBuffer&&xt?Sl(e.asNodeBuffer().toString("binary")):e.asBinary?Sl(e.asBinary()):e._data&&e._data.getContent?Sl(us(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function r_(e){if(!e)return null;if(e.data)return G1(e.data);if(e.asNodeBuffer&&xt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?G1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function M4(e){return e&&e.name.slice(-4)===".bin"?r_(e):n_(e)}function jr(e,t){for(var n=e.FullPaths||cn(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),o=0;o<n.length;++o){var l=n[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return e.files?e.files[n[o]]:e.FileIndex[o]}return null}function Wh(e,t){var n=jr(e,t);if(n==null)throw new Error("Cannot find file "+t+" in zip");return n}function _n(e,t,n){if(!n)return M4(Wh(e,t));if(!t)return null;try{return _n(e,t)}catch{return null}}function Nr(e,t,n){if(!n)return n_(Wh(e,t));if(!t)return null;try{return Nr(e,t)}catch{return null}}function I4(e,t,n){return r_(Wh(e,t))}function ev(e){for(var t=e.FullPaths||cn(e.files),n=[],r=0;r<t.length;++r)t[r].slice(-1)!="/"&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function mt(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return xt?r=$a(n):r=$C(n),et.utils.cfb_add(e,t,r)}et.utils.cfb_add(e,t,n)}else e.file(t,n)}function Kh(){return et.utils.cfb_new()}function a_(e,t){switch(t.type){case"base64":return et.read(e,{type:"base64"});case"binary":return et.read(e,{type:"binary"});case"buffer":case"array":return et.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Al(e,t){if(e.charAt(0)=="/")return e.slice(1);var n=t.split("/");t.slice(-1)!="/"&&n.pop();for(var r=e.split("/");r.length!==0;){var a=r.shift();a===".."?n.pop():a!=="."&&n.push(a)}return n.join("/")}var mn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,F4=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,L4=/<[^>]*>/g,$n=mn.match(tv)?tv:L4,O4=/<\w*:/,P4=/<(\/?)\w+:/;function ot(e,t,n){for(var r={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(t||(r[0]=e.slice(0,a)),a===e.length)return r;var l=e.match(F4),u=0,d="",f=0,m="",v="",y=1;if(l)for(f=0;f!=l.length;++f){for(v=l[f],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(m=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(y=(a=v.charCodeAt(o+1))==34||a==39?1:0,d=v.slice(o+1+y,v.length-y),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),r[m]=d,r[m.toLowerCase()]=d;else{var T=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(r[T]&&m.slice(u-3,u)=="ext")continue;r[T]=d,r[T.toLowerCase()]=d}}return r}function wa(e){return e.replace(P4,"<$1")}var i_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$h=yf(i_),Ct=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function n(r){var a=r+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(u,d){return i_[u]||String.fromCharCode(parseInt(d,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,d){return String.fromCharCode(parseInt(d,16))});var l=a.indexOf("]]>");return n(a.slice(0,o))+a.slice(o+9,l)+n(a.slice(l+3))}})(),Qh=/[&<>'"]/g,U4=/[\u0000-\u0008\u000b-\u001f]/g;function Ht(e){var t=e+"";return t.replace(Qh,function(n){return $h[n]}).replace(U4,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function nv(e){return Ht(e).replace(/ /g,"_x0020_")}var s_=/[\u0000-\u001f]/g;function Zh(e){var t=e+"";return t.replace(Qh,function(n){return $h[n]}).replace(/\n/g,"<br/>").replace(s_,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function B4(e){var t=e+"";return t.replace(Qh,function(n){return $h[n]}).replace(s_,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}var rv=(function(){var e=/&#(\d+);/g;function t(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,t)}})();function H4(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Kt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Jd(e){for(var t="",n=0,r=0,a=0,o=0,l=0,u=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(a=e.charCodeAt(n++),r>191&&r<224){l=(r&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(o=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}l=e.charCodeAt(n++),u=((r&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function av(e){var t=Di(2*e.length),n,r,a=1,o=0,l=0,u;for(r=0;r<e.length;r+=a)a=1,(u=e.charCodeAt(r))<128?n=u:u<224?(n=(u&31)*64+(e.charCodeAt(r+1)&63),a=2):u<240?(n=(u&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),a=3):(a=4,n=(u&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,l=55296+(n>>>10&1023),n=56320+(n&1023)),l!==0&&(t[o++]=l&255,t[o++]=l>>>8,l=0),t[o++]=n%256,t[o++]=n>>>8;return t.slice(0,o).toString("ucs2")}function iv(e){return $a(e,"binary").toString("utf8")}var Au="foo bar baz",qt=xt&&(iv(Au)==Jd(Au)&&iv||av(Au)==Jd(Au)&&av)||Jd,Sa=xt?function(e){return $a(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},ql=(function(){var e={};return function(n,r){var a=n+"|"+(r||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}})(),o_=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)r=r.replace(e[a][0],e[a][1]);return r}})(),G4=(function(){var e={};return function(n){return e[n]!==void 0?e[n]:e[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}})(),V4=/<\/?(?:vt:)?variant>/g,z4=/<(?:vt:)([^>]*)>([\s\S]*)</;function sv(e,t){var n=ot(e),r=e.match(G4(n.baseType))||[],a=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(o){var l=o.replace(V4,"").match(z4);l&&a.push({v:qt(l[2]),t:l[1]})}),a}var l_=/(^\s|\s$|\n)/;function Bn(e,t){return"<"+e+(t.match(l_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function jl(e){return cn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Be(e,t,n){return"<"+e+(n!=null?jl(n):"")+(t!=null?(t.match(l_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function dh(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function q4(e,t){switch(typeof e){case"string":var n=Be("vt:lpwstr",Ht(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return Be((e|0)==e?"vt:i4":"vt:r8",Ht(String(e)));case"boolean":return Be("vt:bool",e?"true":"false")}if(e instanceof Date)return Be("vt:filetime",dh(e));throw new Error("Unable to serialize "+e)}function em(e){if(xt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return qt(Li(Yh(e)));throw new Error("Bad input format: expected Buffer or string")}var Yl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,wn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ps=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ar={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function j4(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,o=5;o>=0;--o)a=a*256+e[t+o];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function Y4(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,o=0,l=r?-t:t;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(t)?26985:0);for(var u=0;u<=5;++u,o/=256)e[n+u]=o&255;e[n+6]=(a&15)<<4|o&15,e[n+7]=a>>4|r}var ov=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,o=e[0][r].length;a<o;a+=n)t.push.apply(t,e[0][r].slice(a,a+n));return t},lv=xt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:$a(t)})):ov(e)}:ov,cv=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(ja(e,a)));return r.join("").replace(rr,"")},tm=xt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(rr,""):cv(e,t,n)}:cv,uv=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},c_=xt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):uv(e,t,n)}:uv,fv=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(io(e,a)));return r.join("")},rc=xt?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):fv(t,n,r)}:fv,u_=function(e,t){var n=Cr(e,t);return n>0?rc(e,t+4,t+4+n-1):""},f_=u_,d_=function(e,t){var n=Cr(e,t);return n>0?rc(e,t+4,t+4+n-1):""},h_=d_,m_=function(e,t){var n=2*Cr(e,t);return n>0?rc(e,t+4,t+4+n-1):""},p_=m_,x_=function(t,n){var r=Cr(t,n);return r>0?tm(t,n+4,n+4+r):""},g_=x_,v_=function(e,t){var n=Cr(e,t);return n>0?rc(e,t+4,t+4+n):""},y_=v_,__=function(e,t){return j4(e,t)},tf=__,nm=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};xt&&(f_=function(t,n){if(!Buffer.isBuffer(t))return u_(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},h_=function(t,n){if(!Buffer.isBuffer(t))return d_(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},p_=function(t,n){if(!Buffer.isBuffer(t))return m_(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},g_=function(t,n){if(!Buffer.isBuffer(t))return x_(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},y_=function(t,n){if(!Buffer.isBuffer(t))return v_(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},tf=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):__(t,n)},nm=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var io=function(e,t){return e[t]},ja=function(e,t){return e[t+1]*256+e[t]},X4=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},Cr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},rs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},J4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Dl(e,t){var n="",r,a,o=[],l,u,d,f;switch(t){case"dbcs":if(f=this.l,xt&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)n+=String.fromCharCode(ja(this,f)),f+=2;e*=2;break;case"utf8":n=rc(this,this.l,this.l+e);break;case"utf16le":e*=2,n=tm(this,this.l,this.l+e);break;case"wstr":return Dl.call(this,e,"dbcs");case"lpstr-ansi":n=f_(this,this.l),e=4+Cr(this,this.l);break;case"lpstr-cp":n=h_(this,this.l),e=4+Cr(this,this.l);break;case"lpwstr":n=p_(this,this.l),e=4+2*Cr(this,this.l);break;case"lpp4":e=4+Cr(this,this.l),n=g_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Cr(this,this.l),n=y_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(l=io(this,this.l+e++))!==0;)o.push(wu(l));n=o.join("");break;case"_wstr":for(e=0,n="";(l=ja(this,this.l+e))!==0;)o.push(wu(l)),e+=2;e+=2,n=o.join("");break;case"dbcs-cont":for(n="",f=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=io(this,f),this.l=f+1,u=Dl.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(wu(ja(this,f))),f+=2}n=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",f=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=io(this,f),this.l=f+1,u=Dl.call(this,e-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(wu(io(this,f))),f+=1}n=o.join("");break;default:switch(e){case 1:return r=io(this,this.l),this.l++,r;case 2:return r=(t==="i"?X4:ja)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(r=(e>0?rs:J4)(this,this.l),this.l+=4,r):(a=Cr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=tf(this,this.l):a=tf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:n=c_(this,this.l,e);break}}return this.l+=e,n}var W4=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},K4=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},$4=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function Q4(e,t,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=t.length;++a)$4(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;r=t.length}else if(n==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,W4(this,t,this.l);break;case 8:if(r=8,n==="f"){Y4(this,t,this.l);break}case 16:break;case-4:r=4,K4(this,t,this.l);break}return this.l+=r,this}function E_(e,t){var n=c_(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function Un(e,t){e.l=t,e.read_shift=Dl,e.chk=E_,e.write_shift=Q4}function Kn(e,t){e.l+=t}function _e(e){var t=Di(e);return Un(t,0),t}function Qa(e,t,n){if(e){var r,a,o;Un(e,e.l||0);for(var l=e.length,u=0,d=0;e.l<l;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var f=Ql[u]||Ql[65535];for(r=e.read_shift(1),o=r&127,a=1;a<4&&r&128;++a)o+=((r=e.read_shift(1))&127)<<7*a;d=e.l+o;var m=f.f&&f.f(e,o,n);if(e.l=d,t(m,f,u))return}}}function pr(){var e=[],t=xt?256:2048,n=function(f){var m=_e(f);return Un(m,0),m},r=n(t),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(f){return r&&f<r.length-r.l?r:(a(),r=n(Math.max(f+1,t)))},l=function(){return a(),Rn(e)},u=function(f){a(),r=f,r.l==null&&(r.l=r.length),o(t)};return{next:o,push:u,end:l,_bufs:e}}function ke(e,t,n,r){var a=+t,o;if(!isNaN(a)){r||(r=Ql[a].p||(n||[]).length||0),o=1+(a>=128?1:0)+1,r>=128&&++o,r>=16384&&++o,r>=2097152&&++o;var l=e.next(o);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(r>=128)l.write_shift(1,(r&127)+128),r>>=7;else{l.write_shift(1,r);break}r>0&&nm(n)&&e.push(n)}}function Ml(e,t,n){var r=Qt(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function dv(e,t,n){var r=Qt(e);return r.s=Ml(r.s,t.s,n),r.e=Ml(r.e,t.s,n),r}function Il(e,t){if(e.cRel&&e.c<0)for(e=Qt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Qt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=st(e);return!e.cRel&&e.cRel!=null&&(n=tb(n)),!e.rRel&&e.rRel!=null&&(n=Z4(n)),n}function Wd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+nn(e.s.c)+":"+(e.e.cRel?"":"$")+nn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+hn(e.s.r)+":"+(e.e.rRel?"":"$")+hn(e.e.r):Il(e.s,t.biff)+":"+Il(e.e,t.biff)}function rm(e){return parseInt(eb(e),10)-1}function hn(e){return""+(e+1)}function Z4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function eb(e){return e.replace(/\$(\d+)$/,"$1")}function am(e){for(var t=nb(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function nn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function tb(e){return e.replace(/^([A-Z])/,"$$$1")}function nb(e){return e.replace(/^\$([A-Z])/,"$1")}function rb(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function rn(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function st(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function xr(e){var t=e.indexOf(":");return t==-1?{s:rn(e),e:rn(e)}:{s:rn(e.slice(0,t)),e:rn(e.slice(t+1))}}function dt(e,t){return typeof t>"u"||typeof t=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=st(e)),typeof t!="string"&&(t=st(t)),e==t?e:e+":"+t)}function bt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,o=e.length;for(n=0;r<o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===o||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=o&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=o&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function hv(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Wr(e.z,n?An(t):t)}catch{}try{return e.w=Wr((e.XF||{}).numFmtId||(n?14:0),n?An(t):t)}catch{return""+t}}function Wa(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?Za[e.v]||e.v:t==null?hv(e,e.v):hv(e,t))}function Oi(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function T_(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense,o=e||(a?[]:{}),l=0,u=0;if(o&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?rn(r.origin):r.origin;l=d.r,u=d.c}o["!ref"]||(o["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var m=bt(o["!ref"]);f.s.c=m.s.c,f.s.r=m.s.r,f.e.c=Math.max(f.e.c,m.e.c),f.e.r=Math.max(f.e.r,m.e.r),l==-1&&(f.e.r=l=m.e.r+1)}for(var v=0;v!=t.length;++v)if(t[v]){if(!Array.isArray(t[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=t[v].length;++y)if(!(typeof t[v][y]>"u")){var T={v:t[v][y]},w=l+v,S=u+y;if(f.s.r>w&&(f.s.r=w),f.s.c>S&&(f.s.c=S),f.e.r<w&&(f.e.r=w),f.e.c<S&&(f.e.c=S),t[v][y]&&typeof t[v][y]=="object"&&!Array.isArray(t[v][y])&&!(t[v][y]instanceof Date))T=t[v][y];else if(Array.isArray(T.v)&&(T.f=t[v][y][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(r.nullError)T.t="e",T.v=0;else if(r.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=r.dateNF||nt[14],r.cellDates?(T.t="d",T.w=Wr(T.z,An(T.v))):(T.t="n",T.v=An(T.v),T.w=Wr(T.z,T.v))):T.t="s";if(a)o[w]||(o[w]=[]),o[w][S]&&o[w][S].z&&(T.z=o[w][S].z),o[w][S]=T;else{var A=st({c:S,r:w});o[A]&&o[A].z&&(T.z=o[A].z),o[A]=T}}}return f.s.c<1e7&&(o["!ref"]=dt(f)),o}function To(e,t){return T_(null,e,t)}function ab(e){return e.read_shift(4,"i")}function ua(e,t){return t||(t=_e(4)),t.write_shift(4,e),t}function Wn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Dn(e,t){var n=!1;return t==null&&(n=!0,t=_e(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function ib(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function sb(e,t){return t||(t=_e(4)),t.write_shift(2,0),t.write_shift(2,0),t}function im(e,t){var n=e.l,r=e.read_shift(1),a=Wn(e),o=[],l={t:a,h:a};if((r&1)!==0){for(var u=e.read_shift(4),d=0;d!=u;++d)o.push(ib(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=n+t,l}function ob(e,t){var n=!1;return t==null&&(n=!0,t=_e(15+4*e.t.length)),t.write_shift(1,0),Dn(e.t,t),n?t.slice(0,t.l):t}var lb=im;function cb(e,t){var n=!1;return t==null&&(n=!0,t=_e(23+4*e.t.length)),t.write_shift(1,1),Dn(e.t,t),t.write_shift(4,1),sb({},t),n?t.slice(0,t.l):t}function $r(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function xs(e,t){return t==null&&(t=_e(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function gs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function vs(e,t){return t==null&&(t=_e(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var ub=Wn,S_=Dn;function sm(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function nf(e,t){var n=!1;return t==null&&(n=!0,t=_e(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var fb=Wn,hh=sm,om=nf;function lm(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var a=r===0?tf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):rs(t,0)>>2;return n?a/100:a}function w_(e,t){t==null&&(t=_e(4));var n=0,r=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(r=1,n=1),r)t.write_shift(-4,((n?a:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function A_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function db(e,t){return t||(t=_e(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ys=A_,So=db;function Xn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function fs(e,t){return(t||_e(8)).write_shift(8,e,"f")}function hb(e){var t={},n=e.read_shift(1),r=n>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),u=e.read_shift(1),d=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=a;var f=is[a];f&&(t.rgb=Jl(f));break;case 2:t.rgb=Jl([l,u,d]);break;case 3:t.theme=a;break}return o!=0&&(t.tint=o>0?o/32767:o/32768),t}function rf(e,t){if(t||(t=_e(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function mb(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function pb(e,t){t||(t=_e(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}function C_(e,t){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function xb(e){return C_(e,1)}function gb(e){return C_(e,2)}var cm=2,hr=3,Cu=11,mv=12,af=19,bu=64,vb=65,yb=71,_b=4108,Eb=4126,kn=80,b_=81,Tb=[kn,b_],mh={1:{n:"CodePage",t:cm},2:{n:"Category",t:kn},3:{n:"PresentationFormat",t:kn},4:{n:"ByteCount",t:hr},5:{n:"LineCount",t:hr},6:{n:"ParagraphCount",t:hr},7:{n:"SlideCount",t:hr},8:{n:"NoteCount",t:hr},9:{n:"HiddenCount",t:hr},10:{n:"MultimediaClipCount",t:hr},11:{n:"ScaleCrop",t:Cu},12:{n:"HeadingPairs",t:_b},13:{n:"TitlesOfParts",t:Eb},14:{n:"Manager",t:kn},15:{n:"Company",t:kn},16:{n:"LinksUpToDate",t:Cu},17:{n:"CharacterCount",t:hr},19:{n:"SharedDoc",t:Cu},22:{n:"HyperlinksChanged",t:Cu},23:{n:"AppVersion",t:hr,p:"version"},24:{n:"DigSig",t:vb},26:{n:"ContentType",t:kn},27:{n:"ContentStatus",t:kn},28:{n:"Language",t:kn},29:{n:"Version",t:kn},255:{},2147483648:{n:"Locale",t:af},2147483651:{n:"Behavior",t:af},1919054434:{}},ph={1:{n:"CodePage",t:cm},2:{n:"Title",t:kn},3:{n:"Subject",t:kn},4:{n:"Author",t:kn},5:{n:"Keywords",t:kn},6:{n:"Comments",t:kn},7:{n:"Template",t:kn},8:{n:"LastAuthor",t:kn},9:{n:"RevNumber",t:kn},10:{n:"EditTime",t:bu},11:{n:"LastPrinted",t:bu},12:{n:"CreatedDate",t:bu},13:{n:"ModifiedDate",t:bu},14:{n:"PageCount",t:hr},15:{n:"WordCount",t:hr},16:{n:"CharCount",t:hr},17:{n:"Thumbnail",t:yb},18:{n:"Application",t:kn},19:{n:"DocSecurity",t:hr},255:{},2147483648:{n:"Locale",t:af},2147483651:{n:"Behavior",t:af},1919054434:{}},pv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Sb=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function wb(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Ab=wb([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),is=Qt(Ab),Za={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},N_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},xh={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function um(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Cb(e){var t=um();if(!e||!e.match)return t;var n={};if((e.match($n)||[]).forEach(function(r){var a=ot(r);switch(a[0].replace(O4,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[a.Extension]=a.ContentType;break;case"<Override":t[xh[a.ContentType]]!==void 0&&t[xh[a.ContentType]].push(a.PartName);break}}),t.xmlns!==wn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}function k_(e,t){var n=C4(xh),r=[],a;r[r.length]=mn,r[r.length]=Be("Types",null,{xmlns:wn.CT,"xmlns:xsd":wn.xsd,"xmlns:xsi":wn.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Be("Default",null,{Extension:d[0],ContentType:d[1]})}));var o=function(d){e[d]&&e[d].length>0&&(a=e[d][0],r[r.length]=Be("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Nu[d][t.bookType]||Nu[d].xlsx}))},l=function(d){(e[d]||[]).forEach(function(f){r[r.length]=Be("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Nu[d][t.bookType]||Nu[d].xlsx})})},u=function(d){(e[d]||[]).forEach(function(f){r[r.length]=Be("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:n[d][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var gt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Xl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Fl(e,t){var n={"!id":{}};if(!e)return n;t.charAt(0)!=="/"&&(t="/"+t);var r={};return(e.match($n)||[]).forEach(function(a){var o=ot(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:Al(o.Target,t);n[u]=l,r[o.Id]=l}}),n["!id"]=r,n}function fo(e){var t=[mn,Be("Relationships",null,{xmlns:wn.RELS})];return cn(e["!id"]).forEach(function(n){t[t.length]=Be("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Bt(e,t,n,r,a,o){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=r,a.Target=n,[gt.HLINK,gt.XPATH,gt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var bb="application/vnd.oasis.opendocument.spreadsheet";function Nb(e,t){for(var n=em(e),r,a;r=Yl.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(a=ot(r[0],!1),a.path=="/"&&a.type!==bb)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}function kb(e){var t=[mn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function xv(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Rb(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Db(e){var t=[mn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(xv(e[n][0],e[n][1])),t.push(Rb("",e[n][0]));return t.push(xv("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function R_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ku.version+"</meta:generator></office:meta></office:document-meta>"}var Xr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Mb=(function(){for(var e=new Array(Xr.length),t=0;t<Xr.length;++t){var n=Xr[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function D_(e){var t={};e=qt(e);for(var n=0;n<Xr.length;++n){var r=Xr[n],a=e.match(Mb[n]);a!=null&&a.length>0&&(t[r[1]]=Ct(a[1])),r[2]==="date"&&t[r[1]]&&(t[r[1]]=$t(t[r[1]]))}return t}function Kd(e,t,n,r,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Ht(t),r[r.length]=n?Be(e,t,n):Bn(e,t))}function M_(e,t){var n=t||{},r=[mn,Be("cp:coreProperties",null,{"xmlns:cp":wn.CORE_PROPS,"xmlns:dc":wn.dc,"xmlns:dcterms":wn.dcterms,"xmlns:dcmitype":wn.dcmitype,"xmlns:xsi":wn.xsi})],a={};if(!e&&!n.Props)return r.join("");e&&(e.CreatedDate!=null&&Kd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:dh(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),e.ModifiedDate!=null&&Kd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:dh(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var o=0;o!=Xr.length;++o){var l=Xr[o],u=n.Props&&n.Props[l[1]]!=null?n.Props[l[1]]:e?e[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Kd(l[0],u,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var ss=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],I_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function F_(e,t,n,r){var a=[];if(typeof e=="string")a=sv(e,r);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(m){return{v:m}}));var l=typeof t=="string"?sv(t,r).map(function(m){return m.v}):t,u=0,d=0;if(l.length>0)for(var f=0;f!==a.length;f+=2){switch(d=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=d,n.SheetNames=l.slice(u,u+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=d,n.DefinedNames=l.slice(u,u+d);break;case"Charts":case"Diagramme":n.Chartsheets=d,n.ChartNames=l.slice(u,u+d);break}u+=d}}function Ib(e,t,n){var r={};return t||(t={}),e=qt(e),ss.forEach(function(a){var o=(e.match(ql(a[0]))||[])[1];switch(a[2]){case"string":o&&(t[a[1]]=Ct(o));break;case"bool":t[a[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&F_(r.HeadingPairs,r.TitlesOfParts,t,n),t}function L_(e){var t=[],n=Be;return e||(e={}),e.Application="SheetJS",t[t.length]=mn,t[t.length]=Be("Properties",null,{xmlns:wn.EXT_PROPS,"xmlns:vt":wn.vt}),ss.forEach(function(r){if(e[r[1]]!==void 0){var a;switch(r[2]){case"string":a=Ht(String(e[r[1]]));break;case"bool":a=e[r[1]]?"true":"false";break}a!==void 0&&(t[t.length]=n(r[0],a))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+Ht(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Fb=/<[^>]+>[^<]*/g;function Lb(e,t){var n={},r="",a=e.match(Fb);if(a)for(var o=0;o!=a.length;++o){var l=a[o],u=ot(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Ct(u.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var d=l.split(">"),f=d[0].slice(4),m=d[1];switch(f){case"lpstr":case"bstr":case"lpwstr":n[r]=Ct(m);break;case"bool":n[r]=Kt(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(m,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(m);break;case"filetime":case"date":n[r]=$t(m);break;case"cy":case"error":n[r]=Ct(m);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,d)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return n}function O_(e){var t=[mn,Be("Properties",null,{xmlns:wn.CUST_PROPS,"xmlns:vt":wn.vt})];if(!e)return t.join("");var n=1;return cn(e).forEach(function(a){++n,t[t.length]=Be("property",q4(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Ht(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var gh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},$d;function Ob(e,t,n){$d||($d=yf(gh)),t=$d[t]||t,e[t]=n}function Pb(e,t){var n=[];return cn(gh).map(function(r){for(var a=0;a<Xr.length;++a)if(Xr[a][1]==r)return Xr[a];for(a=0;a<ss.length;++a)if(ss[a][1]==r)return ss[a];throw r}).forEach(function(r){if(e[r[1]]!=null){var a=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),n.push(Bn(gh[r[1]]||r[1],a))}}),Be("DocumentProperties",n.join(""),{xmlns:Ar.o})}function Ub(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return e&&cn(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var l=0;l<Xr.length;++l)if(o==Xr[l][1])return;for(l=0;l<ss.length;++l)if(o==ss[l][1])return;for(l=0;l<n.length;++l)if(o==n[l])return;var u=e[o],d="string";typeof u=="number"?(d="float",u=String(u)):u===!0||u===!1?(d="boolean",u=u?"1":"0"):u=String(u),a.push(Be(nv(o),u,{"dt:dt":d}))}}),t&&cn(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var l=t[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Be(nv(o),l,{"dt:dt":u}))}}),"<"+r+' xmlns="'+Ar.o+'">'+a.join("")+"</"+r+">"}function fm(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Bb(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,r=n%Math.pow(2,32),a=(n-r)/Math.pow(2,32);r*=1e7,a*=1e7;var o=r/Math.pow(2,32)|0;o>0&&(r=r%Math.pow(2,32),a+=o);var l=_e(8);return l.write_shift(4,r),l.write_shift(4,a),l}function P_(e,t,n){var r=e.l,a=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return a}function U_(e,t,n){var r=e.read_shift(0,"lpwstr");return r}function B_(e,t,n){return t===31?U_(e):P_(e,t,n)}function vh(e,t,n){return B_(e,t,n===!1?0:4)}function Hb(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return B_(e,t,0)}function Gb(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var a=e.l;n[r]=e.read_shift(0,"lpwstr").replace(rr,""),e.l-a&2&&(e.l+=2)}return n}function Vb(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(rr,"");return n}function zb(e){var t=e.l,n=sf(e,b_);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var r=sf(e,hr);return[n,r]}function qb(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(zb(e));return n}function gv(e,t){for(var n=e.read_shift(4),r={},a=0;a!=n;++a){var o=e.read_shift(4),l=e.read_shift(4);r[o]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(rr,"").replace(wl,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function H_(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),n}function jb(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function sf(e,t,n){var r=e.read_shift(2),a,o=n||{};if(e.l+=2,t!==mv&&r!==t&&Tb.indexOf(t)===-1&&!((t&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+t+" saw "+r);switch(t===mv?r:t){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return P_(e,r,4).replace(rr,"");case 31:return U_(e);case 64:return fm(e);case 65:return H_(e);case 71:return jb(e);case 80:return vh(e,r,!o.raw).replace(rr,"");case 81:return Hb(e,r).replace(rr,"");case 4108:return qb(e);case 4126:case 4127:return r==4127?Gb(e):Vb(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function vv(e,t){var n=_e(4),r=_e(4);switch(n.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,t);break;case 5:r=_e(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=Bb(t);break;case 31:case 80:for(r=_e(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Rn([n,r])}function yv(e,t){var n=e.l,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0,u=0,d=-1,f={};for(l=0;l!=a;++l){var m=e.read_shift(4),v=e.read_shift(4);o[l]=[m,v+n]}o.sort(function(I,b){return I[1]-b[1]});var y={};for(l=0;l!=a;++l){if(e.l!==o[l][1]){var T=!0;if(l>0&&t)switch(t[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,T=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],T=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],T=!1);break}if((!t||l==0)&&e.l<=o[l][1]&&(T=!1,e.l=o[l][1]),T)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(t){var w=t[o[l][0]];if(y[w.n]=sf(e,w.t,{raw:!0}),w.p==="version"&&(y[w.n]=String(y[w.n]>>16)+"."+("0000"+String(y[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(y[w.n]){case 0:y[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:oa(u=y[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[w.n])}}else if(o[l][0]===1){if(u=y.CodePage=sf(e,cm),oa(u),d!==-1){var S=e.l;e.l=o[d][1],f=gv(e,u),e.l=S}}else if(o[l][0]===0){if(u===0){d=l,e.l=o[l+1][1];continue}f=gv(e,u)}else{var A=f[o[l][0]],k;switch(e[e.l]){case 65:e.l+=4,k=H_(e);break;case 30:e.l+=4,k=vh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=vh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=dn(e,4);break;case 64:e.l+=4,k=$t(fm(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[A]=k}}return e.l=n+r,y}var G_=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Yb(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function _v(e,t,n){var r=_e(8),a=[],o=[],l=8,u=0,d=_e(8),f=_e(8);if(d.write_shift(4,2),d.write_shift(4,1200),f.write_shift(4,1),o.push(d),a.push(f),l+=8+d.length,!t){f=_e(8),f.write_shift(4,0),a.unshift(f);var m=[_e(4)];for(m[0].write_shift(4,e.length),u=0;u<e.length;++u){var v=e[u][0];for(d=_e(8+2*(v.length+1)+(v.length%2?0:2)),d.write_shift(4,u+2),d.write_shift(4,v.length+1),d.write_shift(0,v,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=Rn(m),o.unshift(d),l+=8+d.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(G_.indexOf(e[u][0])>-1||I_.indexOf(e[u][0])>-1)&&e[u][1]!=null){var y=e[u][1],T=0;if(t){T=+t[e[u][0]];var w=n[T];if(w.p=="version"&&typeof y=="string"){var S=y.split(".");y=(+S[0]<<16)+(+S[1]||0)}d=vv(w.t,y)}else{var A=Yb(y);A==-1&&(A=31,y=String(y)),d=vv(A,y)}o.push(d),f=_e(8),f.write_shift(4,t?T:2+u),a.push(f),l+=8+d.length}var k=8*(o.length+1);for(u=0;u<o.length;++u)a[u].write_shift(4,k),k+=o[u].length;return r.write_shift(4,l),r.write_shift(4,o.length),Rn([r].concat(a).concat(o))}function Ev(e,t,n){var r=e.content;if(!r)return{};Un(r,0);var a,o,l,u,d=0;r.chk("feff","Byte Order: "),r.read_shift(2);var f=r.read_shift(4),m=r.read_shift(16);if(m!==et.utils.consts.HEADER_CLSID&&m!==n)throw new Error("Bad PropertySet CLSID "+m);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=r.read_shift(16),u=r.read_shift(4),a===1&&u!==r.l)throw new Error("Length mismatch: "+u+" !== "+r.l);a===2&&(l=r.read_shift(16),d=r.read_shift(4));var v=yv(r,t),y={SystemIdentifier:f};for(var T in v)y[T]=v[T];if(y.FMTID=o,a===1)return y;if(d-r.l==2&&(r.l+=2),r.l!==d)throw new Error("Length mismatch 2: "+r.l+" !== "+d);var w;try{w=yv(r,null)}catch{}for(T in w)y[T]=w[T];return y.FMTID=[o,l],y}function Tv(e,t,n,r,a,o){var l=_e(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,et.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,a?68:48);var d=_v(e,n,r);if(u.push(d),a){var f=_v(a,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+d.length),u.push(f)}return Rn(u)}function bi(e,t){return e.read_shift(t),null}function Xb(e,t){t||(t=_e(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function Jb(e,t,n){for(var r=[],a=e.l+t;e.l<a;)r.push(n(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return r}function dn(e,t){return e.read_shift(t)===1}function nr(e,t){return t||(t=_e(2)),t.write_shift(2,+!!e),t}function En(e){return e.read_shift(2,"u")}function Yr(e,t){return t||(t=_e(2)),t.write_shift(2,e),t}function V_(e,t){return Jb(e,t,En)}function Wb(e){var t=e.read_shift(1),n=e.read_shift(1);return n===1?t:t===1}function z_(e,t,n){return n||(n=_e(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function ac(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var l=r?e.read_shift(r,a):"";return l}function Kb(e){var t=e.read_shift(2),n=e.read_shift(1),r=n&4,a=n&8,o=1+(n&1),l=0,u,d={};a&&(l=e.read_shift(2)),r&&(u=e.read_shift(4));var f=o==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,f);return a&&(e.l+=4*l),r&&(e.l+=u),d.t=m,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function $b(e){var t=e.t||"",n=_e(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=_e(2*t.length);r.write_shift(2*t.length,t,"utf16le");var a=[n,r];return Rn(a)}function ds(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function ic(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):ds(e,r,n)}function _s(e,t,n){if(n.biff>5)return ic(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function q_(e,t,n){return n||(n=_e(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Qb(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}function Zb(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=n);var a=e.read_shift((r?t-24:t)>>1,"utf16le").replace(rr,"");return r&&(e.l+=24),a}function eN(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return n+r.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(rr,"");return n+l}function tN(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return Zb(e);case"0303000000000000c000000000000046":return eN(e);default:throw new Error("Unsupported Moniker "+n)}}function ku(e){var t=e.read_shift(4),n=t>0?e.read_shift(t,"utf16le").replace(rr,""):"";return n}function Sv(e,t){t||(t=_e(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function nN(e,t){var n=e.l+t,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=e.read_shift(2);e.l+=2;var o,l,u,d,f="",m,v;a&16&&(o=ku(e,n-e.l)),a&128&&(l=ku(e,n-e.l)),(a&257)===257&&(u=ku(e,n-e.l)),(a&257)===1&&(d=tN(e,n-e.l)),a&8&&(f=ku(e,n-e.l)),a&32&&(m=e.read_shift(16)),a&64&&(v=fm(e)),e.l=n;var y=l||u||d||"";y&&f&&(y+="#"+f),y||(y="#"+f),a&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var T={Target:y};return m&&(T.guid=m),v&&(T.time=v),o&&(T.Tooltip=o),T}function rN(e){var t=_e(512),n=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var a=r.indexOf("#"),o=a>-1?31:23;switch(r.charAt(0)){case"#":o=28;break;case".":o&=-3;break}t.write_shift(4,2),t.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(n=0;n<l.length;++n)t.write_shift(4,l[n]);if(o==28)r=r.slice(1),Sv(r,t);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<l.length;++n)t.write_shift(1,parseInt(l[n],16));var u=a>-1?r.slice(0,a):r;for(t.write_shift(4,2*(u.length+1)),n=0;n<u.length;++n)t.write_shift(2,u.charCodeAt(n));t.write_shift(2,0),o&8&&Sv(a>-1?r.slice(a+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<l.length;++n)t.write_shift(1,parseInt(l[n],16));for(var d=0;r.slice(d*3,d*3+3)=="../"||r.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,r.length-3*d+1),n=0;n<r.length-3*d;++n)t.write_shift(1,r.charCodeAt(n+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function j_(e){var t=e.read_shift(1),n=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1);return[t,n,r,a]}function Y_(e,t){var n=j_(e);return n[3]=0,n}function Aa(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return{r:t,c:n,ixfe:r}}function hs(e,t,n,r){return r||(r=_e(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function aN(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}function iN(e,t,n){return t===0?"":_s(e,t,n)}function sN(e,t,n){var r=n.biff>8?4:2,a=e.read_shift(r),o=e.read_shift(r,"i"),l=e.read_shift(r,"i");return[a,o,l]}function X_(e){var t=e.read_shift(2),n=lm(e);return[t,n]}function oN(e,t,n){e.l+=4,t-=4;var r=e.l+t,a=ac(e,t,n),o=e.read_shift(2);if(r-=e.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,a}function Tf(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{s:{c:r,r:t},e:{c:a,r:n}}}function J_(e,t){return t||(t=_e(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function W_(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(1),a=e.read_shift(1);return{s:{c:r,r:t},e:{c:a,r:n}}}var lN=W_;function K_(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function cN(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function uN(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function zn(e){e.l+=2,e.l+=e.read_shift(2)}var fN={0:zn,4:zn,5:zn,6:zn,7:uN,8:zn,9:zn,10:zn,11:zn,12:zn,13:cN,14:zn,15:zn,16:zn,17:zn,18:zn,19:zn,20:zn,21:K_};function dN(e,t){for(var n=e.l+t,r=[];e.l<n;){var a=e.read_shift(2);e.l-=2;try{r.push(fN[a](e,n-e.l))}catch{return e.l=n,r}}return e.l!=n&&(e.l=n),r}function Ru(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),t-=2,t>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function dm(e,t,n){var r=1536,a=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=_e(a);return o.write_shift(2,r),o.write_shift(2,t),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function hN(e,t){return t===0||e.read_shift(2),1200}function mN(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,a=_s(e,0,n);return e.read_shift(t+r-e.l),a}function pN(e,t){var n=!t||t.biff==8,r=_e(n?112:54);for(r.write_shift(t.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function xN(e,t,n){var r=n&&n.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function gN(e,t,n){var r=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=ac(e,0,n);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:o,name:l}}function vN(e,t){var n=!t||t.biff>=8?2:1,r=_e(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function yN(e,t){for(var n=e.l+t,r=e.read_shift(4),a=e.read_shift(4),o=[],l=0;l!=a&&e.l<n;++l)o.push(Kb(e));return o.Count=r,o.Unique=a,o}function _N(e,t){var n=_e(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],a=0;a<e.length;++a)r[a]=$b(e[a]);var o=Rn([n].concat(r));return o.parts=[n.length].concat(r.map(function(l){return l.length})),o}function EN(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}function TN(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(t.level=r&7),r&32&&(t.hidden=!0),r&64&&(t.hpt=n/20),t}function SN(e){var t=aN(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var n=e.read_shift(4);return n!==0}function wN(e){return e.read_shift(2),e.read_shift(4)}function wv(e,t,n){var r=0;n&&n.biff==2||(r=e.read_shift(2));var a=e.read_shift(2);n&&n.biff==2&&(r=1-(a>>15),a&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,a]}function AN(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,n],Dim:[r,a],Flags:o,CurTab:l,FirstTab:u,Selected:d,TabRatio:f}}function CN(){var e=_e(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function bN(e,t,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function NN(e){var t=_e(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function kN(){}function RN(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=ac(e,0,n),r}function DN(e,t){var n=e.name||"Arial",r=t&&t.biff==5,a=r?15+n.length:16+2*n.length,o=_e(a);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,n.length),r||o.write_shift(1,1),o.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),o}function MN(e){var t=Aa(e);return t.isst=e.read_shift(4),t}function IN(e,t,n,r){var a=_e(10);return hs(e,t,r,a),a.write_shift(4,n),a}function FN(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=e.l+t,a=Aa(e);n.biff==2&&e.l++;var o=ic(e,r-e.l,n);return a.val=o,a}function LN(e,t,n,r,a){var o=!a||a.biff==8,l=_e(8+ +o+(1+o)*n.length);return hs(e,t,r,l),l.write_shift(2,n.length),o&&l.write_shift(1,1),l.write_shift((1+o)*n.length,n,o?"utf16le":"sbcs"),l}function ON(e,t,n){var r=e.read_shift(2),a=_s(e,0,n);return[r,a]}function PN(e,t,n,r){var a=n&&n.biff==5;r||(r=_e(a?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(a?1:2,t.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var o=r.length>r.l?r.slice(0,r.l):r;return o.l==null&&(o.l=o.length),o}var UN=_s;function Av(e,t,n){var r=e.l+t,a=n.biff==8||!n.biff?4:2,o=e.read_shift(a),l=e.read_shift(a),u=e.read_shift(2),d=e.read_shift(2);return e.l=r,{s:{r:o,c:u},e:{r:l,c:d}}}function BN(e,t){var n=t.biff==8||!t.biff?4:2,r=_e(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function HN(e){var t=e.read_shift(2),n=e.read_shift(2),r=X_(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}function GN(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<n;)o.push(X_(e));if(e.l!==n)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:o}}function VN(e,t){for(var n=e.l+t-2,r=e.read_shift(2),a=e.read_shift(2),o=[];e.l<n;)o.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:o}}function zN(e,t,n,r){var a={},o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2);return a.patternType=Sb[u>>26],r.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=d&127,a.icvBack=d>>7&127,a.fsxButton=d>>14&1),a}function qN(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,t-=6,r.data=zN(e,t,r.fStyle,n),r}function Cv(e,t,n,r){var a=n&&n.biff==5;r||(r=_e(a?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&a&&(o|=1024),r.write_shift(4,o),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function jN(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function YN(e){var t=_e(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function bv(e,t,n){var r=Aa(e);(n.biff==2||t==9)&&++e.l;var a=Wb(e);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function XN(e,t,n,r,a,o){var l=_e(8);return hs(e,t,r,l),z_(n,o,l),l}function JN(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=Aa(e),a=Xn(e);return r.val=a,r}function WN(e,t,n,r){var a=_e(14);return hs(e,t,r,a),fs(n,a),a}var Nv=iN;function KN(e,t,n){var r=e.l+t,a=e.read_shift(2),o=e.read_shift(2);if(n.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=ds(e,o),u=[];r>e.l;)u.push(ic(e));return[o,a,l,u]}function kv(e,t,n){var r=e.read_shift(2),a,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(a=oN(e,t-2,n)),o.body=a||e.read_shift(t-2),typeof a=="string"&&(o.Name=a),o}var $N=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Rv(e,t,n){var r=e.l+t,a=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(n&&n.biff==2?1:2),d=0;(!n||n.biff>=5)&&(n.biff!=5&&(e.l+=2),d=e.read_shift(2),n.biff==5&&(e.l+=2),e.l+=4);var f=ds(e,l,n);a&32&&(f=$N[f.charCodeAt(0)]);var m=r-e.l;n&&n.biff==2&&--m;var v=r==e.l||u===0||!(m>0)?[]:dM(e,m,n,u);return{chKey:o,Name:f,itab:d,rgce:v}}function $_(e,t,n){if(n.biff<8)return QN(e,t,n);for(var r=[],a=e.l+t,o=e.read_shift(n.biff>8?4:2);o--!==0;)r.push(sN(e,n.biff>8?12:6,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function QN(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=ac(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function ZN(e,t,n){if(n.biff<8){e.l+=t;return}var r=e.read_shift(2),a=e.read_shift(2),o=ds(e,r,n),l=ds(e,a,n);return[o,l]}function ek(e,t,n){var r=W_(e);e.l++;var a=e.read_shift(1);return t-=8,[hM(e,t,n),a,r]}function Dv(e,t,n){var r=lN(e);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,uM(e,t,n)]}function tk(e){var t=e.read_shift(4)!==0,n=e.read_shift(4)!==0,r=e.read_shift(4);return[t,n,r]}function nk(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=_s(e,0,n);return n.biff<8&&e.read_shift(1),[{r,c:a},u,l,o]}}function rk(e,t,n){return nk(e,t,n)}function ak(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(Tf(e));return n}function ik(e){var t=_e(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)J_(e[n],t);return t}function sk(e,t,n){if(n&&n.biff<8)return lk(e,t,n);var r=K_(e),a=dN(e,t-22,r[1]);return{cmo:r,ft:a}}var ok={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=n,{fmt:r}}};function lk(e,t,n){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((ok[r]||Kn)(e,t,n)),{cmo:[a,r,o],ft:l}}function ck(e,t,n){var r=e.l,a="";try{e.l+=4;var o=(n.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=Qb(e,6,n);var u=e.read_shift(2);e.read_shift(2),En(e,2);var d=e.read_shift(2);e.l+=d;for(var f=1;f<e.lens.length-1;++f){if(e.l-r!=e.lens[f])throw new Error("TxO: bad continue record");var m=e[e.l],v=ds(e,e.lens[f+1]-e.lens[f]-1);if(a+=v,a.length>=(m?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return e.l=r+t,{t:a}}catch{return e.l=r+t,{t:a}}}function uk(e,t){var n=Tf(e);e.l+=16;var r=nN(e,t-24);return[n,r]}function fk(e){var t=_e(24),n=rn(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(r[a],16));return Rn([t,rN(e[1])])}function dk(e,t){e.read_shift(2);var n=Tf(e),r=e.read_shift((t-10)/2,"dbcs-cont");return r=r.replace(rr,""),[n,r]}function hk(e){var t=e[1].Tooltip,n=_e(10+2*(t.length+1));n.write_shift(2,2048);var r=rn(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var a=0;a<t.length;++a)n.write_shift(2,t.charCodeAt(a));return n.write_shift(2,0),n}function mk(e){var t=[0,0],n;return n=e.read_shift(2),t[0]=pv[n]||n,n=e.read_shift(2),t[1]=pv[n]||n,t}function pk(e){return e||(e=_e(4)),e.write_shift(2,1),e.write_shift(2,1),e}function xk(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Y_(e));return n}function gk(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Y_(e));return n}function vk(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Q_(e,t,n){if(!n.cellStyles)return Kn(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(r),u=e.read_shift(r),d=e.read_shift(2);r==2&&(e.l+=2);var f={s:a,e:o,w:l,ixfe:u,flags:d};return(n.biff>=5||!n.biff)&&(f.level=d>>8&7),f}function yk(e,t){var n=_e(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function _k(e,t){var n={};return t<32||(e.l+=16,n.header=Xn(e),n.footer=Xn(e),e.l+=2),n}function Ek(e,t,n){var r={area:!1};if(n.biff!=5)return e.l+=t,r;var a=e.read_shift(1);return e.l+=3,a&16&&(r.area=!0),r}function Tk(e){for(var t=_e(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}var Sk=Aa,wk=V_,Ak=ic;function Ck(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,a}function bk(e,t,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=Aa(e);++e.l;var a=_s(e,t-7,n);return r.t="str",r.val=a,r}function Nk(e){var t=Aa(e);++e.l;var n=Xn(e);return t.t="n",t.val=n,t}function kk(e,t,n){var r=_e(15);return cc(r,e,t),r.write_shift(8,n,"f"),r}function Rk(e){var t=Aa(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}function Dk(e,t,n){var r=_e(9);return cc(r,e,t),r.write_shift(2,n),r}function Mk(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Ik(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Fk(e,t,n){var r=e.l+t,a=Aa(e),o=e.read_shift(2),l=ds(e,o,n);return e.l=r,a.t="str",a.val=l,a}var Lk=[2,3,48,49,131,139,140,245],yh=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=yf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(u,d){var f=[],m=Di(1);switch(d.type){case"base64":m=br(kr(u));break;case"binary":m=br(u);break;case"buffer":case"array":m=u;break}Un(m,0);var v=m.read_shift(1),y=!!(v&136),T=!1,w=!1;switch(v){case 2:break;case 3:break;case 48:T=!0,y=!0;break;case 49:T=!0,y=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var S=0,A=521;v==2&&(S=m.read_shift(2)),m.l+=3,v!=2&&(S=m.read_shift(4)),S>1048576&&(S=1e6),v!=2&&(A=m.read_shift(2));var k=m.read_shift(2),I=d.codepage||1252;v!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(I=e[m[m.l]]),m.l+=1,m.l+=2),w&&(m.l+=36);for(var b=[],P={},F=Math.min(m.length,v==2?521:A-10-(T?264:0)),Y=w?32:11;m.l<F&&m[m.l]!=13;)switch(P={},P.name=Gl.utils.decode(I,m.slice(m.l,m.l+Y)).replace(/[\u0000\r\n].*$/g,""),m.l+=Y,P.type=String.fromCharCode(m.read_shift(1)),v!=2&&!w&&(P.offset=m.read_shift(4)),P.len=m.read_shift(1),v==2&&(P.offset=m.read_shift(2)),P.dec=m.read_shift(1),P.name.length&&b.push(P),v!=2&&(m.l+=w?13:14),P.type){case"B":(!T||P.len!=8)&&d.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(m[m.l]!==13&&(m.l=A-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=A;var D=0,Q=0;for(f[0]=[],Q=0;Q!=b.length;++Q)f[0][Q]=b[Q].name;for(;S-- >0;){if(m[m.l]===42){m.l+=k;continue}for(++m.l,f[++D]=[],Q=0,Q=0;Q!=b.length;++Q){var B=m.slice(m.l,m.l+b[Q].len);m.l+=b[Q].len,Un(B,0);var ae=Gl.utils.decode(I,B);switch(b[Q].type){case"C":ae.trim().length&&(f[D][Q]=ae.replace(/\s+$/,""));break;case"D":ae.length===8?f[D][Q]=new Date(+ae.slice(0,4),+ae.slice(4,6)-1,+ae.slice(6,8)):f[D][Q]=ae;break;case"F":f[D][Q]=parseFloat(ae.trim());break;case"+":case"I":f[D][Q]=w?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(ae.trim().toUpperCase()){case"Y":case"T":f[D][Q]=!0;break;case"N":case"F":f[D][Q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ae+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));f[D][Q]="##MEMO##"+(w?parseInt(ae.trim(),10):B.read_shift(4));break;case"N":ae=ae.replace(/\u0000/g,"").trim(),ae&&ae!="."&&(f[D][Q]=+ae||0);break;case"@":f[D][Q]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":f[D][Q]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":f[D][Q]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[D][Q]=-B.read_shift(-8,"f");break;case"B":if(T&&b[Q].len==8){f[D][Q]=B.read_shift(8,"f");break}case"G":case"P":B.l+=b[Q].len;break;case"0":if(b[Q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[Q].type)}}}if(v!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=b,f}function r(u,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var m=To(n(u,f),f);return m["!cols"]=f.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete f.DBF,m}function a(u,d){try{return Oi(r(u,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,d){var f=d||{};if(+f.codepage>=0&&oa(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var m=pr(),v=cf(u,{header:1,raw:!0,cellDates:!0}),y=v[0],T=v.slice(1),w=u["!cols"]||[],S=0,A=0,k=0,I=1;for(S=0;S<y.length;++S){if(((w[S]||{}).DBF||{}).name){y[S]=w[S].DBF.name,++k;continue}if(y[S]!=null){if(++k,typeof y[S]=="number"&&(y[S]=y[S].toString(10)),typeof y[S]!="string")throw new Error("DBF Invalid column name "+y[S]+" |"+typeof y[S]+"|");if(y.indexOf(y[S])!==S){for(A=0;A<1024;++A)if(y.indexOf(y[S]+"_"+A)==-1){y[S]+="_"+A;break}}}}var b=bt(u["!ref"]),P=[],F=[],Y=[];for(S=0;S<=b.e.c-b.s.c;++S){var D="",Q="",B=0,ae=[];for(A=0;A<T.length;++A)T[A][S]!=null&&ae.push(T[A][S]);if(ae.length==0||y[S]==null){P[S]="?";continue}for(A=0;A<ae.length;++A){switch(typeof ae[A]){case"number":Q="B";break;case"string":Q="C";break;case"boolean":Q="L";break;case"object":Q=ae[A]instanceof Date?"D":"C";break;default:Q="C"}B=Math.max(B,String(ae[A]).length),D=D&&D!=Q?"C":Q}B>250&&(B=250),Q=((w[S]||{}).DBF||{}).type,Q=="C"&&w[S].DBF.len>B&&(B=w[S].DBF.len),D=="B"&&Q=="N"&&(D="N",Y[S]=w[S].DBF.dec,B=w[S].DBF.len),F[S]=D=="C"||Q=="N"?B:o[D]||0,I+=F[S],P[S]=D}var ie=m.next(32);for(ie.write_shift(4,318902576),ie.write_shift(4,T.length),ie.write_shift(2,296+32*k),ie.write_shift(2,I),S=0;S<4;++S)ie.write_shift(4,0);for(ie.write_shift(4,0|(+t[G2]||3)<<8),S=0,A=0;S<y.length;++S)if(y[S]!=null){var Z=m.next(32),le=(y[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Z.write_shift(1,le,"sbcs"),Z.write_shift(1,P[S]=="?"?"C":P[S],"sbcs"),Z.write_shift(4,A),Z.write_shift(1,F[S]||o[P[S]]||0),Z.write_shift(1,Y[S]||0),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(1,0),Z.write_shift(4,0),Z.write_shift(4,0),A+=F[S]||o[P[S]]||0}var Te=m.next(264);for(Te.write_shift(4,13),S=0;S<65;++S)Te.write_shift(4,0);for(S=0;S<T.length;++S){var ye=m.next(I);for(ye.write_shift(1,0),A=0;A<y.length;++A)if(y[A]!=null)switch(P[A]){case"L":ye.write_shift(1,T[S][A]==null?63:T[S][A]?84:70);break;case"B":ye.write_shift(8,T[S][A]||0,"f");break;case"N":var H="0";for(typeof T[S][A]=="number"&&(H=T[S][A].toFixed(Y[A]||0)),k=0;k<F[A]-H.length;++k)ye.write_shift(1,32);ye.write_shift(1,H,"sbcs");break;case"D":T[S][A]?(ye.write_shift(4,("0000"+T[S][A].getFullYear()).slice(-4),"sbcs"),ye.write_shift(2,("00"+(T[S][A].getMonth()+1)).slice(-2),"sbcs"),ye.write_shift(2,("00"+T[S][A].getDate()).slice(-2),"sbcs")):ye.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(T[S][A]!=null?T[S][A]:"").slice(0,F[A]);for(ye.write_shift(1,ee,"sbcs"),k=0;k<F[A]-ee.length;++k)ye.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}})(),Z_=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+cn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(y,T){var w=e[T];return typeof w=="number"?V1(w):w},r=function(y,T,w){var S=T.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return S==59?y:V1(S)};e["|"]=254;function a(y,T){switch(T.type){case"base64":return o(kr(y),T);case"binary":return o(y,T);case"buffer":return o(xt&&Buffer.isBuffer(y)?y.toString("binary"):Li(y),T);case"array":return o(us(y),T)}throw new Error("Unrecognized type "+T.type)}function o(y,T){var w=y.split(/[\n\r]+/),S=-1,A=-1,k=0,I=0,b=[],P=[],F=null,Y={},D=[],Q=[],B=[],ae=0,ie;for(+T.codepage>=0&&oa(+T.codepage);k!==w.length;++k){ae=0;var Z=w[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),le=Z.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),Te=le[0],ye;if(Z.length>0)switch(Te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":le[1].charAt(0)=="P"&&P.push(Z.slice(3).replace(/;;/g,";"));break;case"C":var H=!1,ee=!1,Ce=!1,re=!1,Fe=-1,W=-1;for(I=1;I<le.length;++I)switch(le[I].charAt(0)){case"A":break;case"X":A=parseInt(le[I].slice(1))-1,ee=!0;break;case"Y":for(S=parseInt(le[I].slice(1))-1,ee||(A=0),ie=b.length;ie<=S;++ie)b[ie]=[];break;case"K":ye=le[I].slice(1),ye.charAt(0)==='"'?ye=ye.slice(1,ye.length-1):ye==="TRUE"?ye=!0:ye==="FALSE"?ye=!1:isNaN(ca(ye))?isNaN(go(ye).getDate())||(ye=$t(ye)):(ye=ca(ye),F!==null&&_o(F)&&(ye=Ef(ye))),H=!0;break;case"E":re=!0;var N=ho(le[I].slice(1),{r:S,c:A});b[S][A]=[b[S][A],N];break;case"S":Ce=!0,b[S][A]=[b[S][A],"S5S"];break;case"G":break;case"R":Fe=parseInt(le[I].slice(1))-1;break;case"C":W=parseInt(le[I].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+Z)}if(H&&(b[S][A]&&b[S][A].length==2?b[S][A][0]=ye:b[S][A]=ye,F=null),Ce){if(re)throw new Error("SYLK shared formula cannot have own formula");var G=Fe>-1&&b[Fe][W];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");b[S][A][1]=gE(G[1],{r:S-Fe,c:A-W})}break;case"F":var U=0;for(I=1;I<le.length;++I)switch(le[I].charAt(0)){case"X":A=parseInt(le[I].slice(1))-1,++U;break;case"Y":for(S=parseInt(le[I].slice(1))-1,ie=b.length;ie<=S;++ie)b[ie]=[];break;case"M":ae=parseInt(le[I].slice(1))/20;break;case"F":break;case"G":break;case"P":F=P[parseInt(le[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=le[I].slice(1).split(" "),ie=parseInt(B[0],10);ie<=parseInt(B[1],10);++ie)ae=parseInt(B[2],10),Q[ie-1]=ae===0?{hidden:!0}:{wch:ae},Mi(Q[ie-1]);break;case"C":A=parseInt(le[I].slice(1))-1,Q[A]||(Q[A]={});break;case"R":S=parseInt(le[I].slice(1))-1,D[S]||(D[S]={}),ae>0?(D[S].hpt=ae,D[S].hpx=yo(ae)):ae===0&&(D[S].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+Z)}U<1&&(F=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+Z)}}return D.length>0&&(Y["!rows"]=D),Q.length>0&&(Y["!cols"]=Q),T&&T.sheetRows&&(b=b.slice(0,T.sheetRows)),[b,Y]}function l(y,T){var w=a(y,T),S=w[0],A=w[1],k=To(S,T);return cn(A).forEach(function(I){k[I]=A[I]}),k}function u(y,T){return Oi(l(y,T),T)}function d(y,T,w,S){var A="C;Y"+(w+1)+";X"+(S+1)+";K";switch(y.t){case"n":A+=y.v||0,y.f&&!y.F&&(A+=";E"+vm(y.f,{r:w,c:S}));break;case"b":A+=y.v?"TRUE":"FALSE";break;case"e":A+=y.w||y.v;break;case"d":A+='"'+(y.w||y.v)+'"';break;case"s":A+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function f(y,T){T.forEach(function(w,S){var A="F;W"+(S+1)+" "+(S+1)+" ";w.hidden?A+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Wl(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Kl(w.wpx)),typeof w.wch=="number"&&(A+=Math.round(w.wch))),A.charAt(A.length-1)!=" "&&y.push(A)})}function m(y,T){T.forEach(function(w,S){var A="F;";w.hidden?A+="M0;":w.hpt?A+="M"+20*w.hpt+";":w.hpx&&(A+="M"+20*$l(w.hpx)+";"),A.length>2&&y.push(A+"R"+(S+1))})}function v(y,T){var w=["ID;PWXL;N;E"],S=[],A=bt(y["!ref"]),k,I=Array.isArray(y),b=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),y["!cols"]&&f(w,y["!cols"]),y["!rows"]&&m(w,y["!rows"]),w.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var P=A.s.r;P<=A.e.r;++P)for(var F=A.s.c;F<=A.e.c;++F){var Y=st({r:P,c:F});k=I?(y[P]||[])[F]:y[Y],!(!k||k.v==null&&(!k.f||k.F))&&S.push(d(k,y,P,F))}return w.join(b)+b+S.join(b)+b+"E"+b}return{to_workbook:u,to_sheet:l,from_sheet:v}})(),eE=(function(){function e(o,l){switch(l.type){case"base64":return t(kr(o),l);case"binary":return t(o,l);case"buffer":return t(xt&&Buffer.isBuffer(o)?o.toString("binary"):Li(o),l);case"array":return t(us(o),l)}throw new Error("Unrecognized type "+l.type)}function t(o,l){for(var u=o.split(`
`),d=-1,f=-1,m=0,v=[];m!==u.length;++m){if(u[m].trim()==="BOT"){v[++d]=[],f=0;continue}if(!(d<0)){var y=u[m].trim().split(","),T=y[0],w=y[1];++m;for(var S=u[m]||"";(S.match(/["]/g)||[]).length&1&&m<u.length-1;)S+=`
`+u[++m];switch(S=S.trim(),+T){case-1:if(S==="BOT"){v[++d]=[],f=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?v[d][f]=!0:S==="FALSE"?v[d][f]=!1:isNaN(ca(w))?isNaN(go(w).getDate())?v[d][f]=w:v[d][f]=$t(w):v[d][f]=ca(w),++f;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),v[d][f++]=S!==""?S:null;break}if(S==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function n(o,l){return To(e(o,l),l)}function r(o,l){return Oi(n(o,l),l)}var a=(function(){var o=function(d,f,m,v,y){d.push(f),d.push(m+","+v),d.push('"'+y.replace(/"/g,'""')+'"')},l=function(d,f,m,v){d.push(f+","+m),d.push(f==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(d){var f=[],m=bt(d["!ref"]),v,y=Array.isArray(d);o(f,"TABLE",0,1,"sheetjs"),o(f,"VECTORS",0,m.e.r-m.s.r+1,""),o(f,"TUPLES",0,m.e.c-m.s.c+1,""),o(f,"DATA",0,0,"");for(var T=m.s.r;T<=m.e.r;++T){l(f,-1,0,"BOT");for(var w=m.s.c;w<=m.e.c;++w){var S=st({r:T,c:w});if(v=y?(d[T]||[])[w]:d[S],!v){l(f,1,0,"");continue}switch(v.t){case"n":var A=v.w;!A&&v.v!=null&&(A=v.v),A==null?v.f&&!v.F?l(f,1,0,"="+v.f):l(f,1,0,""):l(f,0,A,"V");break;case"b":l(f,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Wr(v.z||nt[14],An($t(v.v)))),l(f,0,v.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var k=`\r
`,I=f.join(k);return I}})();return{to_workbook:r,to_sheet:n,from_sheet:a}})(),tE=(function(){function e(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(v,y){for(var T=v.split(`
`),w=-1,S=-1,A=0,k=[];A!==T.length;++A){var I=T[A].trim().split(":");if(I[0]==="cell"){var b=rn(I[1]);if(k.length<=b.r)for(w=k.length;w<=b.r;++w)k[w]||(k[w]=[]);switch(w=b.r,S=b.c,I[2]){case"t":k[w][S]=e(I[3]);break;case"v":k[w][S]=+I[3];break;case"vtf":var P=I[I.length-1];case"vtc":switch(I[3]){case"nl":k[w][S]=!!+I[4];break;default:k[w][S]=+I[4];break}I[2]=="vtf"&&(k[w][S]=[k[w][S],P])}}}return y&&y.sheetRows&&(k=k.slice(0,y.sheetRows)),k}function r(v,y){return To(n(v,y),y)}function a(v,y){return Oi(r(v,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(v){if(!v||!v["!ref"])return"";for(var y=[],T=[],w,S="",A=xr(v["!ref"]),k=Array.isArray(v),I=A.s.r;I<=A.e.r;++I)for(var b=A.s.c;b<=A.e.c;++b)if(S=st({r:I,c:b}),w=k?(v[I]||[])[b]:v[S],!(!w||w.v==null||w.t==="z")){switch(T=["cell",S,"t"],w.t){case"s":case"str":T.push(t(w.v));break;case"n":w.f?(T[2]="vtf",T[3]="n",T[4]=w.v,T[5]=t(w.f)):(T[2]="v",T[3]=w.v);break;case"b":T[2]="vt"+(w.f?"f":"c"),T[3]="nl",T[4]=w.v?"1":"0",T[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var P=An($t(w.v));T[2]="vtc",T[3]="nd",T[4]=""+P,T[5]=w.w||Wr(w.z||nt[14],P);break;case"e":continue}y.push(T.join(":"))}return y.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function m(v){return[o,l,u,l,f(v),d].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:m}})(),vo=(function(){function e(m,v,y,T,w){w.raw?v[y][T]=m:m===""||(m==="TRUE"?v[y][T]=!0:m==="FALSE"?v[y][T]=!1:isNaN(ca(m))?isNaN(go(m).getDate())?v[y][T]=m:v[y][T]=$t(m):v[y][T]=ca(m))}function t(m,v){var y=v||{},T=[];if(!m||m.length===0)return T;for(var w=m.split(/[\r\n]/),S=w.length-1;S>=0&&w[S].length===0;)--S;for(var A=10,k=0,I=0;I<=S;++I)k=w[I].indexOf(" "),k==-1?k=w[I].length:k++,A=Math.max(A,k);for(I=0;I<=S;++I){T[I]=[];var b=0;for(e(w[I].slice(0,A).trim(),T,I,b,y),b=1;b<=(w[I].length-A)/10+1;++b)e(w[I].slice(A+(b-1)*10,A+b*10).trim(),T,I,b,y)}return y.sheetRows&&(T=T.slice(0,y.sheetRows)),T}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(m){for(var v={},y=!1,T=0,w=0;T<m.length;++T)(w=m.charCodeAt(T))==34?y=!y:!y&&w in n&&(v[w]=(v[w]||0)+1);w=[];for(T in v)Object.prototype.hasOwnProperty.call(v,T)&&w.push([v[T],T]);if(!w.length){v=r;for(T in v)Object.prototype.hasOwnProperty.call(v,T)&&w.push([v[T],T])}return w.sort(function(S,A){return S[0]-A[0]||r[S[1]]-r[A[1]]}),n[w.pop()[1]]||44}function o(m,v){var y=v||{},T="",w=y.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(T=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(T=m.charAt(4),m=m.slice(6)):T=a(m.slice(0,1024)):y&&y.FS?T=y.FS:T=a(m.slice(0,1024));var A=0,k=0,I=0,b=0,P=0,F=T.charCodeAt(0),Y=!1,D=0,Q=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var B=y.dateNF!=null?E4(y.dateNF):null;function ae(){var ie=m.slice(b,P),Z={};if(ie.charAt(0)=='"'&&ie.charAt(ie.length-1)=='"'&&(ie=ie.slice(1,-1).replace(/""/g,'"')),ie.length===0)Z.t="z";else if(y.raw)Z.t="s",Z.v=ie;else if(ie.trim().length===0)Z.t="s",Z.v=ie;else if(ie.charCodeAt(0)==61)ie.charCodeAt(1)==34&&ie.charCodeAt(ie.length-1)==34?(Z.t="s",Z.v=ie.slice(2,-1).replace(/""/g,'"')):KR(ie)?(Z.t="n",Z.f=ie.slice(1)):(Z.t="s",Z.v=ie);else if(ie=="TRUE")Z.t="b",Z.v=!0;else if(ie=="FALSE")Z.t="b",Z.v=!1;else if(!isNaN(I=ca(ie)))Z.t="n",y.cellText!==!1&&(Z.w=ie),Z.v=I;else if(!isNaN(go(ie).getDate())||B&&ie.match(B)){Z.z=y.dateNF||nt[14];var le=0;B&&ie.match(B)&&(ie=T4(ie,y.dateNF,ie.match(B)||[]),le=1),y.cellDates?(Z.t="d",Z.v=$t(ie,le)):(Z.t="n",Z.v=An($t(ie,le))),y.cellText!==!1&&(Z.w=Wr(Z.z,Z.v instanceof Date?An(Z.v):Z.v)),y.cellNF||delete Z.z}else Z.t="s",Z.v=ie;if(Z.t=="z"||(y.dense?(w[A]||(w[A]=[]),w[A][k]=Z):w[st({c:k,r:A})]=Z),b=P+1,Q=m.charCodeAt(b),S.e.c<k&&(S.e.c=k),S.e.r<A&&(S.e.r=A),D==F)++k;else if(k=0,++A,y.sheetRows&&y.sheetRows<=A)return!0}e:for(;P<m.length;++P)switch(D=m.charCodeAt(P)){case 34:Q===34&&(Y=!Y);break;case F:case 10:case 13:if(!Y&&ae())break e;break}return P-b>0&&ae(),w["!ref"]=dt(S),w}function l(m,v){return!(v&&v.PRN)||v.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?o(m,v):To(t(m,v),v)}function u(m,v){var y="",T=v.type=="string"?[0,0,0,0]:Cm(m,v);switch(v.type){case"base64":y=kr(m);break;case"binary":y=m;break;case"buffer":v.codepage==65001?y=m.toString("utf8"):v.codepage&&typeof Gl<"u"||(y=xt&&Buffer.isBuffer(m)?m.toString("binary"):Li(m));break;case"array":y=us(m);break;case"string":y=m;break;default:throw new Error("Unrecognized type "+v.type)}return T[0]==239&&T[1]==187&&T[2]==191?y=qt(y.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?y=qt(y):v.type=="binary"&&typeof Gl<"u",y.slice(0,19)=="socialcalc:version:"?tE.to_sheet(v.type=="string"?y:qt(y),v):l(y,v)}function d(m,v){return Oi(u(m,v),v)}function f(m){for(var v=[],y=bt(m["!ref"]),T,w=Array.isArray(m),S=y.s.r;S<=y.e.r;++S){for(var A=[],k=y.s.c;k<=y.e.c;++k){var I=st({r:S,c:k});if(T=w?(m[S]||[])[k]:m[I],!T||T.v==null){A.push("          ");continue}for(var b=(T.w||(Wa(T),T.w)||"").slice(0,10);b.length<10;)b+=" ";A.push(b+(k===0?" ":""))}v.push(A.join(""))}return v.join(`
`)}return{to_workbook:d,to_sheet:u,from_sheet:f}})();function Ok(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var a=Z_.to_workbook(e,n);return n.WTF=r,a}catch(o){if(n.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return vo.to_workbook(e,t)}}var os=(function(){function e(N,G,U){if(N){Un(N,N.l||0);for(var V=U.Enum||Fe;N.l<N.length;){var q=N.read_shift(2),se=V[q]||V[65535],ge=N.read_shift(2),ve=N.l+ge,we=se.f&&se.f(N,ge,U);if(N.l=ve,G(we,se,q))return}}}function t(N,G){switch(G.type){case"base64":return n(br(kr(N)),G);case"binary":return n(br(N),G);case"buffer":case"array":return n(N,G)}throw"Unsupported type "+G.type}function n(N,G){if(!N)return N;var U=G||{},V=U.dense?[]:{},q="Sheet1",se="",ge=0,ve={},we=[],Je=[],J={s:{r:0,c:0},e:{r:0,c:0}},wt=U.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)U.Enum=Fe,e(N,function(Ge,Ft,tn){switch(tn){case 0:U.vers=Ge,Ge>=4096&&(U.qpro=!0);break;case 6:J=Ge;break;case 204:Ge&&(se=Ge);break;case 222:se=Ge;break;case 15:case 51:U.qpro||(Ge[1].v=Ge[1].v.slice(1));case 13:case 14:case 16:tn==14&&(Ge[2]&112)==112&&(Ge[2]&15)>1&&(Ge[2]&15)<15&&(Ge[1].z=U.dateNF||nt[14],U.cellDates&&(Ge[1].t="d",Ge[1].v=Ef(Ge[1].v))),U.qpro&&Ge[3]>ge&&(V["!ref"]=dt(J),ve[q]=V,we.push(q),V=U.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},ge=Ge[3],q=se||"Sheet"+(ge+1),se="");var Tn=U.dense?(V[Ge[0].r]||[])[Ge[0].c]:V[st(Ge[0])];if(Tn){Tn.t=Ge[1].t,Tn.v=Ge[1].v,Ge[1].z!=null&&(Tn.z=Ge[1].z),Ge[1].f!=null&&(Tn.f=Ge[1].f);break}U.dense?(V[Ge[0].r]||(V[Ge[0].r]=[]),V[Ge[0].r][Ge[0].c]=Ge[1]):V[st(Ge[0])]=Ge[1];break}},U);else if(N[2]==26||N[2]==14)U.Enum=W,N[2]==14&&(U.qpro=!0,N.l=0),e(N,function(Ge,Ft,tn){switch(tn){case 204:q=Ge;break;case 22:Ge[1].v=Ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ge[3]>ge&&(V["!ref"]=dt(J),ve[q]=V,we.push(q),V=U.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},ge=Ge[3],q="Sheet"+(ge+1)),wt>0&&Ge[0].r>=wt)break;U.dense?(V[Ge[0].r]||(V[Ge[0].r]=[]),V[Ge[0].r][Ge[0].c]=Ge[1]):V[st(Ge[0])]=Ge[1],J.e.c<Ge[0].c&&(J.e.c=Ge[0].c),J.e.r<Ge[0].r&&(J.e.r=Ge[0].r);break;case 27:Ge[14e3]&&(Je[Ge[14e3][0]]=Ge[14e3][1]);break;case 1537:Je[Ge[0]]=Ge[1],Ge[0]==ge&&(q=Ge[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(V["!ref"]=dt(J),ve[se||q]=V,we.push(se||q),!Je.length)return{SheetNames:we,Sheets:ve};for(var rt={},vt=[],at=0;at<Je.length;++at)ve[we[at]]?(vt.push(Je[at]||we[at]),rt[Je[at]]=ve[Je[at]]||ve[we[at]]):(vt.push(Je[at]),rt[Je[at]]={"!ref":"A1"});return{SheetNames:vt,Sheets:rt}}function r(N,G){var U=G||{};if(+U.codepage>=0&&oa(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var V=pr(),q=bt(N["!ref"]),se=Array.isArray(N),ge=[];He(V,0,o(1030)),He(V,6,d(q));for(var ve=Math.min(q.e.r,8191),we=q.s.r;we<=ve;++we)for(var Je=hn(we),J=q.s.c;J<=q.e.c;++J){we===q.s.r&&(ge[J]=nn(J));var wt=ge[J]+Je,rt=se?(N[we]||[])[J]:N[wt];if(!(!rt||rt.t=="z"))if(rt.t=="n")(rt.v|0)==rt.v&&rt.v>=-32768&&rt.v<=32767?He(V,13,T(we,J,rt.v)):He(V,14,S(we,J,rt.v));else{var vt=Wa(rt);He(V,15,v(we,J,vt.slice(0,239)))}}return He(V,1),V.end()}function a(N,G){var U=G||{};if(+U.codepage>=0&&oa(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var V=pr();He(V,0,l(N));for(var q=0,se=0;q<N.SheetNames.length;++q)(N.Sheets[N.SheetNames[q]]||{})["!ref"]&&He(V,27,re(N.SheetNames[q],se++));var ge=0;for(q=0;q<N.SheetNames.length;++q){var ve=N.Sheets[N.SheetNames[q]];if(!(!ve||!ve["!ref"])){for(var we=bt(ve["!ref"]),Je=Array.isArray(ve),J=[],wt=Math.min(we.e.r,8191),rt=we.s.r;rt<=wt;++rt)for(var vt=hn(rt),at=we.s.c;at<=we.e.c;++at){rt===we.s.r&&(J[at]=nn(at));var Ge=J[at]+vt,Ft=Je?(ve[rt]||[])[at]:ve[Ge];if(!(!Ft||Ft.t=="z"))if(Ft.t=="n")He(V,23,ae(rt,at,ge,Ft.v));else{var tn=Wa(Ft);He(V,22,D(rt,at,ge,tn.slice(0,239)))}}++ge}}return He(V,1),V.end()}function o(N){var G=_e(2);return G.write_shift(2,N),G}function l(N){var G=_e(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var U=0,V=0,q=0,se=0;se<N.SheetNames.length;++se){var ge=N.SheetNames[se],ve=N.Sheets[ge];if(!(!ve||!ve["!ref"])){++q;var we=xr(ve["!ref"]);U<we.e.r&&(U=we.e.r),V<we.e.c&&(V=we.e.c)}}return U>8191&&(U=8191),G.write_shift(2,U),G.write_shift(1,q),G.write_shift(1,V),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function u(N,G,U){var V={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&U.qpro?(V.s.c=N.read_shift(1),N.l++,V.s.r=N.read_shift(2),V.e.c=N.read_shift(1),N.l++,V.e.r=N.read_shift(2),V):(V.s.c=N.read_shift(2),V.s.r=N.read_shift(2),G==12&&U.qpro&&(N.l+=2),V.e.c=N.read_shift(2),V.e.r=N.read_shift(2),G==12&&U.qpro&&(N.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function d(N){var G=_e(8);return G.write_shift(2,N.s.c),G.write_shift(2,N.s.r),G.write_shift(2,N.e.c),G.write_shift(2,N.e.r),G}function f(N,G,U){var V=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(V[0].c=N.read_shift(1),V[3]=N.read_shift(1),V[0].r=N.read_shift(2),N.l+=2):(V[2]=N.read_shift(1),V[0].c=N.read_shift(2),V[0].r=N.read_shift(2)),V}function m(N,G,U){var V=N.l+G,q=f(N,G,U);if(q[1].t="s",U.vers==20768){N.l++;var se=N.read_shift(1);return q[1].v=N.read_shift(se,"utf8"),q}return U.qpro&&N.l++,q[1].v=N.read_shift(V-N.l,"cstr"),q}function v(N,G,U){var V=_e(7+U.length);V.write_shift(1,255),V.write_shift(2,G),V.write_shift(2,N),V.write_shift(1,39);for(var q=0;q<V.length;++q){var se=U.charCodeAt(q);V.write_shift(1,se>=128?95:se)}return V.write_shift(1,0),V}function y(N,G,U){var V=f(N,G,U);return V[1].v=N.read_shift(2,"i"),V}function T(N,G,U){var V=_e(7);return V.write_shift(1,255),V.write_shift(2,G),V.write_shift(2,N),V.write_shift(2,U,"i"),V}function w(N,G,U){var V=f(N,G,U);return V[1].v=N.read_shift(8,"f"),V}function S(N,G,U){var V=_e(13);return V.write_shift(1,255),V.write_shift(2,G),V.write_shift(2,N),V.write_shift(8,U,"f"),V}function A(N,G,U){var V=N.l+G,q=f(N,G,U);if(q[1].v=N.read_shift(8,"f"),U.qpro)N.l=V;else{var se=N.read_shift(2);P(N.slice(N.l,N.l+se),q),N.l+=se}return q}function k(N,G,U){var V=G&32768;return G&=-32769,G=(V?N:0)+(G>=8192?G-16384:G),(V?"":"$")+(U?nn(G):hn(G))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(N,G){Un(N,0);for(var U=[],V=0,q="",se="",ge="",ve="";N.l<N.length;){var we=N[N.l++];switch(we){case 0:U.push(N.read_shift(8,"f"));break;case 1:se=k(G[0].c,N.read_shift(2),!0),q=k(G[0].r,N.read_shift(2),!1),U.push(se+q);break;case 2:{var Je=k(G[0].c,N.read_shift(2),!0),J=k(G[0].r,N.read_shift(2),!1);se=k(G[0].c,N.read_shift(2),!0),q=k(G[0].r,N.read_shift(2),!1),U.push(Je+J+":"+se+q)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(N.read_shift(2));break;case 6:{for(var wt="";we=N[N.l++];)wt+=String.fromCharCode(we);U.push('"'+wt.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:ve=U.pop(),ge=U.pop(),U.push(["AND","OR"][we-20]+"("+ge+","+ve+")");break;default:if(we<32&&b[we])ve=U.pop(),ge=U.pop(),U.push(ge+b[we]+ve);else if(I[we]){if(V=I[we][1],V==69&&(V=N[N.l++]),V>U.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+U.join("|")+"|");return}var rt=U.slice(-V);U.length-=V,U.push(I[we][0]+"("+rt.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}U.length==1?G[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function F(N){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=N.read_shift(2),G[3]=N[N.l++],G[0].c=N[N.l++],G}function Y(N,G){var U=F(N);return U[1].t="s",U[1].v=N.read_shift(G-4,"cstr"),U}function D(N,G,U,V){var q=_e(6+V.length);q.write_shift(2,N),q.write_shift(1,U),q.write_shift(1,G),q.write_shift(1,39);for(var se=0;se<V.length;++se){var ge=V.charCodeAt(se);q.write_shift(1,ge>=128?95:ge)}return q.write_shift(1,0),q}function Q(N,G){var U=F(N);U[1].v=N.read_shift(2);var V=U[1].v>>1;if(U[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return U[1].v=V,U}function B(N,G){var U=F(N),V=N.read_shift(4),q=N.read_shift(4),se=N.read_shift(2);if(se==65535)return V===0&&q===3221225472?(U[1].t="e",U[1].v=15):V===0&&q===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var ge=se&32768;return se=(se&32767)-16446,U[1].v=(1-ge*2)*(q*Math.pow(2,se+32)+V*Math.pow(2,se)),U}function ae(N,G,U,V){var q=_e(14);if(q.write_shift(2,N),q.write_shift(1,U),q.write_shift(1,G),V==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var se=0,ge=0,ve=0,we=0;return V<0&&(se=1,V=-V),ge=Math.log2(V)|0,V/=Math.pow(2,ge-31),we=V>>>0,(we&2147483648)==0&&(V/=2,++ge,we=V>>>0),V-=we,we|=2147483648,we>>>=0,V*=Math.pow(2,32),ve=V>>>0,q.write_shift(4,ve),q.write_shift(4,we),ge+=16383+(se?32768:0),q.write_shift(2,ge),q}function ie(N,G){var U=B(N);return N.l+=G-14,U}function Z(N,G){var U=F(N),V=N.read_shift(4);return U[1].v=V>>6,U}function le(N,G){var U=F(N),V=N.read_shift(8,"f");return U[1].v=V,U}function Te(N,G){var U=le(N);return N.l+=G-10,U}function ye(N,G){return N[N.l+G-1]==0?N.read_shift(G,"cstr"):""}function H(N,G){var U=N[N.l++];U>G-1&&(U=G-1);for(var V="";V.length<U;)V+=String.fromCharCode(N[N.l++]);return V}function ee(N,G,U){if(!(!U.qpro||G<21)){var V=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var q=N.read_shift(G-21,"cstr");return[V,q]}}function Ce(N,G){for(var U={},V=N.l+G;N.l<V;){var q=N.read_shift(2);if(q==14e3){for(U[q]=[0,""],U[q][0]=N.read_shift(2);N[N.l];)U[q][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return U}function re(N,G){var U=_e(5+N.length);U.write_shift(2,14e3),U.write_shift(2,G);for(var V=0;V<N.length;++V){var q=N.charCodeAt(V);U[U.l++]=q>127?95:q}return U[U.l++]=0,U}var Fe={0:{n:"BOF",f:En},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ye},222:{n:"SHEETNAMELP",f:H},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Y},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:Q},25:{n:"FORMULA19",f:ie},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ce},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Z},38:{n:"??"},39:{n:"NUMBER27",f:le},40:{n:"FORMULA28",f:Te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:t}})();function Pk(e){var t={},n=e.match($n),r=0,a=!1;if(n)for(;r!=n.length;++r){var o=ot(n[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;t.cp=zh[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return t}var Uk=(function(){var e=ql("t"),t=ql("rPr");function n(o){var l=o.match(e);if(!l)return{t:"s",v:""};var u={t:"s",v:Ct(l[1])},d=o.match(t);return d&&(u.s=Pk(d[1])),u}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(n).filter(function(u){return u.v})}})(),Bk=(function(){var t=/(\r\n|\n)/g;function n(a,o,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var d=a.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(o.push("<"+d+">"),l.push("</"+d+">")),l.push("</span>"),a}function r(a){var o=[[],a.v,[]];return a.v?(a.s&&n(a.s,o[0],o[2]),o[0].join("")+o[1].replace(t,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}})(),Hk=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Gk=/<(?:\w+:)?r>/,Vk=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function hm(e,t){var n=t?t.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Ct(qt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=qt(e),n&&(r.h=Zh(r.t))):e.match(Gk)&&(r.r=qt(e),r.t=Ct(qt((e.replace(Vk,"").match(Hk)||[]).join("").replace($n,""))),n&&(r.h=Bk(Uk(r.r)))),r):{t:""}}var zk=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,qk=/<(?:\w+:)?(?:si|sstItem)>/g,jk=/<\/(?:\w+:)?(?:si|sstItem)>/;function Yk(e,t){var n=[],r="";if(!e)return n;var a=e.match(zk);if(a){r=a[2].replace(qk,"").split(jk);for(var o=0;o!=r.length;++o){var l=hm(r[o].trim(),t);l!=null&&(n[n.length]=l)}a=ot(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}var Xk=/^\s|\s$|[\t\n\r]/;function nE(e,t){if(!t.bookSST)return"";var n=[mn];n[n.length]=Be("sst",null,{xmlns:ps[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var a=e[r],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(Xk)&&(o+=' xml:space="preserve"'),o+=">"+Ht(a.t)+"</t>"),o+="</si>",n[n.length]=o}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function Jk(e){return[e.read_shift(4),e.read_shift(4)]}function Wk(e,t){var n=[],r=!1;return Qa(e,function(o,l,u){switch(u){case 159:n.Count=o[0],n.Unique=o[1];break;case 19:n.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function Kk(e,t){return t||(t=_e(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var $k=ob;function Qk(e){var t=pr();ke(t,159,Kk(e));for(var n=0;n<e.length;++n)ke(t,19,$k(e[n]));return ke(t,160),t.end()}function rE(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function Ja(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function Zk(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ja(e,4),t.U=Ja(e,4),t.W=Ja(e,4),t}function e3(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function t3(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e3(e));return t}function n3(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function r3(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ja(e,4),t.U=Ja(e,4),t.W=Ja(e,4),t}function a3(e){var t=r3(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function aE(e,t){var n=e.l+t,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function iE(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function i3(e){var t=Ja(e);switch(t.Minor){case 2:return[t.Minor,s3(e)];case 3:return[t.Minor,o3()];case 4:return[t.Minor,l3(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function s3(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var n=e.read_shift(4),r=aE(e,n),a=iE(e,e.length-e.l);return{t:"Std",h:r,v:a}}function o3(){throw new Error("File is password-protected: ECMA-376 Extensible")}function l3(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace($n,function(o){var l=ot(o);switch(wa(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){r[u]=l[u]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function c3(e,t){var n={},r=n.EncryptionVersionInfo=Ja(e,4);if(t-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,n.EncryptionHeader=aE(e,a),t-=a,n.EncryptionVerifier=iE(e,t),n}function u3(e){var t={},n=t.EncryptionVersionInfo=Ja(e,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function mm(e){var t=0,n,r=rE(e),a=r.length+1,o,l,u,d,f;for(n=Di(a),n[0]=r.length,o=1;o!=a;++o)n[o]=r[o-1];for(o=a-1;o>=0;--o)l=n[o],u=(t&16384)===0?0:1,d=t<<1&32767,f=u|d,t=f^l;return t^52811}var sE=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,u){return r(l^u)},o=function(l){for(var u=t[l.length-1],d=104,f=l.length-1;f>=0;--f)for(var m=l[f],v=0;v!=7;++v)m&64&&(u^=n[d]),m*=2,--d;return u};return function(l){for(var u=rE(l),d=o(u),f=u.length,m=Di(16),v=0;v!=16;++v)m[v]=0;var y,T,w;for((f&1)===1&&(y=d>>8,m[f]=a(e[0],y),--f,y=d&255,T=u[u.length-1],m[f]=a(T,y));f>0;)--f,y=d>>8,m[f]=a(u[f],y),--f,y=d&255,m[f]=a(u[f],y);for(f=15,w=15-u.length;w>0;)y=d>>8,m[f]=a(e[w],y),--f,--w,y=d&255,m[f]=a(u[f],y),--f,--w;return m}})(),f3=function(e,t,n,r,a){a||(a=t),r||(r=sE(e));var o,l;for(o=0;o!=t.length;++o)l=t[o],l^=r[n],l=(l>>5|l<<3)&255,a[o]=l,++n;return[a,n,r]},d3=function(e){var t=0,n=sE(e);return function(r){var a=f3("",r,t,n);return t=a[1],a[0]}};function h3(e,t,n,r){var a={key:En(e),verificationBytes:En(e)};return n.password&&(a.verifier=mm(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=d3(n.password)),a}function m3(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=u3(e):r.Data=c3(e,t),r}function p3(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?m3(e,t-2,r):h3(e,n.biff>=8?t:t-2,n,r),r}var oE=(function(){function e(a,o){switch(o.type){case"base64":return t(kr(a),o);case"binary":return t(a,o);case"buffer":return t(xt&&Buffer.isBuffer(a)?a.toString("binary"):Li(a),o);case"array":return t(us(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){var l=o||{},u=l.dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,v){Array.isArray(u)&&(u[v]=[]);for(var y=/\\\w+\b/g,T=0,w,S=-1;w=y.exec(m);){switch(w[0]){case"\\cell":var A=m.slice(T,y.lastIndex-w[0].length);if(A[0]==" "&&(A=A.slice(1)),++S,A.length){var k={v:A,t:"s"};Array.isArray(u)?u[v][S]=k:u[st({r:v,c:S})]=k}break}T=y.lastIndex}S>f.e.c&&(f.e.c=S)}),u["!ref"]=dt(f),u}function n(a,o){return Oi(e(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],l=bt(a["!ref"]),u,d=Array.isArray(a),f=l.s.r;f<=l.e.r;++f){o.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)o.push("\\cellx"+(m+1));for(o.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var v=st({r:f,c:m});u=d?(a[f]||[])[m]:a[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(Wa(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}})();function x3(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Jl(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function g3(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.max(t,n,r),o=Math.min(t,n,r),l=a-o;if(l===0)return[0,0,t];var u=0,d=0,f=a+o;switch(d=l/(f>1?2-f:f),a){case t:u=((n-r)/l+6)%6;break;case n:u=(r-t)/l+2;break;case r:u=(t-n)/l+4;break}return[u/6,d,f/2]}function v3(e){var t=e[0],n=e[1],r=e[2],a=n*2*(r<.5?r:1-r),o=r-a/2,l=[o,o,o],u=6*t,d;if(n!==0)switch(u|0){case 0:case 6:d=a*u,l[0]+=a,l[1]+=d;break;case 1:d=a*(2-u),l[0]+=d,l[1]+=a;break;case 2:d=a*(u-2),l[1]+=a,l[2]+=d;break;case 3:d=a*(4-u),l[1]+=d,l[2]+=a;break;case 4:d=a*(u-4),l[2]+=a,l[0]+=d;break;case 5:d=a*(6-u),l[2]+=d,l[0]+=a;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function of(e,t){if(t===0)return e;var n=g3(x3(e));return t<0?n[2]=n[2]*(1+t):n[2]=1-(1-n[2])*(1-t),Jl(v3(n))}var lE=6,y3=15,_3=1,Yn=lE;function Wl(e){return Math.floor((e+Math.round(128/Yn)/256)*Yn)}function Kl(e){return Math.floor((e-5)/Yn*100+.5)/100}function lf(e){return Math.round((e*Yn+5)/Yn*256)/256}function Qd(e){return lf(Kl(Wl(e)))}function pm(e){var t=Math.abs(e-Qd(e)),n=Yn;if(t>.005)for(Yn=_3;Yn<y3;++Yn)Math.abs(e-Qd(e))<=t&&(t=Math.abs(e-Qd(e)),n=Yn);Yn=n}function Mi(e){e.width?(e.wpx=Wl(e.width),e.wch=Kl(e.wpx),e.MDW=Yn):e.wpx?(e.wch=Kl(e.wpx),e.width=lf(e.wch),e.MDW=Yn):typeof e.wch=="number"&&(e.width=lf(e.wch),e.wpx=Wl(e.width),e.MDW=Yn),e.customWidth&&delete e.customWidth}var E3=96,cE=E3;function $l(e){return e*96/cE}function yo(e){return e*cE/96}var T3={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function S3(e,t,n,r){t.Borders=[];var a={},o=!1;(e[0].match($n)||[]).forEach(function(l){var u=ot(l);switch(wa(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=Kt(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=Kt(u.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function w3(e,t,n,r){t.Fills=[];var a={},o=!1;(e[0].match($n)||[]).forEach(function(l){var u=ot(l);switch(wa(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function A3(e,t,n,r){t.Fonts=[];var a={},o=!1;(e[0].match($n)||[]).forEach(function(l){var u=ot(l);switch(wa(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=qt(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?Kt(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?Kt(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?Kt(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?Kt(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?Kt(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?Kt(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?Kt(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=zh[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=Kt(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var d=is[a.color.index];a.color.index==81&&(d=is[1]),d||(d=is[1]),a.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=of(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function C3(e,t,n){t.NumberFmt=[];for(var r=cn(nt),a=0;a<r.length;++a)t.NumberFmt[r[a]]=nt[r[a]];var o=e[0].match($n);if(o)for(a=0;a<o.length;++a){var l=ot(o[a]);switch(wa(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Ct(qt(l.formatCode)),d=parseInt(l.numFmtId,10);if(t.NumberFmt[d]=u,d>0){if(d>392){for(d=392;d>60&&t.NumberFmt[d]!=null;--d);t.NumberFmt[d]=u}Xa(u,d)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function b3(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)e[r]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:r,formatCode:Ht(e[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Du=["numFmtId","fillId","fontId","borderId","xfId"],Mu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function N3(e,t,n){t.CellXf=[];var r,a=!1;(e[0].match($n)||[]).forEach(function(o){var l=ot(o),u=0;switch(wa(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],u=0;u<Du.length;++u)r[Du[u]]&&(r[Du[u]]=parseInt(r[Du[u]],10));for(u=0;u<Mu.length;++u)r[Mu[u]]&&(r[Mu[u]]=Kt(r[Mu[u]]));if(t.NumberFmt&&r.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[u]){r.numFmtId=u;break}}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};l.vertical&&(d.vertical=l.vertical),l.horizontal&&(d.horizontal=l.horizontal),l.textRotation!=null&&(d.textRotation=l.textRotation),l.indent&&(d.indent=l.indent),l.wrapText&&(d.wrapText=Kt(l.wrapText)),r.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function k3(e){var t=[];return t[t.length]=Be("cellXfs",null),e.forEach(function(n){t[t.length]=Be("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var R3=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,d,f){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(t))&&C3(v,m,f),(v=u.match(a))&&A3(v,m,d,f),(v=u.match(r))&&w3(v,m,d,f),(v=u.match(o))&&S3(v,m,d,f),(v=u.match(n))&&N3(v,m,f),m}})();function uE(e,t){var n=[mn,Be("styleSheet",null,{xmlns:ps[0],"xmlns:vt":wn.vt})],r;return e.SSF&&(r=b3(e.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=k3(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function D3(e,t){var n=e.read_shift(2),r=Wn(e);return[n,r]}function M3(e,t,n){n||(n=_e(6+4*t.length)),n.write_shift(2,e),Dn(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function I3(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=mb(e);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(r.underline=l);var u=e.read_shift(1);u>0&&(r.family=u);var d=e.read_shift(1);switch(d>0&&(r.charset=d),e.l++,r.color=hb(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Wn(e),r}function F3(e,t){t||(t=_e(153)),t.write_shift(2,e.sz*20),pb(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),rf(e.color,t);var r=0;return r=2,t.write_shift(1,r),Dn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var L3=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Zd,O3=Kn;function Mv(e,t){t||(t=_e(84)),Zd||(Zd=yf(L3));var n=Zd[e.patternType];n==null&&(n=40),t.write_shift(4,n);var r=0;if(n!=40)for(rf({auto:1},t),rf({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function P3(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}function fE(e,t,n){n||(n=_e(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function _l(e,t){return t||(t=_e(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var U3=Kn;function B3(e,t){return t||(t=_e(51)),t.write_shift(1,0),_l(null,t),_l(null,t),_l(null,t),_l(null,t),_l(null,t),t.length>t.l?t.slice(0,t.l):t}function H3(e,t){return t||(t=_e(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),nf(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function G3(e,t,n){var r=_e(2052);return r.write_shift(4,e),nf(t,r),nf(n,r),r.length>r.l?r.slice(0,r.l):r}function V3(e,t,n){var r={};r.NumberFmt=[];for(var a in nt)r.NumberFmt[a]=nt[a];r.CellXf=[],r.Fonts=[];var o=[],l=!1;return Qa(e,function(d,f,m){switch(m){case 44:r.NumberFmt[d[0]]=d[1],Xa(d[1],d[0]);break;case 43:r.Fonts.push(d),d.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(d.color.rgb=of(t.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(m),l=!0;break;case 38:o.pop(),l=!1;break;default:if(f.T>0)o.push(m);else if(f.T<0)o.pop();else if(!l||n.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),r}function z3(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)t[a]!=null&&++n}),n!=0&&(ke(e,615,ua(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)t[a]!=null&&ke(e,44,M3(a,t[a]))}),ke(e,616))}}function q3(e){var t=1;ke(e,611,ua(t)),ke(e,43,F3({sz:12,color:{theme:1},name:"Calibri",family:2})),ke(e,612)}function j3(e){var t=2;ke(e,603,ua(t)),ke(e,45,Mv({patternType:"none"})),ke(e,45,Mv({patternType:"gray125"})),ke(e,604)}function Y3(e){var t=1;ke(e,613,ua(t)),ke(e,46,B3()),ke(e,614)}function X3(e){var t=1;ke(e,626,ua(t)),ke(e,47,fE({numFmtId:0},65535)),ke(e,627)}function J3(e,t){ke(e,617,ua(t.length)),t.forEach(function(n){ke(e,47,fE(n,0))}),ke(e,618)}function W3(e){var t=1;ke(e,619,ua(t)),ke(e,48,H3({xfId:0,name:"Normal"})),ke(e,620)}function K3(e){var t=0;ke(e,505,ua(t)),ke(e,506)}function $3(e){var t=0;ke(e,508,G3(t,"TableStyleMedium9","PivotStyleMedium4")),ke(e,509)}function Q3(e,t){var n=pr();return ke(n,278),z3(n,e.SSF),q3(n),j3(n),Y3(n),X3(n),J3(n,t.cellXfs),W3(n),K3(n),$3(n),ke(n,279),n.end()}var Z3=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function eR(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match($n)||[]).forEach(function(a){var o=ot(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(t.themeElements.clrScheme[Z3.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function tR(){}function nR(){}var rR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,aR=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,iR=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function sR(e,t,n){t.themeElements={};var r;[["clrScheme",rR,eR],["fontScheme",aR,tR],["fmtScheme",iR,nR]].forEach(function(a){if(!(r=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,t,n)})}var oR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function dE(e,t){(!e||e.length===0)&&(e=xm());var n,r={};if(!(n=e.match(oR)))throw new Error("themeElements not found in theme");return sR(n[0],r,t),r.raw=e,r}function xm(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[mn];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function lR(e,t,n){var r=e.l+t,a=e.read_shift(4);if(a!==124226){if(!n.cellStyles){e.l=r;return}var o=e.slice(e.l);e.l=r;var l;try{l=a_(o,{type:"array"})}catch{return}var u=Nr(l,"theme/theme/theme1.xml",!0);if(u)return dE(u,n)}}function cR(e){return e.read_shift(4)}function uR(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=fR(e,4);break;case 2:t.xclrValue=j_(e);break;case 3:t.xclrValue=cR(e);break;case 4:e.l+=4;break}return e.l+=8,t}function fR(e,t){return Kn(e,t)}function dR(e,t){return Kn(e,t)}function hR(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=uR(e);break;case 6:r[1]=dR(e,n);break;case 14:case 15:r[1]=e.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function mR(e,t){var n=e.l+t;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(hR(e,n-e.l));return{ixfe:r,ext:o}}function pR(e,t){t.forEach(function(n){n[0]})}function xR(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Wn(e)}}function gR(e){var t=_e(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Dn(e.name,t),t.slice(0,t.l)}function vR(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function yR(e){var t=_e(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function _R(e,t){var n=_e(8+2*t.length);return n.write_shift(4,e),Dn(t,n),n.slice(0,n.l)}function ER(e){return e.l+=4,e.read_shift(4)!=0}function TR(e,t){var n=_e(8);return n.write_shift(4,e),n.write_shift(4,1),n}function SR(e,t,n){var r={Types:[],Cell:[],Value:[]},a=n||{},o=[],l=!1,u=2;return Qa(e,function(d,f,m){switch(m){case 335:r.Types.push({name:d.name});break;case 51:d.forEach(function(v){u==1?r.Cell.push({type:r.Types[v[0]-1].name,index:v[1]}):u==0&&r.Value.push({type:r.Types[v[0]-1].name,index:v[1]})});break;case 337:u=d?1:0;break;case 338:u=2;break;case 35:o.push(m),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!f.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}function wR(){var e=pr();return ke(e,332),ke(e,334,ua(1)),ke(e,335,gR({name:"XLDAPR",version:12e4,flags:3496657072})),ke(e,336),ke(e,339,_R(1,"XLDAPR")),ke(e,52),ke(e,35,ua(514)),ke(e,4096,ua(0)),ke(e,4097,Yr(1)),ke(e,36),ke(e,53),ke(e,340),ke(e,337,TR(1)),ke(e,51,yR([[1,0]])),ke(e,338),ke(e,333),e.end()}function AR(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var a=!1,o=2,l;return e.replace($n,function(u){var d=ot(u);switch(wa(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<r.Types.length;++f)r.Types[f].name==d.name&&(l=r.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[d.t-1].name,index:+d.v}):o==0&&r.Value.push({type:r.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+d.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return u}),r}function hE(){var e=[mn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function CR(e){var t=[];if(!e)return t;var n=1;return(e.match($n)||[]).forEach(function(r){var a=ot(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?n=a.i:a.i=n,t.push(a);break}}),t}function bR(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=st(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function NR(e,t,n){var r=[];return Qa(e,function(o,l,u){switch(u){case 63:r.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function kR(e,t,n,r){if(!e)return e;var a=r||{},o=!1;Qa(e,function(u,d,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!d.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function RR(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}var oo=1024;function mE(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[Be("xml",null,{"xmlns:v":Ar.v,"xmlns:o":Ar.o,"xmlns:x":Ar.x,"xmlns:mv":Ar.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];oo<e*1e3;)oo+=1e3;return t.forEach(function(o){var l=rn(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var d=u.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Be("v:fill",d,u),m={on:"t",obscured:"t"};++oo,a=a.concat(["<v:shape"+jl({id:"_x0000_s"+oo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Be("v:shadow",null,m),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Bn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Bn("x:AutoFill","False"),Bn("x:Row",String(l.r)),Bn("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Iv(e,t,n,r){var a=Array.isArray(e),o;t.forEach(function(l){var u=rn(l.ref);if(a?(e[u.r]||(e[u.r]=[]),o=e[u.r][u.c]):o=e[l.ref],!o){o={t:"z"},a?e[u.r][u.c]=o:e[l.ref]=o;var d=bt(e["!ref"]||"BDWGO1000001:A1");d.s.r>u.r&&(d.s.r=u.r),d.e.r<u.r&&(d.e.r=u.r),d.s.c>u.c&&(d.s.c=u.c),d.e.c<u.c&&(d.e.c=u.c);var f=dt(d);f!==e["!ref"]&&(e["!ref"]=f)}o.c||(o.c=[]);var m={a:l.author,t:l.t,r:l.r,T:n};l.h&&(m.h=l.h);for(var v=o.c.length-1;v>=0;--v){if(!n&&o.c[v].T)return;n&&!o.c[v].T&&o.c.splice(v,1)}if(n&&r){for(v=0;v<r.length;++v)if(m.a==r[v].id){m.a=r[v].name||m.a;break}}o.c.push(m)})}function DR(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&n.push(u[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var d=ot(u[0]),f={author:d.authorId&&n[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},m=rn(d.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!v&&!!v[1]&&hm(v[1])||{r:"",t:"",h:""};f.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),f.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=y.h),r.push(f)}}}}),r}function pE(e){var t=[mn,Be("comments",null,{xmlns:ps[0]})],n=[];return t.push("<authors>"),e.forEach(function(r){r[1].forEach(function(a){var o=Ht(a.a);n.indexOf(o)==-1&&(n.push(o),t.push("<author>"+o+"</author>")),a.T&&a.ID&&n.indexOf("tc="+a.ID)==-1&&(n.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(r){var a=0,o=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?a=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(d){d.a&&(a=n.indexOf(Ht(d.a))),o.push(d.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+a+'"><text>'),o.length<=1)t.push(Bn("t",Ht(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)l+=`Reply:
    `+o[u]+`
`;t.push(Bn("t",Ht(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function MR(e,t){var n=[],r=!1,a={},o=0;return e.replace($n,function(u,d){var f=ot(u);switch(wa(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&n.push(a);break;case"<text>":case"<text":o=d+u.length;break;case"</text>":a.t=e.slice(o,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return u}),n}function IR(e,t,n){var r=[mn,Be("ThreadedComments",null,{xmlns:wn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var o="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var d={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};u==0?o=d.id:d.parentId=o,l.ID=d.id,l.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),r.push(Be("threadedComment",Bn("text",l.t||""),d))})}),r.push("</ThreadedComments>"),r.join("")}function FR(e,t){var n=[],r=!1;return e.replace($n,function(o){var l=ot(o);switch(wa(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),n}function LR(e){var t=[mn,Be("personList",null,{xmlns:wn.TCMNT,"xmlns:x":ps[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,r){t.push(Be("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function OR(e){var t={};t.iauthor=e.read_shift(4);var n=ys(e);return t.rfx=n.s,t.ref=st(n.s),e.l+=16,t}function PR(e,t){return t==null&&(t=_e(36)),t.write_shift(4,e[1].iauthor),So(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var UR=Wn;function BR(e){return Dn(e.slice(0,54))}function HR(e,t){var n=[],r=[],a={},o=!1;return Qa(e,function(u,d,f){switch(f){case 632:r.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!o||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function GR(e){var t=pr(),n=[];return ke(t,628),ke(t,630),e.forEach(function(r){r[1].forEach(function(a){n.indexOf(a.a)>-1||(n.push(a.a.slice(0,54)),ke(t,632,BR(a.a)))})}),ke(t,631),ke(t,633),e.forEach(function(r){r[1].forEach(function(a){a.iauthor=n.indexOf(a.a);var o={s:rn(r[0]),e:rn(r[0])};ke(t,635,PR([o,a])),a.t&&a.t.length>0&&ke(t,637,cb(a)),ke(t,636),delete a.iauthor})}),ke(t,634),ke(t,629),t.end()}var VR="application/vnd.ms-office.vbaProject";function zR(e){var t=et.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(t,a,e.FileIndex[r].content)}}),et.write(t)}function qR(e,t){t.FullPaths.forEach(function(n,r){if(r!=0){var a=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&et.utils.cfb_add(e,a,t.FileIndex[r].content)}})}var xE=["xlsb","xlsm","xlam","biff8","xla"];function jR(){return{"!type":"dialog"}}function YR(){return{"!type":"dialog"}}function XR(){return{"!type":"macro"}}function JR(){return{"!type":"macro"}}var ho=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,a,o,l){var u=!1,d=!1;o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var f=o.length>0?parseInt(o,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return u?m+=t.c:--m,d?f+=t.r:--f,a+(u?"":"$")+nn(m)+(d?"":"$")+hn(f)}return function(a,o){return t=o,a.replace(e,n)}})(),gm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vm=(function(){return function(t,n){return t.replace(gm,function(r,a,o,l,u,d){var f=am(l)-(o?0:n.c),m=rm(d)-(u?0:n.r),v=m==0?"":u?m+1:"["+m+"]",y=f==0?"":o?f+1:"["+f+"]";return a+"R"+v+"C"+y})}})();function gE(e,t){return e.replace(gm,function(n,r,a,o,l,u){return r+(a=="$"?a+o:nn(am(o)+t.c))+(l=="$"?l+u:hn(rm(u)+t.r))})}function WR(e,t,n){var r=xr(t),a=r.s,o=rn(n),l={r:o.r-a.r,c:o.c-a.c};return gE(e,l)}function KR(e){return e.length!=1}function Fv(e){return e.replace(/_xlfn\./g,"")}function yn(e){e.l+=1}function Ii(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function vE(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return yE(e);n.biff==12&&(r=4)}var a=e.read_shift(r),o=e.read_shift(r),l=Ii(e),u=Ii(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function yE(e){var t=Ii(e),n=Ii(e),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function $R(e,t,n){if(n.biff<8)return yE(e);var r=e.read_shift(n.biff==12?4:2),a=e.read_shift(n.biff==12?4:2),o=Ii(e),l=Ii(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function _E(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return QR(e);var r=e.read_shift(n&&n.biff==12?4:2),a=Ii(e);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function QR(e){var t=Ii(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function ZR(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function eD(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return tD(e);var a=e.read_shift(r>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:u}}function tD(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),a==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:a,rRel:r}}function nD(e,t,n){var r=(e[e.l++]&96)>>5,a=vE(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function rD(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(n)switch(n.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=vE(e,o,n);return[r,a,l]}function aD(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function iD(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(n)switch(n.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,a]}function sD(e,t,n){var r=(e[e.l++]&96)>>5,a=$R(e,t-1,n);return[r,a]}function oD(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Lv(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function lD(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(e.read_shift(n&&n.biff==2?1:2));return a}function cD(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function uD(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function fD(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function dD(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function EE(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function hD(e){return e.read_shift(2),EE(e)}function mD(e){return e.read_shift(2),EE(e)}function pD(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=_E(e,0,n);return[r,a]}function xD(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=eD(e,0,n);return[r,a]}function gD(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var o=_E(e,0,n);return[r,a,o]}function vD(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[EM[a],wE[a],r]}function yD(e,t,n){var r=e[e.l++],a=e.read_shift(1),o=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:_D(e);return[a,(o[0]===0?wE:_M)[o[1]]]}function _D(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function ED(e,t,n){e.l+=n&&n.biff==2?3:4}function TD(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function SD(e){return e.l++,Za[e.read_shift(1)]}function wD(e){return e.l++,e.read_shift(2)}function AD(e){return e.l++,e.read_shift(1)!==0}function CD(e){return e.l++,Xn(e)}function bD(e,t,n){return e.l++,ac(e,t-1,n)}function ND(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=dn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=Za[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Xn(e);break;case 2:n[1]=_s(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function kD(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((n.biff==12?ys:Tf)(e));return a}function RD(e,t,n){var r=0,a=0;n.biff==12?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var o=0,l=[];o!=r&&(l[o]=[]);++o)for(var u=0;u!=a;++u)l[o][u]=ND(e,n.biff);return l}function DD(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,o=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function MD(e,t,n){if(n.biff==5)return ID(e);var r=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[r,a,o]}function ID(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function FD(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function LD(e,t,n){var r=e.read_shift(1)>>>5&3,a=e.read_shift(n&&n.biff==2?1:2);return[r,a]}function OD(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function PD(e,t,n){var r=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(n)switch(n.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,a]}var UD=Kn,BD=Kn,HD=Kn;function sc(e,t,n){return e.l+=2,[ZR(e)]}function ym(e){return e.l+=6,[]}var GD=sc,VD=ym,zD=ym,qD=sc;function TE(e){return e.l+=2,[En(e),e.read_shift(2)&1]}var jD=sc,YD=TE,XD=ym,JD=sc,WD=sc,KD=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function $D(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),l=KD[n>>2&31];return{ixti:t,coltype:n&3,rt:l,idx:r,c:a,C:o}}function QD(e){return e.l+=2,[e.read_shift(4)]}function ZD(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function eM(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function tM(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function nM(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function rM(e){return e.l+=4,[0,0]}var Ov={1:{n:"PtgExp",f:TD},2:{n:"PtgTbl",f:HD},3:{n:"PtgAdd",f:yn},4:{n:"PtgSub",f:yn},5:{n:"PtgMul",f:yn},6:{n:"PtgDiv",f:yn},7:{n:"PtgPower",f:yn},8:{n:"PtgConcat",f:yn},9:{n:"PtgLt",f:yn},10:{n:"PtgLe",f:yn},11:{n:"PtgEq",f:yn},12:{n:"PtgGe",f:yn},13:{n:"PtgGt",f:yn},14:{n:"PtgNe",f:yn},15:{n:"PtgIsect",f:yn},16:{n:"PtgUnion",f:yn},17:{n:"PtgRange",f:yn},18:{n:"PtgUplus",f:yn},19:{n:"PtgUminus",f:yn},20:{n:"PtgPercent",f:yn},21:{n:"PtgParen",f:yn},22:{n:"PtgMissArg",f:yn},23:{n:"PtgStr",f:bD},26:{n:"PtgSheet",f:ZD},27:{n:"PtgEndSheet",f:eM},28:{n:"PtgErr",f:SD},29:{n:"PtgBool",f:AD},30:{n:"PtgInt",f:wD},31:{n:"PtgNum",f:CD},32:{n:"PtgArray",f:oD},33:{n:"PtgFunc",f:vD},34:{n:"PtgFuncVar",f:yD},35:{n:"PtgName",f:DD},36:{n:"PtgRef",f:pD},37:{n:"PtgArea",f:nD},38:{n:"PtgMemArea",f:FD},39:{n:"PtgMemErr",f:UD},40:{n:"PtgMemNoMem",f:BD},41:{n:"PtgMemFunc",f:LD},42:{n:"PtgRefErr",f:OD},43:{n:"PtgAreaErr",f:aD},44:{n:"PtgRefN",f:xD},45:{n:"PtgAreaN",f:sD},46:{n:"PtgMemAreaN",f:tM},47:{n:"PtgMemNoMemN",f:nM},57:{n:"PtgNameX",f:MD},58:{n:"PtgRef3d",f:gD},59:{n:"PtgArea3d",f:rD},60:{n:"PtgRefErr3d",f:PD},61:{n:"PtgAreaErr3d",f:iD},255:{}},aM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},iM={1:{n:"PtgElfLel",f:TE},2:{n:"PtgElfRw",f:JD},3:{n:"PtgElfCol",f:GD},6:{n:"PtgElfRwV",f:WD},7:{n:"PtgElfColV",f:qD},10:{n:"PtgElfRadical",f:jD},11:{n:"PtgElfRadicalS",f:XD},13:{n:"PtgElfColS",f:VD},15:{n:"PtgElfColSV",f:zD},16:{n:"PtgElfRadicalLel",f:YD},25:{n:"PtgList",f:$D},29:{n:"PtgSxName",f:QD},255:{}},sM={0:{n:"PtgAttrNoop",f:rM},1:{n:"PtgAttrSemi",f:dD},2:{n:"PtgAttrIf",f:uD},4:{n:"PtgAttrChoose",f:lD},8:{n:"PtgAttrGoto",f:cD},16:{n:"PtgAttrSum",f:ED},32:{n:"PtgAttrBaxcel",f:Lv},33:{n:"PtgAttrBaxcel",f:Lv},64:{n:"PtgAttrSpace",f:hD},65:{n:"PtgAttrSpaceSemi",f:mD},128:{n:"PtgAttrIfError",f:fD},255:{}};function oc(e,t,n,r){if(r.biff<8)return Kn(e,t);for(var a=e.l+t,o=[],l=0;l!==n.length;++l)switch(n[l][0]){case"PtgArray":n[l][1]=RD(e,0,r),o.push(n[l][1]);break;case"PtgMemArea":n[l][2]=kD(e,n[l][1],r),o.push(n[l][2]);break;case"PtgExp":r&&r.biff==12&&(n[l][1][1]=e.read_shift(4),o.push(n[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[l][0]}return t=a-e.l,t!==0&&o.push(Kn(e,t)),o}function lc(e,t,n){for(var r=e.l+t,a,o,l=[];r!=e.l;)t=r-e.l,o=e[e.l],a=Ov[o]||Ov[aM[o]],(o===24||o===25)&&(a=(o===24?iM:sM)[e[e.l+1]]),!a||!a.f?Kn(e,t):l.push([a.n,a.f(e,t,n)]);return l}function oM(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],o=0;o<r.length;++o){var l=r[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var lM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function cM(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function SE(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(a=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Pv(e,t,n){var r=SE(e,t,n);return r=="#REF"?r:cM(r,n)}function jn(e,t,n,r,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},u=[],d,f,m,v=0,y=0,T,w="";if(!e[0]||!e[0][0])return"";for(var S=-1,A="",k=0,I=e[0].length;k<I;++k){var b=e[0][k];switch(b[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=u.pop(),f=u.pop(),S>=0){switch(e[0][S][1][0]){case 0:A=on(" ",e[0][S][1][1]);break;case 1:A=on("\r",e[0][S][1][1]);break;default:if(A="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}f=f+A,S=-1}u.push(f+lM[b[0]]+d);break;case"PtgIsect":d=u.pop(),f=u.pop(),u.push(f+" "+d);break;case"PtgUnion":d=u.pop(),f=u.pop(),u.push(f+","+d);break;case"PtgRange":d=u.pop(),f=u.pop(),u.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Ml(b[1][1],l,a),u.push(Il(m,o));break;case"PtgRefN":m=n?Ml(b[1][1],n,a):b[1][1],u.push(Il(m,o));break;case"PtgRef3d":v=b[1][1],m=Ml(b[1][2],l,a),w=Pv(r,v,a),u.push(w+"!"+Il(m,o));break;case"PtgFunc":case"PtgFuncVar":var P=b[1][0],F=b[1][1];P||(P=0),P&=127;var Y=P==0?[]:u.slice(-P);u.length-=P,F==="User"&&(F=Y.shift()),u.push(F+"("+Y.join(",")+")");break;case"PtgBool":u.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(b[1]);break;case"PtgNum":u.push(String(b[1]));break;case"PtgStr":u.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(b[1]);break;case"PtgAreaN":T=dv(b[1][1],n?{s:n}:l,a),u.push(Wd(T,a));break;case"PtgArea":T=dv(b[1][1],l,a),u.push(Wd(T,a));break;case"PtgArea3d":v=b[1][1],T=b[1][2],w=Pv(r,v,a),u.push(w+"!"+Wd(T,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=b[1][2];var D=(r.names||[])[y-1]||(r[0]||[])[y],Q=D?D.Name:"SH33TJSNAME"+String(y);Q&&Q.slice(0,6)=="_xlfn."&&!a.xlfn&&(Q=Q.slice(6)),u.push(Q);break;case"PtgNameX":var B=b[1][1];y=b[1][2];var ae;if(a.biff<=5)B<0&&(B=-B),r[B]&&(ae=r[B][y]);else{var ie="";if(((r[B]||[])[0]||[])[0]==14849||(((r[B]||[])[0]||[])[0]==1025?r[B][y]&&r[B][y].itab>0&&(ie=r.SheetNames[r[B][y].itab-1]+"!"):ie=r.SheetNames[y-1]+"!"),r[B]&&r[B][y])ie+=r[B][y].Name;else if(r[0]&&r[0][y])ie+=r[0][y].Name;else{var Z=(SE(r,B,a)||"").split(";;");Z[y-1]?ie=Z[y-1]:ie+="SH33TJSERRX"}u.push(ie);break}ae||(ae={Name:"SH33TJSERRY"}),u.push(ae.Name);break;case"PtgParen":var le="(",Te=")";if(S>=0){switch(A="",e[0][S][1][0]){case 2:le=on(" ",e[0][S][1][1])+le;break;case 3:le=on("\r",e[0][S][1][1])+le;break;case 4:Te=on(" ",e[0][S][1][1])+Te;break;case 5:Te=on("\r",e[0][S][1][1])+Te;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}S=-1}u.push(le+u.pop()+Te);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:b[1][1],r:b[1][0]};var ye={c:n.c,r:n.r};if(r.sharedf[st(m)]){var H=r.sharedf[st(m)];u.push(jn(H,l,ye,r,a))}else{var ee=!1;for(d=0;d!=r.arrayf.length;++d)if(f=r.arrayf[d],!(m.c<f[0].s.c||m.c>f[0].e.c)&&!(m.r<f[0].s.r||m.r>f[0].e.r)){u.push(jn(f[1],l,ye,r,a)),ee=!0;break}ee||u.push(b[1])}break;case"PtgArray":u.push("{"+oM(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var Ce=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&Ce.indexOf(e[0][k][0])==-1){b=e[0][S];var re=!0;switch(b[1][0]){case 4:re=!1;case 0:A=on(" ",b[1][1]);break;case 5:re=!1;case 1:A=on("\r",b[1][1]);break;default:if(A="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}u.push((re?A:"")+u.pop()+(re?"":A)),S=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function uM(e,t,n){var r=e.l+t,a=n.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Kn(e,t-2)];var u=lc(e,l,n);return t!==l+a&&(o=oc(e,t-l-a,u,n)),e.l=r,[u,o]}function fM(e,t,n){var r=e.l+t,a=n.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Kn(e,t-2)];var u=lc(e,l,n);return t!==l+a&&(o=oc(e,t-l-a,u,n)),e.l=r,[u,o]}function dM(e,t,n,r){var a=e.l+t,o=lc(e,r,n),l;return a!==e.l&&(l=oc(e,a-e.l,o,n)),[o,l]}function hM(e,t,n){var r=e.l+t,a,o=e.read_shift(2),l=lc(e,o,n);return o==65535?[[],Kn(e,t-2)]:(t!==o+2&&(a=oc(e,r-o-2,l,n)),[l,a])}function mM(e){var t;if(ja(e,e.l+6)!==65535)return[Xn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function pM(e){if(e==null){var t=_e(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return fs(e);return fs(0)}function eh(e,t,n){var r=e.l+t,a=Aa(e);n.biff==2&&++e.l;var o=mM(e),l=e.read_shift(1);n.biff!=2&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var u=fM(e,r-e.l,n);return{cell:a,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function xM(e,t,n,r,a){var o=hs(t,n,a),l=pM(e.v),u=_e(6),d=33;u.write_shift(2,d),u.write_shift(4,0);for(var f=_e(e.bf.length),m=0;m<e.bf.length;++m)f[m]=e.bf[m];var v=Rn([o,l,u,f]);return v}function Sf(e,t,n){var r=e.read_shift(4),a=lc(e,r,n),o=e.read_shift(4),l=o>0?oc(e,o,a,n):null;return[a,l]}var gM=Sf,wf=Sf,vM=Sf,yM=Sf,_M={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},wE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},EM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Uv(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,n){return n.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function TM(e){var t="of:="+e.replace(gm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function th(e){var t=e.split(":"),n=t[0].split(".")[0];return[n,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function SM(e){return e.replace(/\./,"!")}var Ll={},mo={},Ol=typeof Map<"u";function _m(e,t,n){var r=0,a=e.length;if(n){if(Ol?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var o=Ol?n.get(t):n[t];r<o.length;++r)if(e[o[r]].t===t)return e.Count++,o[r]}}else for(;r<a;++r)if(e[r].t===t)return e.Count++,r;return e[a]={t},e.Count++,e.Unique++,n&&(Ol?(n.has(t)||n.set(t,[]),n.get(t).push(a)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(a))),a}function Af(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(Yn=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?r=Kl(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(n.width=lf(r),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function ls(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function Pi(e,t,n){var r=n.revssf[t.z!=null?t.z:"General"],a=60,o=e.length;if(r==null&&n.ssf){for(;a<392;++a)if(n.ssf[a]==null){Xa(t.z,a),n.ssf[a]=t.z,n.revssf[t.z]=r=a;break}}for(a=0;a!=o;++a)if(e[a].numFmtId===r)return a;return e[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function AE(e,t,n,r,a,o){try{r.cellNF&&(e.z=nt[t])}catch(u){if(r.WTF)throw u}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=$t(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(nt[t]==null&&Xa(_4[t]||"General",t),e.t==="e")e.w=e.w||Za[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zl(e.v);else if(e.t==="d"){var l=An(e.v);(l|0)===l?e.w=l.toString(10):e.w=zl(l)}else{if(e.v===void 0)return"";e.w=cs(e.v,mo)}else e.t==="d"?e.w=Wr(t,An(e.v),mo):e.w=Wr(t,e.v,mo)}catch(u){if(r.WTF)throw u}if(r.cellStyles&&n!=null)try{e.s=o.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=of(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=of(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(r.WTF&&o.Fills)throw u}}}function wM(e,t,n){if(e&&e["!ref"]){var r=bt(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function AM(e,t){var n=bt(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=dt(n))}var CM=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,bM=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,NM=/<(?:\w:)?hyperlink [^>]*>/mg,kM=/"(\w*:\w*)"/,RM=/<(?:\w:)?col\b[^>]*[\/]?>/g,DM=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,MM=/<(?:\w:)?pageMargins[^>]*\/>/g,CE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,IM=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,FM=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function LM(e,t,n,r,a,o,l){if(!e)return e;r||(r={"!id":{}});var u=t.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",m="",v=e.match(bM);v?(f=e.slice(0,v.index),m=e.slice(v.index+v[0].length)):f=m=e;var y=f.match(CE);y?Em(y[0],u,a,n):(y=f.match(IM))&&PM(y[0],y[1]||"",u,a,n);var T=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var w=f.slice(T,T+50).match(kM);w&&AM(u,w[1])}var S=f.match(FM);S&&S[1]&&KM(S[1],a);var A=[];if(t.cellStyles){var k=f.match(RM);k&&jM(A,k)}v&&ZM(v[1],u,t,d,o,l);var I=m.match(DM);I&&(u["!autofilter"]=XM(I[0]));var b=[],P=m.match(CM);if(P)for(T=0;T!=P.length;++T)b[T]=bt(P[T].slice(P[T].indexOf('"')+1));var F=m.match(NM);F&&VM(u,F,r);var Y=m.match(MM);if(Y&&(u["!margins"]=zM(ot(Y[0]))),!u["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(u["!ref"]=dt(d)),t.sheetRows>0&&u["!ref"]){var D=bt(u["!ref"]);t.sheetRows<=+D.e.r&&(D.e.r=t.sheetRows-1,D.e.r>d.e.r&&(D.e.r=d.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>d.e.c&&(D.e.c=d.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),u["!fullref"]=u["!ref"],u["!ref"]=dt(D))}return A.length>0&&(u["!cols"]=A),b.length>0&&(u["!merges"]=b),u}function OM(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+dt(e[n])+'"/>';return t+"</mergeCells>"}function Em(e,t,n,r){var a=ot(e);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=Ct(qt(a.codeName)))}function PM(e,t,n,r,a){Em(e.slice(0,e.indexOf(">")),n,r,a)}function UM(e,t,n,r,a){var o=!1,l={},u=null;if(r.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[n];try{t.Workbook&&(d=t.Workbook.Sheets[n].CodeName||d)}catch{}o=!0,l.codeName=Sa(Ht(d))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),u=(u||"")+Be("outlinePr",null,f)}!o&&!u||(a[a.length]=Be("sheetPr",u,l))}var BM=["objects","scenarios","selectLockedCells","selectUnlockedCells"],HM=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function GM(e){var t={sheet:1};return BM.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),HM.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=mm(e.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function VM(e,t,n){for(var r=Array.isArray(e),a=0;a!=t.length;++a){var o=ot(qt(t[a]),!0);if(!o.ref)return;var l=((n||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Ct(o.location))):(o.Target="#"+Ct(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=bt(o.ref),d=u.s.r;d<=u.e.r;++d)for(var f=u.s.c;f<=u.e.c;++f){var m=st({c:f,r:d});r?(e[d]||(e[d]=[]),e[d][f]||(e[d][f]={t:"z",v:void 0}),e[d][f].l=o):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=o)}}}function zM(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}function qM(e){return ls(e),Be("pageMargins",null,e)}function jM(e,t){for(var n=!1,r=0;r!=t.length;++r){var a=ot(t[r],!0);a.hidden&&(a.hidden=Kt(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,pm(a.width)),Mi(a);o<=l;)e[o++]=Qt(a)}}function YM(e,t){for(var n=["<cols>"],r,a=0;a!=t.length;++a)(r=t[a])&&(n[n.length]=Be("col",null,Af(a,r)));return n[n.length]="</cols>",n.join("")}function XM(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function JM(e,t,n,r){var a=typeof e.ref=="string"?e.ref:dt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,l=xr(a);l.s.r==l.e.r&&(l.e.r=xr(t["!ref"]).e.r,a=dt(l));for(var u=0;u<o.length;++u){var d=o[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==r){d.Ref="'"+n.SheetNames[r]+"'!"+a;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),Be("autoFilter",null,{ref:a})}var WM=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function KM(e,t){t.Views||(t.Views=[{}]),(e.match(WM)||[]).forEach(function(n,r){var a=ot(n);t.Views[r]||(t.Views[r]={}),+a.zoomScale&&(t.Views[r].zoom=+a.zoomScale),Kt(a.rightToLeft)&&(t.Views[r].RTL=!0)})}function $M(e,t,n,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,a),{})}function QM(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",o=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Za[e.v];break;case"d":r&&r.cellDates?a=$t(e.v,-1).toISOString():(e=Qt(e),e.t="n",a=""+(e.v=An($t(e.v)))),typeof e.z>"u"&&(e.z=nt[14]);break;default:a=e.v;break}var u=Bn("v",Ht(a)),d={r:t},f=Pi(r.cellXfs,e,r);switch(f!==0&&(d.s=f),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){u=Bn("v",""+_m(r.Strings,e.v,r.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=o&&(e.t=o,e.v=l),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Be("f",Ht(e.f),m)+(e.v!=null?u:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(d.cm=1),Be("c",u,d)}var ZM=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=ql("v"),l=ql("f");return function(d,f,m,v,y,T){for(var w=0,S="",A=[],k=[],I=0,b=0,P=0,F="",Y,D,Q=0,B=0,ae,ie,Z=0,le=0,Te=Array.isArray(T.CellXf),ye,H=[],ee=[],Ce=Array.isArray(f),re=[],Fe={},W=!1,N=!!m.sheetStubs,G=d.split(t),U=0,V=G.length;U!=V;++U){S=G[U].trim();var q=S.length;if(q!==0){var se=0;e:for(w=0;w<q;++w)switch(S[w]){case">":if(S[w-1]!="/"){++w;break e}if(m&&m.cellStyles){if(D=ot(S.slice(se,w),!0),Q=D.r!=null?parseInt(D.r,10):Q+1,B=-1,m.sheetRows&&m.sheetRows<Q)continue;Fe={},W=!1,D.ht&&(W=!0,Fe.hpt=parseFloat(D.ht),Fe.hpx=yo(Fe.hpt)),D.hidden=="1"&&(W=!0,Fe.hidden=!0),D.outlineLevel!=null&&(W=!0,Fe.level=+D.outlineLevel),W&&(re[Q-1]=Fe)}break;case"<":se=w;break}if(se>=w)break;if(D=ot(S.slice(se,w),!0),Q=D.r!=null?parseInt(D.r,10):Q+1,B=-1,!(m.sheetRows&&m.sheetRows<Q)){v.s.r>Q-1&&(v.s.r=Q-1),v.e.r<Q-1&&(v.e.r=Q-1),m&&m.cellStyles&&(Fe={},W=!1,D.ht&&(W=!0,Fe.hpt=parseFloat(D.ht),Fe.hpx=yo(Fe.hpt)),D.hidden=="1"&&(W=!0,Fe.hidden=!0),D.outlineLevel!=null&&(W=!0,Fe.level=+D.outlineLevel),W&&(re[Q-1]=Fe)),A=S.slice(w).split(e);for(var ge=0;ge!=A.length&&A[ge].trim().charAt(0)=="<";++ge);for(A=A.slice(ge),w=0;w!=A.length;++w)if(S=A[w].trim(),S.length!==0){if(k=S.match(n),I=w,b=0,P=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,k!=null&&k.length===2){for(I=0,F=k[1],b=0;b!=F.length&&!((P=F.charCodeAt(b)-64)<1||P>26);++b)I=26*I+P;--I,B=I}else++B;for(b=0;b!=S.length&&S.charCodeAt(b)!==62;++b);if(++b,D=ot(S.slice(0,b),!0),D.r||(D.r=st({r:Q-1,c:B})),F=S.slice(b),Y={t:""},(k=F.match(o))!=null&&k[1]!==""&&(Y.v=Ct(k[1])),m.cellFormula){if((k=F.match(l))!=null&&k[1]!==""){if(Y.f=Ct(qt(k[1])).replace(/\r\n/g,`
`),m.xlfn||(Y.f=Fv(Y.f)),k[0].indexOf('t="array"')>-1)Y.F=(F.match(a)||[])[1],Y.F.indexOf(":")>-1&&H.push([bt(Y.F),Y.F]);else if(k[0].indexOf('t="shared"')>-1){ie=ot(k[0]);var ve=Ct(qt(k[1]));m.xlfn||(ve=Fv(ve)),ee[parseInt(ie.si,10)]=[ie,ve,D.r]}}else(k=F.match(/<f[^>]*\/>/))&&(ie=ot(k[0]),ee[ie.si]&&(Y.f=WR(ee[ie.si][1],ee[ie.si][2],D.r)));var we=rn(D.r);for(b=0;b<H.length;++b)we.r>=H[b][0].s.r&&we.r<=H[b][0].e.r&&we.c>=H[b][0].s.c&&we.c<=H[b][0].e.c&&(Y.F=H[b][1])}if(D.t==null&&Y.v===void 0)if(Y.f||Y.F)Y.v=0,Y.t="n";else if(N)Y.t="z";else continue;else Y.t=D.t||"n";switch(v.s.c>B&&(v.s.c=B),v.e.c<B&&(v.e.c=B),Y.t){case"n":if(Y.v==""||Y.v==null){if(!N)continue;Y.t="z"}else Y.v=parseFloat(Y.v);break;case"s":if(typeof Y.v>"u"){if(!N)continue;Y.t="z"}else ae=Ll[parseInt(Y.v,10)],Y.v=ae.t,Y.r=ae.r,m.cellHTML&&(Y.h=ae.h);break;case"str":Y.t="s",Y.v=Y.v!=null?qt(Y.v):"",m.cellHTML&&(Y.h=Zh(Y.v));break;case"inlineStr":k=F.match(r),Y.t="s",k!=null&&(ae=hm(k[1]))?(Y.v=ae.t,m.cellHTML&&(Y.h=ae.h)):Y.v="";break;case"b":Y.v=Kt(Y.v);break;case"d":m.cellDates?Y.v=$t(Y.v,1):(Y.v=An($t(Y.v,1)),Y.t="n");break;case"e":(!m||m.cellText!==!1)&&(Y.w=Y.v),Y.v=N_[Y.v];break}if(Z=le=0,ye=null,Te&&D.s!==void 0&&(ye=T.CellXf[D.s],ye!=null&&(ye.numFmtId!=null&&(Z=ye.numFmtId),m.cellStyles&&ye.fillId!=null&&(le=ye.fillId))),AE(Y,Z,le,m,y,T),m.cellDates&&Te&&Y.t=="n"&&_o(nt[Z])&&(Y.t="d",Y.v=Ef(Y.v)),D.cm&&m.xlmeta){var Je=(m.xlmeta.Cell||[])[+D.cm-1];Je&&Je.type=="XLDAPR"&&(Y.D=!0)}if(Ce){var J=rn(D.r);f[J.r]||(f[J.r]=[]),f[J.r][J.c]=Y}else f[D.r]=Y}}}}re.length>0&&(f["!rows"]=re)}})();function eI(e,t,n,r){var a=[],o=[],l=bt(e["!ref"]),u="",d,f="",m=[],v=0,y=0,T=e["!rows"],w=Array.isArray(e),S={r:f},A,k=-1;for(y=l.s.c;y<=l.e.c;++y)m[y]=nn(y);for(v=l.s.r;v<=l.e.r;++v){for(o=[],f=hn(v),y=l.s.c;y<=l.e.c;++y){d=m[y]+f;var I=w?(e[v]||[])[y]:e[d];I!==void 0&&(u=QM(I,d,e,t))!=null&&o.push(u)}(o.length>0||T&&T[v])&&(S={r:f},T&&T[v]&&(A=T[v],A.hidden&&(S.hidden=1),k=-1,A.hpx?k=$l(A.hpx):A.hpt&&(k=A.hpt),k>-1&&(S.ht=k,S.customHeight=1),A.level&&(S.outlineLevel=A.level)),a[a.length]=Be("row",o.join(""),S))}if(T)for(;v<T.length;++v)T&&T[v]&&(S={r:v+1},A=T[v],A.hidden&&(S.hidden=1),k=-1,A.hpx?k=$l(A.hpx):A.hpt&&(k=A.hpt),k>-1&&(S.ht=k,S.customHeight=1),A.level&&(S.outlineLevel=A.level),a[a.length]=Be("row","",S));return a.join("")}function bE(e,t,n,r){var a=[mn,Be("worksheet",null,{xmlns:ps[0],"xmlns:r":wn.r})],o=n.SheetNames[e],l=0,u="",d=n.Sheets[o];d==null&&(d={});var f=d["!ref"]||"A1",m=bt(f);if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),f=dt(m)}r||(r={}),d["!comments"]=[];var v=[];UM(d,n,e,t,a),a[a.length]=Be("dimension",null,{ref:f}),a[a.length]=$M(d,t,e,n),t.sheetFormat&&(a[a.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(a[a.length]=YM(d,d["!cols"])),a[l=a.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(u=eI(d,t),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),d["!protect"]&&(a[a.length]=GM(d["!protect"])),d["!autofilter"]!=null&&(a[a.length]=JM(d["!autofilter"],d,n,e)),d["!merges"]!=null&&d["!merges"].length>0&&(a[a.length]=OM(d["!merges"]));var y=-1,T,w=-1;return d["!links"].length>0&&(a[a.length]="<hyperlinks>",d["!links"].forEach(function(S){S[1].Target&&(T={ref:S[0]},S[1].Target.charAt(0)!="#"&&(w=Bt(r,-1,Ht(S[1].Target).replace(/#.*$/,""),gt.HLINK),T["r:id"]="rId"+w),(y=S[1].Target.indexOf("#"))>-1&&(T.location=Ht(S[1].Target.slice(y+1))),S[1].Tooltip&&(T.tooltip=Ht(S[1].Tooltip)),a[a.length]=Be("hyperlink",null,T))}),a[a.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(a[a.length]=qM(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Bn("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:f}))),v.length>0&&(w=Bt(r,-1,"../drawings/drawing"+(e+1)+".xml",gt.DRAW),a[a.length]=Be("drawing",null,{"r:id":"rId"+w}),d["!drawing"]=v),d["!comments"].length>0&&(w=Bt(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",gt.VML),a[a.length]=Be("legacyDrawing",null,{"r:id":"rId"+w}),d["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function tI(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(n.level=o&7),o&16&&(n.hidden=!0),o&32&&(n.hpt=a/20),n}function nI(e,t,n){var r=_e(145),a=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var o=320;a.hpx?o=$l(a.hpx)*20:a.hpt&&(o=a.hpt*20),r.write_shift(2,o),r.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),r.write_shift(1,l),r.write_shift(1,0);var u=0,d=r.l;r.l+=4;for(var f={r:e,c:0},m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var v=-1,y=-1,T=m<<10;T<m+1<<10;++T){f.c=T;var w=Array.isArray(n)?(n[f.r]||[])[f.c]:n[st(f)];w&&(v<0&&(v=T),y=T)}v<0||(++u,r.write_shift(4,v),r.write_shift(4,y))}var S=r.l;return r.l=d,r.write_shift(4,u),r.l=S,r.length>r.l?r.slice(0,r.l):r}function rI(e,t,n,r){var a=nI(r,n,t);(a.length>17||(t["!rows"]||[])[r])&&ke(e,0,a)}var aI=ys,iI=So;function sI(){}function oI(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=ub(e),n}function lI(e,t,n){n==null&&(n=_e(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var a=1;a<3;++a)n.write_shift(1,0);return rf({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),S_(e,n),n.slice(0,n.l)}function cI(e){var t=$r(e);return[t]}function uI(e,t,n){return n==null&&(n=_e(8)),xs(t,n)}function fI(e){var t=gs(e);return[t]}function dI(e,t,n){return n==null&&(n=_e(4)),vs(t,n)}function hI(e){var t=$r(e),n=e.read_shift(1);return[t,n,"b"]}function mI(e,t,n){return n==null&&(n=_e(9)),xs(t,n),n.write_shift(1,e.v?1:0),n}function pI(e){var t=gs(e),n=e.read_shift(1);return[t,n,"b"]}function xI(e,t,n){return n==null&&(n=_e(5)),vs(t,n),n.write_shift(1,e.v?1:0),n}function gI(e){var t=$r(e),n=e.read_shift(1);return[t,n,"e"]}function vI(e,t,n){return n==null&&(n=_e(9)),xs(t,n),n.write_shift(1,e.v),n}function yI(e){var t=gs(e),n=e.read_shift(1);return[t,n,"e"]}function _I(e,t,n){return n==null&&(n=_e(8)),vs(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function EI(e){var t=$r(e),n=e.read_shift(4);return[t,n,"s"]}function TI(e,t,n){return n==null&&(n=_e(12)),xs(t,n),n.write_shift(4,t.v),n}function SI(e){var t=gs(e),n=e.read_shift(4);return[t,n,"s"]}function wI(e,t,n){return n==null&&(n=_e(8)),vs(t,n),n.write_shift(4,t.v),n}function AI(e){var t=$r(e),n=Xn(e);return[t,n,"n"]}function CI(e,t,n){return n==null&&(n=_e(16)),xs(t,n),fs(e.v,n),n}function NE(e){var t=gs(e),n=Xn(e);return[t,n,"n"]}function bI(e,t,n){return n==null&&(n=_e(12)),vs(t,n),fs(e.v,n),n}function NI(e){var t=$r(e),n=lm(e);return[t,n,"n"]}function kI(e,t,n){return n==null&&(n=_e(12)),xs(t,n),w_(e.v,n),n}function RI(e){var t=gs(e),n=lm(e);return[t,n,"n"]}function DI(e,t,n){return n==null&&(n=_e(8)),vs(t,n),w_(e.v,n),n}function MI(e){var t=$r(e),n=im(e);return[t,n,"is"]}function II(e){var t=$r(e),n=Wn(e);return[t,n,"str"]}function FI(e,t,n){return n==null&&(n=_e(12+4*e.v.length)),xs(t,n),Dn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function LI(e){var t=gs(e),n=Wn(e);return[t,n,"str"]}function OI(e,t,n){return n==null&&(n=_e(8+4*e.v.length)),vs(t,n),Dn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function PI(e,t,n){var r=e.l+t,a=$r(e);a.r=n["!row"];var o=e.read_shift(1),l=[a,o,"b"];if(n.cellFormula){e.l+=2;var u=wf(e,r-e.l,n);l[3]=jn(u,null,a,n.supbooks,n)}else e.l=r;return l}function UI(e,t,n){var r=e.l+t,a=$r(e);a.r=n["!row"];var o=e.read_shift(1),l=[a,o,"e"];if(n.cellFormula){e.l+=2;var u=wf(e,r-e.l,n);l[3]=jn(u,null,a,n.supbooks,n)}else e.l=r;return l}function BI(e,t,n){var r=e.l+t,a=$r(e);a.r=n["!row"];var o=Xn(e),l=[a,o,"n"];if(n.cellFormula){e.l+=2;var u=wf(e,r-e.l,n);l[3]=jn(u,null,a,n.supbooks,n)}else e.l=r;return l}function HI(e,t,n){var r=e.l+t,a=$r(e);a.r=n["!row"];var o=Wn(e),l=[a,o,"str"];if(n.cellFormula){e.l+=2;var u=wf(e,r-e.l,n);l[3]=jn(u,null,a,n.supbooks,n)}else e.l=r;return l}var GI=ys,VI=So;function zI(e,t){return t==null&&(t=_e(4)),t.write_shift(4,e),t}function qI(e,t){var n=e.l+t,r=ys(e),a=sm(e),o=Wn(e),l=Wn(e),u=Wn(e);e.l=n;var d={rfx:r,relId:a,loc:o,display:u};return l&&(d.Tooltip=l),d}function jI(e,t){var n=_e(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));So({s:rn(e[0]),e:rn(e[0])},n),om("rId"+t,n);var r=e[1].Target.indexOf("#"),a=r==-1?"":e[1].Target.slice(r+1);return Dn(a||"",n),Dn(e[1].Tooltip||"",n),Dn("",n),n.slice(0,n.l)}function YI(){}function XI(e,t,n){var r=e.l+t,a=A_(e),o=e.read_shift(1),l=[a];if(l[2]=o,n.cellFormula){var u=gM(e,r-e.l,n);l[1]=u}else e.l=r;return l}function JI(e,t,n){var r=e.l+t,a=ys(e),o=[a];if(n.cellFormula){var l=yM(e,r-e.l,n);o[1]=l,e.l=r}else e.l=r;return o}function WI(e,t,n){n==null&&(n=_e(18));var r=Af(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof r.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),n.write_shift(2,a),n}var kE=["left","right","top","bottom","header","footer"];function KI(e){var t={};return kE.forEach(function(n){t[n]=Xn(e)}),t}function $I(e,t){return t==null&&(t=_e(48)),ls(e),kE.forEach(function(n){fs(e[n],t)}),t}function QI(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function ZI(e,t,n){n==null&&(n=_e(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function e6(e){var t=_e(24);return t.write_shift(4,4),t.write_shift(4,1),So(e,t),t}function t6(e,t){return t==null&&(t=_e(66)),t.write_shift(2,e.password?mm(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function n6(){}function r6(){}function a6(e,t,n,r,a,o,l){if(!e)return e;var u=t||{};r||(r={"!id":{}});var d=u.dense?[]:{},f,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,y=!1,T,w,S,A,k,I,b,P,F,Y=[];u.biff=12,u["!row"]=0;var D=0,Q=!1,B=[],ae={},ie=u.supbooks||a.supbooks||[[]];if(ie.sharedf=ae,ie.arrayf=B,ie.SheetNames=a.SheetNames||a.Sheets.map(function(Ce){return Ce.name}),!u.supbooks&&(u.supbooks=ie,a.Names))for(var Z=0;Z<a.Names.length;++Z)ie[0][Z+1]=a.Names[Z];var le=[],Te=[],ye=!1;Ql[16]={n:"BrtShortReal",f:NE};var H;if(Qa(e,function(re,Fe,W){if(!y)switch(W){case 148:f=re;break;case 0:T=re,u.sheetRows&&u.sheetRows<=T.r&&(y=!0),P=hn(A=T.r),u["!row"]=T.r,(re.hidden||re.hpt||re.level!=null)&&(re.hpt&&(re.hpx=yo(re.hpt)),Te[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:re[2]},re[2]){case"n":w.v=re[1];break;case"s":b=Ll[re[1]],w.v=b.t,w.r=b.r;break;case"b":w.v=!!re[1];break;case"e":w.v=re[1],u.cellText!==!1&&(w.w=Za[w.v]);break;case"str":w.t="s",w.v=re[1];break;case"is":w.t="s",w.v=re[1].t;break}if((S=l.CellXf[re[0].iStyleRef])&&AE(w,S.numFmtId,null,u,o,l),k=re[0].c==-1?k+1:re[0].c,u.dense?(d[A]||(d[A]=[]),d[A][k]=w):d[nn(k)+P]=w,u.cellFormula){for(Q=!1,D=0;D<B.length;++D){var N=B[D];T.r>=N[0].s.r&&T.r<=N[0].e.r&&k>=N[0].s.c&&k<=N[0].e.c&&(w.F=dt(N[0]),Q=!0)}!Q&&re.length>3&&(w.f=re[3])}if(m.s.r>T.r&&(m.s.r=T.r),m.s.c>k&&(m.s.c=k),m.e.r<T.r&&(m.e.r=T.r),m.e.c<k&&(m.e.c=k),u.cellDates&&S&&w.t=="n"&&_o(nt[S.numFmtId])){var G=as(w.v);G&&(w.t="d",w.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}H&&(H.type=="XLDAPR"&&(w.D=!0),H=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;w={t:"z",v:void 0},k=re[0].c==-1?k+1:re[0].c,u.dense?(d[A]||(d[A]=[]),d[A][k]=w):d[nn(k)+P]=w,m.s.r>T.r&&(m.s.r=T.r),m.s.c>k&&(m.s.c=k),m.e.r<T.r&&(m.e.r=T.r),m.e.c<k&&(m.e.c=k),H&&(H.type=="XLDAPR"&&(w.D=!0),H=void 0);break;case 176:Y.push(re);break;case 49:H=((u.xlmeta||{}).Cell||[])[re-1];break;case 494:var U=r["!id"][re.relId];for(U?(re.Target=U.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=U):re.relId==""&&(re.Target="#"+re.loc),A=re.rfx.s.r;A<=re.rfx.e.r;++A)for(k=re.rfx.s.c;k<=re.rfx.e.c;++k)u.dense?(d[A]||(d[A]=[]),d[A][k]||(d[A][k]={t:"z",v:void 0}),d[A][k].l=re):(I=st({c:k,r:A}),d[I]||(d[I]={t:"z",v:void 0}),d[I].l=re);break;case 426:if(!u.cellFormula)break;B.push(re),F=u.dense?d[A][k]:d[nn(k)+P],F.f=jn(re[1],m,{r:T.r,c:k},ie,u),F.F=dt(re[0]);break;case 427:if(!u.cellFormula)break;ae[st(re[0].s)]=re[1],F=u.dense?d[A][k]:d[nn(k)+P],F.f=jn(re[1],m,{r:T.r,c:k},ie,u);break;case 60:if(!u.cellStyles)break;for(;re.e>=re.s;)le[re.e--]={width:re.w/256,hidden:!!(re.flags&1),level:re.level},ye||(ye=!0,pm(re.w/256)),Mi(le[re.e+1]);break;case 161:d["!autofilter"]={ref:dt(re)};break;case 476:d["!margins"]=re;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),re.name&&(a.Sheets[n].CodeName=re.name),(re.above||re.left)&&(d["!outline"]={above:re.above,left:re.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),re.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!Fe.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},u),delete u.supbooks,delete u["!row"],!d["!ref"]&&(m.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(d["!ref"]=dt(f||m)),u.sheetRows&&d["!ref"]){var ee=bt(d["!ref"]);u.sheetRows<=+ee.e.r&&(ee.e.r=u.sheetRows-1,ee.e.r>m.e.r&&(ee.e.r=m.e.r),ee.e.r<ee.s.r&&(ee.s.r=ee.e.r),ee.e.c>m.e.c&&(ee.e.c=m.e.c),ee.e.c<ee.s.c&&(ee.s.c=ee.e.c),d["!fullref"]=d["!ref"],d["!ref"]=dt(ee))}return Y.length>0&&(d["!merges"]=Y),le.length>0&&(d["!cols"]=le),Te.length>0&&(d["!rows"]=Te),d}function i6(e,t,n,r,a,o,l){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Qt(t),t.z=t.z||nt[14],t.v=An($t(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var d={r:n,c:r};switch(d.s=Pi(a.cellXfs,t,a),t.l&&o["!links"].push([st(d),t.l]),t.c&&o["!comments"].push([st(d),t.c]),t.t){case"s":case"str":return a.bookSST?(u=_m(a.Strings,t.v,a.revStrings),d.t="s",d.v=u,l?ke(e,18,wI(t,d)):ke(e,7,TI(t,d))):(d.t="str",l?ke(e,17,OI(t,d)):ke(e,6,FI(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?ke(e,13,DI(t,d)):ke(e,2,kI(t,d)):l?ke(e,16,bI(t,d)):ke(e,5,CI(t,d)),!0;case"b":return d.t="b",l?ke(e,15,xI(t,d)):ke(e,4,mI(t,d)),!0;case"e":return d.t="e",l?ke(e,14,_I(t,d)):ke(e,3,vI(t,d)),!0}return l?ke(e,12,dI(t,d)):ke(e,1,uI(t,d)),!0}function s6(e,t,n,r){var a=bt(t["!ref"]||"A1"),o,l="",u=[];ke(e,145);var d=Array.isArray(t),f=a.e.r;t["!rows"]&&(f=Math.max(a.e.r,t["!rows"].length-1));for(var m=a.s.r;m<=f;++m){l=hn(m),rI(e,t,a,m);var v=!1;if(m<=a.e.r)for(var y=a.s.c;y<=a.e.c;++y){m===a.s.r&&(u[y]=nn(y)),o=u[y]+l;var T=d?(t[m]||[])[y]:t[o];if(!T){v=!1;continue}v=i6(e,T,m,y,r,t,v)}}ke(e,146)}function o6(e,t){!t||!t["!merges"]||(ke(e,177,zI(t["!merges"].length)),t["!merges"].forEach(function(n){ke(e,176,VI(n))}),ke(e,178))}function l6(e,t){!t||!t["!cols"]||(ke(e,390),t["!cols"].forEach(function(n,r){n&&ke(e,60,WI(r,n))}),ke(e,391))}function c6(e,t){!t||!t["!ref"]||(ke(e,648),ke(e,649,e6(bt(t["!ref"]))),ke(e,650))}function u6(e,t,n){t["!links"].forEach(function(r){if(r[1].Target){var a=Bt(n,-1,r[1].Target.replace(/#.*$/,""),gt.HLINK);ke(e,494,jI(r,a))}}),delete t["!links"]}function f6(e,t,n,r){if(t["!comments"].length>0){var a=Bt(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",gt.VML);ke(e,551,om("rId"+a)),t["!legacy"]=a}}function d6(e,t,n,r){if(t["!autofilter"]){var a=t["!autofilter"],o=typeof a.ref=="string"?a.ref:dt(a.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var l=n.Workbook.Names,u=xr(o);u.s.r==u.e.r&&(u.e.r=xr(t["!ref"]).e.r,o=dt(u));for(var d=0;d<l.length;++d){var f=l[d];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==r){f.Ref="'"+n.SheetNames[r]+"'!"+o;break}}d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+o}),ke(e,161,So(bt(o))),ke(e,162)}}function h6(e,t,n){ke(e,133),ke(e,137,ZI(t,n)),ke(e,138),ke(e,134)}function m6(e,t){t["!protect"]&&ke(e,535,t6(t["!protect"]))}function p6(e,t,n,r){var a=pr(),o=n.SheetNames[e],l=n.Sheets[o]||{},u=o;try{n&&n.Workbook&&(u=n.Workbook.Sheets[e].CodeName||u)}catch{}var d=bt(l["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],ke(a,129),(n.vbaraw||l["!outline"])&&ke(a,147,lI(u,l["!outline"])),ke(a,148,iI(d)),h6(a,l,n.Workbook),l6(a,l),s6(a,l,e,t),m6(a,l),d6(a,l,n,e),o6(a,l),u6(a,l,r),l["!margins"]&&ke(a,476,$I(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&c6(a,l),f6(a,l,e,r),ke(a,130),a.end()}function x6(e){var t=[],n=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=n?+l[2]:l[2])});var a=Ct((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[t,a,r]}function g6(e,t,n,r,a,o){var l=o||{"!type":"chart"};if(!e)return o;var u=0,d=0,f="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var y=x6(v);m.s.r=m.s.c=0,m.e.c=u,f=nn(u),y[0].forEach(function(T,w){l[f+hn(w)]={t:"n",v:T,z:y[1]},d=w}),m.e.r<d&&(m.e.r=d),++u}),u>0&&(l["!ref"]=dt(m)),l}function v6(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=e.match(CE);return u&&Em(u[0],o,a,n),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function y6(e,t){e.l+=10;var n=Wn(e);return{name:n}}function _6(e,t,n,r,a){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Qa(e,function(d,f,m){switch(m){case 550:o["!rel"]=d;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),d.name&&(a.Sheets[n].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var Tm=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],E6=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],T6=[],S6=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Bv(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],a=0;a!=t.length;++a){var o=t[a];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=Kt(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function Hv(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=Kt(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function RE(e){Hv(e.WBProps,Tm),Hv(e.CalcPr,S6),Bv(e.WBView,E6),Bv(e.Sheets,T6),mo.date1904=Kt(e.WBProps.date1904)}function w6(e){return!e.Workbook||!e.Workbook.WBProps?"false":Kt(e.Workbook.WBProps.date1904)?"true":"false"}var A6="][*?/\\".split("");function DE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return A6.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function C6(e,t,n){e.forEach(function(r,a){DE(r);for(var o=0;o<a;++o)if(r==e[o])throw new Error("Duplicate Sheet Name: "+r);if(n){var l=t&&t[a]&&t[a].CodeName||r;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function b6(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];C6(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)wM(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}var N6=/<\w+:workbook/;function k6(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",o={},l=0;if(e.replace($n,function(d,f){var m=ot(d);switch(wa(m[0])){case"<?xml":break;case"<workbook":d.match(N6)&&(a="xmlns"+d.match(/<(\w+):/)[1]),n.xmlns=m[a];break;case"</workbook>":break;case"<fileVersion":delete m[0],n.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Tm.forEach(function(v){if(m[v[0]]!=null)switch(v[2]){case"bool":n.WBProps[v[0]]=Kt(m[v[0]]);break;case"int":n.WBProps[v[0]]=parseInt(m[v[0]],10);break;default:n.WBProps[v[0]]=m[v[0]]}}),m.codeName&&(n.WBProps.CodeName=qt(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],n.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Ct(qt(m.name)),delete m[0],n.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=qt(m.name),m.comment&&(o.Comment=m.comment),m.localSheetId&&(o.Sheet=+m.localSheetId),Kt(m.hidden||"0")&&(o.Hidden=!0),l=f+d.length;break;case"</definedName>":o.Ref=Ct(qt(e.slice(l,f))),n.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete m[0],n.CalcPr=m;break;case"<calcPr/>":delete m[0],n.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return d}),ps.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return RE(n),n}function ME(e){var t=[mn];t[t.length]=Be("workbook",null,{xmlns:ps[0],"xmlns:r":wn.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Tm.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(r[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Be("workbookPr",null,r);var a=e.Workbook&&e.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var l={name:Ht(e.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Be("sheet",null,l)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var d={name:u.Name};u.Comment&&(d.comment=u.Comment),u.Sheet!=null&&(d.localSheetId=""+u.Sheet),u.Hidden&&(d.hidden="1"),u.Ref&&(t[t.length]=Be("definedName",Ht(u.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function R6(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=hh(e),n.name=Wn(e),n}function D6(e,t){return t||(t=_e(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),om(e.strRelID,t),Dn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function M6(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?Wn(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function I6(e,t){t||(t=_e(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),S_(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function F6(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function L6(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),o=fb(e),l=vM(e,0,n),u=sm(e);e.l=r;var d={Name:o,Ptg:l};return a<268435455&&(d.Sheet=a),u&&(d.Comment=u),d}function O6(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;t||(t={}),t.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],Ql[16]={n:"BrtFRTArchID$",f:F6},Qa(e,function(d,f,m){switch(m){case 156:l.SheetNames.push(d.name),n.Sheets.push(d);break;case 153:n.WBProps=d;break;case 39:d.Sheet!=null&&(t.SID=d.Sheet),d.Ref=jn(d.Ptg,null,null,l,t),delete t.SID,delete d.Ptg,o.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,d]):l[0]=[m,d],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(d),l.XTI=l.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(m),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(m),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||t.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),RE(n),n.Names=o,n.supbooks=l,n}function P6(e,t){ke(e,143);for(var n=0;n!=t.SheetNames.length;++n){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,a={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};ke(e,156,D6(a))}ke(e,144)}function U6(e,t){t||(t=_e(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return Dn("SheetJS",t),Dn(Ku.version,t),Dn(Ku.version,t),Dn("7262",t),t.length>t.l?t.slice(0,t.l):t}function B6(e,t){t||(t=_e(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function H6(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,r=0,a=-1,o=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&a==-1?a=r:n[r].Hidden==1&&o==-1&&(o=r);o>a||(ke(e,135),ke(e,158,B6(a)),ke(e,136))}}function G6(e,t){var n=pr();return ke(n,131),ke(n,128,U6()),ke(n,153,I6(e.Workbook&&e.Workbook.WBProps||null)),H6(n,e),P6(n,e),ke(n,132),n.end()}function V6(e,t,n){return t.slice(-4)===".bin"?O6(e,n):k6(e,n)}function z6(e,t,n,r,a,o,l,u){return t.slice(-4)===".bin"?a6(e,r,n,a,o,l,u):LM(e,r,n,a,o,l,u)}function q6(e,t,n,r,a,o,l,u){return t.slice(-4)===".bin"?_6(e,r,n,a,o):v6(e,r,n,a,o)}function j6(e,t,n,r,a,o,l,u){return t.slice(-4)===".bin"?XR():JR()}function Y6(e,t,n,r,a,o,l,u){return t.slice(-4)===".bin"?jR():YR()}function X6(e,t,n,r){return t.slice(-4)===".bin"?V3(e,n,r):R3(e,n,r)}function J6(e,t,n){return dE(e,n)}function W6(e,t,n){return t.slice(-4)===".bin"?Wk(e,n):Yk(e,n)}function K6(e,t,n){return t.slice(-4)===".bin"?HR(e,n):DR(e,n)}function $6(e,t,n){return t.slice(-4)===".bin"?NR(e):CR(e)}function Q6(e,t,n,r){return n.slice(-4)===".bin"?kR(e,t,n,r):void 0}function Z6(e,t,n){return t.slice(-4)===".bin"?SR(e,t,n):AR(e,t,n)}function e8(e,t,n){return(t.slice(-4)===".bin"?G6:ME)(e)}function t8(e,t,n,r,a){return(t.slice(-4)===".bin"?p6:bE)(e,n,r,a)}function n8(e,t,n){return(t.slice(-4)===".bin"?Q3:uE)(e,n)}function r8(e,t,n){return(t.slice(-4)===".bin"?Qk:nE)(e,n)}function a8(e,t,n){return(t.slice(-4)===".bin"?GR:pE)(e)}function i8(e){return(e.slice(-4)===".bin"?wR:hE)()}var IE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,FE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function sa(e,t){var n=e.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var a=e.match(IE),o,l,u,d;if(a)for(d=0;d!=a.length;++d)o=a[d].match(FE),(l=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),r[u]=o[2].slice(1,o[2].length-1));return r}function s8(e){var t=e.split(/\s+/),n={};if(t.length===1)return n;var r=e.match(IE),a,o,l,u;if(r)for(u=0;u!=r.length;++u)a=r[u].match(FE),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),n[l]=a[2].slice(1,a[2].length-1));return n}var Pl;function o8(e,t){var n=Pl[e]||Ct(e);return n==="General"?cs(t):Wr(n,t)}function l8(e,t,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Kt(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=$t(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[Ct(t)]=a}function c8(e,t,n){if(e.t!=="z"){if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||Za[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zl(e.v):e.w=cs(e.v):e.w=o8(t||"General",e.v)}catch(o){if(n.WTF)throw o}try{var r=Pl[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&e.t=="n"&&_o(r)){var a=as(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(n.WTF)throw o}}}function u8(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=T3[r.Pattern]||r.Pattern)}e[t.ID]=t}function f8(e,t,n,r,a,o,l,u,d,f){var m="General",v=r.StyleID,y={};f=f||{};var T=[],w=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&l&&(v=l.StyleID);o[v]!==void 0&&(o[v].nf&&(m=o[v].nf),o[v].Interior&&T.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=Kt(e);break;case"String":r.t="s",r.r=rv(Ct(e)),r.v=e.indexOf("<")>-1?Ct(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=($t(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Ct(e):r.v<60&&(r.v=r.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=N_[e],f.cellText!==!1&&(r.w=e);break;default:e==""&&t==""?r.t="z":(r.t="s",r.v=rv(t||e));break}if(c8(r,m,f),f.cellFormula!==!1)if(r.Formula){var S=Ct(r.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),r.f=ho(S,a),delete r.Formula,r.ArrayRange=="RC"?r.F=ho("RC:RC",a):r.ArrayRange&&(r.F=ho(r.ArrayRange,a),d.push([bt(r.F),r.F]))}else for(w=0;w<d.length;++w)a.r>=d[w][0].s.r&&a.r<=d[w][0].e.r&&a.c>=d[w][0].s.c&&a.c<=d[w][0].e.c&&(r.F=d[w][1]);f.cellStyles&&(T.forEach(function(A){!y.patternType&&A.patternType&&(y.patternType=A.patternType)}),r.s=y),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function d8(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function nh(e,t){var n=t||{};Eo();var r=Sl(em(e));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=qt(r));var a=r.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Qt(n);return l.type="string",vo.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ft){a.indexOf("<"+Ft)>=0&&(o=!0)}),o)return $8(r,n);Pl={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,d=[],f,m={},v=[],y=n.dense?[]:{},T="",w={},S={},A=sa('<Data ss:Type="String">'),k=0,I=0,b=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},Y={},D="",Q=0,B=[],ae={},ie={},Z=0,le=[],Te=[],ye={},H=[],ee,Ce=!1,re=[],Fe=[],W={},N=0,G=0,U={Sheets:[],WBProps:{date1904:!1}},V={};Yl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var q="";u=Yl.exec(r);)switch(u[3]=(q=u[3]).toLowerCase()){case"data":if(q=="data"){if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break}if(d[d.length-1][1])break;u[1]==="/"?f8(r.slice(k,u.index),D,A,d[d.length-1][0]=="comment"?ye:w,{c:I,r:b},F,H[I],S,re,n):(D="",A=sa(u[0]),k=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Te.length>0&&(w.c=Te),(!n.sheetRows||n.sheetRows>b)&&w.v!==void 0&&(n.dense?(y[b]||(y[b]=[]),y[b][I]=w):y[nn(I)+hn(b)]=w),w.HRef&&(w.l={Target:Ct(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(N=I+(parseInt(w.MergeAcross,10)|0),G=b+(parseInt(w.MergeDown,10)|0),B.push({s:{c:I,r:b},e:{c:N,r:G}})),!n.sheetStubs)w.MergeAcross?I=N+1:++I;else if(w.MergeAcross||w.MergeDown){for(var se=I;se<=N;++se)for(var ge=b;ge<=G;++ge)(se>I||ge>b)&&(n.dense?(y[ge]||(y[ge]=[]),y[ge][se]={t:"z"}):y[nn(se)+hn(ge)]={t:"z"});I=N+1}else++I;else w=s8(u[0]),w.Index&&(I=+w.Index-1),I<P.s.c&&(P.s.c=I),I>P.e.c&&(P.e.c=I),u[0].slice(-2)==="/>"&&++I,Te=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(b<P.s.r&&(P.s.r=b),b>P.e.r&&(P.e.r=b),u[0].slice(-2)==="/>"&&(S=sa(u[0]),S.Index&&(b=+S.Index-1)),I=0,++b):(S=sa(u[0]),S.Index&&(b=+S.Index-1),W={},(S.AutoFitHeight=="0"||S.Height)&&(W.hpx=parseInt(S.Height,10),W.hpt=$l(W.hpx),Fe[b]=W),S.Hidden=="1"&&(W.hidden=!0,Fe[b]=W));break;case"worksheet":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"));v.push(T),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(y["!ref"]=dt(P),n.sheetRows&&n.sheetRows<=P.e.r&&(y["!fullref"]=y["!ref"],P.e.r=n.sheetRows-1,y["!ref"]=dt(P))),B.length&&(y["!merges"]=B),H.length>0&&(y["!cols"]=H),Fe.length>0&&(y["!rows"]=Fe),m[T]=y}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=I=0,d.push([u[3],!1]),f=sa(u[0]),T=Ct(f.Name),y=n.dense?[]:{},B=[],re=[],Fe=[],V={name:T,Hidden:0},U.Sheets.push(V);break;case"table":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else{if(u[0].slice(-2)=="/>")break;d.push([u[3],!1]),H=[],Ce=!1}break;case"style":u[1]==="/"?u8(F,Y,n):Y=sa(u[0]);break;case"numberformat":Y.nf=Ct(sa(u[0]).Format||"General"),Pl[Y.nf]&&(Y.nf=Pl[Y.nf]);for(var ve=0;ve!=392&&nt[ve]!=Y.nf;++ve);if(ve==392){for(ve=57;ve!=392;++ve)if(nt[ve]==null){Xa(Y.nf,ve);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(ee=sa(u[0]),ee.Hidden&&(ee.hidden=!0,delete ee.Hidden),ee.Width&&(ee.wpx=parseInt(ee.Width,10)),!Ce&&ee.wpx>10){Ce=!0,Yn=lE;for(var we=0;we<H.length;++we)H[we]&&Mi(H[we])}Ce&&Mi(ee),H[ee.Index-1||H.length]=ee;for(var Je=0;Je<+ee.Span;++Je)H[H.length]=Qt(ee);break;case"namedrange":if(u[1]==="/")break;U.Names||(U.Names=[]);var J=ot(u[0]),wt={Name:J.Name,Ref:ho(J.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(wt.Sheet=U.Sheets.length-1),U.Names.push(wt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?D+=r.slice(Q,u.index):Q=u.index+u[0].length;break;case"interior":if(!n.cellStyles)break;Y.Interior=sa(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?Ob(ae,q,r.slice(Z,u.index)):Z=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else d.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"));d8(ye),Te.push(ye)}else d.push([u[3],!1]),f=sa(u[0]),ye={a:f.Author};break;case"autofilter":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var rt=sa(u[0]);y["!autofilter"]={ref:ho(rt.Range).replace(/\$/g,"")},d.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"null":break;default:if(d.length==0&&u[3]=="document"||d.length==0&&u[3]=="uof")return jv(r,n);var vt=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:vt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:vt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:vt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:vt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(r.slice(Z,u.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else Z=u.index+u[0].length;break;case"header":y["!margins"]||ls(y["!margins"]={},"xlml"),isNaN(+ot(u[0]).Margin)||(y["!margins"].header=+ot(u[0]).Margin);break;case"footer":y["!margins"]||ls(y["!margins"]={},"xlml"),isNaN(+ot(u[0]).Margin)||(y["!margins"].footer=+ot(u[0]).Margin);break;case"pagemargins":var at=ot(u[0]);y["!margins"]||ls(y["!margins"]={},"xlml"),isNaN(+at.Top)||(y["!margins"].top=+at.Top),isNaN(+at.Left)||(y["!margins"].left=+at.Left),isNaN(+at.Right)||(y["!margins"].right=+at.Right),isNaN(+at.Bottom)||(y["!margins"].bottom=+at.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:vt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:vt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:vt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:vt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:vt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:vt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:vt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:vt=!1}break;case"smarttags":break;default:vt=!1;break}if(vt||u[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?l8(ie,q,le,r.slice(Z,u.index)):(le=u,Z=u.index+u[0].length);break}if(n.WTF)throw"Unrecognized tag: "+u[3]+"|"+d.join("|")}var Ge={};return!n.bookSheets&&!n.bookProps&&(Ge.Sheets=m),Ge.SheetNames=v,Ge.Workbook=U,Ge.SSF=Qt(nt),Ge.Props=ae,Ge.Custprops=ie,Ge}function _h(e,t){switch(wm(t=t||{}),t.type||"base64"){case"base64":return nh(kr(e),t);case"binary":case"buffer":case"file":return nh(e,t);case"array":return nh(Li(e),t)}}function h8(e,t){var n=[];return e.Props&&n.push(Pb(e.Props,t)),e.Custprops&&n.push(Ub(e.Props,e.Custprops)),n.join("")}function m8(){return""}function p8(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,a){var o=[];o.push(Be("NumberFormat",null,{"ss:Format":Ht(nt[r.numFmtId])}));var l={"ss:ID":"s"+(21+a)};n.push(Be("Style",o.join(""),l))}),Be("Styles",n.join(""))}function LE(e){return Be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+vm(e.Ref,{r:0,c:0})})}function x8(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var a=t[r];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||n.push(LE(a)))}return Be("Names",n.join(""))}function g8(e,t,n,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,o=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==n&&(u.Name.match(/^_xlfn\./)||o.push(LE(u)))}return o.join("")}function v8(e,t,n,r){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Be("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)a.push(Be("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<n&&!(r.Workbook.Sheets[o]&&!r.Workbook.Sheets[o].Hidden);++o);o==n&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Bn("ProtectContents","True")),e["!protect"].objects&&a.push(Bn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Bn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Bn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Bn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Be("WorksheetOptions",a.join(""),{xmlns:Ar.x})}function y8(e){return e.map(function(t){var n=H4(t.t||""),r=Be("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",r,{"ss:Author":t.a})}).join("")}function _8(e,t,n,r,a,o,l){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Ht(vm(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var d=rn(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(d.r==l.r?"":"["+(d.r-l.r)+"]")+"C"+(d.c==l.c?"":"["+(d.c-l.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Ht(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Ht(e.l.Tooltip))),n["!merges"])for(var f=n["!merges"],m=0;m!=f.length;++m)f[m].s.c!=l.c||f[m].s.r!=l.r||(f[m].e.c>f[m].s.c&&(u["ss:MergeAcross"]=f[m].e.c-f[m].s.c),f[m].e.r>f[m].s.r&&(u["ss:MergeDown"]=f[m].e.r-f[m].s.r));var v="",y="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":v="Number",y=String(e.v);break;case"b":v="Boolean",y=e.v?"1":"0";break;case"e":v="Error",y=Za[e.v];break;case"d":v="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||nt[14]);break;case"s":v="String",y=B4(e.v||"");break}var T=Pi(r.cellXfs,e,r);u["ss:StyleID"]="s"+(21+T),u["ss:Index"]=l.c+1;var w=e.v!=null?y:"",S=e.t=="z"?"":'<Data ss:Type="'+v+'">'+w+"</Data>";return(e.c||[]).length>0&&(S+=y8(e.c)),Be("Cell",S,u)}function E8(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=yo(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function T8(e,t,n,r){if(!e["!ref"])return"";var a=bt(e["!ref"]),o=e["!merges"]||[],l=0,u=[];e["!cols"]&&e["!cols"].forEach(function(A,k){Mi(A);var I=!!A.width,b=Af(k,A),P={"ss:Index":k+1};I&&(P["ss:Width"]=Wl(b.width)),A.hidden&&(P["ss:Hidden"]="1"),u.push(Be("Column",null,P))});for(var d=Array.isArray(e),f=a.s.r;f<=a.e.r;++f){for(var m=[E8(f,(e["!rows"]||[])[f])],v=a.s.c;v<=a.e.c;++v){var y=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>v)&&!(o[l].s.r>f)&&!(o[l].e.c<v)&&!(o[l].e.r<f)){(o[l].s.c!=v||o[l].s.r!=f)&&(y=!0);break}if(!y){var T={r:f,c:v},w=st(T),S=d?(e[f]||[])[v]:e[w];m.push(_8(S,w,e,t,n,r,T))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function S8(e,t,n){var r=[],a=n.SheetNames[e],o=n.Sheets[a],l=o?g8(o,t,e,n):"";return l.length>0&&r.push("<Names>"+l+"</Names>"),l=o?T8(o,t,e,n):"",l.length>0&&r.push("<Table>"+l+"</Table>"),r.push(v8(o,t,e,n)),r.join("")}function w8(e,t){t||(t={}),e.SSF||(e.SSF=Qt(nt)),e.SSF&&(Eo(),vf(e.SSF),t.revssf=_f(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Pi(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(h8(e,t)),n.push(m8()),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(Be("Worksheet",S8(r,t,e),{"ss:Name":Ht(e.SheetNames[r])}));return n[2]=p8(e,t),n[3]=x8(e),mn+Be("Workbook",n.join(""),{xmlns:Ar.ss,"xmlns:o":Ar.o,"xmlns:x":Ar.x,"xmlns:ss":Ar.ss,"xmlns:dt":Ar.dt,"xmlns:html":Ar.html})}function A8(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=xb(n),n.length-n.l<=4)return t;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(t.UnicodeClipboardFormat=gb(n),r=n.read_shift(4),r==0||r>40))return t;n.l-=4,t.Reserved2=n.read_shift(0,"lpwstr")}var C8=[60,1084,2066,2165,2175];function b8(e,t,n,r,a){var o=r,l=[],u=n.slice(n.l,n.l+o);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),n.l+=o;for(var d=ja(n,n.l),f=Eh[d],m=0;f!=null&&C8.indexOf(d)>-1;)o=ja(n,n.l+2),m=n.l+4,d==2066?m+=4:(d==2165||d==2175)&&(m+=12),u=n.slice(m,n.l+4+o),l.push(u),n.l+=4+o,f=Eh[d=ja(n,n.l)];var v=Rn(l);Un(v,0);var y=0;v.lens=[];for(var T=0;T<l.length;++T)v.lens.push(y),y+=l[T].length;if(v.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+v.length+" < "+r;return t.f(v,v.length,a)}function _a(e,t,n){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=nt[r])}catch(o){if(t.WTF)throw o}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Za[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zl(e.v):e.w=cs(e.v):e.w=Wr(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(o){if(t.WTF)throw o}if(t.cellDates&&r&&e.t=="n"&&_o(nt[r]||String(r))){var a=as(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Iu(e,t,n){return{v:e,ixfe:t,t:n}}function N8(e,t){var n={opts:{}},r={},a=t.dense?[]:{},o={},l={},u=null,d=[],f="",m={},v,y="",T,w,S,A,k={},I=[],b,P,F=[],Y=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Q={},B=function(Le){return Le<8?is[Le]:Le<64&&Y[Le-8]||is[Le]},ae=function(Le,pt,Ne){var Oe=pt.XF.data;if(!(!Oe||!Oe.patternType||!Ne||!Ne.cellStyles)){pt.s={},pt.s.patternType=Oe.patternType;var je;(je=Jl(B(Oe.icvFore)))&&(pt.s.fgColor={rgb:je}),(je=Jl(B(Oe.icvBack)))&&(pt.s.bgColor={rgb:je})}},ie=function(Le,pt,Ne){if(!(W>1)&&!(Ne.sheetRows&&Le.r>=Ne.sheetRows)){if(Ne.cellStyles&&pt.XF&&pt.XF.data&&ae(Le,pt,Ne),delete pt.ixfe,delete pt.XF,v=Le,y=st(Le),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Le.r<l.s.r&&(l.s.r=Le.r),Le.c<l.s.c&&(l.s.c=Le.c),Le.r+1>l.e.r&&(l.e.r=Le.r+1),Le.c+1>l.e.c&&(l.e.c=Le.c+1),Ne.cellFormula&&pt.f){for(var Oe=0;Oe<I.length;++Oe)if(!(I[Oe][0].s.c>Le.c||I[Oe][0].s.r>Le.r)&&!(I[Oe][0].e.c<Le.c||I[Oe][0].e.r<Le.r)){pt.F=dt(I[Oe][0]),(I[Oe][0].s.c!=Le.c||I[Oe][0].s.r!=Le.r)&&delete pt.f,pt.f&&(pt.f=""+jn(I[Oe][1],l,Le,re,Z));break}}Ne.dense?(a[Le.r]||(a[Le.r]=[]),a[Le.r][Le.c]=pt):a[y]=pt}},Z={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:I,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Z.password=t.password);var le,Te=[],ye=[],H=[],ee=[],Ce=!1,re=[];re.SheetNames=Z.snames,re.sharedf=Z.sharedf,re.arrayf=Z.arrayf,re.names=[],re.XTI=[];var Fe=0,W=0,N=0,G=[],U=[],V;Z.codepage=1200,oa(1200);for(var q=!1;e.l<e.length-1;){var se=e.l,ge=e.read_shift(2);if(ge===0&&Fe===10)break;var ve=e.l===e.length?0:e.read_shift(2),we=Eh[ge];if(we&&we.f){if(t.bookSheets&&Fe===133&&ge!==133)break;if(Fe=ge,we.r===2||we.r==12){var Je=e.read_shift(2);if(ve-=2,!Z.enc&&Je!==ge&&((Je&255)<<8|Je>>8)!==ge)throw new Error("rt mismatch: "+Je+"!="+ge);we.r==12&&(e.l+=10,ve-=10)}var J={};if(ge===10?J=we.f(e,ve,Z):J=b8(ge,we,e,ve,Z),W==0&&[9,521,1033,2057].indexOf(Fe)===-1)continue;switch(ge){case 34:n.opts.Date1904=D.WBProps.date1904=J;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(Z.enc||(e.l=0),Z.enc=J,!t.password)throw new Error("File is password-protected");if(J.valid==null)throw new Error("Encryption scheme unsupported");if(!J.valid)throw new Error("Password is incorrect");break;case 92:Z.lastuser=J;break;case 66:var wt=Number(J);switch(wt){case 21010:wt=1200;break;case 32768:wt=1e4;break;case 32769:wt=1252;break}oa(Z.codepage=wt),q=!0;break;case 317:Z.rrtabid=J;break;case 25:Z.winlocked=J;break;case 439:n.opts.RefreshAll=J;break;case 12:n.opts.CalcCount=J;break;case 16:n.opts.CalcDelta=J;break;case 17:n.opts.CalcIter=J;break;case 13:n.opts.CalcMode=J;break;case 14:n.opts.CalcPrecision=J;break;case 95:n.opts.CalcSaveRecalc=J;break;case 15:Z.CalcRefMode=J;break;case 2211:n.opts.FullCalc=J;break;case 129:J.fDialog&&(a["!type"]="dialog"),J.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),J.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:F.push(J);break;case 430:re.push([J]),re[re.length-1].XTI=[];break;case 35:case 547:re[re.length-1].push(J);break;case 24:case 536:V={Name:J.Name,Ref:jn(J.rgce,l,null,re,Z)},J.itab>0&&(V.Sheet=J.itab-1),re.names.push(V),re[0]||(re[0]=[],re[0].XTI=[]),re[re.length-1].push(J),J.Name=="_xlnm._FilterDatabase"&&J.itab>0&&J.rgce&&J.rgce[0]&&J.rgce[0][0]&&J.rgce[0][0][0]=="PtgArea3d"&&(U[J.itab-1]={ref:dt(J.rgce[0][0][1][2])});break;case 22:Z.ExternCount=J;break;case 23:re.length==0&&(re[0]=[],re[0].XTI=[]),re[re.length-1].XTI=re[re.length-1].XTI.concat(J),re.XTI=re.XTI.concat(J);break;case 2196:if(Z.biff<8)break;V!=null&&(V.Comment=J[1]);break;case 18:a["!protect"]=J;break;case 19:J!==0&&Z.WTF&&console.error("Password verifier: "+J);break;case 133:o[J.pos]=J,Z.snames.push(J.name);break;case 10:{if(--W)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=dt(l),t.sheetRows&&t.sheetRows<=l.e.r){var rt=l.e.r;l.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=dt(l),l.e.r=rt}l.e.r++,l.e.c++}Te.length>0&&(a["!merges"]=Te),ye.length>0&&(a["!objects"]=ye),H.length>0&&(a["!cols"]=H),ee.length>0&&(a["!rows"]=ee),D.Sheets.push(Q)}f===""?m=a:r[f]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Z.biff===8&&(Z.biff={9:2,521:3,1033:4}[ge]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[J.BIFFVer]||8),Z.biffguess=J.BIFFVer==0,J.BIFFVer==0&&J.dt==4096&&(Z.biff=5,q=!0,oa(Z.codepage=28591)),Z.biff==8&&J.BIFFVer==0&&J.dt==16&&(Z.biff=2),W++)break;if(a=t.dense?[]:{},Z.biff<8&&!q&&(q=!0,oa(Z.codepage=t.codepage||1252)),Z.biff<5||J.BIFFVer==0&&J.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var vt={pos:e.l-ve,name:f};o[vt.pos]=vt,Z.snames.push(f)}else f=(o[se]||{name:""}).name;J.dt==32&&(a["!type"]="chart"),J.dt==64&&(a["!type"]="macro"),Te=[],ye=[],Z.arrayf=I=[],H=[],ee=[],Ce=!1,Q={Hidden:(o[se]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[J.r]||[])[J.c]:a[st({c:J.c,r:J.r})])&&++J.c,b={ixfe:J.ixfe,XF:F[J.ixfe]||{},v:J.val,t:"n"},N>0&&(b.z=G[b.ixfe>>8&63]),_a(b,t,n.opts.Date1904),ie({c:J.c,r:J.r},b,t);break;case 5:case 517:b={ixfe:J.ixfe,XF:F[J.ixfe],v:J.val,t:J.t},N>0&&(b.z=G[b.ixfe>>8&63]),_a(b,t,n.opts.Date1904),ie({c:J.c,r:J.r},b,t);break;case 638:b={ixfe:J.ixfe,XF:F[J.ixfe],v:J.rknum,t:"n"},N>0&&(b.z=G[b.ixfe>>8&63]),_a(b,t,n.opts.Date1904),ie({c:J.c,r:J.r},b,t);break;case 189:for(var at=J.c;at<=J.C;++at){var Ge=J.rkrec[at-J.c][0];b={ixfe:Ge,XF:F[Ge],v:J.rkrec[at-J.c][1],t:"n"},N>0&&(b.z=G[b.ixfe>>8&63]),_a(b,t,n.opts.Date1904),ie({c:at,r:J.r},b,t)}break;case 6:case 518:case 1030:{if(J.val=="String"){u=J;break}if(b=Iu(J.val,J.cell.ixfe,J.tt),b.XF=F[b.ixfe],t.cellFormula){var Ft=J.formula;if(Ft&&Ft[0]&&Ft[0][0]&&Ft[0][0][0]=="PtgExp"){var tn=Ft[0][0][1][0],Tn=Ft[0][0][1][1],Cn=st({r:tn,c:Tn});k[Cn]?b.f=""+jn(J.formula,l,J.cell,re,Z):b.F=((t.dense?(a[tn]||[])[Tn]:a[Cn])||{}).F}else b.f=""+jn(J.formula,l,J.cell,re,Z)}N>0&&(b.z=G[b.ixfe>>8&63]),_a(b,t,n.opts.Date1904),ie(J.cell,b,t),u=J}break;case 7:case 519:if(u)u.val=J,b=Iu(J,u.cell.ixfe,"s"),b.XF=F[b.ixfe],t.cellFormula&&(b.f=""+jn(u.formula,l,u.cell,re,Z)),N>0&&(b.z=G[b.ixfe>>8&63]),_a(b,t,n.opts.Date1904),ie(u.cell,b,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{I.push(J);var Qr=st(J[0].s);if(T=t.dense?(a[J[0].s.r]||[])[J[0].s.c]:a[Qr],t.cellFormula&&T){if(!u||!Qr||!T)break;T.f=""+jn(J[1],l,J[0],re,Z),T.F=dt(J[0])}}break;case 1212:{if(!t.cellFormula)break;if(y){if(!u)break;k[st(u.cell)]=J[0],T=t.dense?(a[u.cell.r]||[])[u.cell.c]:a[st(u.cell)],(T||{}).f=""+jn(J[0],l,v,re,Z)}}break;case 253:b=Iu(d[J.isst].t,J.ixfe,"s"),d[J.isst].h&&(b.h=d[J.isst].h),b.XF=F[b.ixfe],N>0&&(b.z=G[b.ixfe>>8&63]),_a(b,t,n.opts.Date1904),ie({c:J.c,r:J.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:J.ixfe,XF:F[J.ixfe],t:"z"},N>0&&(b.z=G[b.ixfe>>8&63]),_a(b,t,n.opts.Date1904),ie({c:J.c,r:J.r},b,t));break;case 190:if(t.sheetStubs)for(var Qn=J.c;Qn<=J.C;++Qn){var Mt=J.ixfe[Qn-J.c];b={ixfe:Mt,XF:F[Mt],t:"z"},N>0&&(b.z=G[b.ixfe>>8&63]),_a(b,t,n.opts.Date1904),ie({c:Qn,r:J.r},b,t)}break;case 214:case 516:case 4:b=Iu(J.val,J.ixfe,"s"),b.XF=F[b.ixfe],N>0&&(b.z=G[b.ixfe>>8&63]),_a(b,t,n.opts.Date1904),ie({c:J.c,r:J.r},b,t);break;case 0:case 512:W===1&&(l=J);break;case 252:d=J;break;case 1054:if(Z.biff==4){G[N++]=J[1];for(var Hn=0;Hn<N+163&&nt[Hn]!=J[1];++Hn);Hn>=163&&Xa(J[1],N+163)}else Xa(J[1],J[0]);break;case 30:{G[N++]=J;for(var te=0;te<N+163&&nt[te]!=J;++te);te>=163&&Xa(J,N+163)}break;case 229:Te=Te.concat(J);break;case 93:ye[J.cmo[0]]=Z.lastobj=J;break;case 438:Z.lastobj.TxO=J;break;case 127:Z.lastobj.ImData=J;break;case 440:for(A=J[0].s.r;A<=J[0].e.r;++A)for(S=J[0].s.c;S<=J[0].e.c;++S)T=t.dense?(a[A]||[])[S]:a[st({c:S,r:A})],T&&(T.l=J[1]);break;case 2048:for(A=J[0].s.r;A<=J[0].e.r;++A)for(S=J[0].s.c;S<=J[0].e.c;++S)T=t.dense?(a[A]||[])[S]:a[st({c:S,r:A})],T&&T.l&&(T.l.Tooltip=J[1]);break;case 28:{if(Z.biff<=5&&Z.biff>=2)break;T=t.dense?(a[J[0].r]||[])[J[0].c]:a[st(J[0])];var Pe=ye[J[2]];T||(t.dense?(a[J[0].r]||(a[J[0].r]=[]),T=a[J[0].r][J[0].c]={t:"z"}):T=a[st(J[0])]={t:"z"},l.e.r=Math.max(l.e.r,J[0].r),l.s.r=Math.min(l.s.r,J[0].r),l.e.c=Math.max(l.e.c,J[0].c),l.s.c=Math.min(l.s.c,J[0].c)),T.c||(T.c=[]),w={a:J[1],t:Pe.TxO.t},T.c.push(w)}break;case 2173:pR(F[J.ixfe],J.ext);break;case 125:{if(!Z.cellStyles)break;for(;J.e>=J.s;)H[J.e--]={width:J.w/256,level:J.level||0,hidden:!!(J.flags&1)},Ce||(Ce=!0,pm(J.w/256)),Mi(H[J.e+1])}break;case 520:{var Me={};J.level!=null&&(ee[J.r]=Me,Me.level=J.level),J.hidden&&(ee[J.r]=Me,Me.hidden=!0),J.hpt&&(ee[J.r]=Me,Me.hpt=J.hpt,Me.hpx=yo(J.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ls(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ge]]=J;break;case 161:a["!margins"]||ls(a["!margins"]={}),a["!margins"].header=J.header,a["!margins"].footer=J.footer;break;case 574:J.RTL&&(D.Views[0].RTL=!0);break;case 146:Y=J;break;case 2198:le=J;break;case 140:P=J;break;case 442:f?Q.CodeName=J||Q.name:D.WBProps.CodeName=J||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+ge.toString(16)),e.l+=ve}return n.SheetNames=cn(o).sort(function(Ye,Le){return Number(Ye)-Number(Le)}).map(function(Ye){return o[Ye].name}),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&m["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=m)):n.Preamble=m,n.Sheets&&U.forEach(function(Ye,Le){n.Sheets[n.SheetNames[Le]]["!autofilter"]=Ye}),n.Strings=d,n.SSF=Qt(nt),Z.enc&&(n.Encryption=Z.enc),le&&(n.Themes=le),n.Metadata={},P!==void 0&&(n.Metadata.Country=P),re.names.length>0&&(D.Names=re.names),n.Workbook=D,n}var Ul={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function k8(e,t,n){var r=et.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=Ev(r,mh,Ul.DSI);for(var o in a)t[o]=a[o]}catch(f){if(n.WTF)throw f}var l=et.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var u=Ev(l,ph,Ul.SI);for(var d in u)t[d]==null&&(t[d]=u[d])}catch(f){if(n.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(F_(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}function R8(e,t){var n=[],r=[],a=[],o=0,l,u=$1(mh,"n"),d=$1(ph,"n");if(e.Props)for(l=cn(e.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(u,l[o])?n:Object.prototype.hasOwnProperty.call(d,l[o])?r:a).push([l[o],e.Props[l[o]]]);if(e.Custprops)for(l=cn(e.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(u,l[o])?n:Object.prototype.hasOwnProperty.call(d,l[o])?r:a).push([l[o],e.Custprops[l[o]]]);var f=[];for(o=0;o<a.length;++o)G_.indexOf(a[o][0])>-1||I_.indexOf(a[o][0])>-1||a[o][1]!=null&&f.push(a[o]);r.length&&et.utils.cfb_add(t,"/SummaryInformation",Tv(r,Ul.SI,d,ph)),(n.length||f.length)&&et.utils.cfb_add(t,"/DocumentSummaryInformation",Tv(n,Ul.DSI,u,mh,f.length?f:null,Ul.UDI))}function OE(e,t){t||(t={}),wm(t),jh(),t.codepage&&qh(t.codepage);var n,r;if(e.FullPaths){if(et.find(e,"/encryption"))throw new Error("File is password-protected");n=et.find(e,"!CompObj"),r=et.find(e,"/Workbook")||et.find(e,"/Book")}else{switch(t.type){case"base64":e=br(kr(e));break;case"binary":e=br(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Un(e,0),r={content:e}}var a,o;if(n&&A8(n),t.bookProps&&!t.bookSheets)a={};else{var l=xt?"buffer":"array";if(r&&r.content)a=N8(r.content,t);else if((o=et.find(e,"PerfectOffice_MAIN"))&&o.content)a=os.to_workbook(o.content,(t.type=l,t));else if((o=et.find(e,"NativeContent_MAIN"))&&o.content)a=os.to_workbook(o.content,(t.type=l,t));else throw(o=et.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&et.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=zR(e))}var u={};return e.FullPaths&&k8(e,u,t),a.Props=a.Custprops=u,t.bookFiles&&(a.cfb=e),a}function D8(e,t){var n=t||{},r=et.utils.cfb_new({root:"R"}),a="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":a="/Workbook",n.biff=8;break;case"biff5":a="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return et.utils.cfb_add(r,a,PE(e,n)),n.biff==8&&(e.Props||e.Custprops)&&R8(e,r),n.biff==8&&e.vbaraw&&qR(r,et.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var Ql={0:{f:tI},1:{f:cI},2:{f:NI},3:{f:gI},4:{f:hI},5:{f:AI},6:{f:II},7:{f:EI},8:{f:HI},9:{f:BI},10:{f:PI},11:{f:UI},12:{f:fI},13:{f:RI},14:{f:yI},15:{f:pI},16:{f:NE},17:{f:LI},18:{f:SI},19:{f:im},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:L6},40:{},42:{},43:{f:I3},44:{f:D3},45:{f:O3},46:{f:U3},47:{f:P3},48:{},49:{f:ab},50:{},51:{f:vR},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Q_},62:{f:MI},63:{f:bR},64:{f:n6},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:QI},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:oI},148:{f:aI,p:16},151:{f:YI},152:{},153:{f:M6},154:{},155:{},156:{f:R6},157:{},158:{},159:{T:1,f:Jk},160:{T:-1},161:{T:1,f:ys},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:GI},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:xR},336:{T:-1},337:{f:ER,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$_},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:XI},427:{f:JI},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:KI},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:sI},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:qI},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:UR},633:{T:1},634:{T:-1},635:{T:1,f:OR},636:{T:-1},637:{f:lb},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:y6},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:r6},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Eh={6:{f:eh},10:{f:bi},12:{f:En},13:{f:En},14:{f:dn},15:{f:dn},16:{f:Xn},17:{f:dn},18:{f:dn},19:{f:En},20:{f:Nv},21:{f:Nv},23:{f:$_},24:{f:Rv},25:{f:dn},26:{},27:{},28:{f:rk},29:{},34:{f:dn},35:{f:kv},38:{f:Xn},39:{f:Xn},40:{f:Xn},41:{f:Xn},42:{f:dn},43:{f:dn},47:{f:p3},49:{f:RN},51:{f:En},60:{},61:{f:AN},64:{f:dn},65:{f:kN},66:{f:En},77:{},80:{},81:{},82:{},85:{f:En},89:{},90:{},91:{},92:{f:mN},93:{f:sk},94:{},95:{f:dn},96:{},97:{},99:{f:dn},125:{f:Q_},128:{f:jN},129:{f:xN},130:{f:En},131:{f:dn},132:{f:dn},133:{f:gN},134:{},140:{f:mk},141:{f:En},144:{},146:{f:gk},151:{},152:{},153:{},154:{},155:{},156:{f:En},157:{},158:{},160:{f:wk},161:{f:_k},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:GN},190:{f:VN},193:{f:bi},197:{},198:{},199:{},200:{},201:{},202:{f:dn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:En},220:{},221:{f:dn},222:{},224:{f:qN},225:{f:hN},226:{f:bi},227:{},229:{f:ak},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:yN},253:{f:MN},255:{f:EN},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:V_},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:dn},353:{f:bi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:KN},431:{f:dn},432:{},433:{},434:{},437:{},438:{f:ck},439:{f:dn},440:{f:uk},441:{},442:{f:ic},443:{},444:{f:En},445:{},446:{},448:{f:bi},449:{f:wN,r:2},450:{f:bi},512:{f:Av},513:{f:Sk},515:{f:JN},516:{f:FN},517:{f:bv},519:{f:Ak},520:{f:TN},523:{},545:{f:Dv},549:{f:wv},566:{},574:{f:bN},638:{f:HN},659:{},1048:{},1054:{f:ON},1084:{},1212:{f:ek},2048:{f:dk},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ru},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:bi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vk,r:12},2173:{f:mR,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:dn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:ZN,r:12},2197:{},2198:{f:lR,r:12},2199:{},2200:{},2201:{},2202:{f:tk,r:12},2203:{f:bi},2204:{},2205:{},2206:{},2207:{},2211:{f:SN},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:En},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Ek},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:xk},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Av},1:{},2:{f:Rk},3:{f:Nk},4:{f:bk},5:{f:bv},7:{f:Mk},8:{},9:{f:Ru},11:{},22:{f:En},30:{f:UN},31:{},32:{},33:{f:Dv},36:{},37:{f:wv},50:{f:Ik},62:{},52:{},67:{},68:{f:En},69:{},86:{},126:{},127:{f:Ck},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Fk},223:{},234:{},354:{},421:{},518:{f:eh},521:{f:Ru},536:{f:Rv},547:{f:kv},561:{},579:{},1030:{f:eh},1033:{f:Ru},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function He(e,t,n,r){var a=t;if(!isNaN(a)){var o=r||(n||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&nm(n)&&e.push(n)}}function M8(e,t,n,r){var a=(n||[]).length||0;if(a<=8224)return He(e,t,n,a);var o=t;if(!isNaN(o)){for(var l=n.parts||[],u=0,d=0,f=0;f+(l[u]||8224)<=8224;)f+=l[u]||8224,u++;var m=e.next(4);for(m.write_shift(2,o),m.write_shift(2,f),e.push(n.slice(d,d+f)),d+=f;d<a;){for(m=e.next(4),m.write_shift(2,60),f=0;f+(l[u]||8224)<=8224;)f+=l[u]||8224,u++;m.write_shift(2,f),e.push(n.slice(d,d+f)),d+=f}}}function cc(e,t,n){return e||(e=_e(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function I8(e,t,n,r){var a=_e(9);return cc(a,e,t),z_(n,r||"b",a),a}function F8(e,t,n){var r=_e(8+2*n.length);return cc(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function L8(e,t,n,r){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?An($t(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?He(e,2,Dk(n,r,a)):He(e,3,kk(n,r,a));return;case"b":case"e":He(e,5,I8(n,r,t.v,t.t));return;case"s":case"str":He(e,4,F8(n,r,(t.v||"").slice(0,255)));return}He(e,1,cc(null,n,r))}function O8(e,t,n,r){var a=Array.isArray(t),o=bt(t["!ref"]||"A1"),l,u="",d=[];if(o.e.c>255||o.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=dt(o)}for(var f=o.s.r;f<=o.e.r;++f){u=hn(f);for(var m=o.s.c;m<=o.e.c;++m){f===o.s.r&&(d[m]=nn(m)),l=d[m]+u;var v=a?(t[f]||[])[m]:t[l];v&&L8(e,v,f,m)}}}function P8(e,t){for(var n=t||{},r=pr(),a=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==n.sheet&&(a=o);if(a==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return He(r,n.biff==4?1033:n.biff==3?521:9,dm(e,16,n)),O8(r,e.Sheets[e.SheetNames[a]],a,n),He(r,10),r.end()}function U8(e,t,n){He(e,49,DN({sz:12,name:"Arial"},n))}function B8(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)t[a]!=null&&He(e,1054,PN(a,t[a],n))})}function H8(e,t){var n=_e(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),He(e,2151,n),n=_e(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),J_(bt(t["!ref"]||"A1"),n),n.write_shift(4,4),He(e,2152,n)}function G8(e,t){for(var n=0;n<16;++n)He(e,224,Cv({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){He(e,224,Cv(r,0,t))})}function V8(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];He(e,440,fk(r)),r[1].Tooltip&&He(e,2048,hk(r))}delete t["!links"]}function z8(e,t){if(t){var n=0;t.forEach(function(r,a){++n<=256&&r&&He(e,125,yk(Af(a,r),a))})}}function q8(e,t,n,r,a){var o=16+Pi(a.cellXfs,t,a);if(t.v==null&&!t.bf){He(e,513,hs(n,r,o));return}if(t.bf)He(e,6,xM(t,n,r,a,o));else switch(t.t){case"d":case"n":var l=t.t=="d"?An($t(t.v)):t.v;He(e,515,WN(n,r,l,o));break;case"b":case"e":He(e,517,XN(n,r,t.v,o,a,t.t));break;case"s":case"str":if(a.bookSST){var u=_m(a.Strings,t.v,a.revStrings);He(e,253,IN(n,r,u,o))}else He(e,516,LN(n,r,(t.v||"").slice(0,255),o,a));break;default:He(e,513,hs(n,r,o))}}function j8(e,t,n){var r=pr(),a=n.SheetNames[e],o=n.Sheets[a]||{},l=(n||{}).Workbook||{},u=(l.Sheets||[])[e]||{},d=Array.isArray(o),f=t.biff==8,m,v="",y=[],T=bt(o["!ref"]||"A1"),w=f?65536:16384;if(T.e.c>255||T.e.r>=w){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,w-1)}He(r,2057,dm(n,16,t)),He(r,13,Yr(1)),He(r,12,Yr(100)),He(r,15,nr(!0)),He(r,17,nr(!1)),He(r,16,fs(.001)),He(r,95,nr(!0)),He(r,42,nr(!1)),He(r,43,nr(!1)),He(r,130,Yr(1)),He(r,128,YN()),He(r,131,nr(!1)),He(r,132,nr(!1)),f&&z8(r,o["!cols"]),He(r,512,BN(T,t)),f&&(o["!links"]=[]);for(var S=T.s.r;S<=T.e.r;++S){v=hn(S);for(var A=T.s.c;A<=T.e.c;++A){S===T.s.r&&(y[A]=nn(A)),m=y[A]+v;var k=d?(o[S]||[])[A]:o[m];k&&(q8(r,k,S,A,t),f&&k.l&&o["!links"].push([m,k.l]))}}var I=u.CodeName||u.name||a;return f&&He(r,574,NN((l.Views||[])[0])),f&&(o["!merges"]||[]).length&&He(r,229,ik(o["!merges"])),f&&V8(r,o),He(r,442,q_(I)),f&&H8(r,o),He(r,10),r.end()}function Y8(e,t,n){var r=pr(),a=(e||{}).Workbook||{},o=a.Sheets||[],l=a.WBProps||{},u=n.biff==8,d=n.biff==5;if(He(r,2057,dm(e,5,n)),n.bookType=="xla"&&He(r,135),He(r,225,u?Yr(1200):null),He(r,193,Xb(2)),d&&He(r,191),d&&He(r,192),He(r,226),He(r,92,pN("SheetJS",n)),He(r,66,Yr(u?1200:1252)),u&&He(r,353,Yr(0)),u&&He(r,448),He(r,317,Tk(e.SheetNames.length)),u&&e.vbaraw&&He(r,211),u&&e.vbaraw){var f=l.CodeName||"ThisWorkbook";He(r,442,q_(f))}He(r,156,Yr(17)),He(r,25,nr(!1)),He(r,18,nr(!1)),He(r,19,Yr(0)),u&&He(r,431,nr(!1)),u&&He(r,444,Yr(0)),He(r,61,CN()),He(r,64,nr(!1)),He(r,141,Yr(0)),He(r,34,nr(w6(e)=="true")),He(r,14,nr(!0)),u&&He(r,439,nr(!1)),He(r,218,Yr(0)),U8(r,e,n),B8(r,e.SSF,n),G8(r,n),u&&He(r,352,nr(!1));var m=r.end(),v=pr();u&&He(v,140,pk()),u&&n.Strings&&M8(v,252,_N(n.Strings)),He(v,10);var y=v.end(),T=pr(),w=0,S=0;for(S=0;S<e.SheetNames.length;++S)w+=(u?12:11)+(u?2:1)*e.SheetNames[S].length;var A=m.length+w+y.length;for(S=0;S<e.SheetNames.length;++S){var k=o[S]||{};He(T,133,vN({pos:A,hs:k.Hidden||0,dt:0,name:e.SheetNames[S]},n)),A+=t[S].length}var I=T.end();if(w!=I.length)throw new Error("BS8 "+w+" != "+I.length);var b=[];return m.length&&b.push(m),I.length&&b.push(I),y.length&&b.push(y),Rn(b)}function X8(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=Qt(nt)),e&&e.SSF&&(Eo(),vf(e.SSF),n.revssf=_f(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Am(n),n.cellXfs=[],Pi(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)r[r.length]=j8(a,n,e);return r.unshift(Y8(e,r,n)),Rn(r)}function PE(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(!(!r||!r["!ref"])){var a=xr(r["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var o=t||{};switch(o.biff||2){case 8:case 5:return X8(e,t);case 4:case 3:case 2:return P8(e,t)}throw new Error("invalid type "+o.bookType+" for BIFF")}function Gv(e,t){var n=t||{},r=n.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=a.index,u=o&&o.index||e.length,d=D4(e.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,m=0,v=0,y=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(l=0;l<d.length;++l){var S=d[l].trim(),A=S.slice(0,3).toLowerCase();if(A=="<tr"){if(++f,n.sheetRows&&n.sheetRows<=f){--f;break}m=0;continue}if(!(A!="<td"&&A!="<th")){var k=S.split(/<\/t[dh]>/i);for(u=0;u<k.length;++u){var I=k[u].trim();if(I.match(/<t[dh]/i)){for(var b=I,P=0;b.charAt(0)=="<"&&(P=b.indexOf(">"))>-1;)b=b.slice(P+1);for(var F=0;F<w.length;++F){var Y=w[F];Y.s.c==m&&Y.s.r<f&&f<=Y.e.r&&(m=Y.e.c+1,F=-1)}var D=ot(I.slice(0,I.indexOf(">")));y=D.colspan?+D.colspan:1,((v=+D.rowspan)>1||y>1)&&w.push({s:{r:f,c:m},e:{r:f+(v||1)-1,c:m+y-1}});var Q=D.t||D["data-t"]||"";if(!b.length){m+=y;continue}if(b=o_(b),T.s.r>f&&(T.s.r=f),T.e.r<f&&(T.e.r=f),T.s.c>m&&(T.s.c=m),T.e.c<m&&(T.e.c=m),!b.length){m+=y;continue}var B={t:"s",v:b};n.raw||!b.trim().length||Q=="s"||(b==="TRUE"?B={t:"b",v:!0}:b==="FALSE"?B={t:"b",v:!1}:isNaN(ca(b))?isNaN(go(b).getDate())||(B={t:"d",v:$t(b)},n.cellDates||(B={t:"n",v:An(B.v)}),B.z=n.dateNF||nt[14]):B={t:"n",v:ca(b)}),n.dense?(r[f]||(r[f]=[]),r[f][m]=B):r[st({r:f,c:m})]=B,m+=y}}}}return r["!ref"]=dt(T),w.length&&(r["!merges"]=w),r}function J8(e,t,n,r){for(var a=e["!merges"]||[],o=[],l=t.s.c;l<=t.e.c;++l){for(var u=0,d=0,f=0;f<a.length;++f)if(!(a[f].s.r>n||a[f].s.c>l)&&!(a[f].e.r<n||a[f].e.c<l)){if(a[f].s.r<n||a[f].s.c<l){u=-1;break}u=a[f].e.r-a[f].s.r+1,d=a[f].e.c-a[f].s.c+1;break}if(!(u<0)){var m=st({r:n,c:l}),v=r.dense?(e[n]||[])[l]:e[m],y=v&&v.v!=null&&(v.h||Zh(v.w||(Wa(v),v.w)||""))||"",T={};u>1&&(T.rowspan=u),d>1&&(T.colspan=d),r.editable?y='<span contenteditable="true">'+y+"</span>":v&&(T["data-t"]=v&&v.t||"z",v.v!=null&&(T["data-v"]=v.v),v.z!=null&&(T["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+v.l.Target+'">'+y+"</a>")),T.id=(r.id||"sjs")+"-"+m,o.push(Be("td",y,T))}}var w="<tr>";return w+o.join("")+"</tr>"}var W8='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',K8="</body></html>";function $8(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return Oi(Gv(n[0],t),t);var r=Nm();return n.forEach(function(a,o){km(r,Gv(a,t),"Sheet"+(o+1))}),r}function Q8(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function UE(e,t){var n=t||{},r=n.header!=null?n.header:W8,a=n.footer!=null?n.footer:K8,o=[r],l=xr(e["!ref"]);n.dense=Array.isArray(e),o.push(Q8(e,l,n));for(var u=l.s.r;u<=l.e.r;++u)o.push(J8(e,l,u,n));return o.push("</table>"+a),o.join("")}function BE(e,t,n){var r=n||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?rn(r.origin):r.origin;a=l.r,o=l.c}var u=t.getElementsByTagName("tr"),d=Math.min(r.sheetRows||1e7,u.length),f={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var m=xr(e["!ref"]);f.s.r=Math.min(f.s.r,m.s.r),f.s.c=Math.min(f.s.c,m.s.c),f.e.r=Math.max(f.e.r,m.e.r),f.e.c=Math.max(f.e.c,m.e.c),a==-1&&(f.e.r=a=m.e.r+1)}var v=[],y=0,T=e["!rows"]||(e["!rows"]=[]),w=0,S=0,A=0,k=0,I=0,b=0;for(e["!cols"]||(e["!cols"]=[]);w<u.length&&S<d;++w){var P=u[w];if(Vv(P)){if(r.display)continue;T[S]={hidden:!0}}var F=P.children;for(A=k=0;A<F.length;++A){var Y=F[A];if(!(r.display&&Vv(Y))){var D=Y.hasAttribute("data-v")?Y.getAttribute("data-v"):Y.hasAttribute("v")?Y.getAttribute("v"):o_(Y.innerHTML),Q=Y.getAttribute("data-z")||Y.getAttribute("z");for(y=0;y<v.length;++y){var B=v[y];B.s.c==k+o&&B.s.r<S+a&&S+a<=B.e.r&&(k=B.e.c+1-o,y=-1)}b=+Y.getAttribute("colspan")||1,((I=+Y.getAttribute("rowspan")||1)>1||b>1)&&v.push({s:{r:S+a,c:k+o},e:{r:S+a+(I||1)-1,c:k+o+(b||1)-1}});var ae={t:"s",v:D},ie=Y.getAttribute("data-t")||Y.getAttribute("t")||"";D!=null&&(D.length==0?ae.t=ie||"z":r.raw||D.trim().length==0||ie=="s"||(D==="TRUE"?ae={t:"b",v:!0}:D==="FALSE"?ae={t:"b",v:!1}:isNaN(ca(D))?isNaN(go(D).getDate())||(ae={t:"d",v:$t(D)},r.cellDates||(ae={t:"n",v:An(ae.v)}),ae.z=r.dateNF||nt[14]):ae={t:"n",v:ca(D)})),ae.z===void 0&&Q!=null&&(ae.z=Q);var Z="",le=Y.getElementsByTagName("A");if(le&&le.length)for(var Te=0;Te<le.length&&!(le[Te].hasAttribute("href")&&(Z=le[Te].getAttribute("href"),Z.charAt(0)!="#"));++Te);Z&&Z.charAt(0)!="#"&&(ae.l={Target:Z}),r.dense?(e[S+a]||(e[S+a]=[]),e[S+a][k+o]=ae):e[st({c:k+o,r:S+a})]=ae,f.e.c<k+o&&(f.e.c=k+o),k+=b}}++S}return v.length&&(e["!merges"]=(e["!merges"]||[]).concat(v)),f.e.r=Math.max(f.e.r,S-1+a),e["!ref"]=dt(f),S>=d&&(e["!fullref"]=dt((f.e.r=u.length-w+S-1+a,f))),e}function HE(e,t){var n=t||{},r=n.dense?[]:{};return BE(r,e,t)}function Z8(e,t){return Oi(HE(e,t),t)}function Vv(e){var t="",n=e5(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function e5(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function t5(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=Ct(t.replace(/<[^>]*>/g,""));return[n]}var zv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function GE(e,t){var n=t||{},r=em(e),a=[],o,l,u={name:""},d="",f=0,m,v,y={},T=[],w=n.dense?[]:{},S,A,k={value:""},I="",b=0,P=[],F=-1,Y=-1,D={s:{r:1e6,c:1e7},e:{r:0,c:0}},Q=0,B={},ae=[],ie={},Z=0,le=0,Te=[],ye=1,H=1,ee=[],Ce={Names:[]},re={},Fe=["",""],W=[],N={},G="",U=0,V=!1,q=!1,se=0;for(Yl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=Yl.exec(r);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"":S[1]==="/"?(D.e.c>=D.s.c&&D.e.r>=D.s.r?w["!ref"]=dt(D):w["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=D.e.r&&(w["!fullref"]=w["!ref"],D.e.r=n.sheetRows-1,w["!ref"]=dt(D)),ae.length&&(w["!merges"]=ae),Te.length&&(w["!rows"]=Te),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),T.push(m.name),y[m.name]=w,q=!1):S[0].charAt(S[0].length-2)!=="/"&&(m=ot(S[0],!1),F=Y=-1,D.s.r=D.s.c=1e7,D.e.r=D.e.c=0,w=n.dense?[]:{},ae=[],Te=[],q=!0);break;case"table-row-group":S[1]==="/"?--Q:++Q;break;case"table-row":case"":if(S[1]==="/"){F+=ye,ye=1;break}if(v=ot(S[0],!1),v.?F=v.-1:F==-1&&(F=0),ye=+v["number-rows-repeated"]||1,ye<10)for(se=0;se<ye;++se)Q>0&&(Te[F+se]={level:Q});Y=-1;break;case"covered-table-cell":S[1]!=="/"&&++Y,n.sheetStubs&&(n.dense?(w[F]||(w[F]=[]),w[F][Y]={t:"z"}):w[st({r:F,c:Y})]={t:"z"}),I="",P=[];break;case"table-cell":case"":if(S[0].charAt(S[0].length-2)==="/")++Y,k=ot(S[0],!1),H=parseInt(k["number-columns-repeated"]||"1",10),A={t:"z",v:null},k.formula&&n.cellFormula!=!1&&(A.f=Uv(Ct(k.formula))),(k.||k["value-type"])=="string"&&(A.t="s",A.v=Ct(k["string-value"]||""),n.dense?(w[F]||(w[F]=[]),w[F][Y]=A):w[st({r:F,c:Y})]=A),Y+=H-1;else if(S[1]!=="/"){++Y,I="",b=0,P=[],H=1;var ge=ye?F+ye-1:F;if(Y>D.e.c&&(D.e.c=Y),Y<D.s.c&&(D.s.c=Y),F<D.s.r&&(D.s.r=F),ge>D.e.r&&(D.e.r=ge),k=ot(S[0],!1),W=[],N={},A={t:k.||k["value-type"],v:null},n.cellFormula)if(k.formula&&(k.formula=Ct(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(Z=parseInt(k["number-matrix-rows-spanned"],10)||0,le=parseInt(k["number-matrix-columns-spanned"],10)||0,ie={s:{r:F,c:Y},e:{r:F+Z-1,c:Y+le-1}},A.F=dt(ie),ee.push([ie,A.F])),k.formula)A.f=Uv(k.formula);else for(se=0;se<ee.length;++se)F>=ee[se][0].s.r&&F<=ee[se][0].e.r&&Y>=ee[se][0].s.c&&Y<=ee[se][0].e.c&&(A.F=ee[se][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(Z=parseInt(k["number-rows-spanned"],10)||0,le=parseInt(k["number-columns-spanned"],10)||0,ie={s:{r:F,c:Y},e:{r:F+Z-1,c:Y+le-1}},ae.push(ie)),k["number-columns-repeated"]&&(H=parseInt(k["number-columns-repeated"],10)),A.t){case"boolean":A.t="b",A.v=Kt(k["boolean-value"]);break;case"float":A.t="n",A.v=parseFloat(k.value);break;case"percentage":A.t="n",A.v=parseFloat(k.value);break;case"currency":A.t="n",A.v=parseFloat(k.value);break;case"date":A.t="d",A.v=$t(k["date-value"]),n.cellDates||(A.t="n",A.v=An(A.v)),A.z="m/d/yy";break;case"time":A.t="n",A.v=N4(k["time-value"])/86400,n.cellDates&&(A.t="d",A.v=Ef(A.v)),A.z="HH:MM:SS";break;case"number":A.t="n",A.v=parseFloat(k.);break;default:if(A.t==="string"||A.t==="text"||!A.t)A.t="s",k["string-value"]!=null&&(I=Ct(k["string-value"]),P=[]);else throw new Error("Unsupported value type "+A.t)}}else{if(V=!1,A.t==="s"&&(A.v=I||"",P.length&&(A.R=P),V=b==0),re.Target&&(A.l=re),W.length>0&&(A.c=W,W=[]),I&&n.cellText!==!1&&(A.w=I),V&&(A.t="z",delete A.v),(!V||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=F))for(var ve=0;ve<ye;++ve){if(H=parseInt(k["number-columns-repeated"]||"1",10),n.dense)for(w[F+ve]||(w[F+ve]=[]),w[F+ve][Y]=ve==0?A:Qt(A);--H>0;)w[F+ve][Y+H]=Qt(A);else for(w[st({r:F+ve,c:Y})]=A;--H>0;)w[st({r:F+ve,c:Y+H})]=Qt(A);D.e.c<=Y&&(D.e.c=Y)}H=parseInt(k["number-columns-repeated"]||"1",10),Y+=H-1,H=0,A={},I="",P=[]}re={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((o=a.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((o=a.pop())[0]!==S[3])throw"Bad state: "+o;N.t=I,P.length&&(N.R=P),N.a=G,W.push(N)}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);G="",U=0,I="",b=0,P=[];break;case"creator":S[1]==="/"?G=r.slice(U,S.index):U=S.index+S[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((o=a.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);I="",b=0,P=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(B[u.name]=d,(o=a.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&(d="",u=ot(S[0],!1),a.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ot(S[0],!1),d+=zv[S[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ot(S[0],!1),d+=zv[S[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":d+=r.slice(f,S.index);break}else f=S.index+S[0].length;break;case"named-range":l=ot(S[0],!1),Fe=th(l["cell-range-address"]);var we={Name:l.name,Ref:Fe[0]+"!"+Fe[1]};q&&(we.Sheet=T.length),Ce.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(S[1]==="/"&&(!k||!k["string-value"])){var Je=t5(r.slice(b,S.index));I=(I.length>0?I+`
`:"")+Je[0]}else ot(S[0],!1),b=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{Fe=th(ot(S[0])["target-range-address"]),y[Fe[0]]["!autofilter"]={ref:Fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(re=ot(S[0],!1),!re.href)break;re.Target=Ct(re.href),delete re.href,re.Target.charAt(0)=="#"&&re.Target.indexOf(".")>-1?(Fe=th(re.Target.slice(1)),re.Target="#"+Fe[0]+"!"+Fe[1]):re.Target.match(/^\.\.[\\\/]/)&&(re.Target=re.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(S)}}var J={Sheets:y,SheetNames:T,Workbook:Ce};return n.bookSheets&&delete J.Sheets,J}function qv(e,t){t=t||{},jr(e,"META-INF/manifest.xml")&&Nb(_n(e,"META-INF/manifest.xml"),t);var n=Nr(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=GE(qt(n),t);return jr(e,"meta.xml")&&(r.Props=D_(_n(e,"meta.xml"))),r}function jv(e,t){return GE(e,t)}var n5=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+jl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return mn+t}})(),Yv=(function(){var e=function(o){return Ht(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(o,l,u){var d=[];d.push('      <table:table table:name="'+Ht(l.SheetNames[u])+`" table:style-name="ta1">
`);var f=0,m=0,v=xr(o["!ref"]||"A1"),y=o["!merges"]||[],T=0,w=Array.isArray(o);if(o["!cols"])for(m=0;m<=v.e.c;++m)d.push("        <table:table-column"+(o["!cols"][m]?' table:style-name="co'+o["!cols"][m].ods+'"':"")+`></table:table-column>
`);var S="",A=o["!rows"]||[];for(f=0;f<v.s.r;++f)S=A[f]?' table:style-name="ro'+A[f].ods+'"':"",d.push("        <table:table-row"+S+`></table:table-row>
`);for(;f<=v.e.r;++f){for(S=A[f]?' table:style-name="ro'+A[f].ods+'"':"",d.push("        <table:table-row"+S+`>
`),m=0;m<v.s.c;++m)d.push(t);for(;m<=v.e.c;++m){var k=!1,I={},b="";for(T=0;T!=y.length;++T)if(!(y[T].s.c>m)&&!(y[T].s.r>f)&&!(y[T].e.c<m)&&!(y[T].e.r<f)){(y[T].s.c!=m||y[T].s.r!=f)&&(k=!0),I["table:number-columns-spanned"]=y[T].e.c-y[T].s.c+1,I["table:number-rows-spanned"]=y[T].e.r-y[T].s.r+1;break}if(k){d.push(n);continue}var P=st({r:f,c:m}),F=w?(o[f]||[])[m]:o[P];if(F&&F.f&&(I["table:formula"]=Ht(TM(F.f)),F.F&&F.F.slice(0,P.length)==P)){var Y=xr(F.F);I["table:number-matrix-columns-spanned"]=Y.e.c-Y.s.c+1,I["table:number-matrix-rows-spanned"]=Y.e.r-Y.s.r+1}if(!F){d.push(t);continue}switch(F.t){case"b":b=F.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=F.v?"true":"false";break;case"n":b=F.w||String(F.v||0),I["office:value-type"]="float",I["office:value"]=F.v||0;break;case"s":case"str":b=F.v==null?"":F.v,I["office:value-type"]="string";break;case"d":b=F.w||$t(F.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=$t(F.v).toISOString(),I["table:style-name"]="ce1";break;default:d.push(t);continue}var D=e(b);if(F.l&&F.l.Target){var Q=F.l.Target;Q=Q.charAt(0)=="#"?"#"+SM(Q.slice(1)):Q,Q.charAt(0)!="#"&&!Q.match(/^\w+:/)&&(Q="../"+Q),D=Be("text:a",D,{"xlink:href":Q.replace(/&/g,"&amp;")})}d.push("          "+Be("table:table-cell",Be("text:p",D,{}),I)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},a=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var m=0;m<f["!cols"].length;++m)if(f["!cols"][m]){var v=f["!cols"][m];if(v.width==null&&v.wpx==null&&v.wch==null)continue;Mi(v),v.ods=u;var y=f["!cols"][m].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),o.push(`  </style:style>
`),++u}}});var d=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var m=0;m<f["!rows"].length;++m)if(f["!rows"][m]){f["!rows"][m].ods=d;var v=f["!rows"][m].hpx+"px";o.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),o.push(`  </style:style>
`),++d}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,u){var d=[mn],f=jl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=jl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(d.push("<office:document"+f+m+`>
`),d.push(R_().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+f+`>
`),a(d,l),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)d.push(r(l.Sheets[l.SheetNames[v]],l,v));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),u.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function VE(e,t){if(t.bookType=="fods")return Yv(e,t);var n=Kh(),r="",a=[],o=[];return r="mimetype",mt(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",mt(n,r,Yv(e,t)),a.push([r,"text/xml"]),o.push([r,"ContentFile"]),r="styles.xml",mt(n,r,n5(e,t)),a.push([r,"text/xml"]),o.push([r,"StylesFile"]),r="meta.xml",mt(n,r,mn+R_()),a.push([r,"text/xml"]),o.push([r,"MetadataFile"]),r="manifest.rdf",mt(n,r,Db(o)),a.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",mt(n,r,kb(a)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ms(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Th(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):qt(Li(e))}function r5(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):br(Sa(e))}function a5(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}function Fi(e){var t=e.reduce(function(a,o){return a+o.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(a){n.set(a,r),r+=a.length}),n}function Xv(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function i5(e,t){for(var n=(e[t+15]&127)<<7|e[t+14]>>1,r=e[t+14]&1,a=t+13;a>=t;--a)r=r*256+e[a];return(e[t+15]&128?-r:r)*Math.pow(10,n-6176)}function s5(e,t,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,a=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(r&127)<<1;for(var o=0;a>=1;++o,a/=256)e[t+o]=a&255;e[t+15]|=n>=0?0:128}function Zl(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Pt(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function ln(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function Rt(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],a=Zl(e,n),o=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(o){case 0:{for(var d=n[0];e[n[0]++]>=128;);u=e.slice(d,n[0])}break;case 5:l=4,u=e.slice(n[0],n[0]+l),n[0]+=l;break;case 1:l=8,u=e.slice(n[0],n[0]+l),n[0]+=l;break;case 2:l=Zl(e,n),u=e.slice(n[0],n[0]+l),n[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var f={data:u,type:o};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function Pn(e){var t=[];return e.forEach(function(n,r){n.forEach(function(a){a.data&&(t.push(Pt(r*8+a.type)),a.type==2&&t.push(Pt(a.data.length)),t.push(a.data))})}),Fi(t)}function Sm(e,t){return(e==null?void 0:e.map(function(n){return t(n.data)}))||[]}function zr(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=Zl(e,r),o=Rt(e.slice(r[0],r[0]+a));r[0]+=a;var l={id:ln(o[1][0].data),messages:[]};o[2].forEach(function(u){var d=Rt(u.data),f=ln(d[3][0].data);l.messages.push({meta:d,data:e.slice(r[0],r[0]+f)}),r[0]+=f}),(t=o[3])!=null&&t[0]&&(l.merge=ln(o[3][0].data)>>>0>0),n.push(l)}return n}function ro(e){var t=[];return e.forEach(function(n){var r=[];r[1]=[{data:Pt(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Pt(+!!n.merge),type:0}]);var a=[];n.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Pt(l.data.length)}],r[2].push({data:Pn(l.meta),type:2})});var o=Pn(r);t.push(Pt(o.length)),t.push(o),a.forEach(function(l){return t.push(l)})}),Fi(t)}function o5(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=Zl(t,n),a=[];n[0]<t.length;){var o=t[n[0]]&3;if(o==0){var l=t[n[0]++]>>2;if(l<60)++l;else{var u=l-59;l=t[n[0]],u>1&&(l|=t[n[0]+1]<<8),u>2&&(l|=t[n[0]+2]<<16),u>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=u}a.push(t.slice(n[0],n[0]+l)),n[0]+=l;continue}else{var d=0,f=0;if(o==1?(f=(t[n[0]]>>2&7)+4,d=(t[n[0]++]&224)<<3,d|=t[n[0]++]):(f=(t[n[0]++]>>2)+1,o==2?(d=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(d=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[Fi(a)],d==0)throw new Error("Invalid offset 0");if(d>a[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(a.push(a[0].slice(-d)),f-=d;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-d,-d+f))}}var m=Fi(a);if(m.length!=r)throw new Error("Unexpected length: ".concat(m.length," != ").concat(r));return m}function qr(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(o5(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return Fi(t)}function ao(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),a=new Uint8Array(4);t.push(a);var o=Pt(r),l=o.length;t.push(o),r<=60?(l++,t.push(new Uint8Array([r-1<<2]))):r<=256?(l+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(l+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(l+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(l+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),l+=r,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,n+=r}return Fi(t)}function l5(e,t,n,r){var a=ms(e),o=a.getUint32(4,!0),l=(r>1?12:8)+Xv(o&(r>1?3470:398))*4,u=-1,d=-1,f=NaN,m=new Date(2001,0,1);o&512&&(u=a.getUint32(l,!0),l+=4),l+=Xv(o&(r>1?12288:4096))*4,o&16&&(d=a.getUint32(l,!0),l+=4),o&32&&(f=a.getFloat64(l,!0),l+=8),o&64&&(m.setTime(m.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var v;switch(e[2]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:t[d]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:f>0};break;case 7:v={t:"n",v:f/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:n[u]};else if(d>-1)v={t:"s",v:t[d]};else if(!isNaN(f))v={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return v}function c5(e,t,n){var r=ms(e),a=r.getUint32(8,!0),o=12,l=-1,u=-1,d=NaN,f=NaN,m=new Date(2001,0,1);a&1&&(d=i5(e,o),o+=16),a&2&&(f=r.getFloat64(o,!0),o+=8),a&4&&(m.setTime(m.getTime()+r.getFloat64(o,!0)*1e3),o+=8),a&8&&(u=r.getUint32(o,!0),o+=4),a&16&&(l=r.getUint32(o,!0),o+=4);var v;switch(e[1]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:t[u]};break;case 5:v={t:"d",v:m};break;case 6:v={t:"b",v:f>0};break;case 7:v={t:"n",v:f/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:n[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:v={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return v}function rh(e,t){var n=new Uint8Array(32),r=ms(n),a=12,o=0;switch(n[0]=5,e.t){case"n":n[1]=2,s5(n,a,e.v),o|=1,a+=16;break;case"b":n[1]=6,r.setFloat64(a,e.v?1:0,!0),o|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(a,t.indexOf(e.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,o,!0),n.slice(0,a)}function ah(e,t){var n=new Uint8Array(32),r=ms(n),a=12,o=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(a,e.v,!0),o|=32,a+=8;break;case"b":n[2]=6,r.setFloat64(a,e.v?1:0,!0),o|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(a,t.indexOf(e.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,o,!0),n.slice(0,a)}function u5(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return l5(e,t,n,e[0]);case 5:return c5(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function qn(e){var t=Rt(e);return Zl(t[1][0].data)}function Jv(e,t){var n=Rt(t.data),r=ln(n[1][0].data),a=n[3],o=[];return(a||[]).forEach(function(l){var u=Rt(l.data),d=ln(u[1][0].data)>>>0;switch(r){case 1:o[d]=Th(u[3][0].data);break;case 8:{var f=e[qn(u[9][0].data)][0],m=Rt(f.data),v=e[qn(m[1][0].data)][0],y=ln(v.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var T=Rt(v.data);o[d]=T[3].map(function(w){return Th(w.data)}).join("")}break}}),o}function f5(e,t){var n,r,a,o,l,u,d,f,m,v,y,T,w,S,A=Rt(e),k=ln(A[1][0].data)>>>0,I=ln(A[2][0].data)>>>0,b=((r=(n=A[8])==null?void 0:n[0])==null?void 0:r.data)&&ln(A[8][0].data)>0||!1,P,F;if((o=(a=A[7])==null?void 0:a[0])!=null&&o.data&&t!=0)P=(u=(l=A[7])==null?void 0:l[0])==null?void 0:u.data,F=(f=(d=A[6])==null?void 0:d[0])==null?void 0:f.data;else if((v=(m=A[4])==null?void 0:m[0])!=null&&v.data&&t!=1)P=(T=(y=A[4])==null?void 0:y[0])==null?void 0:T.data,F=(S=(w=A[3])==null?void 0:w[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var Y=b?4:1,D=ms(P),Q=[],B=0;B<P.length/2;++B){var ae=D.getUint16(B*2,!0);ae<65535&&Q.push([B,ae])}if(Q.length!=I)throw"Expected ".concat(I," cells, found ").concat(Q.length);var ie=[];for(B=0;B<Q.length-1;++B)ie[Q[B][0]]=F.subarray(Q[B][1]*Y,Q[B+1][1]*Y);return Q.length>=1&&(ie[Q[Q.length-1][0]]=F.subarray(Q[Q.length-1][1]*Y)),{R:k,cells:ie}}function d5(e,t){var n,r=Rt(t.data),a=(n=r==null?void 0:r[7])!=null&&n[0]?ln(r[7][0].data)>>>0>0?1:0:-1,o=Sm(r[5],function(l){return f5(l,a)});return{nrows:ln(r[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(d,f){if(l[u.R][f])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(f));l[u.R][f]=d}),l},[])}}function h5(e,t,n){var r,a=Rt(t.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(ln(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(ln(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=dt(o);var l=Rt(a[4][0].data),u=Jv(e,e[qn(l[4][0].data)][0]),d=(r=l[17])!=null&&r[0]?Jv(e,e[qn(l[17][0].data)][0]):[],f=Rt(l[3][0].data),m=0;f[1].forEach(function(v){var y=Rt(v.data),T=e[qn(y[2][0].data)][0],w=ln(T.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var S=d5(e,T);S.data.forEach(function(A,k){A.forEach(function(I,b){var P=st({r:m+k,c:b}),F=u5(I,u,d);F&&(n[P]=F)})}),m+=S.nrows})}function m5(e,t){var n=Rt(t.data),r={"!ref":"A1"},a=e[qn(n[2][0].data)],o=ln(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return h5(e,a[0],r),r}function p5(e,t){var n,r=Rt(t.data),a={name:(n=r[1])!=null&&n[0]?Th(r[1][0].data):"",sheets:[]},o=Sm(r[2],qn);return o.forEach(function(l){e[l].forEach(function(u){var d=ln(u.meta[1][0].data);d==6e3&&a.sheets.push(m5(e,u))})}),a}function x5(e,t){var n=Nm(),r=Rt(t.data),a=Sm(r[1],qn);if(a.forEach(function(o){e[o].forEach(function(l){var u=ln(l.meta[1][0].data);if(u==2){var d=p5(e,l);d.sheets.forEach(function(f,m){km(n,f,m==0?d.name:d.name+"_"+m,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function ih(e){var t,n,r,a,o={},l=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var f;try{f=qr(d.content)}catch(v){return console.log("?? "+d.content.length+" "+(v.message||v))}var m;try{m=zr(f)}catch(v){return console.log("## "+(v.message||v))}m.forEach(function(v){o[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(r=(n=(t=o==null?void 0:o[1])==null?void 0:t[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&ln(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(d){o[d].forEach(function(f){var m=ln(f.meta[1][0].data)>>>0;if(m==1)if(!u)u=f;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return x5(o,u)}function g5(e,t,n){var r,a,o,l;if(!((r=e[6])!=null&&r[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(o=e[8])==null?void 0:o[0])==null?void 0:l.data)&&ln(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var d=0,f=ms(e[7][0].data),m=0,v=[],y=ms(e[4][0].data),T=0,w=[],S=0;S<t.length;++S){if(t[S]==null){f.setUint16(S*2,65535,!0),y.setUint16(S*2,65535);continue}f.setUint16(S*2,m,!0),y.setUint16(S*2,T,!0);var A,k;switch(typeof t[S]){case"string":A=rh({t:"s",v:t[S]},n),k=ah({t:"s",v:t[S]},n);break;case"number":A=rh({t:"n",v:t[S]},n),k=ah({t:"n",v:t[S]},n);break;case"boolean":A=rh({t:"b",v:t[S]},n),k=ah({t:"b",v:t[S]},n);break;default:throw new Error("Unsupported value "+t[S])}v.push(A),m+=A.length,w.push(k),T+=k.length,++d}for(e[2][0].data=Pt(d);S<e[7][0].data.length/2;++S)f.setUint16(S*2,65535,!0),y.setUint16(S*2,65535,!0);return e[6][0].data=Fi(v),e[3][0].data=Fi(w),d}function v5(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=xr(n["!ref"]);r.s.r=r.s.c=0;var a=!1;r.e.c>9&&(a=!0,r.e.c=9),r.e.r>49&&(a=!0,r.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(dt(r)));var o=cf(n,{range:r,header:1}),l=["~Sh33tJ5~"];o.forEach(function(G){return G.forEach(function(U){typeof U=="string"&&l.push(U)})});var u={},d=[],f=et.read(t.numbers,{type:"base64"});f.FileIndex.map(function(G,U){return[G,f.FullPaths[U]]}).forEach(function(G){var U=G[0],V=G[1];if(U.type==2&&U.name.match(/\.iwa/)){var q=U.content,se=qr(q),ge=zr(se);ge.forEach(function(ve){d.push(ve.id),u[ve.id]={deps:[],location:V,type:ln(ve.messages[0].meta[1][0].data)}})}}),d.sort(function(G,U){return G-U});var m=d.filter(function(G){return G>1}).map(function(G){return[G,Pt(G)]});f.FileIndex.map(function(G,U){return[G,f.FullPaths[U]]}).forEach(function(G){var U=G[0];if(G[1],!!U.name.match(/\.iwa/)){var V=zr(qr(U.content));V.forEach(function(q){q.messages.forEach(function(se){m.forEach(function(ge){q.messages.some(function(ve){return ln(ve.meta[1][0].data)!=11006&&a5(ve.data,ge[1])})&&u[ge[0]].deps.push(q.id)})})})}});for(var v=et.find(f,u[1].location),y=zr(qr(v.content)),T,w=0;w<y.length;++w){var S=y[w];S.id==1&&(T=S)}var A=qn(Rt(T.messages[0].data)[1][0].data);for(v=et.find(f,u[A].location),y=zr(qr(v.content)),w=0;w<y.length;++w)S=y[w],S.id==A&&(T=S);for(A=qn(Rt(T.messages[0].data)[2][0].data),v=et.find(f,u[A].location),y=zr(qr(v.content)),w=0;w<y.length;++w)S=y[w],S.id==A&&(T=S);for(A=qn(Rt(T.messages[0].data)[2][0].data),v=et.find(f,u[A].location),y=zr(qr(v.content)),w=0;w<y.length;++w)S=y[w],S.id==A&&(T=S);var k=Rt(T.messages[0].data);{k[6][0].data=Pt(r.e.r+1),k[7][0].data=Pt(r.e.c+1);var I=qn(k[46][0].data),b=et.find(f,u[I].location),P=zr(qr(b.content));{for(var F=0;F<P.length&&P[F].id!=I;++F);if(P[F].id!=I)throw"Bad ColumnRowUIDMapArchive";var Y=Rt(P[F].messages[0].data);Y[1]=[],Y[2]=[],Y[3]=[];for(var D=0;D<=r.e.c;++D){var Q=[];Q[1]=Q[2]=[{type:0,data:Pt(D+420690)}],Y[1].push({type:2,data:Pn(Q)}),Y[2].push({type:0,data:Pt(D)}),Y[3].push({type:0,data:Pt(D)})}Y[4]=[],Y[5]=[],Y[6]=[];for(var B=0;B<=r.e.r;++B)Q=[],Q[1]=Q[2]=[{type:0,data:Pt(B+726270)}],Y[4].push({type:2,data:Pn(Q)}),Y[5].push({type:0,data:Pt(B)}),Y[6].push({type:0,data:Pt(B)});P[F].messages[0].data=Pn(Y)}b.content=ao(ro(P)),b.size=b.content.length,delete k[46];var ae=Rt(k[4][0].data);{ae[7][0].data=Pt(r.e.r+1);var ie=Rt(ae[1][0].data),Z=qn(ie[2][0].data);b=et.find(f,u[Z].location),P=zr(qr(b.content));{if(P[0].id!=Z)throw"Bad HeaderStorageBucket";var le=Rt(P[0].messages[0].data);for(B=0;B<o.length;++B){var Te=Rt(le[2][0].data);Te[1][0].data=Pt(B),Te[4][0].data=Pt(o[B].length),le[2][B]={type:le[2][0].type,data:Pn(Te)}}P[0].messages[0].data=Pn(le)}b.content=ao(ro(P)),b.size=b.content.length;var ye=qn(ae[2][0].data);b=et.find(f,u[ye].location),P=zr(qr(b.content));{if(P[0].id!=ye)throw"Bad HeaderStorageBucket";for(le=Rt(P[0].messages[0].data),D=0;D<=r.e.c;++D)Te=Rt(le[2][0].data),Te[1][0].data=Pt(D),Te[4][0].data=Pt(r.e.r+1),le[2][D]={type:le[2][0].type,data:Pn(Te)};P[0].messages[0].data=Pn(le)}b.content=ao(ro(P)),b.size=b.content.length;var H=qn(ae[4][0].data);(function(){for(var G=et.find(f,u[H].location),U=zr(qr(G.content)),V,q=0;q<U.length;++q){var se=U[q];se.id==H&&(V=se)}var ge=Rt(V.messages[0].data);{ge[3]=[];var ve=[];l.forEach(function(J,wt){ve[1]=[{type:0,data:Pt(wt)}],ve[2]=[{type:0,data:Pt(1)}],ve[3]=[{type:2,data:r5(J)}],ge[3].push({type:2,data:Pn(ve)})})}V.messages[0].data=Pn(ge);var we=ro(U),Je=ao(we);G.content=Je,G.size=G.content.length})();var ee=Rt(ae[3][0].data);{var Ce=ee[1][0];delete ee[2];var re=Rt(Ce.data);{var Fe=qn(re[2][0].data);(function(){for(var G=et.find(f,u[Fe].location),U=zr(qr(G.content)),V,q=0;q<U.length;++q){var se=U[q];se.id==Fe&&(V=se)}var ge=Rt(V.messages[0].data);{delete ge[6],delete ee[7];var ve=new Uint8Array(ge[5][0].data);ge[5]=[];for(var we=0,Je=0;Je<=r.e.r;++Je){var J=Rt(ve);we+=g5(J,o[Je],l),J[1][0].data=Pt(Je),ge[5].push({data:Pn(J),type:2})}ge[1]=[{type:0,data:Pt(r.e.c+1)}],ge[2]=[{type:0,data:Pt(r.e.r+1)}],ge[3]=[{type:0,data:Pt(we)}],ge[4]=[{type:0,data:Pt(r.e.r+1)}]}V.messages[0].data=Pn(ge);var wt=ro(U),rt=ao(wt);G.content=rt,G.size=G.content.length})()}Ce.data=Pn(re)}ae[3][0].data=Pn(ee)}k[4][0].data=Pn(ae)}T.messages[0].data=Pn(k);var W=ro(y),N=ao(W);return v.content=N,v.size=v.content.length,f}function zE(e){return function(n){for(var r=0;r!=e.length;++r){var a=e[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function wm(e){zE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Am(e){zE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function y5(e){return gt.WS.indexOf(e)>-1?"sheet":e==gt.CS?"chart":e==gt.DS?"dialog":e==gt.MS?"macro":e&&e.length?e:"sheet"}function _5(e,t){if(!e)return 0;try{e=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,y5(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function E5(e,t,n,r,a,o,l,u,d,f,m,v){try{o[r]=Fl(Nr(e,n,!0),t);var y=_n(e,t),T;switch(u){case"sheet":T=z6(y,t,a,d,o[r],f,m,v);break;case"chart":if(T=q6(y,t,a,d,o[r],f,m,v),!T||!T["!drawel"])break;var w=Al(T["!drawel"].Target,t),S=Xl(w),A=RR(Nr(e,w,!0),Fl(Nr(e,S,!0),w)),k=Al(A,w),I=Xl(k);T=g6(Nr(e,k,!0),k,d,Fl(Nr(e,I,!0),k),f,T);break;case"macro":T=j6(y,t,a,d,o[r],f,m,v);break;case"dialog":T=Y6(y,t,a,d,o[r],f,m,v);break;default:throw new Error("Unrecognized sheet type "+u)}l[r]=T;var b=[];o&&o[r]&&cn(o[r]).forEach(function(P){var F="";if(o[r][P].Type==gt.CMNT){F=Al(o[r][P].Target,t);var Y=K6(_n(e,F,!0),F,d);if(!Y||!Y.length)return;Iv(T,Y,!1)}o[r][P].Type==gt.TCMNT&&(F=Al(o[r][P].Target,t),b=b.concat(MR(_n(e,F,!0),d)))}),b&&b.length&&Iv(T,b,!0,d.people||[])}catch(P){if(d.WTF)throw P}}function Gr(e){return e.charAt(0)=="/"?e.slice(1):e}function T5(e,t){if(Eo(),t=t||{},wm(t),jr(e,"META-INF/manifest.xml")||jr(e,"objectdata.xml"))return qv(e,t);if(jr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ih<"u"){if(e.FileIndex)return ih(e);var n=et.utils.cfb_new();return ev(e).forEach(function(Te){mt(n,Te,I4(e,Te))}),ih(n)}throw new Error("Unsupported NUMBERS file")}if(!jr(e,"[Content_Types].xml"))throw jr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):jr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=ev(e),a=Cb(Nr(e,"[Content_Types].xml")),o=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",_n(e,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!_n(e,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var d={},f={};if(!t.bookSheets&&!t.bookProps){if(Ll=[],a.sst)try{Ll=W6(_n(e,Gr(a.sst)),a.sst,t)}catch(Te){if(t.WTF)throw Te}t.cellStyles&&a.themes.length&&(d=J6(Nr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(f=X6(_n(e,Gr(a.style)),a.style,d,t))}a.links.map(function(Te){try{var ye=Fl(Nr(e,Xl(Gr(Te))),Te);return Q6(_n(e,Gr(Te)),ye,Te,t)}catch{}});var m=V6(_n(e,Gr(a.workbooks[0])),a.workbooks[0],t),v={},y="";a.coreprops.length&&(y=_n(e,Gr(a.coreprops[0]),!0),y&&(v=D_(y)),a.extprops.length!==0&&(y=_n(e,Gr(a.extprops[0]),!0),y&&Ib(y,v,t)));var T={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(y=Nr(e,Gr(a.custprops[0]),!0),y&&(T=Lb(y,t)));var w={};if((t.bookSheets||t.bookProps)&&(m.Sheets?l=m.Sheets.map(function(ye){return ye.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),t.bookProps&&(w.Props=v,w.Custprops=T),t.bookSheets&&typeof l<"u"&&(w.SheetNames=l),t.bookSheets?w.SheetNames:t.bookProps))return w;l={};var S={};t.bookDeps&&a.calcchain&&(S=$6(_n(e,Gr(a.calcchain)),a.calcchain));var A=0,k={},I,b;{var P=m.Sheets;v.Worksheets=P.length,v.SheetNames=[];for(var F=0;F!=P.length;++F)v.SheetNames[F]=P[F].name}var Y=o?"bin":"xml",D=a.workbooks[0].lastIndexOf("/"),Q=(a.workbooks[0].slice(0,D+1)+"_rels/"+a.workbooks[0].slice(D+1)+".rels").replace(/^\//,"");jr(e,Q)||(Q="xl/_rels/workbook."+Y+".rels");var B=Fl(Nr(e,Q,!0),Q.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Z6(_n(e,Gr(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=FR(_n(e,Gr(a.people[0])),t)),B&&(B=_5(B,m.Sheets));var ae=_n(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(A=0;A!=v.Worksheets;++A){var ie="sheet";if(B&&B[A]?(I="xl/"+B[A][1].replace(/[\/]?xl\//,""),jr(e,I)||(I=B[A][1]),jr(e,I)||(I=Q.replace(/_rels\/.*$/,"")+B[A][1]),ie=B[A][2]):(I="xl/worksheets/sheet"+(A+1-ae)+"."+Y,I=I.replace(/sheet0\./,"sheet.")),b=I.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(A!=t.sheets)continue e;break;case"string":if(v.SheetNames[A].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Z=!1,le=0;le!=t.sheets.length;++le)typeof t.sheets[le]=="number"&&t.sheets[le]==A&&(Z=1),typeof t.sheets[le]=="string"&&t.sheets[le].toLowerCase()==v.SheetNames[A].toLowerCase()&&(Z=1);if(!Z)continue e}}E5(e,I,b,v.SheetNames[A],A,k,l,ie,t,m,d,f)}return w={Directory:a,Workbook:m,Props:v,Custprops:T,Deps:S,Sheets:l,SheetNames:v.SheetNames,Strings:Ll,Styles:f,Themes:d,SSF:Qt(nt)},t&&t.bookFiles&&(e.files?(w.keys=r,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(Te,ye){Te=Te.replace(/^Root Entry[\/]/,""),w.keys.push(Te),w.files[Te]=e.FileIndex[ye]}))),t&&t.bookVBA&&(a.vba.length>0?w.vbaraw=_n(e,Gr(a.vba[0]),!0):a.defaults&&a.defaults.bin===VR&&(w.vbaraw=_n(e,"xl/vbaProject.bin",!0))),w}function S5(e,t){var n=t||{},r="Workbook",a=et.find(e,r);try{if(r="/!DataSpaces/Version",a=et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(Zk(a.content),r="/!DataSpaces/DataSpaceMap",a=et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=t3(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=n3(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);a3(a.content)}catch{}if(r="/EncryptionInfo",a=et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var u=i3(a.content);if(r="/EncryptedPackage",a=et.find(e,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,n.password||"",n);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function w5(e,t){return t.bookType=="ods"?VE(e,t):t.bookType=="numbers"?v5(e,t):t.bookType=="xlsb"?A5(e,t):C5(e,t)}function A5(e,t){oo=1024,e&&!e.SSF&&(e.SSF=Qt(nt)),e&&e.SSF&&(Eo(),vf(e.SSF),t.revssf=_f(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ol?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",r=xE.indexOf(t.bookType)>-1,a=um();Am(t=t||{});var o=Kh(),l="",u=0;if(t.cellXfs=[],Pi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",mt(o,l,M_(e.Props,t)),a.coreprops.push(l),Bt(t.rels,2,l,gt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(e.SheetNames[f]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,mt(o,l,L_(e.Props)),a.extprops.push(l),Bt(t.rels,3,l,gt.EXT_PROPS),e.Custprops!==e.Props&&cn(e.Custprops||{}).length>0&&(l="docProps/custom.xml",mt(o,l,O_(e.Custprops)),a.custprops.push(l),Bt(t.rels,4,l,gt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var m={"!id":{}},v=e.Sheets[e.SheetNames[u-1]],y=(v||{})["!type"]||"sheet";switch(y){case"chart":default:l="xl/worksheets/sheet"+u+"."+n,mt(o,l,t8(u-1,l,t,e,m)),a.sheets.push(l),Bt(t.wbrels,-1,"worksheets/sheet"+u+"."+n,gt.WS[0])}if(v){var T=v["!comments"],w=!1,S="";T&&T.length>0&&(S="xl/comments"+u+"."+n,mt(o,S,a8(T,S)),a.comments.push(S),Bt(m,-1,"../comments"+u+"."+n,gt.CMNT),w=!0),v["!legacy"]&&w&&mt(o,"xl/drawings/vmlDrawing"+u+".vml",mE(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}m["!id"].rId1&&mt(o,Xl(l),fo(m))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+n,mt(o,l,r8(t.Strings,l,t)),a.strs.push(l),Bt(t.wbrels,-1,"sharedStrings."+n,gt.SST)),l="xl/workbook."+n,mt(o,l,e8(e,l)),a.workbooks.push(l),Bt(t.rels,1,l,gt.WB),l="xl/theme/theme1.xml",mt(o,l,xm(e.Themes,t)),a.themes.push(l),Bt(t.wbrels,-1,"theme/theme1.xml",gt.THEME),l="xl/styles."+n,mt(o,l,n8(e,l,t)),a.styles.push(l),Bt(t.wbrels,-1,"styles."+n,gt.STY),e.vbaraw&&r&&(l="xl/vbaProject.bin",mt(o,l,e.vbaraw),a.vba.push(l),Bt(t.wbrels,-1,"vbaProject.bin",gt.VBA)),l="xl/metadata."+n,mt(o,l,i8(l)),a.metadata.push(l),Bt(t.wbrels,-1,"metadata."+n,gt.XLMETA),mt(o,"[Content_Types].xml",k_(a,t)),mt(o,"_rels/.rels",fo(t.rels)),mt(o,"xl/_rels/workbook."+n+".rels",fo(t.wbrels)),delete t.revssf,delete t.ssf,o}function C5(e,t){oo=1024,e&&!e.SSF&&(e.SSF=Qt(nt)),e&&e.SSF&&(Eo(),vf(e.SSF),t.revssf=_f(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ol?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=xE.indexOf(t.bookType)>-1,a=um();Am(t=t||{});var o=Kh(),l="",u=0;if(t.cellXfs=[],Pi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",mt(o,l,M_(e.Props,t)),a.coreprops.push(l),Bt(t.rels,2,l,gt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(e.SheetNames[f]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,mt(o,l,L_(e.Props)),a.extprops.push(l),Bt(t.rels,3,l,gt.EXT_PROPS),e.Custprops!==e.Props&&cn(e.Custprops||{}).length>0&&(l="docProps/custom.xml",mt(o,l,O_(e.Custprops)),a.custprops.push(l),Bt(t.rels,4,l,gt.CUST_PROPS));var m=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var v={"!id":{}},y=e.Sheets[e.SheetNames[u-1]],T=(y||{})["!type"]||"sheet";switch(T){case"chart":default:l="xl/worksheets/sheet"+u+"."+n,mt(o,l,bE(u-1,t,e,v)),a.sheets.push(l),Bt(t.wbrels,-1,"worksheets/sheet"+u+"."+n,gt.WS[0])}if(y){var w=y["!comments"],S=!1,A="";if(w&&w.length>0){var k=!1;w.forEach(function(I){I[1].forEach(function(b){b.T==!0&&(k=!0)})}),k&&(A="xl/threadedComments/threadedComment"+u+"."+n,mt(o,A,IR(w,m,t)),a.threadedcomments.push(A),Bt(v,-1,"../threadedComments/threadedComment"+u+"."+n,gt.TCMNT)),A="xl/comments"+u+"."+n,mt(o,A,pE(w)),a.comments.push(A),Bt(v,-1,"../comments"+u+"."+n,gt.CMNT),S=!0}y["!legacy"]&&S&&mt(o,"xl/drawings/vmlDrawing"+u+".vml",mE(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}v["!id"].rId1&&mt(o,Xl(l),fo(v))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+n,mt(o,l,nE(t.Strings,t)),a.strs.push(l),Bt(t.wbrels,-1,"sharedStrings."+n,gt.SST)),l="xl/workbook."+n,mt(o,l,ME(e)),a.workbooks.push(l),Bt(t.rels,1,l,gt.WB),l="xl/theme/theme1.xml",mt(o,l,xm(e.Themes,t)),a.themes.push(l),Bt(t.wbrels,-1,"theme/theme1.xml",gt.THEME),l="xl/styles."+n,mt(o,l,uE(e,t)),a.styles.push(l),Bt(t.wbrels,-1,"styles."+n,gt.STY),e.vbaraw&&r&&(l="xl/vbaProject.bin",mt(o,l,e.vbaraw),a.vba.push(l),Bt(t.wbrels,-1,"vbaProject.bin",gt.VBA)),l="xl/metadata."+n,mt(o,l,hE()),a.metadata.push(l),Bt(t.wbrels,-1,"metadata."+n,gt.XLMETA),m.length>1&&(l="xl/persons/person.xml",mt(o,l,LR(m)),a.people.push(l),Bt(t.wbrels,-1,"persons/person.xml",gt.PEOPLE)),mt(o,"[Content_Types].xml",k_(a,t)),mt(o,"_rels/.rels",fo(t.rels)),mt(o,"xl/_rels/workbook."+n+".rels",fo(t.wbrels)),delete t.revssf,delete t.ssf,o}function Cm(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=kr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function b5(e,t){return et.find(e,"EncryptedPackage")?S5(e,t):OE(e,t)}function N5(e,t){var n,r=e,a=t||{};return a.type||(a.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),n=a_(r,a),T5(n,a)}function qE(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return _h(e.slice(n),t);default:break e}return vo.to_workbook(e,t)}function k5(e,t){var n="",r=Cm(e,t);switch(t.type){case"base64":n=kr(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=us(e);break;default:throw new Error("Unrecognized type "+t.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=qt(n)),t.type="binary",qE(n,t)}function R5(e,t){var n=e;return t.type=="base64"&&(n=kr(n)),n=Gl.utils.decode(1200,n.slice(2),"str"),t.type="binary",qE(n,t)}function D5(e){return e.match(/[^\x00-\x7F]/)?Sa(e):e}function sh(e,t,n,r){return r?(n.type="string",vo.to_workbook(e,n)):vo.to_workbook(t,n)}function Sh(e,t){jh();var n=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Sh(new Uint8Array(e),(n=Qt(n),n.type="array",n));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=e,a=[0,0,0,0],o=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),mo={},n.dateNF&&(mo.dateNF=n.dateNF),n.type||(n.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),n.type=="file"&&(n.type=xt?"buffer":"binary",r=A4(e),typeof Uint8Array<"u"&&!xt&&(n.type="array")),n.type=="string"&&(o=!0,n.type="binary",n.codepage=65001,r=D5(e)),n.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return n=Qt(n),n.type="array",Sh(Yh(r),n)}switch((a=Cm(r,n))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return b5(et.read(r,n),n);break;case 9:if(a[1]<=8)return OE(r,n);break;case 60:return _h(r,n);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return Ok(r,n);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return eE.to_workbook(r,n);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?N5(r,n):sh(e,r,n,o);case 239:return a[3]===60?_h(r,n):sh(e,r,n,o);case 255:if(a[1]===254)return R5(r,n);if(a[1]===0&&a[2]===2&&a[3]===0)return os.to_workbook(r,n);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return os.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return yh.to_workbook(r,n);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return oE.to_workbook(r,n);break;case 10:case 13:case 32:return k5(r,n);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Lk.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?yh.to_workbook(r,n):sh(e,r,n,o)}function jE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return nc(t.file,et.write(e,{type:xt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return et.write(e,t)}function M5(e,t){var n=Qt(t||{}),r=w5(e,n);return I5(r,n)}function I5(e,t){var n={},r=xt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?et.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(gf(a))}return t.password&&typeof encrypt_agile<"u"?jE(encrypt_agile(a,t.password),t):t.type==="file"?nc(t.file,a):t.type=="string"?qt(a):a}function F5(e,t){var n=t||{},r=D8(e,n);return jE(r,n)}function Ta(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return Vl(Sa(r));case"binary":return Sa(r);case"string":return e;case"file":return nc(t.file,r,"utf8");case"buffer":return xt?$a(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ta(r,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function L5(e,t){switch(t.type){case"base64":return Vl(e);case"binary":return e;case"string":return e;case"file":return nc(t.file,e,"binary");case"buffer":return xt?$a(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Fu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return t.type=="base64"?Vl(n):t.type=="string"?qt(n):n;case"file":return nc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function YE(e,t){jh(),b6(e);var n=Qt(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=YE(e,n);return n.type="array",gf(r)}var a=0;if(n.sheet&&(typeof n.sheet=="number"?a=n.sheet:a=e.SheetNames.indexOf(n.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Ta(w8(e,n),n);case"slk":case"sylk":return Ta(Z_.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"htm":case"html":return Ta(UE(e.Sheets[e.SheetNames[a]],n),n);case"txt":return L5(XE(e.Sheets[e.SheetNames[a]],n),n);case"csv":return Ta(bm(e.Sheets[e.SheetNames[a]],n),n,"\uFEFF");case"dif":return Ta(eE.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"dbf":return Fu(yh.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"prn":return Ta(vo.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"rtf":return Ta(oE.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"eth":return Ta(tE.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"fods":return Ta(VE(e,n),n);case"wk1":return Fu(os.sheet_to_wk1(e.Sheets[e.SheetNames[a]],n),n);case"wk3":return Fu(os.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Fu(PE(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),F5(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return M5(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function O5(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function P5(e,t,n){var r={};return r.type="file",r.file=t,O5(r),YE(e,r)}function U5(e,t,n,r,a,o,l,u){var d=hn(n),f=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,y=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:n,enumerable:!1})}catch{y.__rowNum__=n}else y.__rowNum__=n;if(!l||e[n])for(var T=t.s.c;T<=t.e.c;++T){var w=l?e[n][T]:e[r[T]+d];if(w===void 0||w.t===void 0){if(f===void 0)continue;o[T]!=null&&(y[o[T]]=f);continue}var S=w.v;switch(w.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(o[T]!=null){if(S==null)if(w.t=="e"&&S===null)y[o[T]]=null;else if(f!==void 0)y[o[T]]=f;else if(m&&S===null)y[o[T]]=null;else continue;else y[o[T]]=m&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?S:Wa(w,S,u);S!=null&&(v=!1)}}return{row:y,isempty:v}}function cf(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,o=[],l=0,u="",d={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},m=f.range!=null?f.range:e["!ref"];switch(f.header===1?r=1:f.header==="A"?r=2:Array.isArray(f.header)?r=3:f.header==null&&(r=0),typeof m){case"string":d=bt(m);break;case"number":d=bt(e["!ref"]),d.s.r=m;break;default:d=m}r>0&&(a=0);var v=hn(d.s.r),y=[],T=[],w=0,S=0,A=Array.isArray(e),k=d.s.r,I=0,b={};A&&!e[k]&&(e[k]=[]);var P=f.skipHidden&&e["!cols"]||[],F=f.skipHidden&&e["!rows"]||[];for(I=d.s.c;I<=d.e.c;++I)if(!(P[I]||{}).hidden)switch(y[I]=nn(I),n=A?e[k][I]:e[y[I]+v],r){case 1:o[I]=I-d.s.c;break;case 2:o[I]=y[I];break;case 3:o[I]=f.header[I-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),u=l=Wa(n,null,f),S=b[l]||0,!S)b[l]=1;else{do u=l+"_"+S++;while(b[u]);b[l]=S,b[u]=1}o[I]=u}for(k=d.s.r+a;k<=d.e.r;++k)if(!(F[k]||{}).hidden){var Y=U5(e,d,k,y,r,o,A,f);(Y.isempty===!1||(r===1?f.blankrows!==!1:f.blankrows))&&(T[w++]=Y.row)}return T.length=w,T}var Wv=/"/g;function B5(e,t,n,r,a,o,l,u){for(var d=!0,f=[],m="",v=hn(n),y=t.s.c;y<=t.e.c;++y)if(r[y]){var T=u.dense?(e[n]||[])[y]:e[r[y]+v];if(T==null)m="";else if(T.v!=null){d=!1,m=""+(u.rawNumbers&&T.t=="n"?T.v:Wa(T,null,u));for(var w=0,S=0;w!==m.length;++w)if((S=m.charCodeAt(w))===a||S===o||S===34||u.forceQuotes){m='"'+m.replace(Wv,'""')+'"';break}m=="ID"&&(m='"ID"')}else T.f!=null&&!T.F?(d=!1,m="="+T.f,m.indexOf(",")>=0&&(m='"'+m.replace(Wv,'""')+'"')):m="";f.push(m)}return u.blankrows===!1&&d?null:f.join(l)}function bm(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var a=bt(e["!ref"]),o=r.FS!==void 0?r.FS:",",l=o.charCodeAt(0),u=r.RS!==void 0?r.RS:`
`,d=u.charCodeAt(0),f=new RegExp((o=="|"?"\\|":o)+"+$"),m="",v=[];r.dense=Array.isArray(e);for(var y=r.skipHidden&&e["!cols"]||[],T=r.skipHidden&&e["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(y[w]||{}).hidden||(v[w]=nn(w));for(var S=0,A=a.s.r;A<=a.e.r;++A)(T[A]||{}).hidden||(m=B5(e,a,A,v,l,d,o,r),m!=null&&(r.strip&&(m=m.replace(f,"")),(m||r.blankrows!==!1)&&n.push((S++?u:"")+m)));return delete r.dense,n.join("")}function XE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=bm(e,t);return n}function H5(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var a=bt(e["!ref"]),o="",l=[],u,d=[],f=Array.isArray(e);for(u=a.s.c;u<=a.e.c;++u)l[u]=nn(u);for(var m=a.s.r;m<=a.e.r;++m)for(o=hn(m),u=a.s.c;u<=a.e.c;++u)if(t=l[u]+o,n=f?(e[m]||[])[u]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}d[d.length]=t+"="+r}return d}function JE(e,t,n){var r=n||{},a=+!r.skipHeader,o=e||{},l=0,u=0;if(o&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?rn(r.origin):r.origin;l=d.r,u=d.c}var f,m={s:{c:0,r:0},e:{c:u,r:l+t.length-1+a}};if(o["!ref"]){var v=bt(o["!ref"]);m.e.c=Math.max(m.e.c,v.e.c),m.e.r=Math.max(m.e.r,v.e.r),l==-1&&(l=v.e.r+1,m.e.r=l+t.length-1+a)}else l==-1&&(l=0,m.e.r=t.length-1+a);var y=r.header||[],T=0;t.forEach(function(S,A){cn(S).forEach(function(k){(T=y.indexOf(k))==-1&&(y[T=y.length]=k);var I=S[k],b="z",P="",F=st({c:u+T,r:l+A+a});f=ec(o,F),I&&typeof I=="object"&&!(I instanceof Date)?o[F]=I:(typeof I=="number"?b="n":typeof I=="boolean"?b="b":typeof I=="string"?b="s":I instanceof Date?(b="d",r.cellDates||(b="n",I=An(I)),P=r.dateNF||nt[14]):I===null&&r.nullError&&(b="e",I=0),f?(f.t=b,f.v=I,delete f.w,delete f.R,P&&(f.z=P)):o[F]=f={t:b,v:I},P&&(f.z=P))})}),m.e.c=Math.max(m.e.c,u+y.length-1);var w=hn(l);if(a)for(T=0;T<y.length;++T)o[nn(T+u)+w]={t:"s",v:y[T]};return o["!ref"]=dt(m),o}function G5(e,t){return JE(null,e,t)}function ec(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=rn(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ec(e,st(t)):ec(e,st({r:t,c:n||0}))}function V5(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Nm(){return{SheetNames:[],Sheets:{}}}function km(e,t,n,r){var a=1;if(!n)for(;a<=65535&&e.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var o=n.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||n;for(++a;a<=65535&&e.SheetNames.indexOf(n=l+a)!=-1;++a);}if(DE(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function z5(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=V5(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function q5(e,t){return e.z=t,e}function WE(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function j5(e,t,n){return WE(e,"#"+t,n)}function Y5(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function X5(e,t,n,r){for(var a=typeof t!="string"?t:bt(t),o=typeof t=="string"?t:dt(t),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var d=ec(e,l,u);d.t="n",d.F=o,delete d.v,l==a.s.r&&u==a.s.c&&(d.f=n,r&&(d.D=!0))}return e}var Lu={encode_col:nn,encode_row:hn,encode_cell:st,encode_range:dt,decode_col:am,decode_row:rm,split_cell:rb,decode_cell:rn,decode_range:xr,format_cell:Wa,sheet_add_aoa:T_,sheet_add_json:JE,sheet_add_dom:BE,aoa_to_sheet:To,json_to_sheet:G5,table_to_sheet:HE,table_to_book:Z8,sheet_to_csv:bm,sheet_to_txt:XE,sheet_to_json:cf,sheet_to_html:UE,sheet_to_formulae:H5,sheet_to_row_object_array:cf,sheet_get_cell:ec,book_new:Nm,book_append_sheet:km,book_set_sheet_visibility:z5,cell_set_number_format:q5,cell_set_hyperlink:WE,cell_set_internal_link:j5,cell_add_comment:Y5,sheet_set_array_formula:X5,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},it=(e=>(e.Male="Male",e.Female="Female",e.Unspecified="Unspecified",e))(it||{}),J5={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let W5,K5;function $5(){return{geminiUrl:W5,vertexUrl:K5}}function Q5(e,t,n,r){var a,o;if(!(e!=null&&e.baseUrl)){const l=$5();return t?(a=l.vertexUrl)!==null&&a!==void 0?a:n:(o=l.geminiUrl)!==null&&o!==void 0?o:r}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ei{}function qe(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,a)=>{if(Object.prototype.hasOwnProperty.call(t,a)){const o=t[a];return o!=null?String(o):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function x(e,t,n){for(let o=0;o<t.length-1;o++){const l=t[o];if(l.endsWith("[]")){const u=l.slice(0,-2);if(!(u in e))if(Array.isArray(n))e[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[u])){const d=e[u];if(Array.isArray(n))for(let f=0;f<d.length;f++){const m=d[f];x(m,t.slice(o+1),n[f])}else for(const f of d)x(f,t.slice(o+1),n)}return}else if(l.endsWith("[0]")){const u=l.slice(0,-3);u in e||(e[u]=[{}]);const d=e[u];x(d[0],t.slice(o+1),n);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const r=t[t.length-1],a=e[r];if(a!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===a)return;if(typeof a=="object"&&typeof n=="object"&&a!==null&&n!==null)Object.assign(a,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(e,n):e[r]=n}function p(e,t,n=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let r=0;r<t.length;r++){if(typeof e!="object"||e===null)return n;const a=t[r];if(a.endsWith("[]")){const o=a.slice(0,-2);if(o in e){const l=e[o];return Array.isArray(l)?l.map(u=>p(u,t.slice(r+1),n)):n}else return n}else e=e[a]}return e}catch(r){if(r instanceof TypeError)return n;throw r}}function Z5(e,t){for(const[n,r]of Object.entries(t)){const a=n.split("."),o=r.split("."),l=new Set;let u=-1;for(let d=0;d<a.length;d++)if(a[d]==="*"){u=d;break}if(u!==-1&&o.length>u)for(let d=u;d<o.length;d++){const f=o[d];f!=="*"&&!f.endsWith("[]")&&!f.endsWith("[0]")&&l.add(f)}wh(e,a,o,0,l)}}function wh(e,t,n,r,a){if(r>=t.length||typeof e!="object"||e===null)return;const o=t[r];if(o.endsWith("[]")){const l=o.slice(0,-2),u=e;if(l in u&&Array.isArray(u[l]))for(const d of u[l])wh(d,t,n,r+1,a)}else if(o==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const l=e,u=Object.keys(l).filter(f=>!f.startsWith("_")&&!a.has(f)),d={};for(const f of u)d[f]=l[f];for(const[f,m]of Object.entries(d)){const v=[];for(const y of n.slice(r))y==="*"?v.push(f):v.push(y);x(l,v,m)}for(const f of u)delete l[f]}}else{const l=e;o in l&&wh(l[o],t,n,r+1,a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Rm(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eF(e){const t={},n=p(e,["operationName"]);n!=null&&x(t,["operationName"],n);const r=p(e,["resourceName"]);return r!=null&&x(t,["_url","resourceName"],r),t}function tF(e){const t={},n=p(e,["name"]);n!=null&&x(t,["name"],n);const r=p(e,["metadata"]);r!=null&&x(t,["metadata"],r);const a=p(e,["done"]);a!=null&&x(t,["done"],a);const o=p(e,["error"]);o!=null&&x(t,["error"],o);const l=p(e,["response","generateVideoResponse"]);return l!=null&&x(t,["response"],rF(l)),t}function nF(e){const t={},n=p(e,["name"]);n!=null&&x(t,["name"],n);const r=p(e,["metadata"]);r!=null&&x(t,["metadata"],r);const a=p(e,["done"]);a!=null&&x(t,["done"],a);const o=p(e,["error"]);o!=null&&x(t,["error"],o);const l=p(e,["response"]);return l!=null&&x(t,["response"],aF(l)),t}function rF(e){const t={},n=p(e,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>iF(l))),x(t,["generatedVideos"],o)}const r=p(e,["raiMediaFilteredCount"]);r!=null&&x(t,["raiMediaFilteredCount"],r);const a=p(e,["raiMediaFilteredReasons"]);return a!=null&&x(t,["raiMediaFilteredReasons"],a),t}function aF(e){const t={},n=p(e,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(l=>sF(l))),x(t,["generatedVideos"],o)}const r=p(e,["raiMediaFilteredCount"]);r!=null&&x(t,["raiMediaFilteredCount"],r);const a=p(e,["raiMediaFilteredReasons"]);return a!=null&&x(t,["raiMediaFilteredReasons"],a),t}function iF(e){const t={},n=p(e,["video"]);return n!=null&&x(t,["video"],dF(n)),t}function sF(e){const t={},n=p(e,["_self"]);return n!=null&&x(t,["video"],hF(n)),t}function oF(e){const t={},n=p(e,["operationName"]);return n!=null&&x(t,["_url","operationName"],n),t}function lF(e){const t={},n=p(e,["operationName"]);return n!=null&&x(t,["_url","operationName"],n),t}function cF(e){const t={},n=p(e,["name"]);n!=null&&x(t,["name"],n);const r=p(e,["metadata"]);r!=null&&x(t,["metadata"],r);const a=p(e,["done"]);a!=null&&x(t,["done"],a);const o=p(e,["error"]);o!=null&&x(t,["error"],o);const l=p(e,["response"]);return l!=null&&x(t,["response"],uF(l)),t}function uF(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["parent"]);r!=null&&x(t,["parent"],r);const a=p(e,["documentName"]);return a!=null&&x(t,["documentName"],a),t}function KE(e){const t={},n=p(e,["name"]);n!=null&&x(t,["name"],n);const r=p(e,["metadata"]);r!=null&&x(t,["metadata"],r);const a=p(e,["done"]);a!=null&&x(t,["done"],a);const o=p(e,["error"]);o!=null&&x(t,["error"],o);const l=p(e,["response"]);return l!=null&&x(t,["response"],fF(l)),t}function fF(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["parent"]);r!=null&&x(t,["parent"],r);const a=p(e,["documentName"]);return a!=null&&x(t,["documentName"],a),t}function dF(e){const t={},n=p(e,["uri"]);n!=null&&x(t,["uri"],n);const r=p(e,["encodedVideo"]);r!=null&&x(t,["videoBytes"],Rm(r));const a=p(e,["encoding"]);return a!=null&&x(t,["mimeType"],a),t}function hF(e){const t={},n=p(e,["gcsUri"]);n!=null&&x(t,["uri"],n);const r=p(e,["bytesBase64Encoded"]);r!=null&&x(t,["videoBytes"],Rm(r));const a=p(e,["mimeType"]);return a!=null&&x(t,["mimeType"],a),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Kv;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Kv||(Kv={}));var $v;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})($v||($v={}));var Qv;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(Qv||(Qv={}));var mr;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(mr||(mr={}));var Zv;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Zv||(Zv={}));var ey;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(ey||(ey={}));var ty;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(ty||(ty={}));var ny;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(ny||(ny={}));var ry;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(ry||(ry={}));var ay;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(ay||(ay={}));var iy;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(iy||(iy={}));var sy;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.MINIMAL="MINIMAL"})(sy||(sy={}));var oy;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(oy||(oy={}));var ly;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(ly||(ly={}));var cy;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(cy||(cy={}));var uy;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE",e.IMAGE_RECITATION="IMAGE_RECITATION",e.IMAGE_OTHER="IMAGE_OTHER"})(uy||(uy={}));var fy;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(fy||(fy={}));var dy;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(dy||(dy={}));var hy;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(hy||(hy={}));var my;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(my||(my={}));var py;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(py||(py={}));var uf;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(uf||(uf={}));var xy;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(xy||(xy={}));var gy;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(gy||(gy={}));var vy;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(vy||(vy={}));var Ah;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Ah||(Ah={}));var yy;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(yy||(yy={}));var _y;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",e.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(_y||(_y={}));var Ch;(function(e){e.COLLECTION="COLLECTION"})(Ch||(Ch={}));var Ey;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(Ey||(Ey={}));var Ty;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Ty||(Ty={}));var Sy;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(Sy||(Sy={}));var wy;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(wy||(wy={}));var Ay;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(Ay||(Ay={}));var Cy;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Cy||(Cy={}));var by;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(by||(by={}));var Ny;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Ny||(Ny={}));var ky;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(ky||(ky={}));var Ry;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(Ry||(Ry={}));var Dy;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(Dy||(Dy={}));var My;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(My||(My={}));var Iy;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(Iy||(Iy={}));var Fy;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING",e.DISTILLATION="DISTILLATION"})(Fy||(Fy={}));var Ly;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(Ly||(Ly={}));var Oy;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(Oy||(Oy={}));var Py;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED",e.REGISTERED="REGISTERED"})(Py||(Py={}));var Uy;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Uy||(Uy={}));var By;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(By||(By={}));var Hy;(function(e){e.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",e.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",e.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Hy||(Hy={}));var Gy;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.ACTIVITY_START="ACTIVITY_START",e.ACTIVITY_END="ACTIVITY_END"})(Gy||(Gy={}));var Vy;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Vy||(Vy={}));var zy;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(zy||(zy={}));var qy;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(qy||(qy={}));var jy;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(jy||(jy={}));var Yy;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Yy||(Yy={}));var Xy;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(Xy||(Xy={}));var lo;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(lo||(lo={}));class bh{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class El{get text(){var t,n,r,a,o,l,u,d;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",m=!1;const v=[];for(const y of(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[T,w]of Object.entries(y))T!=="text"&&T!=="thought"&&T!=="thoughtSignature"&&(w!==null||w!==void 0)&&v.push(T);if(typeof y.text=="string"){if(typeof y.thought=="boolean"&&y.thought)continue;m=!0,f+=y.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),m?f:void 0}get data(){var t,n,r,a,o,l,u,d;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const m=[];for(const v of(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[y,T]of Object.entries(v))y!=="inlineData"&&(T!==null||T!==void 0)&&m.push(y);v.inlineData&&typeof v.inlineData.data=="string"&&(f+=atob(v.inlineData.data))}return m.length>0&&console.warn(`there are non-data parts ${m} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var t,n,r,a,o,l,u,d;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(m=>m.functionCall).map(m=>m.functionCall).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var t,n,r,a,o,l,u,d,f;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const m=(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(f=m==null?void 0:m[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var t,n,r,a,o,l,u,d,f;if(((a=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const m=(d=(u=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(f=m==null?void 0:m[0])===null||f===void 0?void 0:f.output}}class Jy{}class Wy{}class mF{}class pF{}class xF{}class gF{}class Ky{}class $y{}class Qy{}class vF{}class ff{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new ff;let a;const o=t;return n?a=nF(o):a=tF(o),Object.assign(r,a),r}}class Zy{}class e2{}class t2{}class n2{}class yF{}class _F{}class EF{}class Dm{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Dm,o=cF(t);return Object.assign(r,o),r}}class TF{}class SF{}class wF{}class AF{}class r2{}class CF{get text(){var t,n,r;let a="",o=!1;const l=[];for(const u of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(u))d!=="text"&&d!=="thought"&&f!==null&&l.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;o=!0,a+=u.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?a:void 0}get data(){var t,n,r;let a="";const o=[];for(const l of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,d]of Object.entries(l))u!=="inlineData"&&d!==null&&o.push(u);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class bF{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Mm{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Mm,o=KE(t);return Object.assign(r,o),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Dt(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function $E(e,t){const n=Dt(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function QE(e){return Array.isArray(e)?e.map(t=>df(t)):[df(e)]}function df(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function ZE(e){const t=df(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function eT(e){const t=df(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function a2(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function tT(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>a2(t)):[a2(e)]}function Nh(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function i2(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function s2(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Jn(e){if(e==null)throw new Error("ContentUnion is required");return Nh(e)?e:{role:"user",parts:tT(e)}}function Im(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=Jn(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=Jn(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Jn(n)):[Jn(t)]}function Jr(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(i2(e)||s2(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Jn(e)]}const t=[],n=[],r=Nh(e[0]);for(const a of e){const o=Nh(a);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(a);else{if(i2(a)||s2(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||t.push({role:"user",parts:tT(n)}),t}function NF(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(mr).includes(n[0].toUpperCase())?n[0].toUpperCase():mr.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(mr).includes(r.toUpperCase())?r.toUpperCase():mr.TYPE_UNSPECIFIED})}}function po(e){const t={},n=["items"],r=["anyOf"],a=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=e.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(t.nullable=!0,e=o[1]):o[1].type==="null"&&(t.nullable=!0,e=o[0])),e.type instanceof Array&&NF(e.type,t);for(const[l,u]of Object.entries(e))if(u!=null)if(l=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;t.type=Object.values(mr).includes(u.toUpperCase())?u.toUpperCase():mr.TYPE_UNSPECIFIED}else if(n.includes(l))t[l]=po(u);else if(r.includes(l)){const d=[];for(const f of u){if(f.type=="null"){t.nullable=!0;continue}d.push(po(f))}t[l]=d}else if(a.includes(l)){const d={};for(const[f,m]of Object.entries(u))d[f]=po(m);t[l]=d}else{if(l==="additionalProperties")continue;t[l]=u}return t}function Fm(e){return po(e)}function Lm(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function Om(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function wo(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=po(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=po(t.response));return e}function Ao(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function kF(e,t,n,r=1){const a=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:a?`${n}/${t}`:t}function ti(e,t){if(typeof t!="string")throw new Error("name must be a string");return kF(e,t,"cachedContents")}function nT(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Ui(e){return Rm(e)}function RF(e){return e!=null&&typeof e=="object"&&"name"in e}function DF(e){return e!=null&&typeof e=="object"&&"video"in e}function MF(e){return e!=null&&typeof e=="object"&&"uri"in e}function rT(e){var t;let n;if(RF(e)&&(n=e.name),!(MF(e)&&(n=e.uri,n===void 0))&&!(DF(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function aT(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function iT(e){for(const t of["models","tunedModels","publisherModels"])if(IF(e,t))return e[t];return[]}function IF(e,t){return e!==null&&typeof e=="object"&&t in e}function FF(e,t={}){const n=e,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function LF(e,t={}){const n=[],r=new Set;for(const a of e){const o=a.name;if(r.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);r.add(o);const l=FF(a,t);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function sT(e,t){let n;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,a=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(a>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||a!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function OF(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function oT(e){if(typeof e!="object"||e===null)return{};const t=e,n=t.inlinedResponses;if(typeof n!="object"||n===null)return e;const a=n.inlinedResponses;if(!Array.isArray(a)||a.length===0)return e;let o=!1;for(const l of a){if(typeof l!="object"||l===null)continue;const d=l.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){o=!0;break}}return o&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function Co(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function lT(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PF(e){const t={},n=p(e,["responsesFile"]);n!=null&&x(t,["fileName"],n);const r=p(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>gL(l))),x(t,["inlinedResponses"],o)}const a=p(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>l)),x(t,["inlinedEmbedContentResponses"],o)}return t}function UF(e){const t={},n=p(e,["predictionsFormat"]);n!=null&&x(t,["format"],n);const r=p(e,["gcsDestination","outputUriPrefix"]);r!=null&&x(t,["gcsUri"],r);const a=p(e,["bigqueryDestination","outputUri"]);return a!=null&&x(t,["bigqueryUri"],a),t}function BF(e){const t={},n=p(e,["format"]);n!=null&&x(t,["predictionsFormat"],n);const r=p(e,["gcsUri"]);r!=null&&x(t,["gcsDestination","outputUriPrefix"],r);const a=p(e,["bigqueryUri"]);if(a!=null&&x(t,["bigqueryDestination","outputUri"],a),p(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(p(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function zu(e){const t={},n=p(e,["name"]);n!=null&&x(t,["name"],n);const r=p(e,["metadata","displayName"]);r!=null&&x(t,["displayName"],r);const a=p(e,["metadata","state"]);a!=null&&x(t,["state"],lT(a));const o=p(e,["metadata","createTime"]);o!=null&&x(t,["createTime"],o);const l=p(e,["metadata","endTime"]);l!=null&&x(t,["endTime"],l);const u=p(e,["metadata","updateTime"]);u!=null&&x(t,["updateTime"],u);const d=p(e,["metadata","model"]);d!=null&&x(t,["model"],d);const f=p(e,["metadata","output"]);return f!=null&&x(t,["dest"],PF(oT(f))),t}function kh(e){const t={},n=p(e,["name"]);n!=null&&x(t,["name"],n);const r=p(e,["displayName"]);r!=null&&x(t,["displayName"],r);const a=p(e,["state"]);a!=null&&x(t,["state"],lT(a));const o=p(e,["error"]);o!=null&&x(t,["error"],o);const l=p(e,["createTime"]);l!=null&&x(t,["createTime"],l);const u=p(e,["startTime"]);u!=null&&x(t,["startTime"],u);const d=p(e,["endTime"]);d!=null&&x(t,["endTime"],d);const f=p(e,["updateTime"]);f!=null&&x(t,["updateTime"],f);const m=p(e,["model"]);m!=null&&x(t,["model"],m);const v=p(e,["inputConfig"]);v!=null&&x(t,["src"],HF(v));const y=p(e,["outputConfig"]);y!=null&&x(t,["dest"],UF(oT(y)));const T=p(e,["completionStats"]);return T!=null&&x(t,["completionStats"],T),t}function HF(e){const t={},n=p(e,["instancesFormat"]);n!=null&&x(t,["format"],n);const r=p(e,["gcsSource","uris"]);r!=null&&x(t,["gcsUri"],r);const a=p(e,["bigquerySource","inputUri"]);return a!=null&&x(t,["bigqueryUri"],a),t}function GF(e,t){const n={};if(p(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(p(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=p(t,["fileName"]);r!=null&&x(n,["fileName"],r);const a=p(t,["inlinedRequests"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>xL(e,l))),x(n,["requests","requests"],o)}return n}function VF(e){const t={},n=p(e,["format"]);n!=null&&x(t,["instancesFormat"],n);const r=p(e,["gcsUri"]);r!=null&&x(t,["gcsSource","uris"],r);const a=p(e,["bigqueryUri"]);if(a!=null&&x(t,["bigquerySource","inputUri"],a),p(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function zF(e){const t={},n=p(e,["data"]);if(n!=null&&x(t,["data"],n),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function qF(e,t){const n={},r=p(t,["name"]);return r!=null&&x(n,["_url","name"],Co(e,r)),n}function jF(e,t){const n={},r=p(t,["name"]);return r!=null&&x(n,["_url","name"],Co(e,r)),n}function YF(e){const t={},n=p(e,["content"]);n!=null&&x(t,["content"],n);const r=p(e,["citationMetadata"]);r!=null&&x(t,["citationMetadata"],XF(r));const a=p(e,["tokenCount"]);a!=null&&x(t,["tokenCount"],a);const o=p(e,["finishReason"]);o!=null&&x(t,["finishReason"],o);const l=p(e,["avgLogprobs"]);l!=null&&x(t,["avgLogprobs"],l);const u=p(e,["groundingMetadata"]);u!=null&&x(t,["groundingMetadata"],u);const d=p(e,["index"]);d!=null&&x(t,["index"],d);const f=p(e,["logprobsResult"]);f!=null&&x(t,["logprobsResult"],f);const m=p(e,["safetyRatings"]);if(m!=null){let y=m;Array.isArray(y)&&(y=y.map(T=>T)),x(t,["safetyRatings"],y)}const v=p(e,["urlContextMetadata"]);return v!=null&&x(t,["urlContextMetadata"],v),t}function XF(e){const t={},n=p(e,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>a)),x(t,["citations"],r)}return t}function cT(e){const t={},n=p(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>wL(o))),x(t,["parts"],a)}const r=p(e,["role"]);return r!=null&&x(t,["role"],r),t}function JF(e,t){const n={},r=p(e,["displayName"]);if(t!==void 0&&r!=null&&x(t,["batch","displayName"],r),p(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function WF(e,t){const n={},r=p(e,["displayName"]);t!==void 0&&r!=null&&x(t,["displayName"],r);const a=p(e,["dest"]);return t!==void 0&&a!=null&&x(t,["outputConfig"],BF(OF(a))),n}function o2(e,t){const n={},r=p(t,["model"]);r!=null&&x(n,["_url","model"],Dt(e,r));const a=p(t,["src"]);a!=null&&x(n,["batch","inputConfig"],GF(e,sT(e,a)));const o=p(t,["config"]);return o!=null&&JF(o,n),n}function KF(e,t){const n={},r=p(t,["model"]);r!=null&&x(n,["model"],Dt(e,r));const a=p(t,["src"]);a!=null&&x(n,["inputConfig"],VF(sT(e,a)));const o=p(t,["config"]);return o!=null&&WF(o,n),n}function $F(e,t){const n={},r=p(e,["displayName"]);return t!==void 0&&r!=null&&x(t,["batch","displayName"],r),n}function QF(e,t){const n={},r=p(t,["model"]);r!=null&&x(n,["_url","model"],Dt(e,r));const a=p(t,["src"]);a!=null&&x(n,["batch","inputConfig"],iL(e,a));const o=p(t,["config"]);return o!=null&&$F(o,n),n}function ZF(e,t){const n={},r=p(t,["name"]);return r!=null&&x(n,["_url","name"],Co(e,r)),n}function eL(e,t){const n={},r=p(t,["name"]);return r!=null&&x(n,["_url","name"],Co(e,r)),n}function tL(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["name"]);r!=null&&x(t,["name"],r);const a=p(e,["done"]);a!=null&&x(t,["done"],a);const o=p(e,["error"]);return o!=null&&x(t,["error"],o),t}function nL(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["name"]);r!=null&&x(t,["name"],r);const a=p(e,["done"]);a!=null&&x(t,["done"],a);const o=p(e,["error"]);return o!=null&&x(t,["error"],o),t}function rL(e,t){const n={},r=p(t,["contents"]);if(r!=null){let o=Im(e,r);Array.isArray(o)&&(o=o.map(l=>l)),x(n,["requests[]","request","content"],o)}const a=p(t,["config"]);return a!=null&&(x(n,["_self"],aL(a,n)),Z5(n,{"requests[].*":"requests[].request.*"})),n}function aL(e,t){const n={},r=p(e,["taskType"]);t!==void 0&&r!=null&&x(t,["requests[]","taskType"],r);const a=p(e,["title"]);t!==void 0&&a!=null&&x(t,["requests[]","title"],a);const o=p(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&x(t,["requests[]","outputDimensionality"],o),p(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function iL(e,t){const n={},r=p(t,["fileName"]);r!=null&&x(n,["file_name"],r);const a=p(t,["inlinedRequests"]);return a!=null&&x(n,["requests"],rL(e,a)),n}function sL(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["fileUri"]);n!=null&&x(t,["fileUri"],n);const r=p(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function oL(e){const t={},n=p(e,["id"]);n!=null&&x(t,["id"],n);const r=p(e,["args"]);r!=null&&x(t,["args"],r);const a=p(e,["name"]);if(a!=null&&x(t,["name"],a),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function lL(e){const t={},n=p(e,["allowedFunctionNames"]);n!=null&&x(t,["allowedFunctionNames"],n);const r=p(e,["mode"]);if(r!=null&&x(t,["mode"],r),p(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function cL(e,t,n){const r={},a=p(t,["systemInstruction"]);n!==void 0&&a!=null&&x(n,["systemInstruction"],cT(Jn(a)));const o=p(t,["temperature"]);o!=null&&x(r,["temperature"],o);const l=p(t,["topP"]);l!=null&&x(r,["topP"],l);const u=p(t,["topK"]);u!=null&&x(r,["topK"],u);const d=p(t,["candidateCount"]);d!=null&&x(r,["candidateCount"],d);const f=p(t,["maxOutputTokens"]);f!=null&&x(r,["maxOutputTokens"],f);const m=p(t,["stopSequences"]);m!=null&&x(r,["stopSequences"],m);const v=p(t,["responseLogprobs"]);v!=null&&x(r,["responseLogprobs"],v);const y=p(t,["logprobs"]);y!=null&&x(r,["logprobs"],y);const T=p(t,["presencePenalty"]);T!=null&&x(r,["presencePenalty"],T);const w=p(t,["frequencyPenalty"]);w!=null&&x(r,["frequencyPenalty"],w);const S=p(t,["seed"]);S!=null&&x(r,["seed"],S);const A=p(t,["responseMimeType"]);A!=null&&x(r,["responseMimeType"],A);const k=p(t,["responseSchema"]);k!=null&&x(r,["responseSchema"],Fm(k));const I=p(t,["responseJsonSchema"]);if(I!=null&&x(r,["responseJsonSchema"],I),p(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=p(t,["safetySettings"]);if(n!==void 0&&b!=null){let le=b;Array.isArray(le)&&(le=le.map(Te=>AL(Te))),x(n,["safetySettings"],le)}const P=p(t,["tools"]);if(n!==void 0&&P!=null){let le=Ao(P);Array.isArray(le)&&(le=le.map(Te=>bL(wo(Te)))),x(n,["tools"],le)}const F=p(t,["toolConfig"]);if(n!==void 0&&F!=null&&x(n,["toolConfig"],CL(F)),p(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const Y=p(t,["cachedContent"]);n!==void 0&&Y!=null&&x(n,["cachedContent"],ti(e,Y));const D=p(t,["responseModalities"]);D!=null&&x(r,["responseModalities"],D);const Q=p(t,["mediaResolution"]);Q!=null&&x(r,["mediaResolution"],Q);const B=p(t,["speechConfig"]);if(B!=null&&x(r,["speechConfig"],Lm(B)),p(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ae=p(t,["thinkingConfig"]);ae!=null&&x(r,["thinkingConfig"],ae);const ie=p(t,["imageConfig"]);ie!=null&&x(r,["imageConfig"],pL(ie));const Z=p(t,["enableEnhancedCivicAnswers"]);if(Z!=null&&x(r,["enableEnhancedCivicAnswers"],Z),p(t,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function uL(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(f=>YF(f))),x(t,["candidates"],d)}const a=p(e,["modelVersion"]);a!=null&&x(t,["modelVersion"],a);const o=p(e,["promptFeedback"]);o!=null&&x(t,["promptFeedback"],o);const l=p(e,["responseId"]);l!=null&&x(t,["responseId"],l);const u=p(e,["usageMetadata"]);return u!=null&&x(t,["usageMetadata"],u),t}function fL(e,t){const n={},r=p(t,["name"]);return r!=null&&x(n,["_url","name"],Co(e,r)),n}function dL(e,t){const n={},r=p(t,["name"]);return r!=null&&x(n,["_url","name"],Co(e,r)),n}function hL(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=p(e,["enableWidget"]);return n!=null&&x(t,["enableWidget"],n),t}function mL(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=p(e,["timeRangeFilter"]);return n!=null&&x(t,["timeRangeFilter"],n),t}function pL(e){const t={},n=p(e,["aspectRatio"]);n!=null&&x(t,["aspectRatio"],n);const r=p(e,["imageSize"]);if(r!=null&&x(t,["imageSize"],r),p(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(p(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function xL(e,t){const n={},r=p(t,["model"]);r!=null&&x(n,["request","model"],Dt(e,r));const a=p(t,["contents"]);if(a!=null){let u=Jr(a);Array.isArray(u)&&(u=u.map(d=>cT(d))),x(n,["request","contents"],u)}const o=p(t,["metadata"]);o!=null&&x(n,["metadata"],o);const l=p(t,["config"]);return l!=null&&x(n,["request","generationConfig"],cL(e,l,p(n,["request"],{}))),n}function gL(e){const t={},n=p(e,["response"]);n!=null&&x(t,["response"],uL(n));const r=p(e,["metadata"]);r!=null&&x(t,["metadata"],r);const a=p(e,["error"]);return a!=null&&x(t,["error"],a),t}function vL(e,t){const n={},r=p(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const a=p(e,["pageToken"]);if(t!==void 0&&a!=null&&x(t,["_query","pageToken"],a),p(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function yL(e,t){const n={},r=p(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const a=p(e,["pageToken"]);t!==void 0&&a!=null&&x(t,["_query","pageToken"],a);const o=p(e,["filter"]);return t!==void 0&&o!=null&&x(t,["_query","filter"],o),n}function _L(e){const t={},n=p(e,["config"]);return n!=null&&vL(n,t),t}function EL(e){const t={},n=p(e,["config"]);return n!=null&&yL(n,t),t}function TL(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["nextPageToken"]);r!=null&&x(t,["nextPageToken"],r);const a=p(e,["operations"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>zu(l))),x(t,["batchJobs"],o)}return t}function SL(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["nextPageToken"]);r!=null&&x(t,["nextPageToken"],r);const a=p(e,["batchPredictionJobs"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>kh(l))),x(t,["batchJobs"],o)}return t}function wL(e){const t={},n=p(e,["mediaResolution"]);n!=null&&x(t,["mediaResolution"],n);const r=p(e,["codeExecutionResult"]);r!=null&&x(t,["codeExecutionResult"],r);const a=p(e,["executableCode"]);a!=null&&x(t,["executableCode"],a);const o=p(e,["fileData"]);o!=null&&x(t,["fileData"],sL(o));const l=p(e,["functionCall"]);l!=null&&x(t,["functionCall"],oL(l));const u=p(e,["functionResponse"]);u!=null&&x(t,["functionResponse"],u);const d=p(e,["inlineData"]);d!=null&&x(t,["inlineData"],zF(d));const f=p(e,["text"]);f!=null&&x(t,["text"],f);const m=p(e,["thought"]);m!=null&&x(t,["thought"],m);const v=p(e,["thoughtSignature"]);v!=null&&x(t,["thoughtSignature"],v);const y=p(e,["videoMetadata"]);return y!=null&&x(t,["videoMetadata"],y),t}function AL(e){const t={},n=p(e,["category"]);if(n!=null&&x(t,["category"],n),p(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=p(e,["threshold"]);return r!=null&&x(t,["threshold"],r),t}function CL(e){const t={},n=p(e,["retrievalConfig"]);n!=null&&x(t,["retrievalConfig"],n);const r=p(e,["functionCallingConfig"]);return r!=null&&x(t,["functionCallingConfig"],lL(r)),t}function bL(e){const t={};if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=p(e,["computerUse"]);n!=null&&x(t,["computerUse"],n);const r=p(e,["fileSearch"]);r!=null&&x(t,["fileSearch"],r);const a=p(e,["codeExecution"]);if(a!=null&&x(t,["codeExecution"],a),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(e,["functionDeclarations"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(v=>v)),x(t,["functionDeclarations"],m)}const l=p(e,["googleMaps"]);l!=null&&x(t,["googleMaps"],hL(l));const u=p(e,["googleSearch"]);u!=null&&x(t,["googleSearch"],mL(u));const d=p(e,["googleSearchRetrieval"]);d!=null&&x(t,["googleSearchRetrieval"],d);const f=p(e,["urlContext"]);return f!=null&&x(t,["urlContext"],f),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ka;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(Ka||(Ka={}));class Es{constructor(t,n,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,a)}init(t,n,r){var a,o;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!r||Object.keys(r).length===0?l={config:{}}:typeof r=="object"?l=Object.assign({},r):l=r,l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NL extends ei{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Es(Ka.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(t){const n=o2(this.apiClient,t),r=n._url,a=qe("{model}:batchGenerateContent",r),u=n.batch.inputConfig.requests,d=u.requests,f=[];for(const m of d){const v=Object.assign({},m);if(v.systemInstruction){const y=v.systemInstruction;delete v.systemInstruction;const T=v.request;T.systemInstruction=y,v.request=T}f.push(v)}return u.requests=f,delete n.config,delete n._url,delete n._query,{path:a,body:n}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,n){const r=n?Object.assign({},n):{},a=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${a}`),r.dest===void 0){const o=this.getGcsUri(t),l=this.getBigqueryUri(t);if(o)o.endsWith(".jsonl")?r.dest=`${o.slice(0,-6)}/dest`:r.dest=`${o}_dest_${a}`;else if(l)r.dest=`${l}_dest_${a}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=KF(this.apiClient,t);return u=qe("batchPredictionJobs",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),l.then(m=>kh(m))}else{const f=o2(this.apiClient,t);return u=qe("{model}:batchGenerateContent",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>zu(m))}}async createEmbeddingsInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=QF(this.apiClient,t);return o=qe("{model}:asyncBatchEmbedContent",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>zu(d))}}async get(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=dL(this.apiClient,t);return u=qe("batchPredictionJobs/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),l.then(m=>kh(m))}else{const f=fL(this.apiClient,t);return u=qe("batches/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>zu(m))}}async cancel(t){var n,r,a,o;let l="",u={};if(this.apiClient.isVertexAI()){const d=jF(this.apiClient,t);l=qe("batchPredictionJobs/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const d=qF(this.apiClient,t);l=qe("batches/{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=EL(t);return u=qe("batchPredictionJobs",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=SL(m),y=new r2;return Object.assign(y,v),y})}else{const f=_L(t);return u=qe("batches",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=TL(m),y=new r2;return Object.assign(y,v),y})}}async delete(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=eL(this.apiClient,t);return u=qe("batchPredictionJobs/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>nL(m))}else{const f=ZF(this.apiClient,t);return u=qe("batches/{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>tL(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kL(e){const t={},n=p(e,["data"]);if(n!=null&&x(t,["data"],n),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function l2(e){const t={},n=p(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>QL(o))),x(t,["parts"],a)}const r=p(e,["role"]);return r!=null&&x(t,["role"],r),t}function RL(e,t){const n={},r=p(e,["ttl"]);t!==void 0&&r!=null&&x(t,["ttl"],r);const a=p(e,["expireTime"]);t!==void 0&&a!=null&&x(t,["expireTime"],a);const o=p(e,["displayName"]);t!==void 0&&o!=null&&x(t,["displayName"],o);const l=p(e,["contents"]);if(t!==void 0&&l!=null){let m=Jr(l);Array.isArray(m)&&(m=m.map(v=>l2(v))),x(t,["contents"],m)}const u=p(e,["systemInstruction"]);t!==void 0&&u!=null&&x(t,["systemInstruction"],l2(Jn(u)));const d=p(e,["tools"]);if(t!==void 0&&d!=null){let m=d;Array.isArray(m)&&(m=m.map(v=>eO(v))),x(t,["tools"],m)}const f=p(e,["toolConfig"]);if(t!==void 0&&f!=null&&x(t,["toolConfig"],ZL(f)),p(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function DL(e,t){const n={},r=p(e,["ttl"]);t!==void 0&&r!=null&&x(t,["ttl"],r);const a=p(e,["expireTime"]);t!==void 0&&a!=null&&x(t,["expireTime"],a);const o=p(e,["displayName"]);t!==void 0&&o!=null&&x(t,["displayName"],o);const l=p(e,["contents"]);if(t!==void 0&&l!=null){let v=Jr(l);Array.isArray(v)&&(v=v.map(y=>y)),x(t,["contents"],v)}const u=p(e,["systemInstruction"]);t!==void 0&&u!=null&&x(t,["systemInstruction"],Jn(u));const d=p(e,["tools"]);if(t!==void 0&&d!=null){let v=d;Array.isArray(v)&&(v=v.map(y=>tO(y))),x(t,["tools"],v)}const f=p(e,["toolConfig"]);t!==void 0&&f!=null&&x(t,["toolConfig"],f);const m=p(e,["kmsKeyName"]);return t!==void 0&&m!=null&&x(t,["encryption_spec","kmsKeyName"],m),n}function ML(e,t){const n={},r=p(t,["model"]);r!=null&&x(n,["model"],$E(e,r));const a=p(t,["config"]);return a!=null&&RL(a,n),n}function IL(e,t){const n={},r=p(t,["model"]);r!=null&&x(n,["model"],$E(e,r));const a=p(t,["config"]);return a!=null&&DL(a,n),n}function FL(e,t){const n={},r=p(t,["name"]);return r!=null&&x(n,["_url","name"],ti(e,r)),n}function LL(e,t){const n={},r=p(t,["name"]);return r!=null&&x(n,["_url","name"],ti(e,r)),n}function OL(e){const t={},n=p(e,["sdkHttpResponse"]);return n!=null&&x(t,["sdkHttpResponse"],n),t}function PL(e){const t={},n=p(e,["sdkHttpResponse"]);return n!=null&&x(t,["sdkHttpResponse"],n),t}function UL(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["fileUri"]);n!=null&&x(t,["fileUri"],n);const r=p(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function BL(e){const t={},n=p(e,["id"]);n!=null&&x(t,["id"],n);const r=p(e,["args"]);r!=null&&x(t,["args"],r);const a=p(e,["name"]);if(a!=null&&x(t,["name"],a),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function HL(e){const t={},n=p(e,["allowedFunctionNames"]);n!=null&&x(t,["allowedFunctionNames"],n);const r=p(e,["mode"]);if(r!=null&&x(t,["mode"],r),p(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function GL(e){const t={},n=p(e,["description"]);n!=null&&x(t,["description"],n);const r=p(e,["name"]);r!=null&&x(t,["name"],r);const a=p(e,["parameters"]);a!=null&&x(t,["parameters"],a);const o=p(e,["parametersJsonSchema"]);o!=null&&x(t,["parametersJsonSchema"],o);const l=p(e,["response"]);l!=null&&x(t,["response"],l);const u=p(e,["responseJsonSchema"]);if(u!=null&&x(t,["responseJsonSchema"],u),p(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function VL(e,t){const n={},r=p(t,["name"]);return r!=null&&x(n,["_url","name"],ti(e,r)),n}function zL(e,t){const n={},r=p(t,["name"]);return r!=null&&x(n,["_url","name"],ti(e,r)),n}function qL(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=p(e,["enableWidget"]);return n!=null&&x(t,["enableWidget"],n),t}function jL(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=p(e,["timeRangeFilter"]);return n!=null&&x(t,["timeRangeFilter"],n),t}function YL(e,t){const n={},r=p(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const a=p(e,["pageToken"]);return t!==void 0&&a!=null&&x(t,["_query","pageToken"],a),n}function XL(e,t){const n={},r=p(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const a=p(e,["pageToken"]);return t!==void 0&&a!=null&&x(t,["_query","pageToken"],a),n}function JL(e){const t={},n=p(e,["config"]);return n!=null&&YL(n,t),t}function WL(e){const t={},n=p(e,["config"]);return n!=null&&XL(n,t),t}function KL(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["nextPageToken"]);r!=null&&x(t,["nextPageToken"],r);const a=p(e,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>l)),x(t,["cachedContents"],o)}return t}function $L(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["nextPageToken"]);r!=null&&x(t,["nextPageToken"],r);const a=p(e,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>l)),x(t,["cachedContents"],o)}return t}function QL(e){const t={},n=p(e,["mediaResolution"]);n!=null&&x(t,["mediaResolution"],n);const r=p(e,["codeExecutionResult"]);r!=null&&x(t,["codeExecutionResult"],r);const a=p(e,["executableCode"]);a!=null&&x(t,["executableCode"],a);const o=p(e,["fileData"]);o!=null&&x(t,["fileData"],UL(o));const l=p(e,["functionCall"]);l!=null&&x(t,["functionCall"],BL(l));const u=p(e,["functionResponse"]);u!=null&&x(t,["functionResponse"],u);const d=p(e,["inlineData"]);d!=null&&x(t,["inlineData"],kL(d));const f=p(e,["text"]);f!=null&&x(t,["text"],f);const m=p(e,["thought"]);m!=null&&x(t,["thought"],m);const v=p(e,["thoughtSignature"]);v!=null&&x(t,["thoughtSignature"],v);const y=p(e,["videoMetadata"]);return y!=null&&x(t,["videoMetadata"],y),t}function ZL(e){const t={},n=p(e,["retrievalConfig"]);n!=null&&x(t,["retrievalConfig"],n);const r=p(e,["functionCallingConfig"]);return r!=null&&x(t,["functionCallingConfig"],HL(r)),t}function eO(e){const t={};if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=p(e,["computerUse"]);n!=null&&x(t,["computerUse"],n);const r=p(e,["fileSearch"]);r!=null&&x(t,["fileSearch"],r);const a=p(e,["codeExecution"]);if(a!=null&&x(t,["codeExecution"],a),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(e,["functionDeclarations"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(v=>v)),x(t,["functionDeclarations"],m)}const l=p(e,["googleMaps"]);l!=null&&x(t,["googleMaps"],qL(l));const u=p(e,["googleSearch"]);u!=null&&x(t,["googleSearch"],jL(u));const d=p(e,["googleSearchRetrieval"]);d!=null&&x(t,["googleSearchRetrieval"],d);const f=p(e,["urlContext"]);return f!=null&&x(t,["urlContext"],f),t}function tO(e){const t={},n=p(e,["retrieval"]);n!=null&&x(t,["retrieval"],n);const r=p(e,["computerUse"]);if(r!=null&&x(t,["computerUse"],r),p(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=p(e,["codeExecution"]);a!=null&&x(t,["codeExecution"],a);const o=p(e,["enterpriseWebSearch"]);o!=null&&x(t,["enterpriseWebSearch"],o);const l=p(e,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(y=>GL(y))),x(t,["functionDeclarations"],v)}const u=p(e,["googleMaps"]);u!=null&&x(t,["googleMaps"],u);const d=p(e,["googleSearch"]);d!=null&&x(t,["googleSearch"],d);const f=p(e,["googleSearchRetrieval"]);f!=null&&x(t,["googleSearchRetrieval"],f);const m=p(e,["urlContext"]);return m!=null&&x(t,["urlContext"],m),t}function nO(e,t){const n={},r=p(e,["ttl"]);t!==void 0&&r!=null&&x(t,["ttl"],r);const a=p(e,["expireTime"]);return t!==void 0&&a!=null&&x(t,["expireTime"],a),n}function rO(e,t){const n={},r=p(e,["ttl"]);t!==void 0&&r!=null&&x(t,["ttl"],r);const a=p(e,["expireTime"]);return t!==void 0&&a!=null&&x(t,["expireTime"],a),n}function aO(e,t){const n={},r=p(t,["name"]);r!=null&&x(n,["_url","name"],ti(e,r));const a=p(t,["config"]);return a!=null&&nO(a,n),n}function iO(e,t){const n={},r=p(t,["name"]);r!=null&&x(n,["_url","name"],ti(e,r));const a=p(t,["config"]);return a!=null&&rO(a,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sO extends ei{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Es(Ka.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=IL(this.apiClient,t);return u=qe("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),l.then(m=>m)}else{const f=ML(this.apiClient,t);return u=qe("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>m)}}async get(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=zL(this.apiClient,t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),l.then(m=>m)}else{const f=VL(this.apiClient,t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>m)}}async delete(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=LL(this.apiClient,t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=PL(m),y=new t2;return Object.assign(y,v),y})}else{const f=FL(this.apiClient,t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=OL(m),y=new t2;return Object.assign(y,v),y})}}async update(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=iO(this.apiClient,t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),l.then(m=>m)}else{const f=aO(this.apiClient,t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>m)}}async listInternal(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=WL(t);return u=qe("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=$L(m),y=new n2;return Object.assign(y,v),y})}else{const f=JL(t);return u=qe("cachedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=KL(m),y=new n2;return Object.assign(y,v),y})}}}function hf(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function c2(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ct(e){return this instanceof ct?(this.v=e,this):new ct(e)}function fa(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(T){return function(w){return Promise.resolve(w).then(T,v)}}function u(T,w){r[T]&&(a[T]=function(S){return new Promise(function(A,k){o.push([T,S,A,k])>1||d(T,S)})},w&&(a[T]=w(a[T])))}function d(T,w){try{f(r[T](w))}catch(S){y(o[0][3],S)}}function f(T){T.value instanceof ct?Promise.resolve(T.value.v).then(m,v):y(o[0][2],T)}function m(T){d("next",T)}function v(T){d("throw",T)}function y(T,w){T(w),o.shift(),o.length&&d(o[0][0],o[0][1])}}function da(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof c2=="function"?c2(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(l){return new Promise(function(u,d){l=e[o](l),a(u,d,l.done,l.value)})}}function a(o,l,u,d){Promise.resolve(d).then(function(f){o({value:f,done:u})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oO(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:uT(n)}function uT(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function lO(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function u2(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const a=[];let o=!0;for(;r<n&&e[r].role==="model";)a.push(e[r]),o&&!uT(e[r])&&(o=!1),r++;o?t.push(...a):t.pop()}return t}class cO{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new uO(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class uO{constructor(t,n,r,a={},o=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=a,this.history=o,this.sendPromise=Promise.resolve(),lO(o)}async sendMessage(t){var n;await this.sendPromise;const r=Jn(t.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,l,u;const d=await a,f=(l=(o=d.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,m=d.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let y=[];m!=null&&(y=(u=m.slice(v))!==null&&u!==void 0?u:[]);const T=f?[f]:[];this.recordHistory(r,T,y)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(t){var n;await this.sendPromise;const r=Jn(t.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const o=await a;return this.processStreamResponse(o,r)}getHistory(t=!1){const n=t?u2(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){return fa(this,arguments,function*(){var a,o,l,u,d,f;const m=[];try{for(var v=!0,y=da(t),T;T=yield ct(y.next()),a=T.done,!a;v=!0){u=T.value,v=!1;const w=u;if(oO(w)){const S=(f=(d=w.candidates)===null||d===void 0?void 0:d[0])===null||f===void 0?void 0:f.content;S!==void 0&&m.push(S)}yield yield ct(w)}}catch(w){o={error:w}}finally{try{!v&&!a&&(l=y.return)&&(yield ct(l.call(y)))}finally{if(o)throw o.error}}this.recordHistory(n,m)})}recordHistory(t,n,r){let a=[];n.length>0&&n.every(o=>o.role!==void 0)?a=n:a.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...u2(r)):this.history.push(t),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tc extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,tc.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fO(e){const t={},n=p(e,["file"]);return n!=null&&x(t,["file"],n),t}function dO(e){const t={},n=p(e,["sdkHttpResponse"]);return n!=null&&x(t,["sdkHttpResponse"],n),t}function hO(e){const t={},n=p(e,["name"]);return n!=null&&x(t,["_url","file"],rT(n)),t}function mO(e){const t={},n=p(e,["sdkHttpResponse"]);return n!=null&&x(t,["sdkHttpResponse"],n),t}function pO(e){const t={},n=p(e,["name"]);return n!=null&&x(t,["_url","file"],rT(n)),t}function xO(e){const t={},n=p(e,["uris"]);return n!=null&&x(t,["uris"],n),t}function gO(e,t){const n={},r=p(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const a=p(e,["pageToken"]);return t!==void 0&&a!=null&&x(t,["_query","pageToken"],a),n}function vO(e){const t={},n=p(e,["config"]);return n!=null&&gO(n,t),t}function yO(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["nextPageToken"]);r!=null&&x(t,["nextPageToken"],r);const a=p(e,["files"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>l)),x(t,["files"],o)}return t}function _O(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>o)),x(t,["files"],a)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class EO extends ei{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Es(Ka.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>n)}async download(t){await this.apiClient.downloadFile(t)}async registerFiles(t){throw new Error("registerFiles is only supported in Node.js environments.")}async _registerFiles(t){return this.registerFilesInternal(t)}async listInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=vO(t);return o=qe("files",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),a.then(d=>{const f=yO(d),m=new TF;return Object.assign(m,f),m})}}async createInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=fO(t);return o=qe("upload/v1beta/files",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=dO(d),m=new SF;return Object.assign(m,f),m})}}async get(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=pO(t);return o=qe("files/{file}",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>d)}}async delete(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=hO(t);return o=qe("files/{file}",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),a.then(d=>{const f=mO(d),m=new wF;return Object.assign(m,f),m})}}async registerFilesInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=xO(t);return o=qe("files:register",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=_O(d),m=new AF;return Object.assign(m,f),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qu(e){const t={},n=p(e,["data"]);if(n!=null&&x(t,["data"],n),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function TO(e){const t={},n=p(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>UO(o))),x(t,["parts"],a)}const r=p(e,["role"]);return r!=null&&x(t,["role"],r),t}function SO(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["fileUri"]);n!=null&&x(t,["fileUri"],n);const r=p(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function wO(e){const t={},n=p(e,["id"]);n!=null&&x(t,["id"],n);const r=p(e,["args"]);r!=null&&x(t,["args"],r);const a=p(e,["name"]);if(a!=null&&x(t,["name"],a),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function AO(e){const t={},n=p(e,["description"]);n!=null&&x(t,["description"],n);const r=p(e,["name"]);r!=null&&x(t,["name"],r);const a=p(e,["parameters"]);a!=null&&x(t,["parameters"],a);const o=p(e,["parametersJsonSchema"]);o!=null&&x(t,["parametersJsonSchema"],o);const l=p(e,["response"]);l!=null&&x(t,["response"],l);const u=p(e,["responseJsonSchema"]);if(u!=null&&x(t,["responseJsonSchema"],u),p(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function CO(e){const t={},n=p(e,["modelSelectionConfig"]);n!=null&&x(t,["modelConfig"],n);const r=p(e,["responseJsonSchema"]);r!=null&&x(t,["responseJsonSchema"],r);const a=p(e,["audioTimestamp"]);a!=null&&x(t,["audioTimestamp"],a);const o=p(e,["candidateCount"]);o!=null&&x(t,["candidateCount"],o);const l=p(e,["enableAffectiveDialog"]);l!=null&&x(t,["enableAffectiveDialog"],l);const u=p(e,["frequencyPenalty"]);u!=null&&x(t,["frequencyPenalty"],u);const d=p(e,["logprobs"]);d!=null&&x(t,["logprobs"],d);const f=p(e,["maxOutputTokens"]);f!=null&&x(t,["maxOutputTokens"],f);const m=p(e,["mediaResolution"]);m!=null&&x(t,["mediaResolution"],m);const v=p(e,["presencePenalty"]);v!=null&&x(t,["presencePenalty"],v);const y=p(e,["responseLogprobs"]);y!=null&&x(t,["responseLogprobs"],y);const T=p(e,["responseMimeType"]);T!=null&&x(t,["responseMimeType"],T);const w=p(e,["responseModalities"]);w!=null&&x(t,["responseModalities"],w);const S=p(e,["responseSchema"]);S!=null&&x(t,["responseSchema"],S);const A=p(e,["routingConfig"]);A!=null&&x(t,["routingConfig"],A);const k=p(e,["seed"]);k!=null&&x(t,["seed"],k);const I=p(e,["speechConfig"]);I!=null&&x(t,["speechConfig"],I);const b=p(e,["stopSequences"]);b!=null&&x(t,["stopSequences"],b);const P=p(e,["temperature"]);P!=null&&x(t,["temperature"],P);const F=p(e,["thinkingConfig"]);F!=null&&x(t,["thinkingConfig"],F);const Y=p(e,["topK"]);Y!=null&&x(t,["topK"],Y);const D=p(e,["topP"]);if(D!=null&&x(t,["topP"],D),p(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function bO(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=p(e,["enableWidget"]);return n!=null&&x(t,["enableWidget"],n),t}function NO(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=p(e,["timeRangeFilter"]);return n!=null&&x(t,["timeRangeFilter"],n),t}function kO(e,t){const n={},r=p(e,["generationConfig"]);t!==void 0&&r!=null&&x(t,["setup","generationConfig"],r);const a=p(e,["responseModalities"]);t!==void 0&&a!=null&&x(t,["setup","generationConfig","responseModalities"],a);const o=p(e,["temperature"]);t!==void 0&&o!=null&&x(t,["setup","generationConfig","temperature"],o);const l=p(e,["topP"]);t!==void 0&&l!=null&&x(t,["setup","generationConfig","topP"],l);const u=p(e,["topK"]);t!==void 0&&u!=null&&x(t,["setup","generationConfig","topK"],u);const d=p(e,["maxOutputTokens"]);t!==void 0&&d!=null&&x(t,["setup","generationConfig","maxOutputTokens"],d);const f=p(e,["mediaResolution"]);t!==void 0&&f!=null&&x(t,["setup","generationConfig","mediaResolution"],f);const m=p(e,["seed"]);t!==void 0&&m!=null&&x(t,["setup","generationConfig","seed"],m);const v=p(e,["speechConfig"]);t!==void 0&&v!=null&&x(t,["setup","generationConfig","speechConfig"],Om(v));const y=p(e,["thinkingConfig"]);t!==void 0&&y!=null&&x(t,["setup","generationConfig","thinkingConfig"],y);const T=p(e,["enableAffectiveDialog"]);t!==void 0&&T!=null&&x(t,["setup","generationConfig","enableAffectiveDialog"],T);const w=p(e,["systemInstruction"]);t!==void 0&&w!=null&&x(t,["setup","systemInstruction"],TO(Jn(w)));const S=p(e,["tools"]);if(t!==void 0&&S!=null){let Y=Ao(S);Array.isArray(Y)&&(Y=Y.map(D=>HO(wo(D)))),x(t,["setup","tools"],Y)}const A=p(e,["sessionResumption"]);t!==void 0&&A!=null&&x(t,["setup","sessionResumption"],BO(A));const k=p(e,["inputAudioTranscription"]);t!==void 0&&k!=null&&x(t,["setup","inputAudioTranscription"],k);const I=p(e,["outputAudioTranscription"]);t!==void 0&&I!=null&&x(t,["setup","outputAudioTranscription"],I);const b=p(e,["realtimeInputConfig"]);t!==void 0&&b!=null&&x(t,["setup","realtimeInputConfig"],b);const P=p(e,["contextWindowCompression"]);t!==void 0&&P!=null&&x(t,["setup","contextWindowCompression"],P);const F=p(e,["proactivity"]);if(t!==void 0&&F!=null&&x(t,["setup","proactivity"],F),p(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function RO(e,t){const n={},r=p(e,["generationConfig"]);t!==void 0&&r!=null&&x(t,["setup","generationConfig"],CO(r));const a=p(e,["responseModalities"]);t!==void 0&&a!=null&&x(t,["setup","generationConfig","responseModalities"],a);const o=p(e,["temperature"]);t!==void 0&&o!=null&&x(t,["setup","generationConfig","temperature"],o);const l=p(e,["topP"]);t!==void 0&&l!=null&&x(t,["setup","generationConfig","topP"],l);const u=p(e,["topK"]);t!==void 0&&u!=null&&x(t,["setup","generationConfig","topK"],u);const d=p(e,["maxOutputTokens"]);t!==void 0&&d!=null&&x(t,["setup","generationConfig","maxOutputTokens"],d);const f=p(e,["mediaResolution"]);t!==void 0&&f!=null&&x(t,["setup","generationConfig","mediaResolution"],f);const m=p(e,["seed"]);t!==void 0&&m!=null&&x(t,["setup","generationConfig","seed"],m);const v=p(e,["speechConfig"]);t!==void 0&&v!=null&&x(t,["setup","generationConfig","speechConfig"],Om(v));const y=p(e,["thinkingConfig"]);t!==void 0&&y!=null&&x(t,["setup","generationConfig","thinkingConfig"],y);const T=p(e,["enableAffectiveDialog"]);t!==void 0&&T!=null&&x(t,["setup","generationConfig","enableAffectiveDialog"],T);const w=p(e,["systemInstruction"]);t!==void 0&&w!=null&&x(t,["setup","systemInstruction"],Jn(w));const S=p(e,["tools"]);if(t!==void 0&&S!=null){let D=Ao(S);Array.isArray(D)&&(D=D.map(Q=>GO(wo(Q)))),x(t,["setup","tools"],D)}const A=p(e,["sessionResumption"]);t!==void 0&&A!=null&&x(t,["setup","sessionResumption"],A);const k=p(e,["inputAudioTranscription"]);t!==void 0&&k!=null&&x(t,["setup","inputAudioTranscription"],k);const I=p(e,["outputAudioTranscription"]);t!==void 0&&I!=null&&x(t,["setup","outputAudioTranscription"],I);const b=p(e,["realtimeInputConfig"]);t!==void 0&&b!=null&&x(t,["setup","realtimeInputConfig"],b);const P=p(e,["contextWindowCompression"]);t!==void 0&&P!=null&&x(t,["setup","contextWindowCompression"],P);const F=p(e,["proactivity"]);t!==void 0&&F!=null&&x(t,["setup","proactivity"],F);const Y=p(e,["explicitVadSignal"]);return t!==void 0&&Y!=null&&x(t,["setup","explicitVadSignal"],Y),n}function DO(e,t){const n={},r=p(t,["model"]);r!=null&&x(n,["setup","model"],Dt(e,r));const a=p(t,["config"]);return a!=null&&x(n,["config"],kO(a,n)),n}function MO(e,t){const n={},r=p(t,["model"]);r!=null&&x(n,["setup","model"],Dt(e,r));const a=p(t,["config"]);return a!=null&&x(n,["config"],RO(a,n)),n}function IO(e){const t={},n=p(e,["musicGenerationConfig"]);return n!=null&&x(t,["musicGenerationConfig"],n),t}function FO(e){const t={},n=p(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>a)),x(t,["weightedPrompts"],r)}return t}function LO(e){const t={},n=p(e,["media"]);if(n!=null){let f=QE(n);Array.isArray(f)&&(f=f.map(m=>qu(m))),x(t,["mediaChunks"],f)}const r=p(e,["audio"]);r!=null&&x(t,["audio"],qu(eT(r)));const a=p(e,["audioStreamEnd"]);a!=null&&x(t,["audioStreamEnd"],a);const o=p(e,["video"]);o!=null&&x(t,["video"],qu(ZE(o)));const l=p(e,["text"]);l!=null&&x(t,["text"],l);const u=p(e,["activityStart"]);u!=null&&x(t,["activityStart"],u);const d=p(e,["activityEnd"]);return d!=null&&x(t,["activityEnd"],d),t}function OO(e){const t={},n=p(e,["media"]);if(n!=null){let f=QE(n);Array.isArray(f)&&(f=f.map(m=>m)),x(t,["mediaChunks"],f)}const r=p(e,["audio"]);r!=null&&x(t,["audio"],eT(r));const a=p(e,["audioStreamEnd"]);a!=null&&x(t,["audioStreamEnd"],a);const o=p(e,["video"]);o!=null&&x(t,["video"],ZE(o));const l=p(e,["text"]);l!=null&&x(t,["text"],l);const u=p(e,["activityStart"]);u!=null&&x(t,["activityStart"],u);const d=p(e,["activityEnd"]);return d!=null&&x(t,["activityEnd"],d),t}function PO(e){const t={},n=p(e,["setupComplete"]);n!=null&&x(t,["setupComplete"],n);const r=p(e,["serverContent"]);r!=null&&x(t,["serverContent"],r);const a=p(e,["toolCall"]);a!=null&&x(t,["toolCall"],a);const o=p(e,["toolCallCancellation"]);o!=null&&x(t,["toolCallCancellation"],o);const l=p(e,["usageMetadata"]);l!=null&&x(t,["usageMetadata"],VO(l));const u=p(e,["goAway"]);u!=null&&x(t,["goAway"],u);const d=p(e,["sessionResumptionUpdate"]);d!=null&&x(t,["sessionResumptionUpdate"],d);const f=p(e,["voiceActivityDetectionSignal"]);f!=null&&x(t,["voiceActivityDetectionSignal"],f);const m=p(e,["voiceActivity"]);return m!=null&&x(t,["voiceActivity"],zO(m)),t}function UO(e){const t={},n=p(e,["mediaResolution"]);n!=null&&x(t,["mediaResolution"],n);const r=p(e,["codeExecutionResult"]);r!=null&&x(t,["codeExecutionResult"],r);const a=p(e,["executableCode"]);a!=null&&x(t,["executableCode"],a);const o=p(e,["fileData"]);o!=null&&x(t,["fileData"],SO(o));const l=p(e,["functionCall"]);l!=null&&x(t,["functionCall"],wO(l));const u=p(e,["functionResponse"]);u!=null&&x(t,["functionResponse"],u);const d=p(e,["inlineData"]);d!=null&&x(t,["inlineData"],qu(d));const f=p(e,["text"]);f!=null&&x(t,["text"],f);const m=p(e,["thought"]);m!=null&&x(t,["thought"],m);const v=p(e,["thoughtSignature"]);v!=null&&x(t,["thoughtSignature"],v);const y=p(e,["videoMetadata"]);return y!=null&&x(t,["videoMetadata"],y),t}function BO(e){const t={},n=p(e,["handle"]);if(n!=null&&x(t,["handle"],n),p(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function HO(e){const t={};if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=p(e,["computerUse"]);n!=null&&x(t,["computerUse"],n);const r=p(e,["fileSearch"]);r!=null&&x(t,["fileSearch"],r);const a=p(e,["codeExecution"]);if(a!=null&&x(t,["codeExecution"],a),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(e,["functionDeclarations"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(v=>v)),x(t,["functionDeclarations"],m)}const l=p(e,["googleMaps"]);l!=null&&x(t,["googleMaps"],bO(l));const u=p(e,["googleSearch"]);u!=null&&x(t,["googleSearch"],NO(u));const d=p(e,["googleSearchRetrieval"]);d!=null&&x(t,["googleSearchRetrieval"],d);const f=p(e,["urlContext"]);return f!=null&&x(t,["urlContext"],f),t}function GO(e){const t={},n=p(e,["retrieval"]);n!=null&&x(t,["retrieval"],n);const r=p(e,["computerUse"]);if(r!=null&&x(t,["computerUse"],r),p(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=p(e,["codeExecution"]);a!=null&&x(t,["codeExecution"],a);const o=p(e,["enterpriseWebSearch"]);o!=null&&x(t,["enterpriseWebSearch"],o);const l=p(e,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(y=>AO(y))),x(t,["functionDeclarations"],v)}const u=p(e,["googleMaps"]);u!=null&&x(t,["googleMaps"],u);const d=p(e,["googleSearch"]);d!=null&&x(t,["googleSearch"],d);const f=p(e,["googleSearchRetrieval"]);f!=null&&x(t,["googleSearchRetrieval"],f);const m=p(e,["urlContext"]);return m!=null&&x(t,["urlContext"],m),t}function VO(e){const t={},n=p(e,["promptTokenCount"]);n!=null&&x(t,["promptTokenCount"],n);const r=p(e,["cachedContentTokenCount"]);r!=null&&x(t,["cachedContentTokenCount"],r);const a=p(e,["candidatesTokenCount"]);a!=null&&x(t,["responseTokenCount"],a);const o=p(e,["toolUsePromptTokenCount"]);o!=null&&x(t,["toolUsePromptTokenCount"],o);const l=p(e,["thoughtsTokenCount"]);l!=null&&x(t,["thoughtsTokenCount"],l);const u=p(e,["totalTokenCount"]);u!=null&&x(t,["totalTokenCount"],u);const d=p(e,["promptTokensDetails"]);if(d!=null){let T=d;Array.isArray(T)&&(T=T.map(w=>w)),x(t,["promptTokensDetails"],T)}const f=p(e,["cacheTokensDetails"]);if(f!=null){let T=f;Array.isArray(T)&&(T=T.map(w=>w)),x(t,["cacheTokensDetails"],T)}const m=p(e,["candidatesTokensDetails"]);if(m!=null){let T=m;Array.isArray(T)&&(T=T.map(w=>w)),x(t,["responseTokensDetails"],T)}const v=p(e,["toolUsePromptTokensDetails"]);if(v!=null){let T=v;Array.isArray(T)&&(T=T.map(w=>w)),x(t,["toolUsePromptTokensDetails"],T)}const y=p(e,["trafficType"]);return y!=null&&x(t,["trafficType"],y),t}function zO(e){const t={},n=p(e,["type"]);return n!=null&&x(t,["voiceActivityType"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qO(e,t){const n={},r=p(e,["data"]);if(r!=null&&x(n,["data"],r),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const a=p(e,["mimeType"]);return a!=null&&x(n,["mimeType"],a),n}function jO(e,t){const n={},r=p(e,["content"]);r!=null&&x(n,["content"],r);const a=p(e,["citationMetadata"]);a!=null&&x(n,["citationMetadata"],YO(a));const o=p(e,["tokenCount"]);o!=null&&x(n,["tokenCount"],o);const l=p(e,["finishReason"]);l!=null&&x(n,["finishReason"],l);const u=p(e,["avgLogprobs"]);u!=null&&x(n,["avgLogprobs"],u);const d=p(e,["groundingMetadata"]);d!=null&&x(n,["groundingMetadata"],d);const f=p(e,["index"]);f!=null&&x(n,["index"],f);const m=p(e,["logprobsResult"]);m!=null&&x(n,["logprobsResult"],m);const v=p(e,["safetyRatings"]);if(v!=null){let T=v;Array.isArray(T)&&(T=T.map(w=>w)),x(n,["safetyRatings"],T)}const y=p(e,["urlContextMetadata"]);return y!=null&&x(n,["urlContextMetadata"],y),n}function YO(e,t){const n={},r=p(e,["citationSources"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>o)),x(n,["citations"],a)}return n}function XO(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["contents"]);if(o!=null){let l=Jr(o);Array.isArray(l)&&(l=l.map(u=>u)),x(r,["contents"],l)}return r}function JO(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["tokensInfo"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>l)),x(n,["tokensInfo"],o)}return n}function WO(e,t){const n={},r=p(e,["values"]);r!=null&&x(n,["values"],r);const a=p(e,["statistics"]);return a!=null&&x(n,["statistics"],KO(a)),n}function KO(e,t){const n={},r=p(e,["truncated"]);r!=null&&x(n,["truncated"],r);const a=p(e,["token_count"]);return a!=null&&x(n,["tokenCount"],a),n}function Cf(e,t){const n={},r=p(e,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>iU(l))),x(n,["parts"],o)}const a=p(e,["role"]);return a!=null&&x(n,["role"],a),n}function $O(e,t){const n={},r=p(e,["controlType"]);r!=null&&x(n,["controlType"],r);const a=p(e,["enableControlImageComputation"]);return a!=null&&x(n,["computeControl"],a),n}function QO(e,t){const n={};if(p(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(p(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(p(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return n}function ZO(e,t,n){const r={},a=p(e,["systemInstruction"]);t!==void 0&&a!=null&&x(t,["systemInstruction"],Jn(a));const o=p(e,["tools"]);if(t!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>mT(d))),x(t,["tools"],u)}const l=p(e,["generationConfig"]);return t!==void 0&&l!=null&&x(t,["generationConfig"],qP(l)),r}function eP(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["contents"]);if(o!=null){let u=Jr(o);Array.isArray(u)&&(u=u.map(d=>Cf(d))),x(r,["contents"],u)}const l=p(t,["config"]);return l!=null&&QO(l),r}function tP(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["contents"]);if(o!=null){let u=Jr(o);Array.isArray(u)&&(u=u.map(d=>d)),x(r,["contents"],u)}const l=p(t,["config"]);return l!=null&&ZO(l,r),r}function nP(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["totalTokens"]);a!=null&&x(n,["totalTokens"],a);const o=p(e,["cachedContentTokenCount"]);return o!=null&&x(n,["cachedContentTokenCount"],o),n}function rP(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["totalTokens"]);return a!=null&&x(n,["totalTokens"],a),n}function aP(e,t,n){const r={},a=p(t,["model"]);return a!=null&&x(r,["_url","name"],Dt(e,a)),r}function iP(e,t,n){const r={},a=p(t,["model"]);return a!=null&&x(r,["_url","name"],Dt(e,a)),r}function sP(e,t){const n={},r=p(e,["sdkHttpResponse"]);return r!=null&&x(n,["sdkHttpResponse"],r),n}function oP(e,t){const n={},r=p(e,["sdkHttpResponse"]);return r!=null&&x(n,["sdkHttpResponse"],r),n}function lP(e,t,n){const r={},a=p(e,["outputGcsUri"]);t!==void 0&&a!=null&&x(t,["parameters","storageUri"],a);const o=p(e,["negativePrompt"]);t!==void 0&&o!=null&&x(t,["parameters","negativePrompt"],o);const l=p(e,["numberOfImages"]);t!==void 0&&l!=null&&x(t,["parameters","sampleCount"],l);const u=p(e,["aspectRatio"]);t!==void 0&&u!=null&&x(t,["parameters","aspectRatio"],u);const d=p(e,["guidanceScale"]);t!==void 0&&d!=null&&x(t,["parameters","guidanceScale"],d);const f=p(e,["seed"]);t!==void 0&&f!=null&&x(t,["parameters","seed"],f);const m=p(e,["safetyFilterLevel"]);t!==void 0&&m!=null&&x(t,["parameters","safetySetting"],m);const v=p(e,["personGeneration"]);t!==void 0&&v!=null&&x(t,["parameters","personGeneration"],v);const y=p(e,["includeSafetyAttributes"]);t!==void 0&&y!=null&&x(t,["parameters","includeSafetyAttributes"],y);const T=p(e,["includeRaiReason"]);t!==void 0&&T!=null&&x(t,["parameters","includeRaiReason"],T);const w=p(e,["language"]);t!==void 0&&w!=null&&x(t,["parameters","language"],w);const S=p(e,["outputMimeType"]);t!==void 0&&S!=null&&x(t,["parameters","outputOptions","mimeType"],S);const A=p(e,["outputCompressionQuality"]);t!==void 0&&A!=null&&x(t,["parameters","outputOptions","compressionQuality"],A);const k=p(e,["addWatermark"]);t!==void 0&&k!=null&&x(t,["parameters","addWatermark"],k);const I=p(e,["labels"]);t!==void 0&&I!=null&&x(t,["labels"],I);const b=p(e,["editMode"]);t!==void 0&&b!=null&&x(t,["parameters","editMode"],b);const P=p(e,["baseSteps"]);return t!==void 0&&P!=null&&x(t,["parameters","editConfig","baseSteps"],P),r}function cP(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["prompt"]);o!=null&&x(r,["instances[0]","prompt"],o);const l=p(t,["referenceImages"]);if(l!=null){let d=l;Array.isArray(d)&&(d=d.map(f=>fU(f))),x(r,["instances[0]","referenceImages"],d)}const u=p(t,["config"]);return u!=null&&lP(u,r),r}function uP(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["predictions"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>bf(l))),x(n,["generatedImages"],o)}return n}function fP(e,t,n){const r={},a=p(e,["taskType"]);t!==void 0&&a!=null&&x(t,["requests[]","taskType"],a);const o=p(e,["title"]);t!==void 0&&o!=null&&x(t,["requests[]","title"],o);const l=p(e,["outputDimensionality"]);if(t!==void 0&&l!=null&&x(t,["requests[]","outputDimensionality"],l),p(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function dP(e,t,n){const r={},a=p(e,["taskType"]);t!==void 0&&a!=null&&x(t,["instances[]","task_type"],a);const o=p(e,["title"]);t!==void 0&&o!=null&&x(t,["instances[]","title"],o);const l=p(e,["outputDimensionality"]);t!==void 0&&l!=null&&x(t,["parameters","outputDimensionality"],l);const u=p(e,["mimeType"]);t!==void 0&&u!=null&&x(t,["instances[]","mimeType"],u);const d=p(e,["autoTruncate"]);return t!==void 0&&d!=null&&x(t,["parameters","autoTruncate"],d),r}function hP(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["contents"]);if(o!=null){let d=Im(e,o);Array.isArray(d)&&(d=d.map(f=>f)),x(r,["requests[]","content"],d)}const l=p(t,["config"]);l!=null&&fP(l,r);const u=p(t,["model"]);return u!==void 0&&x(r,["requests[]","model"],Dt(e,u)),r}function mP(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["contents"]);if(o!=null){let u=Im(e,o);Array.isArray(u)&&(u=u.map(d=>d)),x(r,["instances[]","content"],u)}const l=p(t,["config"]);return l!=null&&dP(l,r),r}function pP(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["embeddings"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>u)),x(n,["embeddings"],l)}const o=p(e,["metadata"]);return o!=null&&x(n,["metadata"],o),n}function xP(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["predictions[]","embeddings"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>WO(u))),x(n,["embeddings"],l)}const o=p(e,["metadata"]);return o!=null&&x(n,["metadata"],o),n}function gP(e,t){const n={},r=p(e,["endpoint"]);r!=null&&x(n,["name"],r);const a=p(e,["deployedModelId"]);return a!=null&&x(n,["deployedModelId"],a),n}function vP(e,t){const n={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["fileUri"]);r!=null&&x(n,["fileUri"],r);const a=p(e,["mimeType"]);return a!=null&&x(n,["mimeType"],a),n}function yP(e,t){const n={},r=p(e,["id"]);r!=null&&x(n,["id"],r);const a=p(e,["args"]);a!=null&&x(n,["args"],a);const o=p(e,["name"]);if(o!=null&&x(n,["name"],o),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return n}function _P(e,t){const n={},r=p(e,["allowedFunctionNames"]);r!=null&&x(n,["allowedFunctionNames"],r);const a=p(e,["mode"]);if(a!=null&&x(n,["mode"],a),p(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return n}function EP(e,t){const n={},r=p(e,["description"]);r!=null&&x(n,["description"],r);const a=p(e,["name"]);a!=null&&x(n,["name"],a);const o=p(e,["parameters"]);o!=null&&x(n,["parameters"],o);const l=p(e,["parametersJsonSchema"]);l!=null&&x(n,["parametersJsonSchema"],l);const u=p(e,["response"]);u!=null&&x(n,["response"],u);const d=p(e,["responseJsonSchema"]);if(d!=null&&x(n,["responseJsonSchema"],d),p(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return n}function TP(e,t,n,r){const a={},o=p(t,["systemInstruction"]);n!==void 0&&o!=null&&x(n,["systemInstruction"],Cf(Jn(o)));const l=p(t,["temperature"]);l!=null&&x(a,["temperature"],l);const u=p(t,["topP"]);u!=null&&x(a,["topP"],u);const d=p(t,["topK"]);d!=null&&x(a,["topK"],d);const f=p(t,["candidateCount"]);f!=null&&x(a,["candidateCount"],f);const m=p(t,["maxOutputTokens"]);m!=null&&x(a,["maxOutputTokens"],m);const v=p(t,["stopSequences"]);v!=null&&x(a,["stopSequences"],v);const y=p(t,["responseLogprobs"]);y!=null&&x(a,["responseLogprobs"],y);const T=p(t,["logprobs"]);T!=null&&x(a,["logprobs"],T);const w=p(t,["presencePenalty"]);w!=null&&x(a,["presencePenalty"],w);const S=p(t,["frequencyPenalty"]);S!=null&&x(a,["frequencyPenalty"],S);const A=p(t,["seed"]);A!=null&&x(a,["seed"],A);const k=p(t,["responseMimeType"]);k!=null&&x(a,["responseMimeType"],k);const I=p(t,["responseSchema"]);I!=null&&x(a,["responseSchema"],Fm(I));const b=p(t,["responseJsonSchema"]);if(b!=null&&x(a,["responseJsonSchema"],b),p(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=p(t,["safetySettings"]);if(n!==void 0&&P!=null){let Te=P;Array.isArray(Te)&&(Te=Te.map(ye=>dU(ye))),x(n,["safetySettings"],Te)}const F=p(t,["tools"]);if(n!==void 0&&F!=null){let Te=Ao(F);Array.isArray(Te)&&(Te=Te.map(ye=>yU(wo(ye)))),x(n,["tools"],Te)}const Y=p(t,["toolConfig"]);if(n!==void 0&&Y!=null&&x(n,["toolConfig"],vU(Y)),p(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const D=p(t,["cachedContent"]);n!==void 0&&D!=null&&x(n,["cachedContent"],ti(e,D));const Q=p(t,["responseModalities"]);Q!=null&&x(a,["responseModalities"],Q);const B=p(t,["mediaResolution"]);B!=null&&x(a,["mediaResolution"],B);const ae=p(t,["speechConfig"]);if(ae!=null&&x(a,["speechConfig"],Lm(ae)),p(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ie=p(t,["thinkingConfig"]);ie!=null&&x(a,["thinkingConfig"],ie);const Z=p(t,["imageConfig"]);Z!=null&&x(a,["imageConfig"],WP(Z));const le=p(t,["enableEnhancedCivicAnswers"]);if(le!=null&&x(a,["enableEnhancedCivicAnswers"],le),p(t,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return a}function SP(e,t,n,r){const a={},o=p(t,["systemInstruction"]);n!==void 0&&o!=null&&x(n,["systemInstruction"],Jn(o));const l=p(t,["temperature"]);l!=null&&x(a,["temperature"],l);const u=p(t,["topP"]);u!=null&&x(a,["topP"],u);const d=p(t,["topK"]);d!=null&&x(a,["topK"],d);const f=p(t,["candidateCount"]);f!=null&&x(a,["candidateCount"],f);const m=p(t,["maxOutputTokens"]);m!=null&&x(a,["maxOutputTokens"],m);const v=p(t,["stopSequences"]);v!=null&&x(a,["stopSequences"],v);const y=p(t,["responseLogprobs"]);y!=null&&x(a,["responseLogprobs"],y);const T=p(t,["logprobs"]);T!=null&&x(a,["logprobs"],T);const w=p(t,["presencePenalty"]);w!=null&&x(a,["presencePenalty"],w);const S=p(t,["frequencyPenalty"]);S!=null&&x(a,["frequencyPenalty"],S);const A=p(t,["seed"]);A!=null&&x(a,["seed"],A);const k=p(t,["responseMimeType"]);k!=null&&x(a,["responseMimeType"],k);const I=p(t,["responseSchema"]);I!=null&&x(a,["responseSchema"],Fm(I));const b=p(t,["responseJsonSchema"]);b!=null&&x(a,["responseJsonSchema"],b);const P=p(t,["routingConfig"]);P!=null&&x(a,["routingConfig"],P);const F=p(t,["modelSelectionConfig"]);F!=null&&x(a,["modelConfig"],F);const Y=p(t,["safetySettings"]);if(n!==void 0&&Y!=null){let Ce=Y;Array.isArray(Ce)&&(Ce=Ce.map(re=>re)),x(n,["safetySettings"],Ce)}const D=p(t,["tools"]);if(n!==void 0&&D!=null){let Ce=Ao(D);Array.isArray(Ce)&&(Ce=Ce.map(re=>mT(wo(re)))),x(n,["tools"],Ce)}const Q=p(t,["toolConfig"]);n!==void 0&&Q!=null&&x(n,["toolConfig"],Q);const B=p(t,["labels"]);n!==void 0&&B!=null&&x(n,["labels"],B);const ae=p(t,["cachedContent"]);n!==void 0&&ae!=null&&x(n,["cachedContent"],ti(e,ae));const ie=p(t,["responseModalities"]);ie!=null&&x(a,["responseModalities"],ie);const Z=p(t,["mediaResolution"]);Z!=null&&x(a,["mediaResolution"],Z);const le=p(t,["speechConfig"]);le!=null&&x(a,["speechConfig"],Lm(le));const Te=p(t,["audioTimestamp"]);Te!=null&&x(a,["audioTimestamp"],Te);const ye=p(t,["thinkingConfig"]);ye!=null&&x(a,["thinkingConfig"],ye);const H=p(t,["imageConfig"]);if(H!=null&&x(a,["imageConfig"],KP(H)),p(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const ee=p(t,["modelArmorConfig"]);return n!==void 0&&ee!=null&&x(n,["modelArmorConfig"],ee),a}function f2(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["contents"]);if(o!=null){let u=Jr(o);Array.isArray(u)&&(u=u.map(d=>Cf(d))),x(r,["contents"],u)}const l=p(t,["config"]);return l!=null&&x(r,["generationConfig"],TP(e,l,r)),r}function d2(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["contents"]);if(o!=null){let u=Jr(o);Array.isArray(u)&&(u=u.map(d=>d)),x(r,["contents"],u)}const l=p(t,["config"]);return l!=null&&x(r,["generationConfig"],SP(e,l,r)),r}function h2(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["candidates"]);if(a!=null){let f=a;Array.isArray(f)&&(f=f.map(m=>jO(m))),x(n,["candidates"],f)}const o=p(e,["modelVersion"]);o!=null&&x(n,["modelVersion"],o);const l=p(e,["promptFeedback"]);l!=null&&x(n,["promptFeedback"],l);const u=p(e,["responseId"]);u!=null&&x(n,["responseId"],u);const d=p(e,["usageMetadata"]);return d!=null&&x(n,["usageMetadata"],d),n}function m2(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["candidates"]);if(a!=null){let m=a;Array.isArray(m)&&(m=m.map(v=>v)),x(n,["candidates"],m)}const o=p(e,["createTime"]);o!=null&&x(n,["createTime"],o);const l=p(e,["modelVersion"]);l!=null&&x(n,["modelVersion"],l);const u=p(e,["promptFeedback"]);u!=null&&x(n,["promptFeedback"],u);const d=p(e,["responseId"]);d!=null&&x(n,["responseId"],d);const f=p(e,["usageMetadata"]);return f!=null&&x(n,["usageMetadata"],f),n}function wP(e,t,n){const r={};if(p(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=p(e,["numberOfImages"]);t!==void 0&&a!=null&&x(t,["parameters","sampleCount"],a);const o=p(e,["aspectRatio"]);t!==void 0&&o!=null&&x(t,["parameters","aspectRatio"],o);const l=p(e,["guidanceScale"]);if(t!==void 0&&l!=null&&x(t,["parameters","guidanceScale"],l),p(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=p(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&x(t,["parameters","safetySetting"],u);const d=p(e,["personGeneration"]);t!==void 0&&d!=null&&x(t,["parameters","personGeneration"],d);const f=p(e,["includeSafetyAttributes"]);t!==void 0&&f!=null&&x(t,["parameters","includeSafetyAttributes"],f);const m=p(e,["includeRaiReason"]);t!==void 0&&m!=null&&x(t,["parameters","includeRaiReason"],m);const v=p(e,["language"]);t!==void 0&&v!=null&&x(t,["parameters","language"],v);const y=p(e,["outputMimeType"]);t!==void 0&&y!=null&&x(t,["parameters","outputOptions","mimeType"],y);const T=p(e,["outputCompressionQuality"]);if(t!==void 0&&T!=null&&x(t,["parameters","outputOptions","compressionQuality"],T),p(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const w=p(e,["imageSize"]);if(t!==void 0&&w!=null&&x(t,["parameters","sampleImageSize"],w),p(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function AP(e,t,n){const r={},a=p(e,["outputGcsUri"]);t!==void 0&&a!=null&&x(t,["parameters","storageUri"],a);const o=p(e,["negativePrompt"]);t!==void 0&&o!=null&&x(t,["parameters","negativePrompt"],o);const l=p(e,["numberOfImages"]);t!==void 0&&l!=null&&x(t,["parameters","sampleCount"],l);const u=p(e,["aspectRatio"]);t!==void 0&&u!=null&&x(t,["parameters","aspectRatio"],u);const d=p(e,["guidanceScale"]);t!==void 0&&d!=null&&x(t,["parameters","guidanceScale"],d);const f=p(e,["seed"]);t!==void 0&&f!=null&&x(t,["parameters","seed"],f);const m=p(e,["safetyFilterLevel"]);t!==void 0&&m!=null&&x(t,["parameters","safetySetting"],m);const v=p(e,["personGeneration"]);t!==void 0&&v!=null&&x(t,["parameters","personGeneration"],v);const y=p(e,["includeSafetyAttributes"]);t!==void 0&&y!=null&&x(t,["parameters","includeSafetyAttributes"],y);const T=p(e,["includeRaiReason"]);t!==void 0&&T!=null&&x(t,["parameters","includeRaiReason"],T);const w=p(e,["language"]);t!==void 0&&w!=null&&x(t,["parameters","language"],w);const S=p(e,["outputMimeType"]);t!==void 0&&S!=null&&x(t,["parameters","outputOptions","mimeType"],S);const A=p(e,["outputCompressionQuality"]);t!==void 0&&A!=null&&x(t,["parameters","outputOptions","compressionQuality"],A);const k=p(e,["addWatermark"]);t!==void 0&&k!=null&&x(t,["parameters","addWatermark"],k);const I=p(e,["labels"]);t!==void 0&&I!=null&&x(t,["labels"],I);const b=p(e,["imageSize"]);t!==void 0&&b!=null&&x(t,["parameters","sampleImageSize"],b);const P=p(e,["enhancePrompt"]);return t!==void 0&&P!=null&&x(t,["parameters","enhancePrompt"],P),r}function CP(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["prompt"]);o!=null&&x(r,["instances[0]","prompt"],o);const l=p(t,["config"]);return l!=null&&wP(l,r),r}function bP(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["prompt"]);o!=null&&x(r,["instances[0]","prompt"],o);const l=p(t,["config"]);return l!=null&&AP(l,r),r}function NP(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["predictions"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>HP(u))),x(n,["generatedImages"],l)}const o=p(e,["positivePromptSafetyAttributes"]);return o!=null&&x(n,["positivePromptSafetyAttributes"],dT(o)),n}function kP(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["predictions"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(u=>bf(u))),x(n,["generatedImages"],l)}const o=p(e,["positivePromptSafetyAttributes"]);return o!=null&&x(n,["positivePromptSafetyAttributes"],hT(o)),n}function RP(e,t,n){const r={},a=p(e,["numberOfVideos"]);if(t!==void 0&&a!=null&&x(t,["parameters","sampleCount"],a),p(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=p(e,["durationSeconds"]);if(t!==void 0&&o!=null&&x(t,["parameters","durationSeconds"],o),p(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=p(e,["aspectRatio"]);t!==void 0&&l!=null&&x(t,["parameters","aspectRatio"],l);const u=p(e,["resolution"]);t!==void 0&&u!=null&&x(t,["parameters","resolution"],u);const d=p(e,["personGeneration"]);if(t!==void 0&&d!=null&&x(t,["parameters","personGeneration"],d),p(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=p(e,["negativePrompt"]);t!==void 0&&f!=null&&x(t,["parameters","negativePrompt"],f);const m=p(e,["enhancePrompt"]);if(t!==void 0&&m!=null&&x(t,["parameters","enhancePrompt"],m),p(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const v=p(e,["lastFrame"]);t!==void 0&&v!=null&&x(t,["instances[0]","lastFrame"],Nf(v));const y=p(e,["referenceImages"]);if(t!==void 0&&y!=null){let T=y;Array.isArray(T)&&(T=T.map(w=>MU(w))),x(t,["instances[0]","referenceImages"],T)}if(p(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(p(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return r}function DP(e,t,n){const r={},a=p(e,["numberOfVideos"]);t!==void 0&&a!=null&&x(t,["parameters","sampleCount"],a);const o=p(e,["outputGcsUri"]);t!==void 0&&o!=null&&x(t,["parameters","storageUri"],o);const l=p(e,["fps"]);t!==void 0&&l!=null&&x(t,["parameters","fps"],l);const u=p(e,["durationSeconds"]);t!==void 0&&u!=null&&x(t,["parameters","durationSeconds"],u);const d=p(e,["seed"]);t!==void 0&&d!=null&&x(t,["parameters","seed"],d);const f=p(e,["aspectRatio"]);t!==void 0&&f!=null&&x(t,["parameters","aspectRatio"],f);const m=p(e,["resolution"]);t!==void 0&&m!=null&&x(t,["parameters","resolution"],m);const v=p(e,["personGeneration"]);t!==void 0&&v!=null&&x(t,["parameters","personGeneration"],v);const y=p(e,["pubsubTopic"]);t!==void 0&&y!=null&&x(t,["parameters","pubsubTopic"],y);const T=p(e,["negativePrompt"]);t!==void 0&&T!=null&&x(t,["parameters","negativePrompt"],T);const w=p(e,["enhancePrompt"]);t!==void 0&&w!=null&&x(t,["parameters","enhancePrompt"],w);const S=p(e,["generateAudio"]);t!==void 0&&S!=null&&x(t,["parameters","generateAudio"],S);const A=p(e,["lastFrame"]);t!==void 0&&A!=null&&x(t,["instances[0]","lastFrame"],ha(A));const k=p(e,["referenceImages"]);if(t!==void 0&&k!=null){let P=k;Array.isArray(P)&&(P=P.map(F=>IU(F))),x(t,["instances[0]","referenceImages"],P)}const I=p(e,["mask"]);t!==void 0&&I!=null&&x(t,["instances[0]","mask"],DU(I));const b=p(e,["compressionQuality"]);return t!==void 0&&b!=null&&x(t,["parameters","compressionQuality"],b),r}function MP(e,t){const n={},r=p(e,["name"]);r!=null&&x(n,["name"],r);const a=p(e,["metadata"]);a!=null&&x(n,["metadata"],a);const o=p(e,["done"]);o!=null&&x(n,["done"],o);const l=p(e,["error"]);l!=null&&x(n,["error"],l);const u=p(e,["response","generateVideoResponse"]);return u!=null&&x(n,["response"],OP(u)),n}function IP(e,t){const n={},r=p(e,["name"]);r!=null&&x(n,["name"],r);const a=p(e,["metadata"]);a!=null&&x(n,["metadata"],a);const o=p(e,["done"]);o!=null&&x(n,["done"],o);const l=p(e,["error"]);l!=null&&x(n,["error"],l);const u=p(e,["response"]);return u!=null&&x(n,["response"],PP(u)),n}function FP(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["prompt"]);o!=null&&x(r,["instances[0]","prompt"],o);const l=p(t,["image"]);l!=null&&x(r,["instances[0]","image"],Nf(l));const u=p(t,["video"]);u!=null&&x(r,["instances[0]","video"],pT(u));const d=p(t,["source"]);d!=null&&UP(d,r);const f=p(t,["config"]);return f!=null&&RP(f,r),r}function LP(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["prompt"]);o!=null&&x(r,["instances[0]","prompt"],o);const l=p(t,["image"]);l!=null&&x(r,["instances[0]","image"],ha(l));const u=p(t,["video"]);u!=null&&x(r,["instances[0]","video"],xT(u));const d=p(t,["source"]);d!=null&&BP(d,r);const f=p(t,["config"]);return f!=null&&DP(f,r),r}function OP(e,t){const n={},r=p(e,["generatedSamples"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>VP(u))),x(n,["generatedVideos"],l)}const a=p(e,["raiMediaFilteredCount"]);a!=null&&x(n,["raiMediaFilteredCount"],a);const o=p(e,["raiMediaFilteredReasons"]);return o!=null&&x(n,["raiMediaFilteredReasons"],o),n}function PP(e,t){const n={},r=p(e,["videos"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(u=>zP(u))),x(n,["generatedVideos"],l)}const a=p(e,["raiMediaFilteredCount"]);a!=null&&x(n,["raiMediaFilteredCount"],a);const o=p(e,["raiMediaFilteredReasons"]);return o!=null&&x(n,["raiMediaFilteredReasons"],o),n}function UP(e,t,n){const r={},a=p(e,["prompt"]);t!==void 0&&a!=null&&x(t,["instances[0]","prompt"],a);const o=p(e,["image"]);t!==void 0&&o!=null&&x(t,["instances[0]","image"],Nf(o));const l=p(e,["video"]);return t!==void 0&&l!=null&&x(t,["instances[0]","video"],pT(l)),r}function BP(e,t,n){const r={},a=p(e,["prompt"]);t!==void 0&&a!=null&&x(t,["instances[0]","prompt"],a);const o=p(e,["image"]);t!==void 0&&o!=null&&x(t,["instances[0]","image"],ha(o));const l=p(e,["video"]);return t!==void 0&&l!=null&&x(t,["instances[0]","video"],xT(l)),r}function HP(e,t){const n={},r=p(e,["_self"]);r!=null&&x(n,["image"],$P(r));const a=p(e,["raiFilteredReason"]);a!=null&&x(n,["raiFilteredReason"],a);const o=p(e,["_self"]);return o!=null&&x(n,["safetyAttributes"],dT(o)),n}function bf(e,t){const n={},r=p(e,["_self"]);r!=null&&x(n,["image"],fT(r));const a=p(e,["raiFilteredReason"]);a!=null&&x(n,["raiFilteredReason"],a);const o=p(e,["_self"]);o!=null&&x(n,["safetyAttributes"],hT(o));const l=p(e,["prompt"]);return l!=null&&x(n,["enhancedPrompt"],l),n}function GP(e,t){const n={},r=p(e,["_self"]);r!=null&&x(n,["mask"],fT(r));const a=p(e,["labels"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>l)),x(n,["labels"],o)}return n}function VP(e,t){const n={},r=p(e,["video"]);return r!=null&&x(n,["video"],kU(r)),n}function zP(e,t){const n={},r=p(e,["_self"]);return r!=null&&x(n,["video"],RU(r)),n}function qP(e,t){const n={},r=p(e,["modelSelectionConfig"]);r!=null&&x(n,["modelConfig"],r);const a=p(e,["responseJsonSchema"]);a!=null&&x(n,["responseJsonSchema"],a);const o=p(e,["audioTimestamp"]);o!=null&&x(n,["audioTimestamp"],o);const l=p(e,["candidateCount"]);l!=null&&x(n,["candidateCount"],l);const u=p(e,["enableAffectiveDialog"]);u!=null&&x(n,["enableAffectiveDialog"],u);const d=p(e,["frequencyPenalty"]);d!=null&&x(n,["frequencyPenalty"],d);const f=p(e,["logprobs"]);f!=null&&x(n,["logprobs"],f);const m=p(e,["maxOutputTokens"]);m!=null&&x(n,["maxOutputTokens"],m);const v=p(e,["mediaResolution"]);v!=null&&x(n,["mediaResolution"],v);const y=p(e,["presencePenalty"]);y!=null&&x(n,["presencePenalty"],y);const T=p(e,["responseLogprobs"]);T!=null&&x(n,["responseLogprobs"],T);const w=p(e,["responseMimeType"]);w!=null&&x(n,["responseMimeType"],w);const S=p(e,["responseModalities"]);S!=null&&x(n,["responseModalities"],S);const A=p(e,["responseSchema"]);A!=null&&x(n,["responseSchema"],A);const k=p(e,["routingConfig"]);k!=null&&x(n,["routingConfig"],k);const I=p(e,["seed"]);I!=null&&x(n,["seed"],I);const b=p(e,["speechConfig"]);b!=null&&x(n,["speechConfig"],b);const P=p(e,["stopSequences"]);P!=null&&x(n,["stopSequences"],P);const F=p(e,["temperature"]);F!=null&&x(n,["temperature"],F);const Y=p(e,["thinkingConfig"]);Y!=null&&x(n,["thinkingConfig"],Y);const D=p(e,["topK"]);D!=null&&x(n,["topK"],D);const Q=p(e,["topP"]);if(Q!=null&&x(n,["topP"],Q),p(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}function jP(e,t,n){const r={},a=p(t,["model"]);return a!=null&&x(r,["_url","name"],Dt(e,a)),r}function YP(e,t,n){const r={},a=p(t,["model"]);return a!=null&&x(r,["_url","name"],Dt(e,a)),r}function XP(e,t){const n={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const r=p(e,["enableWidget"]);return r!=null&&x(n,["enableWidget"],r),n}function JP(e,t){const n={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const r=p(e,["timeRangeFilter"]);return r!=null&&x(n,["timeRangeFilter"],r),n}function WP(e,t){const n={},r=p(e,["aspectRatio"]);r!=null&&x(n,["aspectRatio"],r);const a=p(e,["imageSize"]);if(a!=null&&x(n,["imageSize"],a),p(e,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(p(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(p(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return n}function KP(e,t){const n={},r=p(e,["aspectRatio"]);r!=null&&x(n,["aspectRatio"],r);const a=p(e,["imageSize"]);a!=null&&x(n,["imageSize"],a);const o=p(e,["personGeneration"]);o!=null&&x(n,["personGeneration"],o);const l=p(e,["outputMimeType"]);l!=null&&x(n,["imageOutputOptions","mimeType"],l);const u=p(e,["outputCompressionQuality"]);return u!=null&&x(n,["imageOutputOptions","compressionQuality"],u),n}function $P(e,t){const n={},r=p(e,["bytesBase64Encoded"]);r!=null&&x(n,["imageBytes"],Ui(r));const a=p(e,["mimeType"]);return a!=null&&x(n,["mimeType"],a),n}function fT(e,t){const n={},r=p(e,["gcsUri"]);r!=null&&x(n,["gcsUri"],r);const a=p(e,["bytesBase64Encoded"]);a!=null&&x(n,["imageBytes"],Ui(a));const o=p(e,["mimeType"]);return o!=null&&x(n,["mimeType"],o),n}function Nf(e,t){const n={};if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=p(e,["imageBytes"]);r!=null&&x(n,["bytesBase64Encoded"],Ui(r));const a=p(e,["mimeType"]);return a!=null&&x(n,["mimeType"],a),n}function ha(e,t){const n={},r=p(e,["gcsUri"]);r!=null&&x(n,["gcsUri"],r);const a=p(e,["imageBytes"]);a!=null&&x(n,["bytesBase64Encoded"],Ui(a));const o=p(e,["mimeType"]);return o!=null&&x(n,["mimeType"],o),n}function QP(e,t,n,r){const a={},o=p(t,["pageSize"]);n!==void 0&&o!=null&&x(n,["_query","pageSize"],o);const l=p(t,["pageToken"]);n!==void 0&&l!=null&&x(n,["_query","pageToken"],l);const u=p(t,["filter"]);n!==void 0&&u!=null&&x(n,["_query","filter"],u);const d=p(t,["queryBase"]);return n!==void 0&&d!=null&&x(n,["_url","models_url"],aT(e,d)),a}function ZP(e,t,n,r){const a={},o=p(t,["pageSize"]);n!==void 0&&o!=null&&x(n,["_query","pageSize"],o);const l=p(t,["pageToken"]);n!==void 0&&l!=null&&x(n,["_query","pageToken"],l);const u=p(t,["filter"]);n!==void 0&&u!=null&&x(n,["_query","filter"],u);const d=p(t,["queryBase"]);return n!==void 0&&d!=null&&x(n,["_url","models_url"],aT(e,d)),a}function eU(e,t,n){const r={},a=p(t,["config"]);return a!=null&&QP(e,a,r),r}function tU(e,t,n){const r={},a=p(t,["config"]);return a!=null&&ZP(e,a,r),r}function nU(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["nextPageToken"]);a!=null&&x(n,["nextPageToken"],a);const o=p(e,["_self"]);if(o!=null){let l=iT(o);Array.isArray(l)&&(l=l.map(u=>Rh(u))),x(n,["models"],l)}return n}function rU(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["nextPageToken"]);a!=null&&x(n,["nextPageToken"],a);const o=p(e,["_self"]);if(o!=null){let l=iT(o);Array.isArray(l)&&(l=l.map(u=>Dh(u))),x(n,["models"],l)}return n}function aU(e,t){const n={},r=p(e,["maskMode"]);r!=null&&x(n,["maskMode"],r);const a=p(e,["segmentationClasses"]);a!=null&&x(n,["maskClasses"],a);const o=p(e,["maskDilation"]);return o!=null&&x(n,["dilation"],o),n}function Rh(e,t){const n={},r=p(e,["name"]);r!=null&&x(n,["name"],r);const a=p(e,["displayName"]);a!=null&&x(n,["displayName"],a);const o=p(e,["description"]);o!=null&&x(n,["description"],o);const l=p(e,["version"]);l!=null&&x(n,["version"],l);const u=p(e,["_self"]);u!=null&&x(n,["tunedModelInfo"],_U(u));const d=p(e,["inputTokenLimit"]);d!=null&&x(n,["inputTokenLimit"],d);const f=p(e,["outputTokenLimit"]);f!=null&&x(n,["outputTokenLimit"],f);const m=p(e,["supportedGenerationMethods"]);m!=null&&x(n,["supportedActions"],m);const v=p(e,["temperature"]);v!=null&&x(n,["temperature"],v);const y=p(e,["maxTemperature"]);y!=null&&x(n,["maxTemperature"],y);const T=p(e,["topP"]);T!=null&&x(n,["topP"],T);const w=p(e,["topK"]);w!=null&&x(n,["topK"],w);const S=p(e,["thinking"]);return S!=null&&x(n,["thinking"],S),n}function Dh(e,t){const n={},r=p(e,["name"]);r!=null&&x(n,["name"],r);const a=p(e,["displayName"]);a!=null&&x(n,["displayName"],a);const o=p(e,["description"]);o!=null&&x(n,["description"],o);const l=p(e,["versionId"]);l!=null&&x(n,["version"],l);const u=p(e,["deployedModels"]);if(u!=null){let y=u;Array.isArray(y)&&(y=y.map(T=>gP(T))),x(n,["endpoints"],y)}const d=p(e,["labels"]);d!=null&&x(n,["labels"],d);const f=p(e,["_self"]);f!=null&&x(n,["tunedModelInfo"],EU(f));const m=p(e,["defaultCheckpointId"]);m!=null&&x(n,["defaultCheckpointId"],m);const v=p(e,["checkpoints"]);if(v!=null){let y=v;Array.isArray(y)&&(y=y.map(T=>T)),x(n,["checkpoints"],y)}return n}function iU(e,t){const n={},r=p(e,["mediaResolution"]);r!=null&&x(n,["mediaResolution"],r);const a=p(e,["codeExecutionResult"]);a!=null&&x(n,["codeExecutionResult"],a);const o=p(e,["executableCode"]);o!=null&&x(n,["executableCode"],o);const l=p(e,["fileData"]);l!=null&&x(n,["fileData"],vP(l));const u=p(e,["functionCall"]);u!=null&&x(n,["functionCall"],yP(u));const d=p(e,["functionResponse"]);d!=null&&x(n,["functionResponse"],d);const f=p(e,["inlineData"]);f!=null&&x(n,["inlineData"],qO(f));const m=p(e,["text"]);m!=null&&x(n,["text"],m);const v=p(e,["thought"]);v!=null&&x(n,["thought"],v);const y=p(e,["thoughtSignature"]);y!=null&&x(n,["thoughtSignature"],y);const T=p(e,["videoMetadata"]);return T!=null&&x(n,["videoMetadata"],T),n}function sU(e,t){const n={},r=p(e,["productImage"]);return r!=null&&x(n,["image"],ha(r)),n}function oU(e,t,n){const r={},a=p(e,["numberOfImages"]);t!==void 0&&a!=null&&x(t,["parameters","sampleCount"],a);const o=p(e,["baseSteps"]);t!==void 0&&o!=null&&x(t,["parameters","baseSteps"],o);const l=p(e,["outputGcsUri"]);t!==void 0&&l!=null&&x(t,["parameters","storageUri"],l);const u=p(e,["seed"]);t!==void 0&&u!=null&&x(t,["parameters","seed"],u);const d=p(e,["safetyFilterLevel"]);t!==void 0&&d!=null&&x(t,["parameters","safetySetting"],d);const f=p(e,["personGeneration"]);t!==void 0&&f!=null&&x(t,["parameters","personGeneration"],f);const m=p(e,["addWatermark"]);t!==void 0&&m!=null&&x(t,["parameters","addWatermark"],m);const v=p(e,["outputMimeType"]);t!==void 0&&v!=null&&x(t,["parameters","outputOptions","mimeType"],v);const y=p(e,["outputCompressionQuality"]);t!==void 0&&y!=null&&x(t,["parameters","outputOptions","compressionQuality"],y);const T=p(e,["enhancePrompt"]);t!==void 0&&T!=null&&x(t,["parameters","enhancePrompt"],T);const w=p(e,["labels"]);return t!==void 0&&w!=null&&x(t,["labels"],w),r}function lU(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["source"]);o!=null&&uU(o,r);const l=p(t,["config"]);return l!=null&&oU(l,r),r}function cU(e,t){const n={},r=p(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>bf(o))),x(n,["generatedImages"],a)}return n}function uU(e,t,n){const r={},a=p(e,["prompt"]);t!==void 0&&a!=null&&x(t,["instances[0]","prompt"],a);const o=p(e,["personImage"]);t!==void 0&&o!=null&&x(t,["instances[0]","personImage","image"],ha(o));const l=p(e,["productImages"]);if(t!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(d=>sU(d))),x(t,["instances[0]","productImages"],u)}return r}function fU(e,t){const n={},r=p(e,["referenceImage"]);r!=null&&x(n,["referenceImage"],ha(r));const a=p(e,["referenceId"]);a!=null&&x(n,["referenceId"],a);const o=p(e,["referenceType"]);o!=null&&x(n,["referenceType"],o);const l=p(e,["maskImageConfig"]);l!=null&&x(n,["maskImageConfig"],aU(l));const u=p(e,["controlImageConfig"]);u!=null&&x(n,["controlImageConfig"],$O(u));const d=p(e,["styleImageConfig"]);d!=null&&x(n,["styleImageConfig"],d);const f=p(e,["subjectImageConfig"]);return f!=null&&x(n,["subjectImageConfig"],f),n}function dT(e,t){const n={},r=p(e,["safetyAttributes","categories"]);r!=null&&x(n,["categories"],r);const a=p(e,["safetyAttributes","scores"]);a!=null&&x(n,["scores"],a);const o=p(e,["contentType"]);return o!=null&&x(n,["contentType"],o),n}function hT(e,t){const n={},r=p(e,["safetyAttributes","categories"]);r!=null&&x(n,["categories"],r);const a=p(e,["safetyAttributes","scores"]);a!=null&&x(n,["scores"],a);const o=p(e,["contentType"]);return o!=null&&x(n,["contentType"],o),n}function dU(e,t){const n={},r=p(e,["category"]);if(r!=null&&x(n,["category"],r),p(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const a=p(e,["threshold"]);return a!=null&&x(n,["threshold"],a),n}function hU(e,t){const n={},r=p(e,["image"]);return r!=null&&x(n,["image"],ha(r)),n}function mU(e,t,n){const r={},a=p(e,["mode"]);t!==void 0&&a!=null&&x(t,["parameters","mode"],a);const o=p(e,["maxPredictions"]);t!==void 0&&o!=null&&x(t,["parameters","maxPredictions"],o);const l=p(e,["confidenceThreshold"]);t!==void 0&&l!=null&&x(t,["parameters","confidenceThreshold"],l);const u=p(e,["maskDilation"]);t!==void 0&&u!=null&&x(t,["parameters","maskDilation"],u);const d=p(e,["binaryColorThreshold"]);t!==void 0&&d!=null&&x(t,["parameters","binaryColorThreshold"],d);const f=p(e,["labels"]);return t!==void 0&&f!=null&&x(t,["labels"],f),r}function pU(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["source"]);o!=null&&gU(o,r);const l=p(t,["config"]);return l!=null&&mU(l,r),r}function xU(e,t){const n={},r=p(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>GP(o))),x(n,["generatedMasks"],a)}return n}function gU(e,t,n){const r={},a=p(e,["prompt"]);t!==void 0&&a!=null&&x(t,["instances[0]","prompt"],a);const o=p(e,["image"]);t!==void 0&&o!=null&&x(t,["instances[0]","image"],ha(o));const l=p(e,["scribbleImage"]);return t!==void 0&&l!=null&&x(t,["instances[0]","scribble"],hU(l)),r}function vU(e,t){const n={},r=p(e,["retrievalConfig"]);r!=null&&x(n,["retrievalConfig"],r);const a=p(e,["functionCallingConfig"]);return a!=null&&x(n,["functionCallingConfig"],_P(a)),n}function yU(e,t){const n={};if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=p(e,["computerUse"]);r!=null&&x(n,["computerUse"],r);const a=p(e,["fileSearch"]);a!=null&&x(n,["fileSearch"],a);const o=p(e,["codeExecution"]);if(o!=null&&x(n,["codeExecution"],o),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=p(e,["functionDeclarations"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(y=>y)),x(n,["functionDeclarations"],v)}const u=p(e,["googleMaps"]);u!=null&&x(n,["googleMaps"],XP(u));const d=p(e,["googleSearch"]);d!=null&&x(n,["googleSearch"],JP(d));const f=p(e,["googleSearchRetrieval"]);f!=null&&x(n,["googleSearchRetrieval"],f);const m=p(e,["urlContext"]);return m!=null&&x(n,["urlContext"],m),n}function mT(e,t){const n={},r=p(e,["retrieval"]);r!=null&&x(n,["retrieval"],r);const a=p(e,["computerUse"]);if(a!=null&&x(n,["computerUse"],a),p(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=p(e,["codeExecution"]);o!=null&&x(n,["codeExecution"],o);const l=p(e,["enterpriseWebSearch"]);l!=null&&x(n,["enterpriseWebSearch"],l);const u=p(e,["functionDeclarations"]);if(u!=null){let y=u;Array.isArray(y)&&(y=y.map(T=>EP(T))),x(n,["functionDeclarations"],y)}const d=p(e,["googleMaps"]);d!=null&&x(n,["googleMaps"],d);const f=p(e,["googleSearch"]);f!=null&&x(n,["googleSearch"],f);const m=p(e,["googleSearchRetrieval"]);m!=null&&x(n,["googleSearchRetrieval"],m);const v=p(e,["urlContext"]);return v!=null&&x(n,["urlContext"],v),n}function _U(e,t){const n={},r=p(e,["baseModel"]);r!=null&&x(n,["baseModel"],r);const a=p(e,["createTime"]);a!=null&&x(n,["createTime"],a);const o=p(e,["updateTime"]);return o!=null&&x(n,["updateTime"],o),n}function EU(e,t){const n={},r=p(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&x(n,["baseModel"],r);const a=p(e,["createTime"]);a!=null&&x(n,["createTime"],a);const o=p(e,["updateTime"]);return o!=null&&x(n,["updateTime"],o),n}function TU(e,t,n){const r={},a=p(e,["displayName"]);t!==void 0&&a!=null&&x(t,["displayName"],a);const o=p(e,["description"]);t!==void 0&&o!=null&&x(t,["description"],o);const l=p(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&x(t,["defaultCheckpointId"],l),r}function SU(e,t,n){const r={},a=p(e,["displayName"]);t!==void 0&&a!=null&&x(t,["displayName"],a);const o=p(e,["description"]);t!==void 0&&o!=null&&x(t,["description"],o);const l=p(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&x(t,["defaultCheckpointId"],l),r}function wU(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","name"],Dt(e,a));const o=p(t,["config"]);return o!=null&&TU(o,r),r}function AU(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["config"]);return o!=null&&SU(o,r),r}function CU(e,t,n){const r={},a=p(e,["outputGcsUri"]);t!==void 0&&a!=null&&x(t,["parameters","storageUri"],a);const o=p(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&x(t,["parameters","safetySetting"],o);const l=p(e,["personGeneration"]);t!==void 0&&l!=null&&x(t,["parameters","personGeneration"],l);const u=p(e,["includeRaiReason"]);t!==void 0&&u!=null&&x(t,["parameters","includeRaiReason"],u);const d=p(e,["outputMimeType"]);t!==void 0&&d!=null&&x(t,["parameters","outputOptions","mimeType"],d);const f=p(e,["outputCompressionQuality"]);t!==void 0&&f!=null&&x(t,["parameters","outputOptions","compressionQuality"],f);const m=p(e,["enhanceInputImage"]);t!==void 0&&m!=null&&x(t,["parameters","upscaleConfig","enhanceInputImage"],m);const v=p(e,["imagePreservationFactor"]);t!==void 0&&v!=null&&x(t,["parameters","upscaleConfig","imagePreservationFactor"],v);const y=p(e,["labels"]);t!==void 0&&y!=null&&x(t,["labels"],y);const T=p(e,["numberOfImages"]);t!==void 0&&T!=null&&x(t,["parameters","sampleCount"],T);const w=p(e,["mode"]);return t!==void 0&&w!=null&&x(t,["parameters","mode"],w),r}function bU(e,t,n){const r={},a=p(t,["model"]);a!=null&&x(r,["_url","model"],Dt(e,a));const o=p(t,["image"]);o!=null&&x(r,["instances[0]","image"],ha(o));const l=p(t,["upscaleFactor"]);l!=null&&x(r,["parameters","upscaleConfig","upscaleFactor"],l);const u=p(t,["config"]);return u!=null&&CU(u,r),r}function NU(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["predictions"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>bf(l))),x(n,["generatedImages"],o)}return n}function kU(e,t){const n={},r=p(e,["uri"]);r!=null&&x(n,["uri"],r);const a=p(e,["encodedVideo"]);a!=null&&x(n,["videoBytes"],Ui(a));const o=p(e,["encoding"]);return o!=null&&x(n,["mimeType"],o),n}function RU(e,t){const n={},r=p(e,["gcsUri"]);r!=null&&x(n,["uri"],r);const a=p(e,["bytesBase64Encoded"]);a!=null&&x(n,["videoBytes"],Ui(a));const o=p(e,["mimeType"]);return o!=null&&x(n,["mimeType"],o),n}function DU(e,t){const n={},r=p(e,["image"]);r!=null&&x(n,["_self"],ha(r));const a=p(e,["maskMode"]);return a!=null&&x(n,["maskMode"],a),n}function MU(e,t){const n={},r=p(e,["image"]);r!=null&&x(n,["image"],Nf(r));const a=p(e,["referenceType"]);return a!=null&&x(n,["referenceType"],a),n}function IU(e,t){const n={},r=p(e,["image"]);r!=null&&x(n,["image"],ha(r));const a=p(e,["referenceType"]);return a!=null&&x(n,["referenceType"],a),n}function pT(e,t){const n={},r=p(e,["uri"]);r!=null&&x(n,["uri"],r);const a=p(e,["videoBytes"]);a!=null&&x(n,["encodedVideo"],Ui(a));const o=p(e,["mimeType"]);return o!=null&&x(n,["encoding"],o),n}function xT(e,t){const n={},r=p(e,["uri"]);r!=null&&x(n,["gcsUri"],r);const a=p(e,["videoBytes"]);a!=null&&x(n,["bytesBase64Encoded"],Ui(a));const o=p(e,["mimeType"]);return o!=null&&x(n,["mimeType"],o),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FU(e,t){const n={},r=p(e,["displayName"]);return t!==void 0&&r!=null&&x(t,["displayName"],r),n}function LU(e){const t={},n=p(e,["config"]);return n!=null&&FU(n,t),t}function OU(e,t){const n={},r=p(e,["force"]);return t!==void 0&&r!=null&&x(t,["_query","force"],r),n}function PU(e){const t={},n=p(e,["name"]);n!=null&&x(t,["_url","name"],n);const r=p(e,["config"]);return r!=null&&OU(r,t),t}function UU(e){const t={},n=p(e,["name"]);return n!=null&&x(t,["_url","name"],n),t}function BU(e,t){const n={},r=p(e,["customMetadata"]);if(t!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),x(t,["customMetadata"],o)}const a=p(e,["chunkingConfig"]);return t!==void 0&&a!=null&&x(t,["chunkingConfig"],a),n}function HU(e){const t={},n=p(e,["name"]);n!=null&&x(t,["name"],n);const r=p(e,["metadata"]);r!=null&&x(t,["metadata"],r);const a=p(e,["done"]);a!=null&&x(t,["done"],a);const o=p(e,["error"]);o!=null&&x(t,["error"],o);const l=p(e,["response"]);return l!=null&&x(t,["response"],VU(l)),t}function GU(e){const t={},n=p(e,["fileSearchStoreName"]);n!=null&&x(t,["_url","file_search_store_name"],n);const r=p(e,["fileName"]);r!=null&&x(t,["fileName"],r);const a=p(e,["config"]);return a!=null&&BU(a,t),t}function VU(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["parent"]);r!=null&&x(t,["parent"],r);const a=p(e,["documentName"]);return a!=null&&x(t,["documentName"],a),t}function zU(e,t){const n={},r=p(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const a=p(e,["pageToken"]);return t!==void 0&&a!=null&&x(t,["_query","pageToken"],a),n}function qU(e){const t={},n=p(e,["config"]);return n!=null&&zU(n,t),t}function jU(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["nextPageToken"]);r!=null&&x(t,["nextPageToken"],r);const a=p(e,["fileSearchStores"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>l)),x(t,["fileSearchStores"],o)}return t}function gT(e,t){const n={},r=p(e,["mimeType"]);t!==void 0&&r!=null&&x(t,["mimeType"],r);const a=p(e,["displayName"]);t!==void 0&&a!=null&&x(t,["displayName"],a);const o=p(e,["customMetadata"]);if(t!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>d)),x(t,["customMetadata"],u)}const l=p(e,["chunkingConfig"]);return t!==void 0&&l!=null&&x(t,["chunkingConfig"],l),n}function YU(e){const t={},n=p(e,["fileSearchStoreName"]);n!=null&&x(t,["_url","file_search_store_name"],n);const r=p(e,["config"]);return r!=null&&gT(r,t),t}function XU(e){const t={},n=p(e,["sdkHttpResponse"]);return n!=null&&x(t,["sdkHttpResponse"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const JU="Content-Type",WU="X-Server-Timeout",KU="User-Agent",Mh="x-goog-api-client",$U="1.39.0",QU=`google-genai-sdk/${$U}`,ZU="v1beta1",e7="v1beta";class t7{constructor(t){var n,r,a;this.clientOptions=Object.assign({},t),this.customBaseUrl=(n=t.httpOptions)===null||n===void 0?void 0:n.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const o={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const u=t.project&&t.location||!!t.apiKey;this.customBaseUrl&&!u?(o.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?o.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(o.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),o.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:ZU}else{if(!this.clientOptions.apiKey)throw new tc({message:"API key must be set when using the Gemini API.",status:403});o.apiVersion=(a=this.clientOptions.apiVersion)!==null&&a!==void 0?a:e7,o.baseUrl="https://generativelanguage.googleapis.com/"}o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,t.httpOptions))}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const t=new Headers;return await this.clientOptions.auth.addAuthHeaders(t),t}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const a=[this.getRequestUrlInternal(n)];return r&&a.push(this.getBaseResourcePath()),t!==""&&a.push(t),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(t,n){return!(n.baseUrl&&n.baseUrlResourceScope===Ch.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t,n),a=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[l,u]of Object.entries(t.queryParams))a.searchParams.append(l,String(u));let o={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=t.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,a.toString(),t.abortSignal),this.unaryApiCall(a,o,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[a,o]of Object.entries(n))typeof o=="object"?r[a]=Object.assign(Object.assign({},r[a]),o):o!==void 0&&(r[a]=o);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t,n),a=this.constructUrl(t.path,n,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let o={};return o.body=t.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,a.toString(),t.abortSignal),this.streamApiCall(a,o,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r,a){if(n&&n.timeout||a){const o=new AbortController,l=o.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const u=setTimeout(()=>o.abort(),n.timeout);u&&typeof u.unref=="function"&&u.unref()}a&&a.addEventListener("abort",()=>{o.abort()}),t.signal=l}return n&&n.extraBody!==null&&n7(t,n.extraBody),t.headers=await this.getHeadersInternal(n,r),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await p2(a),new bh(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await p2(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(t){return fa(this,arguments,function*(){var r;const a=(r=t==null?void 0:t.body)===null||r===void 0?void 0:r.getReader(),o=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";const u="data:",d=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:f,value:m}=yield ct(a.read());if(f){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const v=o.decode(m,{stream:!0});try{const w=JSON.parse(v);if("error"in w){const S=JSON.parse(JSON.stringify(w.error)),A=S.status,k=S.code,I=`got status: ${A}. ${JSON.stringify(w)}`;if(k>=400&&k<600)throw new tc({message:I,status:k})}}catch(w){if(w.name==="ApiError")throw w}l+=v;let y=-1,T=0;for(;;){y=-1,T=0;for(const A of d){const k=l.indexOf(A);k!==-1&&(y===-1||k<y)&&(y=k,T=A.length)}if(y===-1)break;const w=l.substring(0,y);l=l.substring(y+T);const S=w.trim();if(S.startsWith(u)){const A=S.substring(u.length).trim();try{const k=new Response(A,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield ct(new bh(k))}catch(k){throw new Error(`exception parsing stream chunk ${A}. ${k}`)}}}}}finally{a.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=QU+" "+this.clientOptions.userAgentExtra;return t[KU]=n,t[Mh]=n,t[JU]="application/json",t}async getHeadersInternal(t,n){const r=new Headers;if(t&&t.headers){for(const[a,o]of Object.entries(t.headers))r.append(a,o);t.timeout&&t.timeout>0&&r.append(WU,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(t){var n;let r="";return typeof t=="string"&&(r=t.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(t,n){var r;const a={};n!=null&&(a.mimeType=n.mimeType,a.name=n.name,a.displayName=n.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const o=this.clientOptions.uploader,l=await o.stat(t);a.sizeBytes=String(l.size);const u=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:l.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=u;const d={file:a},f=this.getFileName(t),m=qe("upload/v1beta/files",d._url),v=await this.fetchUploadUrl(m,a.sizeBytes,a.mimeType,f,d,n==null?void 0:n.httpOptions);return o.upload(t,v,this)}async uploadFileToFileSearchStore(t,n,r){var a;const o=this.clientOptions.uploader,l=await o.stat(n),u=String(l.size),d=(a=r==null?void 0:r.mimeType)!==null&&a!==void 0?a:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const f=`upload/v1beta/${t}:uploadToFileSearchStore`,m=this.getFileName(n),v={};r!=null&&gT(r,v);const y=await this.fetchUploadUrl(f,u,d,m,v,r==null?void 0:r.httpOptions);return o.uploadToFileSearchStore(n,y,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n,r,a,o,l){var u;let d={};l?d=l:d={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},a?{"X-Goog-Upload-File-Name":a}:{})};const f=await this.request({path:t,body:JSON.stringify(o),httpMethod:"POST",httpOptions:d});if(!f||!(f!=null&&f.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const m=(u=f==null?void 0:f.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(m===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return m}}async function p2(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const a=JSON.stringify(r);throw n>=400&&n<600?new tc({message:a,status:n}):new Error(a)}}function n7(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const o=JSON.parse(e.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(o,l){const u=Object.assign({},o);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const f=l[d],m=u[d];f&&typeof f=="object"&&!Array.isArray(f)&&m&&typeof m=="object"&&!Array.isArray(m)?u[d]=r(m,f):(m&&f&&typeof m!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof m}, New type: ${typeof f}. Overwriting.`),u[d]=f)}return u}const a=r(n,t);e.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const r7="mcp_used/unknown";let a7=!1;function vT(e){for(const t of e)if(i7(t)||typeof t=="object"&&"inputSchema"in t)return!0;return a7}function yT(e){var t;const n=(t=e[Mh])!==null&&t!==void 0?t:"";e[Mh]=(n+` ${r7}`).trimStart()}function i7(e){return e!==null&&typeof e=="object"&&e instanceof Pm}function s7(e){return fa(this,arguments,function*(n,r=100){let a,o=0;for(;o<r;){const l=yield ct(n.listTools({cursor:a}));for(const u of l.tools)yield yield ct(u),o++;if(!l.nextCursor)break;a=l.nextCursor}})}class Pm{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new Pm(t,n)}async initialize(){var t,n,r,a;if(this.mcpTools.length>0)return;const o={},l=[];for(const m of this.mcpClients)try{for(var u=!0,d=(n=void 0,da(s7(m))),f;f=await d.next(),t=f.done,!t;u=!0){a=f.value,u=!1;const v=a;l.push(v);const y=v.name;if(o[y])throw new Error(`Duplicate function name ${y} found in MCP tools. Please ensure function names are unique.`);o[y]=m}}catch(v){n={error:v}}finally{try{!u&&!t&&(r=d.return)&&await r.call(d)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),LF(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[r.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const l=await a.callTool({name:r.name,arguments:r.args},void 0,o);n.push({functionResponse:{name:r.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function o7(e,t,n){const r=new bF;let a;n.data instanceof Blob?a=JSON.parse(await n.data.text()):a=JSON.parse(n.data),Object.assign(r,a),t(r)}class l7{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),l=f7(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${a}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${u}`;let f=()=>{};const m=new Promise(b=>{f=b}),v=t.callbacks,y=function(){f({})},T=this.apiClient,w={onopen:y,onmessage:b=>{o7(T,v.onmessage,b)},onerror:(n=v==null?void 0:v.onerror)!==null&&n!==void 0?n:function(b){},onclose:(r=v==null?void 0:v.onclose)!==null&&r!==void 0?r:function(b){}},S=this.webSocketFactory.create(d,u7(l),w);S.connect(),await m;const I={setup:{model:Dt(this.apiClient,t.model)}};return S.send(JSON.stringify(I)),new c7(S,this.apiClient)}}class c7{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=FO(t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=IO(t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const n={playbackControl:t};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(lo.PLAY)}pause(){this.sendPlaybackControl(lo.PAUSE)}stop(){this.sendPlaybackControl(lo.STOP)}resetContext(){this.sendPlaybackControl(lo.RESET_CONTEXT)}close(){this.conn.close()}}function u7(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function f7(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const d7="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function h7(e,t,n){const r=new CF;let a;n.data instanceof Blob?a=await n.data.text():n.data instanceof ArrayBuffer?a=new TextDecoder().decode(n.data):a=n.data;const o=JSON.parse(a);if(e.isVertexAI()){const l=PO(o);Object.assign(r,l)}else Object.assign(r,o);t(r)}class m7{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new l7(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,a,o,l,u;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let m;const v=this.apiClient.getHeaders();t.config&&t.config.tools&&vT(t.config.tools)&&yT(v);const y=v7(v);if(this.apiClient.isVertexAI()){const B=this.apiClient.getProject(),ae=this.apiClient.getLocation(),ie=this.apiClient.getApiKey(),Z=!!B&&!!ae||!!ie;this.apiClient.getCustomBaseUrl()&&!Z?m=d:(m=`${d}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(y,m))}else{const B=this.apiClient.getApiKey();let ae="BidiGenerateContent",ie="key";B!=null&&B.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),f!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),ae="BidiGenerateContentConstrained",ie="access_token"),m=`${d}/ws/google.ai.generativelanguage.${f}.GenerativeService.${ae}?${ie}=${B}`}let T=()=>{};const w=new Promise(B=>{T=B}),S=t.callbacks,A=function(){var B;(B=S==null?void 0:S.onopen)===null||B===void 0||B.call(S),T({})},k=this.apiClient,I={onopen:A,onmessage:B=>{h7(k,S.onmessage,B)},onerror:(n=S==null?void 0:S.onerror)!==null&&n!==void 0?n:function(B){},onclose:(r=S==null?void 0:S.onclose)!==null&&r!==void 0?r:function(B){}},b=this.webSocketFactory.create(m,g7(y),I);b.connect(),await w;let P=Dt(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const B=this.apiClient.getProject(),ae=this.apiClient.getLocation();B&&ae&&(P=`projects/${B}/locations/${ae}/`+P)}let F={};this.apiClient.isVertexAI()&&((a=t.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[uf.AUDIO]}:t.config.responseModalities=[uf.AUDIO]),!((o=t.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const Y=(u=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[],D=[];for(const B of Y)if(this.isCallableTool(B)){const ae=B;D.push(await ae.tool())}else D.push(B);D.length>0&&(t.config.tools=D);const Q={model:P,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?F=MO(this.apiClient,Q):F=DO(this.apiClient,Q),delete F.config,b.send(JSON.stringify(F)),new x7(b,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const p7={turnComplete:!0};class x7{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Jr(n.turns),t.isVertexAI()||(r=r.map(a=>Cf(a)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!t.isVertexAI()&&!("id"in o))throw new Error(d7)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},p7),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:OO(t)}:n={realtimeInput:LO(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function g7(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function v7(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const x2=10;function g2(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let a=!1;for(const l of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(xo(l)){a=!0;break}if(!a)return!0;const o=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function xo(e){return"callTool"in e&&typeof e.callTool=="function"}function y7(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(a=>xo(a)))!==null&&r!==void 0?r:!1}function v2(e){var t;const n=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((r,a)=>{if(xo(r))return;const o=r;o.functionDeclarations&&o.functionDeclarations.length>0&&n.push(a)}),n}function y2(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _7 extends ei{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,a,o,l,u;const d=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!y7(n)||g2(n.config))return await this.generateContentInternal(d);const f=v2(n);if(f.length>0){const S=f.map(A=>`tools[${A}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${S}.`)}let m,v;const y=Jr(d.contents),T=(o=(a=(r=d.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&o!==void 0?o:x2;let w=0;for(;w<T&&(m=await this.generateContentInternal(d),!(!m.functionCalls||m.functionCalls.length===0));){const S=m.candidates[0].content,A=[];for(const k of(u=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&u!==void 0?u:[])if(xo(k)){const b=await k.callTool(m.functionCalls);A.push(...b)}w++,v={role:"user",parts:A},d.contents=Jr(d.contents),d.contents.push(S),d.contents.push(v),y2(d.config)&&(y.push(S),y.push(v))}return y2(d.config)&&(m.automaticFunctionCallingHistory=y),m},this.generateContentStream=async n=>{var r,a,o,l,u;if(this.maybeMoveToResponseJsonSchem(n),g2(n.config)){const v=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(v)}const d=v2(n);if(d.length>0){const v=d.map(y=>`tools[${y}]`).join(", ");throw new Error(`Incompatible tools found at ${v}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const f=(o=(a=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||a===void 0?void 0:a.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,m=(u=(l=n==null?void 0:n.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(f&&!m)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var a;let o;const l=[];if(r!=null&&r.generatedImages)for(const d of r.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((a=d==null?void 0:d.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?o=d==null?void 0:d.safetyAttributes:l.push(d);let u;return o?u={generatedImages:l,positivePromptSafetyAttributes:o,sdkHttpResponse:r.sdkHttpResponse}:u={generatedImages:l,sdkHttpResponse:r.sdkHttpResponse},u}),this.list=async n=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Es(Ka.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(l),l)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const a={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(a)},this.generateVideos=async n=>{var r,a,o,l,u,d;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((a=n.video)===null||a===void 0)&&a.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((l=(o=n.source)===null||o===void 0?void 0:o.video)===null||l===void 0)&&l.uri&&(!((d=(u=n.source)===null||u===void 0?void 0:u.video)===null||d===void 0)&&d.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,r,a;const o=(n=t.config)===null||n===void 0?void 0:n.tools;if(!o)return t;const l=await Promise.all(o.map(async d=>xo(d)?await d.tool():d)),u={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:l})};if(u.config.tools=l,t.config&&t.config.tools&&vT(t.config.tools)){const d=(a=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&a!==void 0?a:{};let f=Object.assign({},d);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),yT(f),u.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:f})}return u}async initAfcToolsMap(t){var n,r,a;const o=new Map;for(const l of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(xo(l)){const u=l,d=await u.tool();for(const f of(a=d.functionDeclarations)!==null&&a!==void 0?a:[]){if(!f.name)throw new Error("Function declaration name is required.");if(o.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);o.set(f.name,u)}}return o}async processAfcStream(t){var n,r,a;const o=(a=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:x2;let l=!1,u=0;const d=await this.initAfcToolsMap(t);return(function(f,m,v){return fa(this,arguments,function*(){for(var y,T,w,S,A,k;u<o;){l&&(u++,l=!1);const F=yield ct(f.processParamsMaybeAddMcpUsage(v)),Y=yield ct(f.generateContentStreamInternal(F)),D=[],Q=[];try{for(var I=!0,b=(T=void 0,da(Y)),P;P=yield ct(b.next()),y=P.done,!y;I=!0){S=P.value,I=!1;const B=S;if(yield yield ct(B),B.candidates&&(!((A=B.candidates[0])===null||A===void 0)&&A.content)){Q.push(B.candidates[0].content);for(const ae of(k=B.candidates[0].content.parts)!==null&&k!==void 0?k:[])if(u<o&&ae.functionCall){if(!ae.functionCall.name)throw new Error("Function call name was not returned by the model.");if(m.has(ae.functionCall.name)){const ie=yield ct(m.get(ae.functionCall.name).callTool([ae.functionCall]));D.push(...ie)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${m.keys()}, mising tool: ${ae.functionCall.name}`)}}}}catch(B){T={error:B}}finally{try{!I&&!y&&(w=b.return)&&(yield ct(w.call(b)))}finally{if(T)throw T.error}}if(D.length>0){l=!0;const B=new El;B.candidates=[{content:{role:"user",parts:D}}],yield yield ct(B);const ae=[];ae.push(...Q),ae.push({role:"user",parts:D});const ie=Jr(v.contents).concat(ae);v.contents=ie}else break}})})(this,d,t)}async generateContentInternal(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=d2(this.apiClient,t);return u=qe("{model}:generateContent",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=m2(m),y=new El;return Object.assign(y,v),y})}else{const f=f2(this.apiClient,t);return u=qe("{model}:generateContent",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=h2(m),y=new El;return Object.assign(y,v),y})}}async generateContentStreamInternal(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=d2(this.apiClient,t);return u=qe("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(v){return fa(this,arguments,function*(){var y,T,w,S;try{for(var A=!0,k=da(v),I;I=yield ct(k.next()),y=I.done,!y;A=!0){S=I.value,A=!1;const b=S,P=m2(yield ct(b.json()),t);P.sdkHttpResponse={headers:b.headers};const F=new El;Object.assign(F,P),yield yield ct(F)}}catch(b){T={error:b}}finally{try{!A&&!y&&(w=k.return)&&(yield ct(w.call(k)))}finally{if(T)throw T.error}}})})}else{const f=f2(this.apiClient,t);return u=qe("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(v){return fa(this,arguments,function*(){var y,T,w,S;try{for(var A=!0,k=da(v),I;I=yield ct(k.next()),y=I.done,!y;A=!0){S=I.value,A=!1;const b=S,P=h2(yield ct(b.json()),t);P.sdkHttpResponse={headers:b.headers};const F=new El;Object.assign(F,P),yield yield ct(F)}}catch(b){T={error:b}}finally{try{!A&&!y&&(w=k.return)&&(yield ct(w.call(k)))}finally{if(T)throw T.error}}})})}}async embedContent(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=mP(this.apiClient,t);return u=qe("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=xP(m),y=new Jy;return Object.assign(y,v),y})}else{const f=hP(this.apiClient,t);return u=qe("{model}:batchEmbedContents",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=pP(m),y=new Jy;return Object.assign(y,v),y})}}async generateImagesInternal(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=bP(this.apiClient,t);return u=qe("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=kP(m),y=new Wy;return Object.assign(y,v),y})}else{const f=CP(this.apiClient,t);return u=qe("{model}:predict",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=NP(m),y=new Wy;return Object.assign(y,v),y})}}async editImageInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=cP(this.apiClient,t);return o=qe("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),a.then(d=>{const f=uP(d),m=new mF;return Object.assign(m,f),m})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=bU(this.apiClient,t);return o=qe("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),a.then(d=>{const f=NU(d),m=new pF;return Object.assign(m,f),m})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=lU(this.apiClient,t);return o=qe("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=cU(d),m=new xF;return Object.assign(m,f),m})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=pU(this.apiClient,t);return o=qe("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=xU(d),m=new gF;return Object.assign(m,f),m})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=YP(this.apiClient,t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),l.then(m=>Dh(m))}else{const f=jP(this.apiClient,t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>Rh(m))}}async listInternal(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=tU(this.apiClient,t);return u=qe("{models_url}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=rU(m),y=new Ky;return Object.assign(y,v),y})}else{const f=eU(this.apiClient,t);return u=qe("{models_url}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=nU(m),y=new Ky;return Object.assign(y,v),y})}}async update(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=AU(this.apiClient,t);return u=qe("{model}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),l.then(m=>Dh(m))}else{const f=wU(this.apiClient,t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>Rh(m))}}async delete(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=iP(this.apiClient,t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=oP(m),y=new $y;return Object.assign(y,v),y})}else{const f=aP(this.apiClient,t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=sP(m),y=new $y;return Object.assign(y,v),y})}}async countTokens(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=tP(this.apiClient,t);return u=qe("{model}:countTokens",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=rP(m),y=new Qy;return Object.assign(y,v),y})}else{const f=eP(this.apiClient,t);return u=qe("{model}:countTokens",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=nP(m),y=new Qy;return Object.assign(y,v),y})}}async computeTokens(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=XO(this.apiClient,t);return o=qe("{model}:computeTokens",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),a.then(d=>{const f=JO(d),m=new vF;return Object.assign(m,f),m})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=LP(this.apiClient,t);return u=qe("{model}:predictLongRunning",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),l.then(m=>{const v=IP(m),y=new ff;return Object.assign(y,v),y})}else{const f=FP(this.apiClient,t);return u=qe("{model}:predictLongRunning",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l.then(m=>{const v=MP(m),y=new ff;return Object.assign(y,v),y})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class E7 extends ei{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async get(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const a=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async getVideosOperationInternal(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=lF(t);return u=qe("{operationName}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),l}else{const f=oF(t);return u=qe("{operationName}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json()),l}}async fetchPredictVideosOperationInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=eF(t);return o=qe("{resourceName}:fetchPredictOperation",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function T7(e){const t={},n=p(e,["data"]);if(n!=null&&x(t,["data"],n),p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=p(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function S7(e){const t={},n=p(e,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(o=>M7(o))),x(t,["parts"],a)}const r=p(e,["role"]);return r!=null&&x(t,["role"],r),t}function w7(e,t,n){const r={},a=p(t,["expireTime"]);n!==void 0&&a!=null&&x(n,["expireTime"],a);const o=p(t,["newSessionExpireTime"]);n!==void 0&&o!=null&&x(n,["newSessionExpireTime"],o);const l=p(t,["uses"]);n!==void 0&&l!=null&&x(n,["uses"],l);const u=p(t,["liveConnectConstraints"]);n!==void 0&&u!=null&&x(n,["bidiGenerateContentSetup"],D7(e,u));const d=p(t,["lockAdditionalFields"]);return n!==void 0&&d!=null&&x(n,["fieldMask"],d),r}function A7(e,t){const n={},r=p(t,["config"]);return r!=null&&x(n,["config"],w7(e,r,n)),n}function C7(e){const t={};if(p(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(e,["fileUri"]);n!=null&&x(t,["fileUri"],n);const r=p(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function b7(e){const t={},n=p(e,["id"]);n!=null&&x(t,["id"],n);const r=p(e,["args"]);r!=null&&x(t,["args"],r);const a=p(e,["name"]);if(a!=null&&x(t,["name"],a),p(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(p(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function N7(e){const t={};if(p(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=p(e,["enableWidget"]);return n!=null&&x(t,["enableWidget"],n),t}function k7(e){const t={};if(p(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(p(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=p(e,["timeRangeFilter"]);return n!=null&&x(t,["timeRangeFilter"],n),t}function R7(e,t){const n={},r=p(e,["generationConfig"]);t!==void 0&&r!=null&&x(t,["setup","generationConfig"],r);const a=p(e,["responseModalities"]);t!==void 0&&a!=null&&x(t,["setup","generationConfig","responseModalities"],a);const o=p(e,["temperature"]);t!==void 0&&o!=null&&x(t,["setup","generationConfig","temperature"],o);const l=p(e,["topP"]);t!==void 0&&l!=null&&x(t,["setup","generationConfig","topP"],l);const u=p(e,["topK"]);t!==void 0&&u!=null&&x(t,["setup","generationConfig","topK"],u);const d=p(e,["maxOutputTokens"]);t!==void 0&&d!=null&&x(t,["setup","generationConfig","maxOutputTokens"],d);const f=p(e,["mediaResolution"]);t!==void 0&&f!=null&&x(t,["setup","generationConfig","mediaResolution"],f);const m=p(e,["seed"]);t!==void 0&&m!=null&&x(t,["setup","generationConfig","seed"],m);const v=p(e,["speechConfig"]);t!==void 0&&v!=null&&x(t,["setup","generationConfig","speechConfig"],Om(v));const y=p(e,["thinkingConfig"]);t!==void 0&&y!=null&&x(t,["setup","generationConfig","thinkingConfig"],y);const T=p(e,["enableAffectiveDialog"]);t!==void 0&&T!=null&&x(t,["setup","generationConfig","enableAffectiveDialog"],T);const w=p(e,["systemInstruction"]);t!==void 0&&w!=null&&x(t,["setup","systemInstruction"],S7(Jn(w)));const S=p(e,["tools"]);if(t!==void 0&&S!=null){let Y=Ao(S);Array.isArray(Y)&&(Y=Y.map(D=>F7(wo(D)))),x(t,["setup","tools"],Y)}const A=p(e,["sessionResumption"]);t!==void 0&&A!=null&&x(t,["setup","sessionResumption"],I7(A));const k=p(e,["inputAudioTranscription"]);t!==void 0&&k!=null&&x(t,["setup","inputAudioTranscription"],k);const I=p(e,["outputAudioTranscription"]);t!==void 0&&I!=null&&x(t,["setup","outputAudioTranscription"],I);const b=p(e,["realtimeInputConfig"]);t!==void 0&&b!=null&&x(t,["setup","realtimeInputConfig"],b);const P=p(e,["contextWindowCompression"]);t!==void 0&&P!=null&&x(t,["setup","contextWindowCompression"],P);const F=p(e,["proactivity"]);if(t!==void 0&&F!=null&&x(t,["setup","proactivity"],F),p(e,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function D7(e,t){const n={},r=p(t,["model"]);r!=null&&x(n,["setup","model"],Dt(e,r));const a=p(t,["config"]);return a!=null&&x(n,["config"],R7(a,n)),n}function M7(e){const t={},n=p(e,["mediaResolution"]);n!=null&&x(t,["mediaResolution"],n);const r=p(e,["codeExecutionResult"]);r!=null&&x(t,["codeExecutionResult"],r);const a=p(e,["executableCode"]);a!=null&&x(t,["executableCode"],a);const o=p(e,["fileData"]);o!=null&&x(t,["fileData"],C7(o));const l=p(e,["functionCall"]);l!=null&&x(t,["functionCall"],b7(l));const u=p(e,["functionResponse"]);u!=null&&x(t,["functionResponse"],u);const d=p(e,["inlineData"]);d!=null&&x(t,["inlineData"],T7(d));const f=p(e,["text"]);f!=null&&x(t,["text"],f);const m=p(e,["thought"]);m!=null&&x(t,["thought"],m);const v=p(e,["thoughtSignature"]);v!=null&&x(t,["thoughtSignature"],v);const y=p(e,["videoMetadata"]);return y!=null&&x(t,["videoMetadata"],y),t}function I7(e){const t={},n=p(e,["handle"]);if(n!=null&&x(t,["handle"],n),p(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function F7(e){const t={};if(p(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=p(e,["computerUse"]);n!=null&&x(t,["computerUse"],n);const r=p(e,["fileSearch"]);r!=null&&x(t,["fileSearch"],r);const a=p(e,["codeExecution"]);if(a!=null&&x(t,["codeExecution"],a),p(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=p(e,["functionDeclarations"]);if(o!=null){let m=o;Array.isArray(m)&&(m=m.map(v=>v)),x(t,["functionDeclarations"],m)}const l=p(e,["googleMaps"]);l!=null&&x(t,["googleMaps"],N7(l));const u=p(e,["googleSearch"]);u!=null&&x(t,["googleSearch"],k7(u));const d=p(e,["googleSearchRetrieval"]);d!=null&&x(t,["googleSearchRetrieval"],d);const f=p(e,["urlContext"]);return f!=null&&x(t,["urlContext"],f),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function L7(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const a=Object.keys(r).map(o=>`${n}.${o}`);t.push(...a)}else t.push(n)}return t.join(",")}function O7(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const o=r.setup;typeof o=="object"&&o!==null?(e.bidiGenerateContentSetup=o,n=o):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const a=e.fieldMask;if(n){const o=L7(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)o?e.fieldMask=o:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];a.length>0&&(u=a.map(f=>l.includes(f)?`generationConfig.${f}`:f));const d=[];o&&d.push(o),u.length>0&&d.push(...u),d.length>0?e.fieldMask=d.join(","):delete e.fieldMask}else delete e.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?e.fieldMask=a.join(","):delete e.fieldMask;return e}class P7 extends ei{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=A7(this.apiClient,t);o=qe("auth_tokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query;const d=O7(u,t.config);return a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>f)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function U7(e,t){const n={},r=p(e,["force"]);return t!==void 0&&r!=null&&x(t,["_query","force"],r),n}function B7(e){const t={},n=p(e,["name"]);n!=null&&x(t,["_url","name"],n);const r=p(e,["config"]);return r!=null&&U7(r,t),t}function H7(e){const t={},n=p(e,["name"]);return n!=null&&x(t,["_url","name"],n),t}function G7(e,t){const n={},r=p(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const a=p(e,["pageToken"]);return t!==void 0&&a!=null&&x(t,["_query","pageToken"],a),n}function V7(e){const t={},n=p(e,["parent"]);n!=null&&x(t,["_url","parent"],n);const r=p(e,["config"]);return r!=null&&G7(r,t),t}function z7(e){const t={},n=p(e,["sdkHttpResponse"]);n!=null&&x(t,["sdkHttpResponse"],n);const r=p(e,["nextPageToken"]);r!=null&&x(t,["nextPageToken"],r);const a=p(e,["documents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>l)),x(t,["documents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class q7 extends ei{constructor(t){super(),this.apiClient=t,this.list=async n=>new Es(Ka.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=H7(t);return o=qe("{name}",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>d)}}async delete(t){var n,r;let a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=B7(t);a=qe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=V7(t);return o=qe("{parent}/documents",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=z7(d),m=new yF;return Object.assign(m,f),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class j7 extends ei{constructor(t,n=new q7(t)){super(),this.apiClient=t,this.documents=n,this.list=async(r={})=>new Es(Ka.PAGED_ITEM_FILE_SEARCH_STORES,a=>this.listInternal(a),await this.listInternal(r),r)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=LU(t);return o=qe("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>d)}}async get(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=UU(t);return o=qe("{name}",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>d)}}async delete(t){var n,r;let a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=PU(t);a=qe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=qU(t);return o=qe("fileSearchStores",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=jU(d),m=new _F;return Object.assign(m,f),m})}}async uploadToFileSearchStoreInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=YU(t);return o=qe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=XU(d),m=new EF;return Object.assign(m,f),m})}}async importFile(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=GU(t);return o=qe("{file_search_store_name}:importFile",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=HU(d),m=new Dm;return Object.assign(m,f),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let _T=function(){const{crypto:e}=globalThis;if(e!=null&&e.randomUUID)return _T=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};const Y7=()=>_T();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ih(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const Fh=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kr extends Error{}class ar extends Kr{constructor(t,n,r,a){super(`${ar.makeMessage(t,n,r)}`),this.status=t,this.headers=a,this.error=n}static makeMessage(t,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&a?`${t} ${a}`:t?`${t} status code (no body)`:a||"(no status code or body)"}static generate(t,n,r,a){if(!t||!a)return new kf({message:r,cause:Fh(n)});const o=n;return t===400?new TT(t,o,r,a):t===401?new ST(t,o,r,a):t===403?new wT(t,o,r,a):t===404?new AT(t,o,r,a):t===409?new CT(t,o,r,a):t===422?new bT(t,o,r,a):t===429?new NT(t,o,r,a):t>=500?new kT(t,o,r,a):new ar(t,o,r,a)}}class Lh extends ar{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class kf extends ar{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class ET extends kf{constructor({message:t}={}){super({message:t??"Request timed out."})}}class TT extends ar{}class ST extends ar{}class wT extends ar{}class AT extends ar{}class CT extends ar{}class bT extends ar{}class NT extends ar{}class kT extends ar{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const X7=/^[a-z][a-z0-9+.-]*:/i,J7=e=>X7.test(e);let Oh=e=>(Oh=Array.isArray,Oh(e));const W7=Oh;let K7=W7;const _2=K7;function $7(e){if(!e)return!0;for(const t in e)return!1;return!0}function Q7(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const Z7=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new Kr(`${e} must be an integer`);if(t<0)throw new Kr(`${e} must be a positive integer`);return t},e9=e=>{try{return JSON.parse(e)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const t9=e=>new Promise(t=>setTimeout(t,e));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const so="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n9(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const r9=()=>{var e,t,n,r,a;const o=n9();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":so,"X-Stainless-OS":T2(Deno.build.os),"X-Stainless-Arch":E2(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(t=(e=Deno.version)===null||e===void 0?void 0:e.deno)!==null&&t!==void 0?t:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":so,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":so,"X-Stainless-OS":T2((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":E2((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(a=globalThis.process.version)!==null&&a!==void 0?a:"unknown"};const l=a9();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":so,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":so,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function a9(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,o=r[2]||0,l=r[3]||0;return{browser:t,version:`${a}.${o}.${l}`}}}return null}const E2=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",T2=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let Ou;const i9=()=>Ou??(Ou=r9());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function s9(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function RT(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function o9(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return RT({start(){},async pull(n){const{done:r,value:a}=await t.next();r?n.close():n.enqueue(a)},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}function DT(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function l9(e){var t,n;if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await((n=(t=e[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(t));return}const r=e.getReader(),a=r.cancel();r.releaseLock(),await a}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const c9=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const MT=()=>{var e;if(typeof File>"u"){const{process:t}=globalThis,n=typeof((e=t==null?void 0:t.versions)===null||e===void 0?void 0:e.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function oh(e,t,n){return MT(),new File(e,t??"unknown_file",n)}function u9(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const f9=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const IT=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",d9=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&IT(e),h9=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function m9(e,t,n){if(MT(),e=await e,d9(e))return e instanceof File?e:oh([await e.arrayBuffer()],e.name);if(h9(e)){const a=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),oh(await Ph(a),t,n)}const r=await Ph(e);if(t||(t=u9(e)),!(n!=null&&n.type)){const a=r.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof a=="string"&&(n=Object.assign(Object.assign({},n),{type:a}))}return oh(r,t,n)}async function Ph(e){var t,n,r,a,o;let l=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)l.push(e);else if(IT(e))l.push(e instanceof Blob?e:await e.arrayBuffer());else if(f9(e))try{for(var u=!0,d=da(e),f;f=await d.next(),t=f.done,!t;u=!0){a=f.value,u=!1;const m=a;l.push(...await Ph(m))}}catch(m){n={error:m}}finally{try{!u&&!t&&(r=d.return)&&await r.call(d)}finally{if(n)throw n.error}}else{const m=(o=e==null?void 0:e.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof e}${m?`; constructor: ${m}`:""}${p9(e)}`)}return l}function p9(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FT{constructor(t){this._client=t}}FT._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LT(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const S2=Object.freeze(Object.create(null)),x9=(e=LT)=>(function(n,...r){if(n.length===1)return n[0];let a=!1;const o=[],l=n.reduce((m,v,y)=>{var T,w,S;/[?#]/.test(v)&&(a=!0);const A=r[y];let k=(a?encodeURIComponent:e)(""+A);return y!==r.length&&(A==null||typeof A=="object"&&A.toString===((S=Object.getPrototypeOf((w=Object.getPrototypeOf((T=A.hasOwnProperty)!==null&&T!==void 0?T:S2))!==null&&w!==void 0?w:S2))===null||S===void 0?void 0:S.toString))&&(k=A+"",o.push({start:m.length+v.length,length:k.length,error:`Value of type ${Object.prototype.toString.call(A).slice(8,-1)} is not a valid path parameter`})),m+v+(y===r.length?"":k)},""),u=l.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=d.exec(u))!==null;)o.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(o.sort((m,v)=>m.start-v.start),o.length>0){let m=0;const v=o.reduce((y,T)=>{const w=" ".repeat(T.start-m),S="^".repeat(T.length);return m=T.start+T.length,y+w+S},"");throw new Kr(`Path parameters result in path with invalid segments:
${o.map(y=>y.error).join(`
`)}
${l}
${v}`)}return l}),Pu=x9(LT);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class OT extends FT{create(t,n){var r;const{api_version:a=this._client.apiVersion}=t,o=hf(t,["api_version"]);if("model"in o&&"agent_config"in o)throw new Kr("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new Kr("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Pu`/${a}/interactions`,Object.assign(Object.assign({body:o},n),{stream:(r=t.stream)!==null&&r!==void 0?r:!1}))}delete(t,n={},r){const{api_version:a=this._client.apiVersion}=n??{};return this._client.delete(Pu`/${a}/interactions/${t}`,r)}cancel(t,n={},r){const{api_version:a=this._client.apiVersion}=n??{};return this._client.post(Pu`/${a}/interactions/${t}/cancel`,r)}get(t,n={},r){var a;const o=n??{},{api_version:l=this._client.apiVersion}=o,u=hf(o,["api_version"]);return this._client.get(Pu`/${l}/interactions/${t}`,Object.assign(Object.assign({query:u},r),{stream:(a=n==null?void 0:n.stream)!==null&&a!==void 0?a:!1}))}}OT._key=Object.freeze(["interactions"]);class PT extends OT{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function g9(e){let t=0;for(const a of e)t+=a.length;const n=new Uint8Array(t);let r=0;for(const a of e)n.set(a,r),r+=a.length;return n}let Uu;function Um(e){let t;return(Uu??(t=new globalThis.TextEncoder,Uu=t.encode.bind(t)))(e)}let Bu;function w2(e){let t;return(Bu??(t=new globalThis.TextDecoder,Bu=t.decode.bind(t)))(e)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rf{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(t){if(t==null)return[];const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?Um(t):t;this.buffer=g9([this.buffer,n]);const r=[];let a;for(;(a=v9(this.buffer,this.carriageReturnIndex))!=null;){if(a.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=a.index;continue}if(this.carriageReturnIndex!=null&&(a.index!==this.carriageReturnIndex+1||a.carriage)){r.push(w2(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const o=this.carriageReturnIndex!==null?a.preceding-1:a.preceding,l=w2(this.buffer.subarray(0,o));r.push(l),this.buffer=this.buffer.subarray(a.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}}Rf.NEWLINE_CHARS=new Set([`
`,"\r"]);Rf.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function v9(e,t){for(let a=t??0;a<e.length;a++){if(e[a]===10)return{preceding:a,index:a+1,carriage:!1};if(e[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function y9(e){for(let r=0;r<e.length-1;r++){if(e[r]===10&&e[r+1]===10||e[r]===13&&e[r+1]===13)return r+2;if(e[r]===13&&e[r+1]===10&&r+3<e.length&&e[r+2]===13&&e[r+3]===10)return r+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mf={off:0,error:200,warn:300,info:400,debug:500},A2=(e,t,n)=>{if(e){if(Q7(mf,e))return e;er(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(mf))}`)}};function Cl(){}function Hu(e,t,n){return!t||mf[e]>mf[n]?Cl:t[e].bind(t)}const _9={error:Cl,warn:Cl,info:Cl,debug:Cl};let C2=new WeakMap;function er(e){var t;const n=e.logger,r=(t=e.logLevel)!==null&&t!==void 0?t:"off";if(!n)return _9;const a=C2.get(n);if(a&&a[0]===r)return a[1];const o={error:Hu("error",n,r),warn:Hu("warn",n,r),info:Hu("info",n,r),debug:Hu("debug",n,r)};return C2.set(n,[r,o]),o}const ns=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,n])=>[t,t.toLowerCase()==="x-goog-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class co{constructor(t,n,r){this.iterator=t,this.controller=n,this.client=r}static fromSSEResponse(t,n,r){let a=!1;const o=r?er(r):console;function l(){return fa(this,arguments,function*(){var d,f,m,v;if(a)throw new Kr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let y=!1;try{try{for(var T=!0,w=da(E9(t,n)),S;S=yield ct(w.next()),d=S.done,!d;T=!0){v=S.value,T=!1;const A=v;if(!y)if(A.data.startsWith("[DONE]")){y=!0;continue}else try{yield yield ct(JSON.parse(A.data))}catch(k){throw o.error("Could not parse message into JSON:",A.data),o.error("From chunk:",A.raw),k}}}catch(A){f={error:A}}finally{try{!T&&!d&&(m=w.return)&&(yield ct(m.call(w)))}finally{if(f)throw f.error}}y=!0}catch(A){if(Ih(A))return yield ct(void 0);throw A}finally{y||n.abort()}})}return new co(l,n,r)}static fromReadableStream(t,n,r){let a=!1;function o(){return fa(this,arguments,function*(){var d,f,m,v;const y=new Rf,T=DT(t);try{for(var w=!0,S=da(T),A;A=yield ct(S.next()),d=A.done,!d;w=!0){v=A.value,w=!1;const k=v;for(const I of y.decode(k))yield yield ct(I)}}catch(k){f={error:k}}finally{try{!w&&!d&&(m=S.return)&&(yield ct(m.call(S)))}finally{if(f)throw f.error}}for(const k of y.flush())yield yield ct(k)})}function l(){return fa(this,arguments,function*(){var d,f,m,v;if(a)throw new Kr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let y=!1;try{try{for(var T=!0,w=da(o()),S;S=yield ct(w.next()),d=S.done,!d;T=!0){v=S.value,T=!1;const A=v;y||A&&(yield yield ct(JSON.parse(A)))}}catch(A){f={error:A}}finally{try{!T&&!d&&(m=w.return)&&(yield ct(m.call(w)))}finally{if(f)throw f.error}}y=!0}catch(A){if(Ih(A))return yield ct(void 0);throw A}finally{y||n.abort()}})}return new co(l,n,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),a=o=>({next:()=>{if(o.length===0){const l=r.next();t.push(l),n.push(l)}return o.shift()}});return[new co(()=>a(t),this.controller,this.client),new co(()=>a(n),this.controller,this.client)]}toReadableStream(){const t=this;let n;return RT({async start(){n=t[Symbol.asyncIterator]()},async pull(r){try{const{value:a,done:o}=await n.next();if(o)return r.close();const l=Um(JSON.stringify(a)+`
`);r.enqueue(l)}catch(a){r.error(a)}},async cancel(){var r;await((r=n.return)===null||r===void 0?void 0:r.call(n))}})}}function E9(e,t){return fa(this,arguments,function*(){var r,a,o,l;if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Kr("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Kr("Attempted to iterate over a response with no body");const u=new S9,d=new Rf,f=DT(e.body);try{for(var m=!0,v=da(T9(f)),y;y=yield ct(v.next()),r=y.done,!r;m=!0){l=y.value,m=!1;const T=l;for(const w of d.decode(T)){const S=u.decode(w);S&&(yield yield ct(S))}}}catch(T){a={error:T}}finally{try{!m&&!r&&(o=v.return)&&(yield ct(o.call(v)))}finally{if(a)throw a.error}}for(const T of d.flush()){const w=u.decode(T);w&&(yield yield ct(w))}})}function T9(e){return fa(this,arguments,function*(){var n,r,a,o;let l=new Uint8Array;try{for(var u=!0,d=da(e),f;f=yield ct(d.next()),n=f.done,!n;u=!0){o=f.value,u=!1;const m=o;if(m==null)continue;const v=m instanceof ArrayBuffer?new Uint8Array(m):typeof m=="string"?Um(m):m;let y=new Uint8Array(l.length+v.length);y.set(l),y.set(v,l.length),l=y;let T;for(;(T=y9(l))!==-1;)yield yield ct(l.slice(0,T)),l=l.slice(T)}}catch(m){r={error:m}}finally{try{!u&&!n&&(a=d.return)&&(yield ct(a.call(d)))}finally{if(r)throw r.error}}l.length>0&&(yield yield ct(l))})}class S9{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,r,a]=w9(t,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}function w9(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function A9(e,t){const{response:n,requestLogID:r,retryOfRequestLogID:a,startTime:o}=t,l=await(async()=>{var u;if(t.options.stream)return er(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e):co.fromSSEResponse(n,t.controller,e);if(n.status===204)return null;if(t.options.__binaryResponse)return n;const d=n.headers.get("content-type"),f=(u=d==null?void 0:d.split(";")[0])===null||u===void 0?void 0:u.trim();return(f==null?void 0:f.includes("application/json"))||(f==null?void 0:f.endsWith("+json"))?await n.json():await n.text()})();return er(e).debug(`[${r}] response parsed`,ns({retryOfRequestLogID:a,url:n.url,status:n.status,body:l,durationMs:Date.now()-o})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Bm extends Promise{constructor(t,n,r=A9){super(a=>{a(null)}),this.responsePromise=n,this.parseResponse=r,this.client=t}_thenUnwrap(t){return new Bm(this.client,this.responsePromise,async(n,r)=>t(await this.parseResponse(n,r),r))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(this.client,t))),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const UT=Symbol("brand.privateNullableHeaders");function*C9(e){if(!e)return;if(UT in e){const{values:r,nulls:a}=e;yield*r.entries();for(const o of a)yield[o,null];return}let t=!1,n;e instanceof Headers?n=e.entries():_2(e)?n=e:(t=!0,n=Object.entries(e??{}));for(let r of n){const a=r[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const o=_2(r[1])?r[1]:[r[1]];let l=!1;for(const u of o)u!==void 0&&(t&&!l&&(l=!0,yield[a,null]),yield[a,u])}}const Tl=e=>{const t=new Headers,n=new Set;for(const r of e){const a=new Set;for(const[o,l]of C9(r)){const u=o.toLowerCase();a.has(u)||(t.delete(o),a.add(u)),l===null?(t.delete(o),n.add(u)):(t.append(o,l),n.delete(u))}}return{[UT]:!0,values:t,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lh=e=>{var t,n,r,a,o,l;if(typeof globalThis.process<"u")return(r=(n=(t=J5)===null||t===void 0?void 0:t[e])===null||n===void 0?void 0:n.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(l=(o=(a=globalThis.Deno.env)===null||a===void 0?void 0:a.get)===null||o===void 0?void 0:o.call(a,e))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var BT;class Df{constructor(t){var n,r,a,o,l,u,d,{baseURL:f=lh("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:m=(n=lh("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:v="v1beta"}=t,y=hf(t,["baseURL","apiKey","apiVersion"]);const T=Object.assign(Object.assign({apiKey:m,apiVersion:v},y),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=T.baseURL,this.timeout=(r=T.timeout)!==null&&r!==void 0?r:Df.DEFAULT_TIMEOUT,this.logger=(a=T.logger)!==null&&a!==void 0?a:console;const w="warn";this.logLevel=w,this.logLevel=(l=(o=A2(T.logLevel,"ClientOptions.logLevel",this))!==null&&o!==void 0?o:A2(lh("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:w,this.fetchOptions=T.fetchOptions,this.maxRetries=(u=T.maxRetries)!==null&&u!==void 0?u:2,this.fetch=(d=T.fetch)!==null&&d!==void 0?d:s9(),this.encoder=c9,this._options=T,this.apiKey=m,this.apiVersion=v,this.clientAdapter=T.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:n}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){const n=Tl([t.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return Tl([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Tl([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new Kr(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${so}`}defaultIdempotencyKey(){return`stainless-node-retry-${Y7()}`}makeStatusError(t,n,r,a){return ar.generate(t,n,r,a)}buildURL(t,n,r){const a=!this.baseURLOverridden()&&r||this.baseURL,o=J7(t)?new URL(t):new URL(a+(a.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),l=this.defaultQuery();return $7(l)||(n=Object.assign(Object.assign({},l),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(o.search=this.stringifyQuery(n)),o.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){const n=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(t,{url:n,options:r}){}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,r){return this.request(Promise.resolve(r).then(a=>Object.assign({method:t,path:n},a)))}request(t,n=null){return new Bm(this,this.makeRequest(t,n,void 0))}async makeRequest(t,n,r){var a,o,l;const u=await t,d=(a=u.maxRetries)!==null&&a!==void 0?a:this.maxRetries;n==null&&(n=d),await this.prepareOptions(u);const{req:f,url:m,timeout:v}=await this.buildRequest(u,{retryCount:d-n});await this.prepareRequest(f,{url:m,options:u});const y="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),T=r===void 0?"":`, retryOf: ${r}`,w=Date.now();if(er(this).debug(`[${y}] sending request`,ns({retryOfRequestLogID:r,method:u.method,url:m,options:u,headers:f.headers})),!((o=u.signal)===null||o===void 0)&&o.aborted)throw new Lh;const S=new AbortController,A=await this.fetchWithTimeout(m,f,v,S).catch(Fh),k=Date.now();if(A instanceof globalThis.Error){const b=`retrying, ${n} attempts remaining`;if(!((l=u.signal)===null||l===void 0)&&l.aborted)throw new Lh;const P=Ih(A)||/timed? ?out/i.test(String(A)+("cause"in A?String(A.cause):""));if(n)return er(this).info(`[${y}] connection ${P?"timed out":"failed"} - ${b}`),er(this).debug(`[${y}] connection ${P?"timed out":"failed"} (${b})`,ns({retryOfRequestLogID:r,url:m,durationMs:k-w,message:A.message})),this.retryRequest(u,n,r??y);throw er(this).info(`[${y}] connection ${P?"timed out":"failed"} - error; no more retries left`),er(this).debug(`[${y}] connection ${P?"timed out":"failed"} (error; no more retries left)`,ns({retryOfRequestLogID:r,url:m,durationMs:k-w,message:A.message})),P?new ET:new kf({cause:A})}const I=`[${y}${T}] ${f.method} ${m} ${A.ok?"succeeded":"failed"} with status ${A.status} in ${k-w}ms`;if(!A.ok){const b=await this.shouldRetry(A);if(n&&b){const B=`retrying, ${n} attempts remaining`;return await l9(A.body),er(this).info(`${I} - ${B}`),er(this).debug(`[${y}] response error (${B})`,ns({retryOfRequestLogID:r,url:A.url,status:A.status,headers:A.headers,durationMs:k-w})),this.retryRequest(u,n,r??y,A.headers)}const P=b?"error; no more retries left":"error; not retryable";er(this).info(`${I} - ${P}`);const F=await A.text().catch(B=>Fh(B).message),Y=e9(F),D=Y?void 0:F;throw er(this).debug(`[${y}] response error (${P})`,ns({retryOfRequestLogID:r,url:A.url,status:A.status,headers:A.headers,message:D,durationMs:Date.now()-w})),this.makeStatusError(A.status,Y,D,A.headers)}return er(this).info(I),er(this).debug(`[${y}] response start`,ns({retryOfRequestLogID:r,url:A.url,status:A.status,headers:A.headers,durationMs:k-w})),{response:A,options:u,controller:S,requestLogID:y,retryOfRequestLogID:r,startTime:w}}async fetchWithTimeout(t,n,r,a){const o=n||{},{signal:l,method:u}=o,d=hf(o,["signal","method"]);l&&l.addEventListener("abort",()=>a.abort());const f=setTimeout(()=>a.abort(),r),m=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,v=Object.assign(Object.assign(Object.assign({signal:a.signal},m?{duplex:"half"}:{}),{method:"GET"}),d);u&&(v.method=u.toUpperCase());try{return await this.fetch.call(void 0,t,v)}finally{clearTimeout(f)}}async shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,r,a){var o;let l;const u=a==null?void 0:a.get("retry-after-ms");if(u){const f=parseFloat(u);Number.isNaN(f)||(l=f)}const d=a==null?void 0:a.get("retry-after");if(d&&!l){const f=parseFloat(d);Number.isNaN(f)?l=Date.parse(d)-Date.now():l=f*1e3}if(!(l&&0<=l&&l<60*1e3)){const f=(o=t.maxRetries)!==null&&o!==void 0?o:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(n,f)}return await t9(l),this.makeRequest(t,n-1,r)}calculateDefaultRetryTimeoutMillis(t,n){const o=n-t,l=Math.min(.5*Math.pow(2,o),8),u=1-Math.random()*.25;return l*u*1e3}async buildRequest(t,{retryCount:n=0}={}){var r,a,o;const l=Object.assign({},t),{method:u,path:d,query:f,defaultBaseURL:m}=l,v=this.buildURL(d,f,m);"timeout"in l&&Z7("timeout",l.timeout),l.timeout=(r=l.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:y,body:T}=this.buildBody({options:l}),w=await this.buildHeaders({options:t,method:u,bodyHeaders:y,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:u,headers:w},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&T instanceof globalThis.ReadableStream&&{duplex:"half"}),T&&{body:T}),(a=this.fetchOptions)!==null&&a!==void 0?a:{}),(o=l.fetchOptions)!==null&&o!==void 0?o:{}),url:v,timeout:l.timeout}}async buildHeaders({options:t,method:n,bodyHeaders:r,retryCount:a}){let o={};this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);const l=await this.authHeaders(t);let u=Tl([o,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),i9()),this._options.defaultHeaders,r,t.headers,l]);return this.validateHeaders(u),u.values}buildBody({options:{body:t,headers:n}}){if(!t)return{bodyHeaders:void 0,body:void 0};const r=Tl([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&r.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:o9(t)}:this.encoder({body:t,headers:r})}}Df.DEFAULT_TIMEOUT=6e4;class Mn extends Df{constructor(){super(...arguments),this.interactions=new PT(this)}}BT=Mn;Mn.GeminiNextGenAPIClient=BT;Mn.GeminiNextGenAPIClientError=Kr;Mn.APIError=ar;Mn.APIConnectionError=kf;Mn.APIConnectionTimeoutError=ET;Mn.APIUserAbortError=Lh;Mn.NotFoundError=AT;Mn.ConflictError=CT;Mn.RateLimitError=NT;Mn.BadRequestError=TT;Mn.AuthenticationError=ST;Mn.InternalServerError=kT;Mn.PermissionDeniedError=wT;Mn.UnprocessableEntityError=bT;Mn.toFile=m9;Mn.Interactions=PT;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function b9(e,t){const n={},r=p(e,["name"]);return r!=null&&x(n,["_url","name"],r),n}function N9(e,t){const n={},r=p(e,["name"]);return r!=null&&x(n,["_url","name"],r),n}function k9(e,t){const n={},r=p(e,["sdkHttpResponse"]);return r!=null&&x(n,["sdkHttpResponse"],r),n}function R9(e,t){const n={},r=p(e,["sdkHttpResponse"]);return r!=null&&x(n,["sdkHttpResponse"],r),n}function D9(e,t,n){const r={};if(p(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=p(e,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&x(t,["displayName"],a),p(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=p(e,["epochCount"]);t!==void 0&&o!=null&&x(t,["tuningTask","hyperparameters","epochCount"],o);const l=p(e,["learningRateMultiplier"]);if(l!=null&&x(r,["tuningTask","hyperparameters","learningRateMultiplier"],l),p(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(p(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(p(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");if(p(e,["tuningMode"])!==void 0)throw new Error("tuningMode parameter is not supported in Gemini API.");if(p(e,["customBaseModel"])!==void 0)throw new Error("customBaseModel parameter is not supported in Gemini API.");const u=p(e,["batchSize"]);t!==void 0&&u!=null&&x(t,["tuningTask","hyperparameters","batchSize"],u);const d=p(e,["learningRate"]);if(t!==void 0&&d!=null&&x(t,["tuningTask","hyperparameters","learningRate"],d),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(p(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");if(p(e,["baseTeacherModel"])!==void 0)throw new Error("baseTeacherModel parameter is not supported in Gemini API.");if(p(e,["tunedTeacherModelSource"])!==void 0)throw new Error("tunedTeacherModelSource parameter is not supported in Gemini API.");if(p(e,["sftLossWeightMultiplier"])!==void 0)throw new Error("sftLossWeightMultiplier parameter is not supported in Gemini API.");if(p(e,["outputUri"])!==void 0)throw new Error("outputUri parameter is not supported in Gemini API.");return r}function M9(e,t,n){const r={};let a=p(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const F=p(e,["validationDataset"]);t!==void 0&&F!=null&&x(t,["supervisedTuningSpec"],ch(F))}else if(a==="PREFERENCE_TUNING"){const F=p(e,["validationDataset"]);t!==void 0&&F!=null&&x(t,["preferenceOptimizationSpec"],ch(F))}else if(a==="DISTILLATION"){const F=p(e,["validationDataset"]);t!==void 0&&F!=null&&x(t,["distillationSpec"],ch(F))}const o=p(e,["tunedModelDisplayName"]);t!==void 0&&o!=null&&x(t,["tunedModelDisplayName"],o);const l=p(e,["description"]);t!==void 0&&l!=null&&x(t,["description"],l);let u=p(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const F=p(e,["epochCount"]);t!==void 0&&F!=null&&x(t,["supervisedTuningSpec","hyperParameters","epochCount"],F)}else if(u==="PREFERENCE_TUNING"){const F=p(e,["epochCount"]);t!==void 0&&F!=null&&x(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],F)}else if(u==="DISTILLATION"){const F=p(e,["epochCount"]);t!==void 0&&F!=null&&x(t,["distillationSpec","hyperParameters","epochCount"],F)}let d=p(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const F=p(e,["learningRateMultiplier"]);t!==void 0&&F!=null&&x(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],F)}else if(d==="PREFERENCE_TUNING"){const F=p(e,["learningRateMultiplier"]);t!==void 0&&F!=null&&x(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],F)}else if(d==="DISTILLATION"){const F=p(e,["learningRateMultiplier"]);t!==void 0&&F!=null&&x(t,["distillationSpec","hyperParameters","learningRateMultiplier"],F)}let f=p(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const F=p(e,["exportLastCheckpointOnly"]);t!==void 0&&F!=null&&x(t,["supervisedTuningSpec","exportLastCheckpointOnly"],F)}else if(f==="PREFERENCE_TUNING"){const F=p(e,["exportLastCheckpointOnly"]);t!==void 0&&F!=null&&x(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],F)}else if(f==="DISTILLATION"){const F=p(e,["exportLastCheckpointOnly"]);t!==void 0&&F!=null&&x(t,["distillationSpec","exportLastCheckpointOnly"],F)}let m=p(n,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const F=p(e,["adapterSize"]);t!==void 0&&F!=null&&x(t,["supervisedTuningSpec","hyperParameters","adapterSize"],F)}else if(m==="PREFERENCE_TUNING"){const F=p(e,["adapterSize"]);t!==void 0&&F!=null&&x(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],F)}else if(m==="DISTILLATION"){const F=p(e,["adapterSize"]);t!==void 0&&F!=null&&x(t,["distillationSpec","hyperParameters","adapterSize"],F)}let v=p(n,["config","method"]);if(v===void 0&&(v="SUPERVISED_FINE_TUNING"),v==="SUPERVISED_FINE_TUNING"){const F=p(e,["tuningMode"]);t!==void 0&&F!=null&&x(t,["supervisedTuningSpec","tuningMode"],F)}const y=p(e,["customBaseModel"]);t!==void 0&&y!=null&&x(t,["customBaseModel"],y);let T=p(n,["config","method"]);if(T===void 0&&(T="SUPERVISED_FINE_TUNING"),T==="SUPERVISED_FINE_TUNING"){const F=p(e,["batchSize"]);t!==void 0&&F!=null&&x(t,["supervisedTuningSpec","hyperParameters","batchSize"],F)}let w=p(n,["config","method"]);if(w===void 0&&(w="SUPERVISED_FINE_TUNING"),w==="SUPERVISED_FINE_TUNING"){const F=p(e,["learningRate"]);t!==void 0&&F!=null&&x(t,["supervisedTuningSpec","hyperParameters","learningRate"],F)}const S=p(e,["labels"]);t!==void 0&&S!=null&&x(t,["labels"],S);const A=p(e,["beta"]);t!==void 0&&A!=null&&x(t,["preferenceOptimizationSpec","hyperParameters","beta"],A);const k=p(e,["baseTeacherModel"]);t!==void 0&&k!=null&&x(t,["distillationSpec","baseTeacherModel"],k);const I=p(e,["tunedTeacherModelSource"]);t!==void 0&&I!=null&&x(t,["distillationSpec","tunedTeacherModelSource"],I);const b=p(e,["sftLossWeightMultiplier"]);t!==void 0&&b!=null&&x(t,["distillationSpec","hyperParameters","sftLossWeightMultiplier"],b);const P=p(e,["outputUri"]);return t!==void 0&&P!=null&&x(t,["outputUri"],P),r}function I9(e,t){const n={},r=p(e,["baseModel"]);r!=null&&x(n,["baseModel"],r);const a=p(e,["preTunedModel"]);a!=null&&x(n,["preTunedModel"],a);const o=p(e,["trainingDataset"]);o!=null&&q9(o);const l=p(e,["config"]);return l!=null&&D9(l,n),n}function F9(e,t){const n={},r=p(e,["baseModel"]);r!=null&&x(n,["baseModel"],r);const a=p(e,["preTunedModel"]);a!=null&&x(n,["preTunedModel"],a);const o=p(e,["trainingDataset"]);o!=null&&j9(o,n,t);const l=p(e,["config"]);return l!=null&&M9(l,n,t),n}function L9(e,t){const n={},r=p(e,["name"]);return r!=null&&x(n,["_url","name"],r),n}function O9(e,t){const n={},r=p(e,["name"]);return r!=null&&x(n,["_url","name"],r),n}function P9(e,t,n){const r={},a=p(e,["pageSize"]);t!==void 0&&a!=null&&x(t,["_query","pageSize"],a);const o=p(e,["pageToken"]);t!==void 0&&o!=null&&x(t,["_query","pageToken"],o);const l=p(e,["filter"]);return t!==void 0&&l!=null&&x(t,["_query","filter"],l),r}function U9(e,t,n){const r={},a=p(e,["pageSize"]);t!==void 0&&a!=null&&x(t,["_query","pageSize"],a);const o=p(e,["pageToken"]);t!==void 0&&o!=null&&x(t,["_query","pageToken"],o);const l=p(e,["filter"]);return t!==void 0&&l!=null&&x(t,["_query","filter"],l),r}function B9(e,t){const n={},r=p(e,["config"]);return r!=null&&P9(r,n),n}function H9(e,t){const n={},r=p(e,["config"]);return r!=null&&U9(r,n),n}function G9(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["nextPageToken"]);a!=null&&x(n,["nextPageToken"],a);const o=p(e,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>HT(u))),x(n,["tuningJobs"],l)}return n}function V9(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["nextPageToken"]);a!=null&&x(n,["nextPageToken"],a);const o=p(e,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>Uh(u))),x(n,["tuningJobs"],l)}return n}function z9(e,t){const n={},r=p(e,["name"]);r!=null&&x(n,["model"],r);const a=p(e,["name"]);return a!=null&&x(n,["endpoint"],a),n}function q9(e,t){const n={};if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=p(e,["examples"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>o)),x(n,["examples","examples"],a)}return n}function j9(e,t,n){const r={};let a=p(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=p(e,["gcsUri"]);t!==void 0&&l!=null&&x(t,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=p(e,["gcsUri"]);t!==void 0&&l!=null&&x(t,["preferenceOptimizationSpec","trainingDatasetUri"],l)}else if(a==="DISTILLATION"){const l=p(e,["gcsUri"]);t!==void 0&&l!=null&&x(t,["distillationSpec","promptDatasetUri"],l)}let o=p(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const l=p(e,["vertexDatasetResource"]);t!==void 0&&l!=null&&x(t,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(o==="PREFERENCE_TUNING"){const l=p(e,["vertexDatasetResource"]);t!==void 0&&l!=null&&x(t,["preferenceOptimizationSpec","trainingDatasetUri"],l)}else if(o==="DISTILLATION"){const l=p(e,["vertexDatasetResource"]);t!==void 0&&l!=null&&x(t,["distillationSpec","promptDatasetUri"],l)}if(p(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function HT(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["name"]);a!=null&&x(n,["name"],a);const o=p(e,["state"]);o!=null&&x(n,["state"],nT(o));const l=p(e,["createTime"]);l!=null&&x(n,["createTime"],l);const u=p(e,["tuningTask","startTime"]);u!=null&&x(n,["startTime"],u);const d=p(e,["tuningTask","completeTime"]);d!=null&&x(n,["endTime"],d);const f=p(e,["updateTime"]);f!=null&&x(n,["updateTime"],f);const m=p(e,["description"]);m!=null&&x(n,["description"],m);const v=p(e,["baseModel"]);v!=null&&x(n,["baseModel"],v);const y=p(e,["_self"]);return y!=null&&x(n,["tunedModel"],z9(y)),n}function Uh(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["name"]);a!=null&&x(n,["name"],a);const o=p(e,["state"]);o!=null&&x(n,["state"],nT(o));const l=p(e,["createTime"]);l!=null&&x(n,["createTime"],l);const u=p(e,["startTime"]);u!=null&&x(n,["startTime"],u);const d=p(e,["endTime"]);d!=null&&x(n,["endTime"],d);const f=p(e,["updateTime"]);f!=null&&x(n,["updateTime"],f);const m=p(e,["error"]);m!=null&&x(n,["error"],m);const v=p(e,["description"]);v!=null&&x(n,["description"],v);const y=p(e,["baseModel"]);y!=null&&x(n,["baseModel"],y);const T=p(e,["tunedModel"]);T!=null&&x(n,["tunedModel"],T);const w=p(e,["preTunedModel"]);w!=null&&x(n,["preTunedModel"],w);const S=p(e,["supervisedTuningSpec"]);S!=null&&x(n,["supervisedTuningSpec"],S);const A=p(e,["preferenceOptimizationSpec"]);A!=null&&x(n,["preferenceOptimizationSpec"],A);const k=p(e,["distillationSpec"]);k!=null&&x(n,["distillationSpec"],k);const I=p(e,["tuningDataStats"]);I!=null&&x(n,["tuningDataStats"],I);const b=p(e,["encryptionSpec"]);b!=null&&x(n,["encryptionSpec"],b);const P=p(e,["partnerModelTuningSpec"]);P!=null&&x(n,["partnerModelTuningSpec"],P);const F=p(e,["customBaseModel"]);F!=null&&x(n,["customBaseModel"],F);const Y=p(e,["experiment"]);Y!=null&&x(n,["experiment"],Y);const D=p(e,["labels"]);D!=null&&x(n,["labels"],D);const Q=p(e,["outputUri"]);Q!=null&&x(n,["outputUri"],Q);const B=p(e,["pipelineJob"]);B!=null&&x(n,["pipelineJob"],B);const ae=p(e,["serviceAccount"]);ae!=null&&x(n,["serviceAccount"],ae);const ie=p(e,["tunedModelDisplayName"]);ie!=null&&x(n,["tunedModelDisplayName"],ie);const Z=p(e,["veoTuningSpec"]);return Z!=null&&x(n,["veoTuningSpec"],Z),n}function Y9(e,t){const n={},r=p(e,["sdkHttpResponse"]);r!=null&&x(n,["sdkHttpResponse"],r);const a=p(e,["name"]);a!=null&&x(n,["name"],a);const o=p(e,["metadata"]);o!=null&&x(n,["metadata"],o);const l=p(e,["done"]);l!=null&&x(n,["done"],l);const u=p(e,["error"]);return u!=null&&x(n,["error"],u),n}function ch(e,t){const n={},r=p(e,["gcsUri"]);r!=null&&x(n,["validationDatasetUri"],r);const a=p(e,["vertexDatasetResource"]);return a!=null&&x(n,["validationDatasetUri"],a),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class X9 extends ei{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new Es(Ka.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const a={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(a.checkpointId=n.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},n),{preTunedModel:a});return o.baseModel=void 0,await this.tuneInternal(o)}else{const a=Object.assign({},n);return await this.tuneInternal(a)}else{const a=Object.assign({},n),o=await this.tuneMldevInternal(a);let l="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?l=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(l=o.name.split("/operations/")[0]),{name:l,state:Ah.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=O9(t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>Uh(m))}else{const f=L9(t);return u=qe("{name}",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>HT(m))}}async listInternal(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=H9(t);return u=qe("tuningJobs",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=V9(m),y=new Zy;return Object.assign(y,v),y})}else{const f=B9(t);return u=qe("tunedModels",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=G9(m),y=new Zy;return Object.assign(y,v),y})}}async cancel(t){var n,r,a,o;let l,u="",d={};if(this.apiClient.isVertexAI()){const f=N9(t);return u=qe("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=R9(m),y=new e2;return Object.assign(y,v),y})}else{const f=b9(t);return u=qe("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,l=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=t.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(m=>m.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:m.headers},y})),l.then(m=>{const v=k9(m),y=new e2;return Object.assign(y,v),y})}}async tuneInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=F9(t,t);return o=qe("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),a.then(d=>Uh(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=I9(t);return o=qe("tunedModels",u._url),l=u._query,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(f=>{const m=f;return m.sdkHttpResponse={headers:d.headers},m})),a.then(d=>Y9(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class J9{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const W9=1024*1024*8,K9=3,$9=1e3,Q9=2,pf="x-goog-upload-status";async function Z9(e,t,n){var r;const a=await GT(e,t,n),o=await(a==null?void 0:a.json());if(((r=a==null?void 0:a.headers)===null||r===void 0?void 0:r[pf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function eB(e,t,n){var r;const a=await GT(e,t,n),o=await(a==null?void 0:a.json());if(((r=a==null?void 0:a.headers)===null||r===void 0?void 0:r[pf])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=KE(o),u=new Mm;return Object.assign(u,l),u}async function GT(e,t,n){var r,a;let o=0,l=0,u=new bh(new Response),d="upload";for(o=e.size;l<o;){const f=Math.min(W9,o-l),m=e.slice(l,l+f);l+f>=o&&(d+=", finalize");let v=0,y=$9;for(;v<K9&&(u=await n.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(f)}}}),!(!((r=u==null?void 0:u.headers)===null||r===void 0)&&r[pf]));)v++,await nB(y),y=y*Q9;if(l+=f,((a=u==null?void 0:u.headers)===null||a===void 0?void 0:a[pf])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function tB(e){return{size:e.size,type:e.type}}function nB(e){return new Promise(t=>setTimeout(t,e))}class rB{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Z9(t,n,r)}async uploadToFileSearchStore(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await eB(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await tB(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aB{create(t,n,r){return new iB(t,n,r)}}class iB{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const b2="x-goog-api-key";class sB{constructor(t){this.apiKey=t}async addAuthHeaders(t,n){if(t.get(b2)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(b2,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oB="gl-node/";class lB{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const t=this.httpOptions;t!=null&&t.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new Mn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:t==null?void 0:t.timeout});return this._interactions=n.interactions,this._interactions}constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=Q5(t.httpOptions,t.vertexai,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion,this.httpOptions=t.httpOptions;const a=new sB(this.apiKey);this.apiClient=new t7({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:oB+"web",uploader:new rB,downloader:new J9}),this.models=new _7(this.apiClient),this.live=new m7(this.apiClient,a,new aB),this.batches=new NL(this.apiClient),this.chats=new cO(this.models,this.apiClient),this.caches=new sO(this.apiClient),this.files=new EO(this.apiClient),this.operations=new E7(this.apiClient),this.authTokens=new P7(this.apiClient),this.tunings=new X9(this.apiClient),this.fileSearchStores=new j7(this.apiClient)}}const Hm=()=>new lB({apiKey:"REDACTED_SECRET"}),cB=async e=>{try{const r=await Hm().models.generateContent({model:"gemini-2.5-flash",contents:`Analyze the name "${e}" for a Spanish-speaking corporate context. Determine the gender and the appropriate title (e.g., "Sr." or "Sra.").`,config:{responseMimeType:"application/json",responseSchema:{type:mr.OBJECT,properties:{gender:{type:mr.STRING,enum:["Male","Female","Unspecified"],description:"The gender associated with the name."},title:{type:mr.STRING,description:"The formal Spanish title prefix (e.g. 'Sr.', 'Sra.', 'Dr.'). Do not include 'Estimado'."}},required:["gender","title"]}}});if(r.text){const a=JSON.parse(r.text);let o=it.Unspecified;return a.gender==="Male"&&(o=it.Male),a.gender==="Female"&&(o=it.Female),{gender:o,title:a.title}}return{gender:it.Unspecified,title:"Sr./Sra."}}catch(t){return console.error("Error detecting gender:",t),{gender:it.Unspecified,title:"Sr./Sra."}}},uB=async e=>{try{const a=await Hm().models.generateContent({model:"gemini-2.5-flash",contents:e,config:{systemInstruction:`You are an expert corporate communications assistant. 
    Your goal is to write a professional email template in Spanish based on the user's request.
    
    CRITICAL RULES:
    1. You MUST use the following placeholders where appropriate for dynamic content:
       - {nombre} (Name of the recipient)
       - {titulo} (Title like 'Sr.', 'Sra.')
       - {estimado} (Adjective: 'Estimado', 'Estimada' or 'Estimado/a' based on gender)
       - {departamento} (Recipient's department)
       - {cargo} (Recipient's position)
       - {correo} (Recipient's email)
       - {jefatura_nombre} (Boss's name)
       - {jefatura_cargo} (Boss's position)
    
    2. Return a JSON object with 'subject' and 'body'.
    3. The tone should be professional but adapted to the instruction (formal, urgent, celebratory, etc.).
    `,responseMimeType:"application/json",responseSchema:{type:mr.OBJECT,properties:{subject:{type:mr.STRING,description:"The email subject line"},body:{type:mr.STRING,description:"The email body with placeholders"}},required:["subject","body"]}}});if(a.text)return JSON.parse(a.text);throw new Error("No content generated")}catch(t){throw console.error("Error generating template:",t),t}},fB=async(e,t)=>{try{const a=await Hm().models.generateContent({model:"gemini-2.5-flash",contents:`Original Email Body:
      """${e}"""
      
      Instruction for modification: "${t}"
      
      Task: Rewrite the email body according to the instruction. Keep the tone professional. Do not add preamble. Return only the new body text.`});if(a.text)return a.text.trim();throw new Error("No content generated")}catch(n){throw console.error("Error refining email:",n),n}},dB=({initialData:e,existingOfficials:t,onSave:n,onCancel:r})=>{const[a,o]=Re.useState(""),[l,u]=Re.useState(""),[d,f]=Re.useState(""),[m,v]=Re.useState(""),[y,T]=Re.useState(""),[w,S]=Re.useState(!1),[A,k]=Re.useState(""),[I,b]=Re.useState(""),[P,F]=Re.useState(""),[Y,D]=Re.useState(it.Unspecified),[Q,B]=Re.useState("Sr./Sra."),[ae,ie]=Re.useState(!1);Re.useEffect(()=>{if(e)o(e.name),u(e.email),f(e.department||""),v(e.position),T(e.stament||""),S(e.isBoss||!1),k(e.bossName),b(e.bossPosition),F(e.bossEmail),D(e.gender),B(e.title);else{const N=localStorage.getItem("officialFormDraft");if(N)try{const G=JSON.parse(N);o(G.name||""),u(G.email||""),f(G.department||""),v(G.position||""),T(G.stament||""),S(G.isBoss||!1),k(G.bossName||""),b(G.bossPosition||""),F(G.bossEmail||""),D(G.gender||it.Unspecified),B(G.title||"Sr./Sra.")}catch(G){console.error("Error loading draft",G)}}},[e]),Re.useEffect(()=>{if(!e){const N={name:a,email:l,department:d,position:m,stament:y,isBoss:w,bossName:A,bossPosition:I,bossEmail:P,gender:Y,title:Q};localStorage.setItem("officialFormDraft",JSON.stringify(N))}},[a,l,d,m,y,w,A,I,P,Y,Q,e]);const Z=Re.useMemo(()=>t.filter(N=>N.isBoss),[t]),le=Re.useMemo(()=>[...new Set(t.map(N=>N.department).filter(Boolean))].sort(),[t]),Te=Re.useMemo(()=>[...new Set(t.map(N=>N.stament).filter(Boolean))].sort(),[t]),ye=Re.useMemo(()=>{const N=t.map(U=>U.bossName).filter(Boolean),G=Z.map(U=>U.name);return[...new Set([...N,...G])].filter(U=>U&&U.trim().length>0).sort()},[t,Z]),H=Re.useMemo(()=>{const N=t.map(U=>U.bossPosition).filter(Boolean),G=Z.map(U=>U.position);return[...new Set([...N,...G])].filter(U=>U&&U.trim().length>0).sort()},[t,Z]),ee=Re.useMemo(()=>{const N=t.map(U=>U.bossEmail).filter(Boolean),G=Z.map(U=>U.email);return[...new Set([...N,...G])].filter(U=>U&&U.trim().length>0).sort()},[t,Z]),Ce=async()=>{if(!a)return;ie(!0);const N=await cB(a);D(N.gender),B(N.title),ie(!1)},re=N=>{const G=N.target.value;k(G);const U=Z.find(q=>q.name.toLowerCase()===G.toLowerCase());if(U){b(U.position),F(U.email);return}const V=t.find(q=>q.bossName.toLowerCase()===G.toLowerCase());V&&(!I&&V.bossPosition&&b(V.bossPosition),!P&&V.bossEmail&&F(V.bossEmail))},Fe=()=>{window.confirm("Ests seguro de que quieres limpiar el formulario?")&&(o(""),u(""),f(""),v(""),T(""),S(!1),k(""),b(""),F(""),D(it.Unspecified),B("Sr./Sra."),localStorage.removeItem("officialFormDraft"))},W=N=>{N.preventDefault(),n({name:a,email:l,department:d,position:m,stament:y,isBoss:w,bossName:A,bossPosition:I,bossEmail:P,gender:Y,title:Q}),e||localStorage.removeItem("officialFormDraft")};return E.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:[E.jsxs("div",{className:"flex justify-between items-center mb-6",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:e?"Editar Funcionario":"Nuevo Funcionario"}),!e&&(a||l)&&E.jsx("span",{className:"text-[10px] bg-amber-100 text-amber-700 px-2 py-0.5 rounded-full font-medium",children:"Borrador detectado"})]}),E.jsxs("div",{className:"flex gap-2",children:[!e&&(a||l)&&E.jsx("button",{onClick:Fe,className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Limpiar formulario",children:E.jsx(YA,{className:"w-5 h-5"})}),E.jsx("button",{onClick:r,className:"text-slate-400 hover:text-slate-600",children:E.jsx(xf,{className:"w-5 h-5"})})]})]}),E.jsxs("form",{onSubmit:W,className:"space-y-5",children:[E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[E.jsxs("div",{className:"md:col-span-2",children:[E.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nombre Completo"}),E.jsxs("div",{className:"flex gap-2",children:[E.jsxs("div",{className:"relative flex-1",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(Rl,{className:"h-4 w-4 text-slate-400"})}),E.jsx("input",{required:!0,type:"text",value:a,onChange:N=>o(N.target.value),className:"pl-10 w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-corporate-blue focus:border-transparent outline-none transition-all",placeholder:"Ej. Juan Prez"})]}),E.jsxs("button",{type:"button",onClick:Ce,disabled:!a||ae,className:"px-4 py-2 bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100 flex items-center gap-2 transition-colors font-medium text-sm",title:"Detectar gnero automticamente con IA",children:[ae?E.jsx("span",{className:"animate-spin",children:""}):E.jsx(Hl,{className:"w-4 h-4"}),"IA Detect"]})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Gnero"}),E.jsxs("select",{value:Y,onChange:N=>D(N.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-corporate-blue outline-none",children:[E.jsx("option",{value:it.Unspecified,children:"No especificado"}),E.jsx("option",{value:it.Male,children:"Masculino"}),E.jsx("option",{value:it.Female,children:"Femenino"})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Ttulo"}),E.jsx("input",{type:"text",value:Q,onChange:N=>B(N.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-corporate-blue outline-none",placeholder:"Ej. Sr."})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Correo Electrnico"}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(Bl,{className:"h-4 w-4 text-slate-400"})}),E.jsx("input",{required:!0,type:"email",value:l,onChange:N=>u(N.target.value),className:"pl-10 w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-corporate-blue outline-none",placeholder:"juan@empresa.com"})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Departamento"}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(bl,{className:"h-4 w-4 text-slate-400"})}),E.jsx("input",{type:"text",list:"departments-list",value:d,onChange:N=>f(N.target.value),className:"pl-10 w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-corporate-blue outline-none",placeholder:"Seleccionar o escribir..."}),E.jsx("datalist",{id:"departments-list",children:le.map(N=>E.jsx("option",{value:N},N))})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Cargo"}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(ju,{className:"h-4 w-4 text-slate-400"})}),E.jsx("input",{required:!0,type:"text",value:m,onChange:N=>v(N.target.value),className:"pl-10 w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-corporate-blue outline-none",placeholder:"Ej. Analista"})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Estamento"}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(xA,{className:"h-4 w-4 text-slate-400"})}),E.jsx("input",{type:"text",list:"staments-list",value:y,onChange:N=>T(N.target.value),className:"pl-10 w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-corporate-blue outline-none",placeholder:"Ej. Profesional"}),E.jsx("datalist",{id:"staments-list",children:Te.map(N=>E.jsx("option",{value:N},N))})]})]})]}),E.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[E.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[E.jsx("div",{className:"flex items-center h-5",children:E.jsx("input",{id:"is-boss",type:"checkbox",checked:w,onChange:N=>S(N.target.checked),className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"})}),E.jsxs("div",{className:"text-sm",children:[E.jsxs("label",{htmlFor:"is-boss",className:"font-medium text-slate-700 flex items-center gap-2",children:["Es Jefatura",E.jsx(L2,{className:`w-4 h-4 ${w?"text-amber-500":"text-slate-300"}`})]}),E.jsx("p",{className:"text-xs text-slate-500",children:"Habilita a esta persona para ser seleccionada como jefe de otros."})]})]}),E.jsxs("div",{className:"border-t border-slate-200 pt-4 mt-4",children:[E.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-3 flex items-center gap-2",children:[E.jsx(kl,{className:"w-4 h-4 text-slate-500"}),"Jefatura Directa (A quien reporta)"]}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Nombre Jefatura"}),E.jsx("input",{type:"text",list:"boss-names",value:A,onChange:re,className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-corporate-blue outline-none",placeholder:"Buscar jefe..."}),E.jsx("datalist",{id:"boss-names",children:ye.map(N=>E.jsx("option",{value:N},N))})]}),E.jsxs("div",{children:[E.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Cargo Jefatura"}),E.jsx("input",{type:"text",list:"boss-positions",value:I,onChange:N=>b(N.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-corporate-blue outline-none",placeholder:"Cargo del jefe"}),E.jsx("datalist",{id:"boss-positions",children:H.map(N=>E.jsx("option",{value:N},N))})]}),E.jsxs("div",{className:"md:col-span-2",children:[E.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Correo Jefatura"}),E.jsx("input",{type:"email",list:"boss-emails",value:P,onChange:N=>F(N.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-corporate-blue outline-none",placeholder:"correo.jefe@empresa.com"}),E.jsx("datalist",{id:"boss-emails",children:ee.map(N=>E.jsx("option",{value:N},N))})]})]})]})]}),E.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-100",children:[E.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 font-medium transition-colors",children:"Cancelar"}),E.jsxs("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium shadow-sm transition-colors flex items-center gap-2",children:[E.jsx(Gh,{className:"w-4 h-4"}),e?"Actualizar Funcionario":"Guardar Funcionario"]})]})]})]})},Gu=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),hB=(e,t)=>{switch(e){case"missingBoss":return"Funcionarios sin Jefatura";case"missingGender":return"Funcionarios sin Gnero";case"invalidEmail":return"Correos Invlidos";case"department":return`Departamento: ${t}`;default:return"Filtro Activo"}},mB=({officials:e,onEdit:t,onDelete:n,onBulkDelete:r,onBulkUpdate:a,sortOption:o,onSortChange:l,initialFilter:u,onClearFilter:d})=>{const[f,m]=Re.useState(""),[v,y]=Re.useState("Todos"),[T,w]=Re.useState("Todos"),S=Re.useRef(null),[A,k]=Re.useState([]),[I,b]=Re.useState(null);Re.useEffect(()=>{u&&(m(""),u.type==="department"&&u.value?(y(u.value),w("Todos")):["missingBoss","missingGender","invalidEmail"].includes(u.type)?(y("Todos"),w("Todos")):u.type)},[u]),Re.useEffect(()=>{const H=ee=>{var Ce;(ee.ctrlKey||ee.metaKey)&&ee.key==="k"&&(ee.preventDefault(),(Ce=S.current)==null||Ce.focus())};return window.addEventListener("keydown",H),()=>window.removeEventListener("keydown",H)},[]);const P=Re.useMemo(()=>["Todos",...new Set(e.map(H=>H.department).filter(Boolean).sort())],[e]),F=Re.useMemo(()=>["Todos",...new Set(e.map(H=>H.bossName).filter(Boolean).sort())],[e]),Y=Re.useMemo(()=>{const H={};return e.forEach(ee=>{var re;const Ce=((re=ee.department)==null?void 0:re.trim())||"Sin Departamento";H[Ce]=(H[Ce]||0)+1}),Object.entries(H).sort((ee,Ce)=>Ce[1]-ee[1])},[e]),D=e.filter(H=>H.gender===it.Male).length,Q=e.filter(H=>H.gender===it.Female).length,B=e.filter(H=>{if((u==null?void 0:u.type)==="missingBoss"&&H.bossName||(u==null?void 0:u.type)==="missingGender"&&H.gender!==it.Unspecified||(u==null?void 0:u.type)==="invalidEmail"&&H.email.includes("@"))return!1;const ee=Gu(f),Ce=Gu(H.name).includes(ee)||Gu(H.email).includes(ee)||Gu(H.position).includes(ee),re=v==="Todos"||H.department===v,Fe=T==="Todos"||H.bossName===T;return Ce&&re&&Fe}),ae=[...B].sort((H,ee)=>{switch(o){case"department":return(H.department||"").localeCompare(ee.department||"");case"surname":const Ce=H.name.trim().split(" ").pop()||"",re=ee.name.trim().split(" ").pop()||"";return Ce.localeCompare(re);case"name":default:return H.name.localeCompare(ee.name)}}),ie=()=>{A.length===ae.length?k([]):k(ae.map(H=>H.id))},Z=H=>{A.includes(H)?k(ee=>ee.filter(Ce=>Ce!==H)):k(ee=>[...ee,H])},le=()=>{const H=window.prompt("Ingresa el nuevo departamento para los usuarios seleccionados:");H!==null&&(a(A,"department",H),k([]))},Te=(H,ee)=>{if(!ee.bossName)return;const Ce=H.currentTarget.getBoundingClientRect(),Fe=window.innerHeight-Ce.bottom<180?"top":"bottom";b({official:ee,x:Ce.left+20,y:Fe==="bottom"?Ce.bottom+5:Ce.top-5,position:Fe})},ye=()=>{b(null)};return e.length===0?E.jsxs("div",{className:"text-center py-20 bg-white rounded-xl border border-slate-200 border-dashed",children:[E.jsx("div",{className:"mx-auto w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:E.jsx(Rl,{className:"w-6 h-6 text-slate-400"})}),E.jsx("h3",{className:"text-lg font-medium text-slate-900",children:"No hay funcionarios"}),E.jsx("p",{className:"text-slate-500 mt-1",children:"Agrega nuevos funcionarios para comenzar a gestionar correos."})]}):E.jsxs("div",{className:"space-y-4 relative",children:[E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[E.jsxs("div",{className:"bg-indigo-600 rounded-xl p-4 text-white shadow-sm flex flex-col justify-between",children:[E.jsxs("div",{children:[E.jsx("p",{className:"text-indigo-200 text-xs font-bold uppercase tracking-wider mb-1",children:"Total Registros"}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(Rl,{className:"w-5 h-5 text-indigo-300"}),E.jsx("span",{className:"text-3xl font-bold",children:e.length})]})]}),E.jsx("div",{className:"mt-2 text-xs text-indigo-200",children:"Funcionarios ingresados"})]}),E.jsxs("div",{className:"bg-white rounded-xl p-4 border border-slate-200 shadow-sm flex flex-col justify-center gap-2",children:[E.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Por Gnero"}),E.jsxs("div",{className:"space-y-2",children:[E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("span",{className:"flex items-center gap-2 text-sm text-slate-600",children:[E.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),"Hombres"]}),E.jsx("span",{className:"font-bold text-slate-900",children:D})]}),E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("span",{className:"flex items-center gap-2 text-sm text-slate-600",children:[E.jsx("span",{className:"w-2 h-2 rounded-full bg-pink-500"}),"Mujeres"]}),E.jsx("span",{className:"font-bold text-slate-900",children:Q})]})]})]}),E.jsxs("div",{className:"md:col-span-2 bg-white rounded-xl border border-slate-200 p-4 shadow-sm",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[E.jsx(TA,{className:"w-4 h-4 text-slate-400"}),E.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Desglose por Departamento"})]}),E.jsx("div",{className:"flex flex-wrap gap-2 max-h-24 overflow-y-auto pr-1 custom-scrollbar",children:Y.map(([H,ee])=>E.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 border border-slate-200 rounded-lg text-xs font-medium text-slate-700",children:[E.jsx("span",{className:"truncate max-w-[150px]",children:H}),E.jsx("span",{className:"bg-white px-1.5 py-0.5 rounded-md border border-slate-200 text-slate-900 font-bold text-[10px] shadow-sm",children:ee})]},H))})]})]}),A.length>0&&E.jsxs("div",{className:"bg-indigo-900 text-white p-3 rounded-xl flex items-center justify-between animate-in slide-in-from-top-2 shadow-lg",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsxs("span",{className:"bg-indigo-700 px-2 py-1 rounded text-xs font-bold",children:[A.length," seleccionados"]}),E.jsx("span",{className:"text-sm text-indigo-200 hidden sm:inline",children:"Acciones masivas:"})]}),E.jsxs("div",{className:"flex gap-2",children:[E.jsxs("button",{onClick:le,className:"flex items-center gap-2 px-3 py-1.5 bg-indigo-800 hover:bg-indigo-700 rounded-lg text-xs font-medium transition-colors",children:[E.jsx(bl,{className:"w-3 h-3"}),"Cambiar Dept."]}),E.jsxs("button",{onClick:()=>{r(A),k([])},className:"flex items-center gap-2 px-3 py-1.5 bg-red-600 hover:bg-red-500 rounded-lg text-xs font-medium transition-colors shadow-sm",children:[E.jsx(Ri,{className:"w-3 h-3"}),"Eliminar"]}),E.jsx("button",{onClick:()=>k([]),className:"p-1.5 text-indigo-300 hover:text-white",children:E.jsx(qA,{className:"w-4 h-4"})})]})]}),u&&u.type!=="none"&&E.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3 flex items-center justify-between animate-in fade-in slide-in-from-top-2",children:[E.jsxs("div",{className:"flex items-center gap-2 text-amber-900",children:[E.jsx(oC,{className:"w-4 h-4 text-amber-600"}),E.jsxs("span",{className:"text-sm font-medium",children:[hB(u.type,u.value),": ",E.jsx("span",{className:"font-bold",children:B.length})," resultados"]})]}),E.jsxs("button",{onClick:d,className:"text-xs bg-white border border-amber-200 text-amber-700 px-3 py-1.5 rounded-lg hover:bg-amber-100 font-medium transition-colors flex items-center gap-1 shadow-sm",children:[E.jsx(xf,{className:"w-3 h-3"}),"Limpiar Filtro"]})]}),E.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col xl:flex-row gap-4 justify-between items-start xl:items-center",children:[E.jsxs("div",{className:"relative w-full xl:w-64",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(B2,{className:"h-4 w-4 text-slate-400"})}),E.jsx("input",{ref:S,type:"text",value:f,onChange:H=>m(H.target.value),placeholder:"Buscar (Ctrl + K)...",className:"pl-10 w-full px-4 py-2 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-corporate-blue outline-none"})]}),E.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-3 w-full xl:w-auto",children:[E.jsxs("div",{className:"relative min-w-[160px]",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(I2,{className:"h-4 w-4 text-slate-400"})}),E.jsxs("select",{value:o,onChange:H=>l(H.target.value),className:"pl-10 w-full px-4 py-2 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-corporate-blue outline-none appearance-none cursor-pointer font-medium text-slate-700",children:[E.jsx("option",{value:"name",children:"Nombre (A-Z)"}),E.jsx("option",{value:"surname",children:"Apellido (A-Z)"}),E.jsx("option",{value:"department",children:"Departamento"})]})]}),E.jsx("div",{className:"h-full w-px bg-slate-200 hidden sm:block mx-1"}),E.jsxs("div",{className:"relative min-w-[160px]",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(bl,{className:"h-4 w-4 text-slate-400"})}),E.jsx("select",{value:v,onChange:H=>y(H.target.value),className:"pl-10 w-full px-4 py-2 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-corporate-blue outline-none appearance-none cursor-pointer",children:P.map(H=>E.jsx("option",{value:H,children:H==="Todos"?"Todos Depts.":H},H))})]}),E.jsxs("div",{className:"relative min-w-[160px]",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(kl,{className:"h-4 w-4 text-slate-400"})}),E.jsx("select",{value:T,onChange:H=>w(H.target.value),className:"pl-10 w-full px-4 py-2 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-corporate-blue outline-none appearance-none cursor-pointer",children:F.map(H=>E.jsx("option",{value:H,children:H==="Todos"?"Todas Jefaturas":H},H))})]})]})]}),E.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-visible",children:E.jsx("div",{className:"overflow-x-auto",children:E.jsxs("table",{className:"w-full text-left",children:[E.jsx("thead",{children:E.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[E.jsx("th",{className:"px-6 py-4 w-10",children:E.jsx("button",{onClick:ie,className:"flex items-center text-slate-400 hover:text-indigo-600",children:A.length>0&&A.length===ae.length?E.jsx(Ju,{className:"w-5 h-5 text-indigo-600"}):E.jsx(Wu,{className:"w-5 h-5"})})}),E.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Nombre"}),E.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Departamento"}),E.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Cargo"}),E.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Correo"}),E.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Jefatura"}),E.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider text-right",children:"Acciones"})]})}),E.jsx("tbody",{className:"divide-y divide-slate-100",children:ae.length===0?E.jsx("tr",{children:E.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-slate-500",children:"No se encontraron resultados con los filtros seleccionados."})}):ae.map(H=>E.jsxs("tr",{className:`hover:bg-slate-50 transition-colors ${A.includes(H.id)?"bg-indigo-50/50":""}`,children:[E.jsx("td",{className:"px-6 py-4",children:E.jsx("button",{onClick:()=>Z(H.id),className:"flex items-center text-slate-400 hover:text-indigo-600",children:A.includes(H.id)?E.jsx(Ju,{className:"w-5 h-5 text-indigo-600"}):E.jsx(Wu,{className:"w-5 h-5"})})}),E.jsx("td",{className:"px-6 py-4",children:E.jsxs("div",{className:"flex items-center gap-3",children:[H.isBoss&&E.jsx(L2,{className:"w-4 h-4 text-amber-500 fill-amber-500 flex-shrink-0",title:"Jefatura"}),E.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${H.gender===it.Female?"bg-pink-100 text-pink-600":H.gender===it.Male?"bg-blue-100 text-blue-600":"bg-slate-100 text-slate-600"}`,children:E.jsx(FA,{className:"w-5 h-5"})}),E.jsxs("div",{children:[E.jsx("p",{className:"font-medium text-slate-900 flex items-center gap-1",children:H.name}),E.jsx("p",{className:"text-xs text-slate-500",children:H.title})]})]})}),E.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:H.department?E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx(bl,{className:"w-3 h-3 text-slate-400"}),H.department]}):"-"}),E.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:H.position}),E.jsx("td",{className:"px-6 py-4 text-sm",children:H.email?E.jsxs("div",{className:"text-slate-600 flex items-center gap-1.5 font-medium",children:[E.jsx(Bl,{className:"w-3 h-3"}),E.jsx("span",{className:"break-all",children:H.email})]}):E.jsx("span",{className:"text-slate-400 italic",children:"Sin correo"})}),E.jsxs("td",{className:"px-6 py-4 cursor-help",onMouseEnter:ee=>Te(ee,H),onMouseLeave:ye,children:[E.jsx("div",{className:"text-sm text-slate-900 font-medium decoration-slate-300 decoration-dotted underline-offset-2 hover:underline",children:H.bossName||"-"}),E.jsx("div",{className:"text-xs text-slate-500",children:H.bossPosition})]}),E.jsx("td",{className:"px-6 py-4 text-right",children:E.jsxs("div",{className:"flex justify-end gap-2",children:[E.jsx("button",{type:"button",onClick:ee=>{ee.stopPropagation(),t(H)},className:"p-1.5 text-slate-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors",children:E.jsx(TC,{className:"w-4 h-4 pointer-events-none"})}),E.jsx("button",{type:"button",onClick:ee=>{ee.stopPropagation(),n(H.id)},className:"p-1.5 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",children:E.jsx(Ri,{className:"w-4 h-4 pointer-events-none"})})]})})]},H.id))})]})})}),I&&E.jsxs("div",{className:"fixed z-[9999] bg-slate-800 text-white p-3 rounded-lg shadow-xl animate-in fade-in zoom-in-95 pointer-events-none",style:{left:I.x,top:I.position==="bottom"?I.y:void 0,bottom:I.position==="top"?window.innerHeight-I.y:void 0,width:"260px"},children:[E.jsx("div",{className:"text-xs font-bold text-slate-300 uppercase tracking-wider mb-1",children:"Detalles Jefatura"}),E.jsxs("div",{className:"space-y-1",children:[E.jsxs("div",{className:"flex items-start gap-2",children:[E.jsx(Rl,{className:"w-3 h-3 text-indigo-400 mt-0.5"}),E.jsx("span",{className:"text-sm font-medium",children:I.official.bossName})]}),E.jsxs("div",{className:"flex items-start gap-2",children:[E.jsx(ju,{className:"w-3 h-3 text-indigo-400 mt-0.5"}),E.jsx("span",{className:"text-xs text-slate-300",children:I.official.bossPosition||"Sin Cargo"})]}),E.jsxs("div",{className:"flex items-start gap-2",children:[E.jsx(Bl,{className:"w-3 h-3 text-indigo-400 mt-0.5"}),E.jsx("span",{className:"text-xs text-slate-300 break-all",children:I.official.bossEmail||"Sin Correo"})]})]}),E.jsx("div",{className:"absolute left-6 w-2 h-2 bg-slate-800 rotate-45",style:{top:I.position==="bottom"?"-4px":void 0,bottom:I.position==="top"?"-4px":void 0}})]})]})},N2=[{label:"Nombre Completo",value:"{nombre}"},{label:"Primer Nombre",value:"{nombres}"},{label:"Apellidos",value:"{apellidos}"},{label:"Ttulo (Sr/Sra)",value:"{titulo}"},{label:"Estimado/a (Adj)",value:"{estimado}"},{label:"Departamento",value:"{departamento}"},{label:"Cargo",value:"{cargo}"},{label:"Correo",value:"{correo}"},{label:"Nombre Jefatura",value:"{jefatura_nombre}"},{label:"Cargo Jefatura",value:"{jefatura_cargo}"}],pB=({template:e,onChange:t,files:n,onFilesChange:r,officials:a,onToast:o,savedTemplates:l,onSaveTemplate:u,onDeleteTemplate:d})=>{const[f,m]=Re.useState(""),[v,y]=Re.useState(!1),[T,w]=Re.useState(!1),[S,A]=Re.useState(""),[k,I]=Re.useState(!1),[b,P]=Re.useState(!1),[F,Y]=Re.useState(null),D=Re.useRef(null),Q=Re.useRef(null),B=a[0],ae=Re.useMemo(()=>{if(!B)return{subject:e.subject,body:"Agrega un funcionario a la base de datos para ver la vista previa real."};let q=e.body,se="Estimado/a";B.gender===it.Male&&(se="Estimado"),B.gender===it.Female&&(se="Estimada");const ge=B.name.trim().split(/\s+/),ve=ge[0]||"";let we="";return ge.length>2?we=ge.slice(-2).join(" "):ge.length===2&&(we=ge[1]),q=q.replace(/{nombre}/g,B.name),q=q.replace(/{nombres}/g,ve),q=q.replace(/{apellidos}/g,we),q=q.replace(/{titulo}/g,B.title),q=q.replace(/{estimado}/g,se),q=q.replace(/{departamento}/g,B.department||"[DEPARTAMENTO]"),q=q.replace(/{cargo}/g,B.position),q=q.replace(/{correo}/g,B.email),q=q.replace(/{jefatura_nombre}/g,B.bossName||"N/A"),q=q.replace(/{jefatura_cargo}/g,B.bossPosition||"N/A"),{subject:e.subject,body:q}},[e,B]);Re.useEffect(()=>{const q=se=>{(se.ctrlKey||se.metaKey)&&se.key==="s"&&(se.preventDefault(),Ce())};return window.addEventListener("keydown",q),()=>window.removeEventListener("keydown",q)},[e]);const ie=q=>{const se=document.getElementById("body-textarea");if(se){const ge=se.selectionStart,ve=se.selectionEnd,we=e.body,Je=we.substring(0,ge)+q+we.substring(ve);t({...e,body:Je}),setTimeout(()=>{se.focus(),se.setSelectionRange(ge+q.length,ge+q.length)},0)}},Z=q=>{if(q.target.files){const se=Array.from(q.target.files);r([...n,...se])}},le=q=>{q.preventDefault(),P(!0)},Te=()=>{P(!1)},ye=q=>{if(q.preventDefault(),P(!1),q.dataTransfer.files&&q.dataTransfer.files.length>0){const se=Array.from(q.dataTransfer.files);r([...n,...se])}},H=q=>{const se=[...n];se.splice(q,1),r(se)},ee=async()=>{if(f){y(!0);try{const q=await uB(f);t({subject:q.subject,body:q.body}),o("Plantilla generada exitosamente","success"),w(!1)}catch{o("Error al generar plantilla","error")}finally{y(!1)}}},Ce=()=>{if(!e.subject&&!e.body){o("La plantilla est vaca","error");return}I(!0)},re=()=>{S.trim()&&(u(S),A(""),I(!1))},Fe=q=>{window.confirm("Reemplazar el contenido actual con esta plantilla?")&&t({subject:q.subject,body:q.body})},W=()=>{const q=JSON.stringify(e,null,2),se=new Blob([q],{type:"application/json"}),ge=URL.createObjectURL(se),ve=document.createElement("a");ve.href=ge,ve.download=`plantilla_correo_${Date.now()}.json`,document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),o("Plantilla exportada","success")},N=q=>{var ve;const se=(ve=q.target.files)==null?void 0:ve[0];if(!se)return;const ge=new FileReader;ge.onload=we=>{var Je;try{const J=JSON.parse((Je=we.target)==null?void 0:Je.result);J.subject!==void 0&&J.body!==void 0?(t({subject:J.subject,body:J.body}),o("Plantilla importada correctamente","success")):o("Formato de archivo invlido","error")}catch(J){console.error(J),o("Error al leer el archivo","error")}},ge.readAsText(se),q.target.value=""},G=()=>{const q=D.current;if(!q)return{top:0,left:0};const se=document.createElement("div"),ge=window.getComputedStyle(q);Array.from(ge).forEach(at=>{se.style.setProperty(at,ge.getPropertyValue(at))}),se.style.position="absolute",se.style.top="0px",se.style.left="0px",se.style.visibility="hidden",se.style.height="auto",se.style.width=ge.width,se.style.whiteSpace="pre-wrap",se.style.overflow="hidden";const ve=q.value.substring(0,q.selectionStart);se.textContent=ve;const we=document.createElement("span");we.textContent=".",se.appendChild(we),document.body.appendChild(se);const Je=q.getBoundingClientRect(),J=parseInt(ge.lineHeight),wt=isNaN(J)?20:J,rt=Je.top+window.scrollY+we.offsetTop-q.scrollTop+wt,vt=Je.left+window.scrollX+we.offsetLeft;return document.body.removeChild(se),{top:rt,left:vt}},U=q=>{if(q.key==="{"){const{top:se,left:ge}=G();Y({top:se,left:ge})}else F&&(q.key==="Escape"||q.key===" "||q.key==="Enter"||q.key==="}")&&Y(null)};Re.useEffect(()=>{const q=()=>Y(null);return F&&window.addEventListener("click",q),()=>window.removeEventListener("click",q)},[F]);const V=q=>{if(!D.current)return;const se=D.current,ge=se.selectionStart,ve=se.selectionEnd,we=e.body;let Je=ge;we[ge-1]==="{"&&(Je=ge-1);const J=we.substring(0,Je)+q+we.substring(ve);t({...e,body:J}),Y(null),setTimeout(()=>{se.focus(),se.setSelectionRange(Je+q.length,Je+q.length)},0)};return E.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full",children:[E.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[E.jsxs("div",{className:"bg-indigo-900 rounded-xl p-6 text-white shadow-lg relative overflow-hidden",children:[E.jsx("div",{className:"absolute top-0 right-0 -mt-4 -mr-4 w-24 h-24 bg-indigo-700 rounded-full opacity-50 blur-xl"}),E.jsxs("div",{className:"relative z-10",children:[E.jsxs("div",{className:"flex justify-between items-start mb-4",children:[E.jsxs("div",{children:[E.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[E.jsx(Hl,{className:"w-5 h-5 text-yellow-300"}),"Generador Mgico de Plantillas"]}),E.jsx("p",{className:"text-indigo-200 text-sm mt-1",children:"Describe qu tipo de correo necesitas y deja que Gemini lo escriba por ti."})]}),E.jsx("button",{onClick:()=>w(!T),className:"px-3 py-1.5 bg-indigo-800 hover:bg-indigo-700 rounded-lg text-xs font-medium transition-colors border border-indigo-700",children:T?"Ocultar":"Abrir Generador"})]}),T&&E.jsxs("div",{className:"space-y-3 animate-in slide-in-from-top-2 duration-200",children:[E.jsx("textarea",{value:f,onChange:q=>m(q.target.value),placeholder:"Ej: Escribe un correo formal invitando a la fiesta de fin de ao el viernes a las 5pm. Menciona que es obligatoria.",className:"w-full bg-indigo-950/50 border border-indigo-700 rounded-lg p-3 text-sm text-white placeholder-indigo-400 focus:ring-2 focus:ring-indigo-500 outline-none resize-none h-20"}),E.jsx("div",{className:"flex justify-end",children:E.jsxs("button",{onClick:ee,disabled:!f||v,className:"px-4 py-2 bg-white text-indigo-900 rounded-lg font-medium hover:bg-indigo-50 transition-all flex items-center gap-2 text-sm shadow-md",children:[v?E.jsx("span",{className:"animate-spin w-4 h-4 border-2 border-indigo-900 border-t-transparent rounded-full"}):E.jsx(Hl,{className:"w-4 h-4"}),v?"Escribiendo...":"Generar Correo"]})})]}),v&&E.jsxs("div",{className:"mt-4 space-y-2 animate-pulse",children:[E.jsx("div",{className:"h-2 bg-indigo-800 rounded w-full"}),E.jsx("div",{className:"h-2 bg-indigo-800 rounded w-5/6"}),E.jsx("div",{className:"h-2 bg-indigo-800 rounded w-4/6"})]})]})]}),E.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:[E.jsxs("div",{className:"flex justify-between items-center mb-4 flex-wrap gap-2",children:[E.jsx("h3",{className:"font-medium text-slate-800",children:"Editor"}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("input",{type:"file",ref:Q,onChange:N,accept:".json",className:"hidden"}),E.jsxs("button",{onClick:()=>{var q;return(q=Q.current)==null?void 0:q.click()},className:"text-slate-500 hover:text-slate-700 hover:bg-slate-100 px-3 py-1.5 rounded-lg text-xs font-medium flex items-center gap-1.5 transition-colors border border-slate-200",title:"Importar archivo JSON",children:[E.jsx(Vh,{className:"w-3.5 h-3.5"}),"Importar"]}),E.jsxs("button",{onClick:W,className:"text-slate-500 hover:text-slate-700 hover:bg-slate-100 px-3 py-1.5 rounded-lg text-xs font-medium flex items-center gap-1.5 transition-colors border border-slate-200",title:"Exportar archivo JSON",children:[E.jsx(KA,{className:"w-3.5 h-3.5"}),"Exportar"]}),E.jsx("div",{className:"w-px h-4 bg-slate-300 mx-1"}),E.jsxs("button",{onClick:Ce,className:"text-indigo-600 hover:bg-indigo-50 px-3 py-1.5 rounded-lg text-sm font-medium flex items-center gap-2 transition-colors",title:"Guardar Plantilla (Ctrl + S)",children:[E.jsx(Gh,{className:"w-4 h-4"}),"Guardar Plantilla"]})]})]}),k&&E.jsxs("div",{className:"mb-4 p-4 bg-slate-50 border border-slate-200 rounded-lg flex items-end gap-3 animate-in fade-in duration-200",children:[E.jsxs("div",{className:"flex-1",children:[E.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Nombre de la plantilla"}),E.jsx("input",{autoFocus:!0,type:"text",value:S,onChange:q=>A(q.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md text-sm",placeholder:"Ej. Recordatorio Mensual"})]}),E.jsx("button",{onClick:re,className:"px-4 py-2 bg-indigo-600 text-white text-sm rounded-md hover:bg-indigo-700",children:"Guardar"}),E.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 text-slate-500 text-sm hover:text-slate-700",children:"Cancelar"})]}),E.jsxs("div",{className:"mb-4",children:[E.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Asunto del Correo"}),E.jsx("input",{type:"text",value:e.subject,onChange:q=>t({...e,subject:q.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-corporate-blue outline-none font-medium",placeholder:"Ej. Memorndum Importante"})]}),E.jsxs("div",{children:[E.jsx("div",{className:"flex justify-between items-center mb-2",children:E.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Cuerpo del Correo"})}),E.jsxs("div",{className:"text-xs text-slate-500 mb-2 bg-slate-50 p-2 rounded border border-slate-100 flex gap-2",children:[E.jsx(fh,{className:"w-4 h-4 mt-0.5"}),E.jsxs("p",{children:["El formato (negritas/cursivas) se conserva al usar el botn ",E.jsx("strong",{children:"Copiar"}),". Para envos directos (botn Enviar), se usar texto plano."]})]}),E.jsxs("div",{className:"relative",children:[E.jsx("textarea",{ref:D,id:"body-textarea",value:e.body,onChange:q=>t({...e,body:q.target.value}),onKeyUp:U,className:"w-full h-96 px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-corporate-blue outline-none font-mono text-sm leading-relaxed resize-none",placeholder:"Escribe el contenido del correo aqu..."}),F&&E.jsxs("div",{className:"fixed z-50 bg-white rounded-lg shadow-xl border border-slate-200 w-48 overflow-hidden animate-in fade-in zoom-in-95 duration-100",style:{top:F.top,left:F.left},children:[E.jsx("div",{className:"bg-indigo-50 px-3 py-1.5 text-[10px] font-bold text-indigo-800 uppercase tracking-wider border-b border-indigo-100",children:"Insertar Variable"}),E.jsx("div",{className:"max-h-48 overflow-y-auto",children:N2.map(q=>E.jsxs("button",{onClick:se=>{se.stopPropagation(),V(q.value)},className:"w-full text-left px-3 py-2 text-xs hover:bg-slate-50 text-slate-700 flex flex-col",children:[E.jsx("span",{className:"font-medium text-indigo-600",children:q.value}),E.jsx("span",{className:"text-[10px] text-slate-400",children:q.label})]},q.value))})]})]}),E.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[E.jsx(tC,{className:"w-4 h-4 text-indigo-600"}),E.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Variables Disponibles"}),E.jsx("span",{className:"text-[10px] text-slate-400",children:"(Click para insertar)"})]}),E.jsx("div",{className:"flex flex-wrap gap-2",children:N2.map(q=>E.jsx("button",{onClick:()=>ie(q.value),className:"px-3 py-1.5 bg-indigo-50 hover:bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full transition-colors border border-indigo-100",children:q.label},q.value))})]})]})]}),E.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:[E.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[E.jsx(U1,{className:"w-4 h-4 text-slate-600"}),E.jsx("h3",{className:"text-sm font-medium text-slate-800",children:"Adjuntos (Simulacin)"})]}),E.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-100 mb-4 flex items-start gap-3",children:[E.jsx(fh,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),E.jsxs("p",{className:"text-xs text-blue-800",children:["Nota: Debido a restricciones de seguridad de los navegadores, los archivos ",E.jsx("strong",{children:"no pueden adjuntarse automticamente"})," al abrir su cliente de correo. Esta seccin le ayuda a verificar qu archivos deben ir en cada envo y los incluye en la descarga .EML."]})]}),E.jsxs("div",{onDragOver:le,onDragLeave:Te,onDrop:ye,className:`flex flex-col items-center justify-center border-2 border-dashed rounded-xl p-8 transition-colors ${b?"border-indigo-500 bg-indigo-50":"border-slate-300 hover:border-slate-400 bg-slate-50"}`,children:[E.jsx(OA,{className:`w-10 h-10 mb-2 ${b?"text-indigo-500":"text-slate-400"}`}),E.jsxs("div",{className:"flex flex-col items-center",children:[E.jsxs("label",{className:"cursor-pointer px-4 py-2 bg-white text-slate-700 rounded-lg text-sm font-medium transition-colors border border-slate-300 hover:border-indigo-400 hover:text-indigo-600 shadow-sm mb-2",children:["Seleccionar Archivos",E.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:Z})]}),E.jsx("p",{className:"text-xs text-slate-400",children:"o arrastra y suelta aqu"})]})]}),n.length>0&&E.jsxs("div",{className:"mt-4",children:[E.jsxs("span",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block",children:[n.length," archivo(s) seleccionado(s)"]}),E.jsx("ul",{className:"space-y-2",children:n.map((q,se)=>E.jsxs("li",{className:"flex justify-between items-center text-sm p-2 bg-slate-50 rounded border border-slate-100 group hover:border-slate-300 transition-colors",children:[E.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[E.jsx(U1,{className:"w-3 h-3 text-slate-400"}),E.jsx("span",{className:"truncate max-w-xs text-slate-600 font-medium",children:q.name}),E.jsxs("span",{className:"text-[10px] text-slate-400",children:["(",Math.round(q.size/1024)," KB)"]})]}),E.jsx("button",{onClick:()=>H(se),className:"text-slate-400 hover:text-red-500 px-2 transition-colors",children:E.jsx(Ri,{className:"w-3 h-3"})})]},se))})]})]})]}),E.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[E.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 max-h-64 overflow-y-auto",children:[E.jsxs("h3",{className:"text-sm font-semibold text-slate-800 mb-3 flex items-center gap-2",children:[E.jsx(vA,{className:"w-4 h-4"}),"Mis Plantillas"]}),l.length===0?E.jsx("p",{className:"text-xs text-slate-400 italic",children:"No hay plantillas guardadas"}):E.jsx("ul",{className:"space-y-2",children:l.map(q=>E.jsxs("li",{className:"flex items-center justify-between group p-2 hover:bg-slate-50 rounded-lg transition-colors border border-transparent hover:border-slate-100",children:[E.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>Fe(q),children:[E.jsx("p",{className:"text-sm font-medium text-slate-700",children:q.name}),E.jsx("p",{className:"text-[10px] text-slate-400 truncate max-w-[150px]",children:q.subject})]}),E.jsxs("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity",children:[E.jsx("button",{onClick:()=>Fe(q),title:"Cargar",className:"p-1 text-blue-500 hover:bg-blue-50 rounded",children:E.jsx(Yu,{className:"w-3 h-3"})}),E.jsx("button",{onClick:()=>d(q.id),title:"Eliminar",className:"p-1 text-red-500 hover:bg-red-50 rounded",children:E.jsx(Ri,{className:"w-3 h-3"})})]})]},q.id))})]}),E.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden sticky top-6",children:[E.jsxs("div",{className:"bg-slate-100 px-4 py-3 border-b border-slate-200 flex items-center justify-between",children:[E.jsxs("h3",{className:"text-sm font-semibold text-slate-700 flex items-center gap-2",children:[E.jsx(JA,{className:"w-4 h-4"}),"Vista Previa"]}),B&&E.jsx("span",{className:"text-xs bg-slate-200 text-slate-600 px-2 py-0.5 rounded-full",children:B.name})]}),E.jsx("div",{className:"p-4",children:B?E.jsxs("div",{className:"space-y-3",children:[E.jsxs("div",{children:[E.jsx("span",{className:"text-[10px] uppercase tracking-wider text-slate-400 font-bold",children:"Asunto"}),E.jsx("p",{className:"text-sm font-medium text-slate-800 leading-tight",children:ae.subject||"(Sin asunto)"})]}),E.jsxs("div",{children:[E.jsx("span",{className:"text-[10px] uppercase tracking-wider text-slate-400 font-bold",children:"Cuerpo"}),E.jsx("div",{className:"mt-1 text-xs text-slate-600 whitespace-pre-wrap font-mono bg-slate-50 p-2 rounded border border-slate-100",children:ae.body})]})]}):E.jsx("div",{className:"text-center py-8 text-slate-400 text-xs",children:"Agrega funcionarios para ver cmo queda el correo."})})]})]})]})},xB=async e=>{try{return await e.json()}catch{return null}},VT=async()=>{const e=await fetch("/api/auth/status",{credentials:"include"});if(!e.ok)throw new Error("status_failed");return e.json()},zT=()=>{window.location.href="/api/auth/google"},gB=async()=>{if(!(await fetch("/api/auth/logout",{method:"POST",credentials:"include"})).ok)throw new Error("logout_failed")},vB=async e=>{const t=await fetch("/api/gmail/send",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){const n=await xB(t);throw new Error((n==null?void 0:n.error)||"send_failed")}return t.json()},k2=e=>new Promise((t,n)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>{if(typeof r.result=="string"){const a=r.result.split(",")[1];t(a)}else n(new Error("Failed to convert file"))},r.onerror=a=>n(a)}),Vu=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),yB=({officials:e,template:t,files:n,sentHistory:r,onMarkAsSent:a,onToast:o})=>{const[l,u]=Re.useState([]),[d,f]=Re.useState(""),m=Re.useRef(null),[v,y]=Re.useState("cards"),[T,w]=Re.useState([]),[S,A]=Re.useState("gestion.personas@cftestatalaricayparinacota.cl"),[k,I]=Re.useState({authenticated:!1,email:"",loading:!0}),[b,P]=Re.useState(!1),[F,Y]=Re.useState("Todos"),[D,Q]=Re.useState("Todos"),[B,ae]=Re.useState("Todos"),[ie,Z]=Re.useState("name"),[le,Te]=Re.useState(1),ye=v==="compact"?10:5,[H,ee]=Re.useState(null);Re.useMemo(()=>["Todos",...new Set(e.map(te=>te.position).filter(Boolean).sort())],[e]);const Ce=Re.useMemo(()=>["Todos",...new Set(e.map(te=>te.department).filter(Boolean).sort())],[e]),re=Re.useMemo(()=>["Todos",...new Set(e.map(te=>te.bossName).filter(Boolean).sort())],[e]),Fe=Re.useMemo(()=>[...e].sort((te,Pe)=>te.name.localeCompare(Pe.name)),[e]);Re.useEffect(()=>{const te=Pe=>{var Me;(Pe.ctrlKey||Pe.metaKey)&&Pe.key==="k"&&(Pe.preventDefault(),(Me=m.current)==null||Me.focus())};return window.addEventListener("keydown",te),()=>window.removeEventListener("keydown",te)},[]);const W=async()=>{try{const te=await VT();I({authenticated:te.authenticated,email:te.email||"",loading:!1})}catch(te){console.warn("Gmail status check failed",te),I({authenticated:!1,email:"",loading:!1})}};Re.useEffect(()=>{W()},[]),Re.useEffect(()=>{const te=new URLSearchParams(window.location.search),Pe=te.get("gmail");if(Pe==="connected"&&(o("Gmail conectado","success"),W()),Pe==="error"&&(o("Error conectando Gmail","error"),W()),Pe){te.delete("gmail");const Me=te.toString(),Ye=window.location.pathname+(Me?`?${Me}`:"");window.history.replaceState({},document.title,Ye)}},[o]),Re.useEffect(()=>{const te=e.map(Pe=>{let Me=t.body,Ye="Estimado/a";Pe.gender===it.Male&&(Ye="Estimado"),Pe.gender===it.Female&&(Ye="Estimada");const Le=Pe.name.trim().split(/\s+/),pt=Le[0]||"";let Ne="";return Le.length>2?Ne=Le.slice(-2).join(" "):Le.length===2&&(Ne=Le[1]),Me=Me.replace(/{nombre}/g,Pe.name),Me=Me.replace(/{nombres}/g,pt),Me=Me.replace(/{apellidos}/g,Ne),Me=Me.replace(/{titulo}/g,Pe.title),Me=Me.replace(/{estimado}/g,Ye),Me=Me.replace(/{departamento}/g,Pe.department||""),Me=Me.replace(/{cargo}/g,Pe.position),Me=Me.replace(/{correo}/g,Pe.email),Me=Me.replace(/{jefatura_nombre}/g,Pe.bossName||"N/A"),Me=Me.replace(/{jefatura_cargo}/g,Pe.bossPosition||"N/A"),{id:Pe.id,official:Pe,recipientType:"official",includeCc:!1,includeSubdirectora:!1,additionalCc:"",subject:t.subject,body:Me,sent:r.includes(Pe.id),sending:!1,aiRefining:!1}});u(te)},[e,t,r]);const N=(te,Pe,Me)=>{u(Ye=>Ye.map(Le=>Le.id===te?{...Le,[Pe]:Me}:Le))},G=(te,Pe)=>{u(Me=>Me.map(Ye=>Ye.id===te?{...Ye,recipientType:Pe}:Ye))},U=te=>{u(Pe=>Pe.map(Me=>Me.id===te?{...Me,includeCc:!Me.includeCc}:Me))},V=te=>{u(Pe=>Pe.map(Me=>Me.id===te?{...Me,includeSubdirectora:!Me.includeSubdirectora}:Me))},q=(te,Pe)=>{u(Me=>Me.map(Ye=>({...Ye,[te]:Pe}))),o(`Configuracin aplicada a ${l.length} correos.`,"success")},se=(te,Pe)=>{u(Me=>Me.map(Ye=>Ye.id===te?{...Ye,additionalCc:Pe}:Ye))},ge=te=>{w(Pe=>Pe.includes(te)?Pe.filter(Me=>Me!==te):[...Pe,te])},ve=te=>{const Pe=te.recipientType==="official"?te.official.email:te.official.bossEmail,Me=[];te.includeCc&&te.recipientType==="official"&&te.official.bossEmail&&Me.push(te.official.bossEmail),te.includeSubdirectora&&S&&Me.push(S),te.additionalCc&&Me.push(te.additionalCc);const Ye=Me.join(",");return{to:Pe,cc:Ye}},we=()=>{P(!0),zT()},Je=async()=>{P(!0);try{await gB(),I({authenticated:!1,email:"",loading:!1}),o("Gmail desconectado","success")}catch(te){console.error("Error disconnecting Gmail",te),o("Error desconectando Gmail","error")}finally{P(!1)}},J=async()=>n.length===0?[]:Promise.all(n.map(async te=>({filename:te.name,mimeType:te.type||"application/octet-stream",contentBase64:await k2(te)}))),wt=async te=>{if(!k.authenticated){o("Conecta Gmail para enviar","error");return}const{to:Pe,cc:Me}=ve(te);if(!Pe||!Pe.includes("@")){o("Destinatario sin correo valido","error");return}u(Ye=>Ye.map(Le=>Le.id===te.id?{...Le,sending:!0}:Le));try{const Ye=await J();await vB({to:Pe,cc:Me||void 0,subject:te.subject||"",body:te.body||"",attachments:Ye,officialId:te.id}),a(te.id),u(Le=>Le.map(pt=>pt.id===te.id?{...pt,sent:!0,sending:!1}:pt)),o("Correo enviado con Gmail","success")}catch(Ye){console.error("Error sending Gmail",Ye),u(Le=>Le.map(pt=>pt.id===te.id?{...pt,sending:!1}:pt)),o("Error al enviar con Gmail","error")}},rt=async te=>{try{const{to:Pe,cc:Me}=ve(te),Ye=`----=_NextPart_${Date.now()}`;let Le=`To: ${Pe}
`;if(Me&&(Le+=`Cc: ${Me}
`),Le+=`Subject: ${te.subject}
`,Le+=`X-Unsent: 1
`,Le+=`MIME-Version: 1.0
`,Le+=`Content-Type: multipart/mixed; boundary="${Ye}"

`,Le+=`--${Ye}
`,Le+=`Content-Type: text/html; charset="utf-8"
`,Le+=`Content-Transfer-Encoding: 7bit

`,Le+=`<html><body style="font-family: sans-serif;">${te.body.replace(/\n/g,"<br/>")}</body></html>

`,n.length>0)for(const je of n){const Qe=await k2(je);Le+=`--${Ye}
`,Le+=`Content-Type: ${je.type||"application/octet-stream"}; name="${je.name}"
`,Le+=`Content-Disposition: attachment; filename="${je.name}"
`,Le+=`Content-Transfer-Encoding: base64

`;const lt=Qe.match(/.{1,76}/g)||[];Le+=lt.join(`
`),Le+=`

`}Le+=`--${Ye}--`;const pt=new Blob([Le],{type:"message/rfc822"}),Ne=URL.createObjectURL(pt),Oe=document.createElement("a");Oe.href=Ne,Oe.download=`${te.subject.replace(/[^a-z0-9]/gi,"_")}.eml`,document.body.appendChild(Oe),Oe.click(),document.body.removeChild(Oe),o("Archivo .eml descargado con adjuntos","success")}catch(Pe){console.error("Error generating EML",Pe),o("Error al generar archivo .eml","error")}},vt=te=>{navigator.clipboard.writeText(te),o("Copiado al portapapeles","success")},at=async te=>{const Pe=l.find(Me=>Me.id===te);if(!(!Pe||!H||H.id!==te||!H.text)){u(Me=>Me.map(Ye=>Ye.id===te?{...Ye,aiRefining:!0}:Ye));try{const Me=await fB(Pe.body,H.text);u(Ye=>Ye.map(Le=>Le.id===te?{...Le,body:Me,aiRefining:!1}:Le)),ee(null),o("Correo reescrito con xito","success")}catch{u(Ye=>Ye.map(Le=>Le.id===te?{...Le,aiRefining:!1}:Le)),o("Error al reescribir con IA","error")}}},Ge=l.filter(te=>{const Pe=Vu(d),Me=Vu(te.official.name).includes(Pe)||Vu(te.official.email).includes(Pe)||Vu(te.subject).includes(Pe),Ye=F==="Todos"||te.official.position===F,Le=D==="Todos"||te.official.department===D,pt=B==="Todos"||te.official.bossName===B;return Me&&Ye&&Le&&pt}),Ft=[...Ge].sort((te,Pe)=>{switch(ie){case"department":return(te.official.department||"").localeCompare(Pe.official.department||"");case"surname":const Me=te.official.name.trim().split(" ").slice(-1)[0]||"",Ye=Pe.official.name.trim().split(" ").slice(-1)[0]||"";return Me.localeCompare(Ye);case"name":default:return te.official.name.localeCompare(Pe.official.name)}}),tn=Math.ceil(Ft.length/ye),Tn=(le-1)*ye,Cn=Ft.slice(Tn,Tn+ye),Qr=te=>{f(te.target.value),Te(1)},Qn=te=>{te>=1&&te<=tn&&(Te(te),window.scrollTo({top:0,behavior:"smooth"}))};if(e.length===0)return E.jsxs("div",{className:"flex flex-col items-center justify-center h-64 bg-white rounded-xl border border-slate-200",children:[E.jsx(uh,{className:"w-8 h-8 text-amber-500 mb-2"}),E.jsx("p",{className:"text-slate-600",children:"No hay funcionarios seleccionados para generar correos."})]});const Mt=()=>E.jsxs("div",{className:"flex justify-center items-center gap-4 mt-8 pb-4",children:[E.jsx("button",{onClick:()=>Qn(le-1),disabled:le===1,className:"p-2 rounded-lg border border-slate-300 bg-white text-slate-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50 transition-colors",children:E.jsx(CA,{className:"w-5 h-5"})}),E.jsxs("span",{className:"text-sm font-medium text-slate-600",children:["Pgina ",le," de ",tn]}),E.jsx("button",{onClick:()=>Qn(le+1),disabled:le===tn,className:"p-2 rounded-lg border border-slate-300 bg-white text-slate-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50 transition-colors",children:E.jsx(NA,{className:"w-5 h-5"})})]}),Hn=te=>E.jsxs("div",{className:"space-y-4 relative bg-slate-50 p-4 rounded-lg border border-slate-200 mt-4",children:[E.jsxs("div",{children:[E.jsx("span",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Asunto"}),E.jsx("input",{type:"text",value:te.subject,onChange:Pe=>N(te.id,"subject",Pe.target.value),className:"w-full mt-1 px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-corporate-blue outline-none font-medium text-slate-800"})]}),E.jsxs("div",{className:"relative",children:[E.jsxs("div",{className:"flex justify-between items-center mb-1",children:[E.jsx("span",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider",children:"Contenido"}),E.jsxs("button",{onClick:()=>ee(Pe=>(Pe==null?void 0:Pe.id)===te.id?null:{id:te.id,text:""}),className:"text-xs text-indigo-600 flex items-center gap-1 hover:text-indigo-800",children:[E.jsx(Hl,{className:"w-3 h-3"})," IA Rewrite"]})]}),(H==null?void 0:H.id)===te.id&&E.jsxs("div",{className:"mb-3 p-3 bg-indigo-50 rounded-lg border border-indigo-100 animate-in fade-in slide-in-from-top-2",children:[E.jsx("label",{className:"block text-xs font-medium text-indigo-800 mb-1",children:"Cmo quieres mejorar este correo?"}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("input",{type:"text",autoFocus:!0,value:H.text,onChange:Pe=>ee({id:te.id,text:Pe.target.value}),className:"flex-1 px-3 py-1.5 text-xs border border-indigo-200 rounded focus:outline-none focus:border-indigo-400",placeholder:"Ej. Hazlo ms formal, resume el segundo prrafo...",onKeyDown:Pe=>Pe.key==="Enter"&&at(te.id)}),E.jsx("button",{onClick:()=>at(te.id),disabled:!H.text||te.aiRefining,className:"px-3 py-1 bg-indigo-600 text-white rounded text-xs hover:bg-indigo-700 disabled:opacity-50",children:te.aiRefining?"...":"Aplicar"})]})]}),te.aiRefining?E.jsxs("div",{className:"w-full h-[200px] bg-white rounded-lg border border-slate-200 p-4 space-y-3 animate-pulse",children:[E.jsx("div",{className:"h-4 bg-slate-200 rounded w-3/4"}),E.jsx("div",{className:"h-4 bg-slate-200 rounded w-full"}),E.jsx("div",{className:"h-4 bg-slate-200 rounded w-full"}),E.jsx("div",{className:"h-4 bg-slate-200 rounded w-5/6"}),E.jsx("div",{className:"h-4 bg-slate-200 rounded w-1/2"})]}):E.jsx("textarea",{value:te.body,onChange:Pe=>N(te.id,"body",Pe.target.value),className:"w-full p-4 bg-white rounded-lg border border-slate-300 text-sm text-slate-700 whitespace-pre-wrap font-mono focus:ring-2 focus:ring-corporate-blue outline-none min-h-[200px]"})]})]});return E.jsxs("div",{className:"space-y-6",children:[E.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${k.authenticated?"bg-green-100 text-green-700":"bg-slate-100 text-slate-500"}`,children:E.jsx(Bl,{className:"w-5 h-5"})}),E.jsxs("div",{children:[E.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Gmail integrado"}),E.jsx("p",{className:"text-xs text-slate-500",children:k.loading?"Revisando sesion...":k.authenticated?`Conectado como ${k.email||"Cuenta Google"}`:"No conectado"})]})]}),E.jsx("div",{className:"flex items-center gap-2",children:k.authenticated?E.jsx("button",{onClick:Je,disabled:b,className:"px-4 py-2 text-sm font-medium rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:b?"Desconectando...":"Desconectar"}):E.jsx("button",{onClick:we,disabled:b,className:"px-4 py-2 text-sm font-medium rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:b?"Abriendo Google...":"Conectar Gmail"})})]}),E.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col gap-4",children:[E.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 justify-between items-start xl:items-center border-b border-slate-100 pb-4",children:[E.jsxs("div",{children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Filtros y Bsqueda"}),E.jsxs("div",{className:"bg-slate-100 p-1 rounded-lg flex border border-slate-200",children:[E.jsx("button",{onClick:()=>y("cards"),className:`p-1.5 rounded-md transition-all ${v==="cards"?"bg-white shadow-sm text-indigo-600":"text-slate-500 hover:text-slate-700"}`,title:"Vista Tarjetas",children:E.jsx(mC,{className:"w-4 h-4"})}),E.jsx("button",{onClick:()=>y("compact"),className:`p-1.5 rounded-md transition-all ${v==="compact"?"bg-white shadow-sm text-indigo-600":"text-slate-500 hover:text-slate-700"}`,title:"Vista Compacta",children:E.jsx(dC,{className:"w-4 h-4"})})]})]}),E.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Mostrando ",Ft.length," correos"]})]}),E.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-3 w-full xl:w-auto",children:[E.jsxs("div",{className:"relative min-w-[150px]",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(I2,{className:"h-4 w-4 text-slate-400"})}),E.jsxs("select",{value:ie,onChange:te=>{Z(te.target.value),Te(1)},className:"pl-10 w-full px-4 py-2 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-corporate-blue outline-none appearance-none cursor-pointer",children:[E.jsx("option",{value:"name",children:"Nombre (A-Z)"}),E.jsx("option",{value:"surname",children:"Apellido (A-Z)"}),E.jsx("option",{value:"department",children:"Departamento"})]})]}),E.jsxs("div",{className:"relative min-w-[150px]",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(bl,{className:"h-4 w-4 text-slate-400"})}),E.jsx("select",{value:D,onChange:te=>{Q(te.target.value),Te(1)},className:"pl-10 w-full px-4 py-2 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-corporate-blue outline-none appearance-none cursor-pointer",children:Ce.map(te=>E.jsx("option",{value:te,children:te==="Todos"?"Todos Depts.":te},te))})]}),E.jsxs("div",{className:"relative min-w-[150px]",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(kl,{className:"h-4 w-4 text-slate-400"})}),E.jsx("select",{value:B,onChange:te=>{ae(te.target.value),Te(1)},className:"pl-10 w-full px-4 py-2 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-corporate-blue outline-none appearance-none cursor-pointer",children:re.map(te=>E.jsx("option",{value:te,children:te==="Todos"?"Todas Jef.":te},te))})]}),E.jsxs("div",{className:"relative w-full sm:w-64",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:E.jsx(B2,{className:"h-4 w-4 text-slate-400"})}),E.jsx("input",{ref:m,type:"text",value:d,onChange:Qr,className:"pl-10 w-full px-4 py-2 bg-slate-50 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-corporate-blue outline-none",placeholder:"Buscar (Ctrl + K)"})]})]})]}),E.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 bg-indigo-50 p-3 rounded-lg border border-indigo-100",children:[E.jsxs("div",{className:"flex-1 w-full",children:[E.jsxs("label",{className:"block text-xs font-bold text-indigo-900 mb-1 uppercase tracking-wider flex items-center gap-2",children:[E.jsx(H1,{className:"w-4 h-4"}),"Correo Subdirectora de Gestin de Personas (CC Opcional)"]}),E.jsx("input",{type:"email",value:S,onChange:te=>A(te.target.value),className:"w-full px-3 py-1.5 text-sm border border-indigo-200 rounded text-slate-700 focus:outline-none focus:border-indigo-400",placeholder:"ejemplo@empresa.cl"})]}),E.jsxs("div",{className:"flex items-end gap-2 text-xs text-indigo-700",children:[E.jsx(uh,{className:"w-4 h-4 mb-0.5"}),E.jsxs("span",{className:"max-w-md",children:["Este correo se usar si activas la opcin ",E.jsx("strong",{children:"CC Subdirectora de Gestin de Personas"})," en los envos individuales o masivos."]})]})]})]}),Ge.length===0?E.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-slate-200 border-dashed",children:[E.jsx("p",{className:"text-slate-500",children:"No se encontraron resultados."}),E.jsx("button",{onClick:()=>{f(""),Y("Todos"),Q("Todos"),ae("Todos")},className:"mt-2 text-indigo-600 hover:underline text-sm",children:"Limpiar filtros"})]}):v==="cards"?E.jsx("div",{className:"grid grid-cols-1 gap-6",children:Cn.map(te=>{const Pe=!k.authenticated||te.sending,Me=k.authenticated?te.sending?"Enviando...":"Enviar con Gmail":"Conecta Gmail para enviar";return E.jsxs("div",{className:`bg-white rounded-xl shadow-sm border ${te.sent?"border-green-200":"border-slate-200"} overflow-visible transition-all hover:shadow-md`,children:[E.jsxs("div",{className:`px-6 py-4 border-b flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 ${te.sent?"bg-green-50/50 border-green-100":"bg-slate-50 border-slate-200"}`,children:[E.jsxs("div",{className:"flex flex-col gap-3 w-full lg:w-auto",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider w-12",children:"Para:"}),E.jsxs("div",{className:"flex bg-white border border-slate-200 rounded-lg p-1",children:[E.jsxs("button",{onClick:()=>G(te.id,"official"),className:`flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-all ${te.recipientType==="official"?"bg-indigo-100 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:[E.jsx(Rl,{className:"w-3 h-3"}),te.official.name]}),E.jsxs("button",{onClick:()=>G(te.id,"boss"),className:`flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-all ${te.recipientType==="boss"?"bg-purple-100 text-purple-700 shadow-sm":"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:[E.jsx(kl,{className:"w-3 h-3"}),"Jefatura"]})]})]}),E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider w-12"}),E.jsxs("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[E.jsx("span",{className:"font-semibold",children:te.official.position}),te.official.department&&E.jsxs("span",{className:"text-slate-400",children:[" ",te.official.department]})]})]})]}),E.jsxs("div",{className:"flex flex-col gap-2 w-full lg:w-auto",children:[E.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[E.jsxs("div",{className:"flex items-center",children:[E.jsxs("button",{onClick:()=>U(te.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-l-lg border-y border-l transition-all text-xs font-medium ${te.includeCc?"bg-indigo-50 border-indigo-200 text-indigo-700 z-10":"bg-white border-slate-200 text-slate-500 hover:bg-slate-50"}`,children:[te.includeCc?E.jsx(Ju,{className:"w-4 h-4"}):E.jsx(Wu,{className:"w-4 h-4"}),"CC Jefatura"]}),E.jsx("button",{onClick:()=>q("includeCc",!te.includeCc),className:"px-2 py-1.5 bg-slate-100 border border-slate-200 rounded-r-lg hover:bg-slate-200 text-slate-500 transition-colors",title:`Aplicar "CC Jefatura: ${te.includeCc?"No":"S"}" a TODOS`,children:E.jsx(P1,{className:"w-4 h-4"})})]}),E.jsxs("div",{className:"flex items-center",children:[E.jsxs("button",{onClick:()=>V(te.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-l-lg border-y border-l transition-all text-xs font-medium ${te.includeSubdirectora?"bg-pink-50 border-pink-200 text-pink-700 z-10":"bg-white border-slate-200 text-slate-500 hover:bg-slate-50"}`,children:[te.includeSubdirectora?E.jsx(Ju,{className:"w-4 h-4"}):E.jsx(Wu,{className:"w-4 h-4"}),"CC Subdirectora de Gestin de Personas"]}),E.jsx("button",{onClick:()=>q("includeSubdirectora",!te.includeSubdirectora),className:"px-2 py-1.5 bg-slate-100 border border-slate-200 rounded-r-lg hover:bg-slate-200 text-slate-500 transition-colors",title:`Aplicar "CC Subdirectora de Gestin de Personas: ${te.includeSubdirectora?"No":"S"}" a TODOS`,children:E.jsx(P1,{className:"w-4 h-4"})})]})]}),E.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-2 lg:mt-0",children:[E.jsxs("div",{className:"flex items-center gap-1",children:[E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:E.jsx(H2,{className:"w-3 h-3 text-slate-400"})}),E.jsxs("select",{value:te.additionalCc,onChange:Ye=>se(te.id,Ye.target.value),className:`pl-7 pr-4 py-1.5 rounded-lg border text-xs font-medium appearance-none cursor-pointer outline-none focus:ring-2 focus:ring-indigo-100 transition-all max-w-[150px] ${te.additionalCc?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-white border-slate-200 text-slate-500 hover:bg-slate-50"}`,children:[E.jsx("option",{value:"",children:te.additionalCc?"Sin copia extra":"+ CC Otro"}),Fe.filter(Ye=>Ye.email!==(te.recipientType==="official"?te.official.email:te.official.bossEmail)).map(Ye=>E.jsx("option",{value:Ye.email,children:Ye.name},Ye.id))]})]}),te.additionalCc&&E.jsx("button",{onClick:()=>se(te.id,""),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",title:"Quitar CC adicional",children:E.jsx(xf,{className:"w-3 h-3"})})]}),E.jsx("div",{className:"h-4 w-px bg-slate-300 hidden lg:block"}),E.jsxs("div",{className:"flex flex-wrap gap-2 w-full lg:w-auto",children:[E.jsx("button",{onClick:()=>rt(te),className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-white rounded-lg transition-all border border-slate-200 hover:border-indigo-200",title:"Descargar archivo .eml (Outlook)",children:E.jsx(Yu,{className:"w-4 h-4"})}),E.jsx("button",{onClick:()=>vt(te.body),className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-white rounded-lg transition-all border border-slate-200 hover:border-indigo-200",title:"Copiar texto",children:E.jsx(BA,{className:"w-4 h-4"})}),E.jsxs("button",{onClick:()=>wt(te),disabled:Pe,title:Me,className:`px-4 py-2 text-xs font-medium rounded-lg flex items-center justify-center gap-2 transition-colors shadow-sm hover:shadow ${te.sent?"bg-green-100 text-green-700 border border-green-200 hover:bg-green-200":"bg-indigo-600 hover:bg-indigo-700 text-white"} ${Pe?"opacity-60 cursor-not-allowed":""}`,children:[te.sent?E.jsx(Yd,{className:"w-3 h-3"}):E.jsx(Xu,{className:"w-3 h-3"}),te.sending?"Enviando...":te.sent?"Enviado":"Enviar con Gmail"]})]})]})]})]}),E.jsxs("div",{className:"p-6 relative",children:[te.sent&&E.jsx("div",{className:"absolute top-0 right-0 m-2",children:E.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded text-[10px] font-medium bg-green-100 text-green-800 border border-green-200",children:[E.jsx(Yd,{className:"w-3 h-3"})," Enviado"]})}),Hn(te),n.length>0&&E.jsxs("div",{className:"pt-2 mt-4 border-t border-slate-100",children:[E.jsxs("span",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider flex items-center gap-2",children:[E.jsx("span",{className:"w-2 h-2 bg-amber-400 rounded-full"}),"Adjuntos incluidos en descarga .EML"]}),E.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:n.map((Ye,Le)=>E.jsx("span",{className:"px-2 py-1 bg-white border border-slate-200 rounded text-xs text-slate-600",children:Ye.name},Le))})]})]})]},te.id)})}):E.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:E.jsx("div",{className:"overflow-x-auto",children:E.jsxs("table",{className:"w-full text-left",children:[E.jsx("thead",{children:E.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[E.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-slate-500 uppercase",children:"Destinatario"}),E.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-slate-500 uppercase",children:"Configuracin"}),E.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-slate-500 uppercase",children:"Asunto"}),E.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-slate-500 uppercase text-center",children:"Estado"}),E.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-slate-500 uppercase text-right",children:"Acciones"}),E.jsx("th",{className:"w-10"})]})}),E.jsx("tbody",{className:"divide-y divide-slate-100",children:Cn.map(te=>{const Pe=!k.authenticated||te.sending,Me=k.authenticated?te.sending?"Enviando...":"Enviar con Gmail":"Conecta Gmail para enviar";return E.jsxs(D2.Fragment,{children:[E.jsxs("tr",{className:`hover:bg-slate-50 transition-colors ${te.sent?"bg-green-50/30":""}`,children:[E.jsxs("td",{className:"px-4 py-3",children:[E.jsx("div",{className:"font-medium text-sm text-slate-900",children:te.official.name}),E.jsx("div",{className:"text-xs text-slate-500",children:te.official.email})]}),E.jsx("td",{className:"px-4 py-3",children:E.jsxs("div",{className:"flex gap-2",children:[E.jsx("button",{onClick:()=>U(te.id),className:`p-1 rounded border transition-colors ${te.includeCc?"bg-indigo-100 border-indigo-200 text-indigo-700":"bg-white border-slate-200 text-slate-400"}`,title:"CC Jefatura",children:E.jsx(kl,{className:"w-3 h-3"})}),E.jsx("button",{onClick:()=>V(te.id),className:`p-1 rounded border transition-colors ${te.includeSubdirectora?"bg-pink-100 border-pink-200 text-pink-700":"bg-white border-slate-200 text-slate-400"}`,title:"CC Subdirectora de Gestin de Personas",children:E.jsx(H1,{className:"w-3 h-3"})})]})}),E.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 max-w-xs truncate",children:te.subject}),E.jsx("td",{className:"px-4 py-3 text-center",children:te.sent?E.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-medium bg-green-100 text-green-800",children:"Enviado"}):E.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-medium bg-slate-100 text-slate-500",children:"Pendiente"})}),E.jsx("td",{className:"px-4 py-3 text-right",children:E.jsxs("div",{className:"flex justify-end gap-2",children:[E.jsx("button",{onClick:()=>rt(te),className:"p-1.5 text-slate-400 hover:text-indigo-600 rounded bg-transparent hover:bg-indigo-50",title:"Descargar EML",children:E.jsx(Yu,{className:"w-4 h-4"})}),E.jsx("button",{onClick:()=>wt(te),disabled:Pe,className:`p-1.5 rounded transition-colors ${te.sent?"text-green-600 hover:bg-green-100":"text-indigo-600 hover:bg-indigo-100"} ${Pe?"opacity-60 cursor-not-allowed":""}`,title:Me,children:te.sent?E.jsx(Yd,{className:"w-4 h-4"}):E.jsx(Xu,{className:"w-4 h-4"})})]})}),E.jsx("td",{className:"px-2",children:E.jsx("button",{onClick:()=>ge(te.id),className:"p-1 text-slate-400 hover:text-slate-600",children:T.includes(te.id)?E.jsx(RA,{className:"w-4 h-4"}):E.jsx(F2,{className:"w-4 h-4"})})})]}),T.includes(te.id)&&E.jsx("tr",{className:"bg-slate-50/50",children:E.jsx("td",{colSpan:6,className:"px-4 py-4 border-b border-slate-100",children:Hn(te)})})]},te.id)})})]})})}),tn>1&&Mt()]})},_B=({officials:e,sentHistory:t,onNavigate:n,onImport:r,onExportExcel:a,onNewOfficial:o,onExportBackup:l,onImportBackup:u,onClearDatabase:d})=>{var Z;const f=e.length,m=Re.useRef(null),v=e.filter(le=>t.includes(le.id)).length,y=f>0?Math.round(v/f*100):0,T=e.filter(le=>le.gender===it.Male).length,w=e.filter(le=>le.gender===it.Female).length,S=e.filter(le=>le.gender===it.Unspecified).length,A=T/f*360||0,k=w/f*360||0,I=A,b=A+k,P=e.filter(le=>!le.bossName).length,F=S,Y=e.filter(le=>!le.email.includes("@")).length,D=P===0&&F===0&&Y===0&&f>0,Q=Re.useMemo(()=>{const le={};return e.forEach(Te=>{const ye=Te.department||"Sin Dept.";le[ye]=(le[ye]||0)+1}),Object.entries(le).sort((Te,ye)=>ye[1]-Te[1]).slice(0,5)},[e]),B=((Z=Q[0])==null?void 0:Z[1])||1,ae=()=>{m.current&&(m.current.value="",m.current.click())},ie=le=>{var ye;const Te=(ye=le.target.files)==null?void 0:ye[0];Te&&u(Te)};return E.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[E.jsx("input",{type:"file",ref:m,onChange:ie,className:"hidden",accept:".json"}),E.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[E.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 lg:col-span-2 flex flex-col justify-between relative overflow-hidden",children:[E.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-50 rounded-full -mr-10 -mt-10 blur-2xl"}),E.jsxs("div",{children:[E.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-1",children:"Progreso de Envos"}),E.jsxs("p",{className:"text-slate-500 text-sm mb-4",children:["Has contactado al ",E.jsxs("strong",{className:"text-indigo-600",children:[y,"%"]})," de tu base de datos actual."]})]}),E.jsxs("div",{children:[E.jsxs("div",{className:"flex justify-between text-xs font-semibold text-slate-500 mb-1 uppercase tracking-wider",children:[E.jsxs("span",{children:["Enviados: ",v]}),E.jsxs("span",{children:["Total: ",f]})]}),E.jsx("div",{className:"w-full bg-slate-100 rounded-full h-4 overflow-hidden",children:E.jsx("div",{className:"bg-indigo-600 h-full rounded-full transition-all duration-1000 ease-out shadow-sm relative",style:{width:`${y}%`},children:E.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-white/20 animate-pulse"})})})]})]}),E.jsxs("div",{className:"bg-slate-900 text-white p-6 rounded-xl shadow-lg flex flex-col justify-between",children:[E.jsx("h3",{className:"font-bold mb-4",children:"Acciones Rpidas"}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("button",{onClick:r,className:"flex flex-col items-center justify-center p-3 bg-slate-800 hover:bg-slate-700 rounded-lg border border-slate-700 transition-all group",children:[E.jsx(Vh,{className:"w-5 h-5 mb-1 text-emerald-400 group-hover:scale-110 transition-transform"}),E.jsx("span",{className:"text-xs font-medium",children:"Importar"})]}),E.jsxs("button",{onClick:a,className:"flex flex-col items-center justify-center p-3 bg-slate-800 hover:bg-slate-700 rounded-lg border border-slate-700 transition-all group",children:[E.jsx(P2,{className:"w-5 h-5 mb-1 text-green-400 group-hover:scale-110 transition-transform"}),E.jsx("span",{className:"text-xs font-medium",children:"Exportar"})]}),E.jsxs("button",{onClick:o,className:"col-span-2 flex items-center justify-center gap-2 p-3 bg-slate-800 hover:bg-slate-700 rounded-lg font-medium text-xs border border-slate-700 transition-all group",children:[E.jsx(H2,{className:"w-4 h-4 text-blue-400"}),"Nuevo Funcionario"]}),E.jsxs("button",{onClick:()=>n("generate"),className:"col-span-2 flex items-center justify-center gap-2 p-3 bg-indigo-600 hover:bg-indigo-500 rounded-lg font-medium text-sm shadow-md transition-all",children:[E.jsx(Xu,{className:"w-4 h-4"}),"Continuar Envos"]}),E.jsxs("button",{type:"button",onClick:d,className:"col-span-2 flex items-center justify-center gap-2 p-3 bg-red-900/20 hover:bg-red-900/30 text-red-200 border border-red-900/50 rounded-lg font-medium text-xs transition-all group mt-2",children:[E.jsx(Ri,{className:"w-4 h-4 text-red-500"}),"Limpiar Base de Datos"]})]})]})]}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[E.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:[E.jsxs("h3",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[E.jsx(jC,{className:"w-5 h-5 text-slate-400"}),"Top Departamentos"]}),E.jsx("div",{className:"space-y-4",children:Q.length===0?E.jsx("p",{className:"text-sm text-slate-400 italic text-center py-4",children:"No hay datos suficientes"}):Q.map(([le,Te],ye)=>E.jsxs("div",{className:"relative cursor-pointer hover:bg-slate-50 p-1 rounded -mx-1 transition-colors",onClick:()=>n("database",{type:"department",value:le==="Sin Dept."?"":le}),children:[E.jsxs("div",{className:"flex justify-between text-xs mb-1 font-medium z-10 relative",children:[E.jsx("span",{className:"text-slate-700 truncate max-w-[180px]",children:le}),E.jsxs("span",{className:"text-slate-500",children:[Te," pers."]})]}),E.jsx("div",{className:"w-full bg-slate-50 h-2 rounded-full overflow-hidden",children:E.jsx("div",{className:`h-full rounded-full ${ye===0?"bg-indigo-500":"bg-indigo-300"}`,style:{width:`${Te/B*100}%`}})})]},le))})]}),E.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex flex-col items-center justify-center relative",children:[E.jsx("h3",{className:"absolute top-6 left-6 font-bold text-slate-800 text-sm",children:"Distribucin"}),f===0?E.jsx("div",{className:"text-slate-400 text-sm italic mt-8",children:"Sin datos"}):E.jsxs("div",{className:"relative w-40 h-40 mt-4",children:[E.jsx("div",{className:"w-full h-full rounded-full",style:{background:`conic-gradient(
                            #3b82f6 0deg ${I}deg, 
                            #ec4899 ${I}deg ${b}deg, 
                            #94a3b8 ${b}deg 360deg
                        )`}}),E.jsxs("div",{className:"absolute inset-0 m-auto w-24 h-24 bg-white rounded-full flex flex-col items-center justify-center shadow-inner",children:[E.jsx("span",{className:"text-2xl font-bold text-slate-800",children:f}),E.jsx("span",{className:"text-[10px] text-slate-400 uppercase",children:"Total"})]})]}),E.jsxs("div",{className:"flex gap-4 mt-6 text-xs",children:[E.jsxs("div",{className:"flex items-center gap-1.5",children:[E.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-blue-500"}),E.jsx("span",{className:"text-slate-600",children:"Hombres"})]}),E.jsxs("div",{className:"flex items-center gap-1.5",children:[E.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-pink-500"}),E.jsx("span",{className:"text-slate-600",children:"Mujeres"})]}),E.jsxs("div",{className:"flex items-center gap-1.5",children:[E.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-slate-400"}),E.jsx("span",{className:"text-slate-600",children:"Otros"})]})]})]}),E.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex flex-col",children:[E.jsx("h3",{className:"font-bold text-slate-800 mb-4 text-sm",children:"Salud de Datos"}),f===0?E.jsx("div",{className:"flex-1 flex items-center justify-center text-slate-400 text-sm italic",children:"Base de datos vaca"}):D?E.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center py-4",children:[E.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-3",children:E.jsx(Hh,{className:"w-8 h-8 text-green-600"})}),E.jsx("h4",{className:"font-bold text-green-700",children:"Excelente"}),E.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Todos los registros tienen la informacin crtica completa."})]}):E.jsxs("div",{className:"space-y-3",children:[P>0&&E.jsxs("div",{onClick:()=>n("database",{type:"missingBoss"}),className:"flex items-center gap-3 p-3 bg-red-50 border border-red-100 rounded-lg cursor-pointer hover:bg-red-100 transition-colors",children:[E.jsx(Nl,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),E.jsxs("div",{children:[E.jsxs("p",{className:"text-xs font-bold text-red-800",children:[P," Sin Jefatura"]}),E.jsx("p",{className:"text-[10px] text-red-600",children:"Click para corregir."})]})]}),F>0&&E.jsxs("div",{onClick:()=>n("database",{type:"missingGender"}),className:"flex items-center gap-3 p-3 bg-amber-50 border border-amber-100 rounded-lg cursor-pointer hover:bg-amber-100 transition-colors",children:[E.jsx(Nl,{className:"w-5 h-5 text-amber-500 flex-shrink-0"}),E.jsxs("div",{children:[E.jsxs("p",{className:"text-xs font-bold text-amber-800",children:[F," Sin Gnero"]}),E.jsx("p",{className:"text-[10px] text-amber-600",children:"Click para detectar con IA."})]})]}),Y>0&&E.jsxs("div",{onClick:()=>n("database",{type:"invalidEmail"}),className:"flex items-center gap-3 p-3 bg-red-50 border border-red-100 rounded-lg cursor-pointer hover:bg-red-100 transition-colors",children:[E.jsx(Nl,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),E.jsxs("div",{children:[E.jsxs("p",{className:"text-xs font-bold text-red-800",children:[Y," Correo Invlido"]}),E.jsx("p",{className:"text-[10px] text-red-600",children:"Formato incorrecto o vaco."})]})]})]})]}),E.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200 md:col-span-2 lg:col-span-3",children:[E.jsxs("h3",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[E.jsx(Gh,{className:"w-5 h-5 text-slate-400"}),"Copia de Seguridad"]}),E.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[E.jsx("div",{className:"text-sm text-slate-600",children:E.jsx("p",{children:"Descarga un respaldo completo de tu sistema (funcionarios, plantillas e historial) para no perder datos al cambiar de equipo o borrar cach."})}),E.jsxs("div",{className:"flex gap-3 w-full sm:w-auto",children:[E.jsxs("button",{onClick:l,className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-white border border-slate-300 rounded-lg text-sm font-medium hover:bg-slate-50 transition-colors shadow-sm",children:[E.jsx(Yu,{className:"w-4 h-4 text-slate-500"}),"Descargar"]}),E.jsxs("button",{onClick:ae,className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors shadow-sm",children:[E.jsx(U2,{className:"w-4 h-4"}),"Restaurar"]})]})]})]})]})]})},EB=({toasts:e,removeToast:t})=>E.jsx("div",{className:"fixed bottom-6 right-6 z-50 flex flex-col gap-2",children:e.map(n=>E.jsx(TB,{toast:n,onRemove:()=>t(n.id)},n.id))}),TB=({toast:e,onRemove:t})=>{Re.useEffect(()=>{const a=setTimeout(()=>{t()},3e3);return()=>clearTimeout(a)},[t]);const n=()=>{switch(e.type){case"success":return"bg-white border-green-500 text-slate-800 shadow-lg shadow-green-900/5";case"error":return"bg-white border-red-500 text-slate-800 shadow-lg shadow-red-900/5";default:return"bg-slate-800 border-slate-700 text-white shadow-lg shadow-slate-900/20"}},r=()=>{switch(e.type){case"success":return E.jsx(Hh,{className:"w-5 h-5 text-green-500"});case"error":return E.jsx(uh,{className:"w-5 h-5 text-red-500"});default:return E.jsx(fh,{className:"w-5 h-5 text-blue-400"})}};return E.jsxs("div",{className:`${n()} border-l-4 p-4 rounded-md shadow-md flex items-center gap-3 min-w-[300px] animate-in slide-in-from-right-full duration-300`,children:[r(),E.jsx("p",{className:"text-sm font-medium flex-1",children:e.message}),E.jsx("button",{onClick:t,className:"opacity-50 hover:opacity-100 transition-opacity",children:E.jsx(xf,{className:"w-4 h-4"})})]})};let SB=0;const Ut=()=>typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():Date.now().toString(36)+Math.random().toString(36).substring(2)+(SB++).toString(36),wB=e=>{if(!e)return it.Unspecified;const t=String(e).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim();return["male","masculino","hombre","m","varon","caballero","h","masc","senor","sr","don"].includes(t)?it.Male:["female","femenino","mujer","f","sra","srta","dama","fem","senora","dona"].includes(t)?it.Female:it.Unspecified},AB=[{id:Ut(),name:"David Alejandro Alarcn Sandoval",gender:it.Male,title:"Sr.",position:"Coordinador",department:"Subdireccin Acadmica",stament:"Tcnico",email:"d.alarcon@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Natalia Carolina lvarez Rojas",gender:it.Female,title:"Sra.",position:"Coordinador",department:"Subdireccin Acadmica",stament:"Tcnico",email:"n.alvarez@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Yoselin Estefana Aranda Valderrama",gender:it.Female,title:"Sra.",position:"Coordinador",department:"Subdireccin Acadmica",stament:"Tcnico",email:"y.aranda@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Carlos Alberto Araos Uribe",gender:it.Male,title:"Sr.",position:"Rector",department:"Rectora",stament:"Directivo",email:"rector@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Gloria Noem Bolao Gavia",gender:it.Female,title:"Sra.",position:"Encargada de Finanzas",department:"Direccin Acadmica",stament:"Tcnico",email:"g.bolano@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Rubn Boris Caldern Jaques",gender:it.Male,title:"Sr.",position:"Auxiliar de Operaciones",department:"Adquisiciones y Servicios",stament:"Auxiliar",email:"r.calderon@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"David Alberto Campos Araya",gender:it.Male,title:"Sr.",position:"Subdirector",department:"Subdireccin de Administracin y Finanzas",stament:"Profesional",email:"contabilidad@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Jennifer Roxana Cancino Andrade",gender:it.Female,title:"Sra.",position:"Auxiliar",department:"Servicios Generales",stament:"Auxiliar",email:"jennifer.cancino@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Marcelo Alejandro Crdenas Neira",gender:it.Male,title:"Sr.",position:"Jefe de Carrera",department:"Subdireccin Acadmica",stament:"Profesional",email:"jc.informatica@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Anbal Ral Carrasco Mamani",gender:it.Male,title:"Sr.",position:"Asistente encargado",department:"Conectividad y Redes",stament:"Administrativo",email:"asis.conectividad@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Jacqueline Carmen Castillo Roblero",gender:it.Female,title:"Sra.",position:"Subdirector",department:"DIAC",stament:"Profesional",email:"vinculacion@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Juan Carlos Cejas Rivera",gender:it.Male,title:"Sr.",position:"Encargado de Adquisiciones",department:"Adquisiciones y Servicios",stament:"Tcnico",email:"adquisiciones@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Guillermo Javier Cid Araneda",gender:it.Male,title:"Sr.",position:"Subdirector",department:"Subdireccin Acadmica",stament:"Profesional",email:"areasformativas@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Ana Karen Cofr Segovia",gender:it.Female,title:"Sra.",position:"Asistente encargado",department:"Subdireccin de Administracin y Finanzas",stament:"Tcnico",email:"asistente.gestiondepersonas@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Mercedes Del Carmen Corrales Salas",gender:it.Female,title:"Sra.",position:"Subdirector",department:"Direccin Acadmica",stament:"Directivo",email:"diac@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Sebastin Alejandro Daz Campos",gender:it.Male,title:"Sr.",position:"Profesional",department:"Adquisiciones y Servicios",stament:"Profesional",email:"compraspublicas@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Karen Yanira Daz Corona",gender:it.Female,title:"Sra.",position:"Profesional",department:"DIAC",stament:"Profesional",email:"serviciosocial@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Nicol Camila Daz Tupa",gender:it.Female,title:"Sra.",position:"Asistente De",department:"DEA",stament:"Administrativo",email:"asistente.contable@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Silvia Yanet Esquivel Daz",gender:it.Female,title:"Sra.",position:"Asistente De",department:"RECTORA",stament:"Administrativo",email:"asistente.rectoria@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Sebastin Ignacio Flores Briones",gender:it.Male,title:"Sr.",position:"Coordinador",department:"DIAC",stament:"Profesional",email:"s.flores@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""},{id:Ut(),name:"Alfonso Eleazar Fuentes Daz",gender:it.Male,title:"Sr.",position:"Asistente De",department:"DEA",stament:"Administrativo",email:"a.fuentes@cftestatalaricayparinacota.cl",bossName:"",bossPosition:"",bossEmail:""}];function CB(){const[e,t]=Re.useState(()=>{const Ne=localStorage.getItem("app_databases");if(Ne)return JSON.parse(Ne);const Oe=localStorage.getItem("officials_db"),je=Oe?JSON.parse(Oe):AB;return[{id:Ut(),name:"Funcionarios CFT",officials:je,createdAt:Date.now()}]}),[n,r]=Re.useState(()=>localStorage.getItem("active_db_id")||(e.length>0?e[0].id:"")),a=e.findIndex(Ne=>Ne.id===n),o=a>=0?e[a]:e[0],l=(o==null?void 0:o.officials)||[],[u,d]=Re.useState("dashboard"),[f,m]=Re.useState(null),[v,y]=Re.useState(!1),[T,w]=Re.useState(null),[S,A]=Re.useState(()=>{const Ne=localStorage.getItem("current_template");return Ne?JSON.parse(Ne):{subject:"",body:`Estimado/a {nombre},

Escriba aqu el contenido del correo...

Atentamente,
[Su Nombre]`}}),[k,I]=Re.useState(()=>{const Ne=localStorage.getItem("saved_templates");return Ne?JSON.parse(Ne):[]}),[b,P]=Re.useState([]),[F,Y]=Re.useState(()=>{const Ne=localStorage.getItem("sent_history");return Ne?JSON.parse(Ne):[]}),[D,Q]=Re.useState([]),[B,ae]=Re.useState(!1),[ie,Z]=Re.useState(!1),[le,Te]=Re.useState(!1),[ye,H]=Re.useState({isOpen:!1,mode:"create",value:""}),[ee,Ce]=Re.useState(null),[re,Fe]=Re.useState("name"),[W,N]=Re.useState({type:"none"}),G=Re.useRef(null),U=Re.useRef(null);Re.useEffect(()=>{localStorage.setItem("app_databases",JSON.stringify(e)),o&&localStorage.setItem("officials_db",JSON.stringify(o.officials))},[e,o]),Re.useEffect(()=>{localStorage.setItem("active_db_id",n)},[n]),Re.useEffect(()=>{localStorage.setItem("current_template",JSON.stringify(S))},[S]),Re.useEffect(()=>{localStorage.setItem("saved_templates",JSON.stringify(k))},[k]),Re.useEffect(()=>{localStorage.setItem("sent_history",JSON.stringify(F))},[F]);const V=(Ne,Oe="info")=>{Q(je=>[...je,{id:Ut(),message:Ne,type:Oe}])},q=Ne=>{Q(Oe=>Oe.filter(je=>je.id!==Ne))},se=Ne=>{t(Oe=>Oe.map(je=>{if(je.id===n){const Qe=typeof Ne=="function"?Ne(je.officials):Ne;return{...je,officials:Qe}}return je}))},ge=(Ne,Oe)=>{d(Ne),Oe&&N(Oe),Ne==="database"&&y(!1),ae(!1)},ve=()=>{N({type:"none"})},we=Ne=>{f?(se(Oe=>Oe.map(je=>je.id===f.id?{...Ne,id:f.id}:je)),V("Funcionario actualizado correctamente","success")):(se(Oe=>[...Oe,{...Ne,id:Ut()}]),V("Funcionario creado correctamente","success")),y(!1),m(null)},Je=Ne=>{w(Ne)},J=()=>{T&&(se(Ne=>Ne.filter(Oe=>Oe.id!==T)),V("Funcionario eliminado","success"),w(null))},wt=Ne=>{window.confirm(`Ests seguro de que deseas eliminar ${Ne.length} funcionarios seleccionados?`)&&(se(Oe=>Oe.filter(je=>!Ne.includes(je.id))),V(`${Ne.length} funcionarios eliminados`,"success"))},rt=()=>{if(l.length===0){V("La base de datos ya est vaca.","info");return}Z(!0)},vt=()=>{se([]),m(null),y(!1),Z(!1),V(`Base de datos "${o.name}" vaciada`,"success")},at=(Ne,Oe,je)=>{se(Qe=>Qe.map(lt=>Ne.includes(lt.id)?{...lt,[Oe]:je}:lt)),V(`${Ne.length} registros actualizados`,"success")},Ge=Ne=>{m(Ne),y(!0),d("database")},Ft=Ne=>{F.includes(Ne)||Y(Oe=>[...Oe,Ne])},tn=()=>{H({isOpen:!0,mode:"create",value:""})},Tn=()=>{H({isOpen:!0,mode:"rename",value:o.name})},Cn=Ne=>{Ne.preventDefault();const Oe=ye.value.trim();if(Oe){if(ye.mode==="create"){const je={id:Ut(),name:Oe,officials:[],createdAt:Date.now()};t(Qe=>[...Qe,je]),r(je.id),V(`Base de datos "${Oe}" creada`,"success")}else t(je=>je.map(Qe=>Qe.id===n?{...Qe,name:Oe}:Qe)),V("Nombre actualizado","success");H({...ye,isOpen:!1})}},Qr=()=>{if(e.length<=1){V("No puedes eliminar la nica base de datos.","error");return}if(confirm(`Ests seguro de que deseas ELIMINAR COMPLETAMENTE la base de datos "${o.name}"? Esta accin no se puede deshacer.`)){const Ne=e.filter(Oe=>Oe.id!==n);t(Ne),r(Ne[0].id),V("Base de datos eliminada","success")}},Qn=()=>{const Ne=JSON.stringify(o,null,2),Oe=new Blob([Ne],{type:"application/json"}),je=URL.createObjectURL(Oe),Qe=document.createElement("a");Qe.href=je,Qe.download=`DB_${o.name.replace(/\s+/g,"_")}_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(Qe),Qe.click(),document.body.removeChild(Qe),V(`Base de datos "${o.name}" exportada`,"success")},Mt=Ne=>{var Qe;const Oe=(Qe=Ne.target.files)==null?void 0:Qe[0];if(!Oe)return;const je=new FileReader;je.onload=lt=>{var gr;try{const bn=JSON.parse((gr=lt.target)==null?void 0:gr.result);if(bn.officials&&Array.isArray(bn.officials)){const ma={...bn,id:Ut(),name:bn.name+" (Importada)",createdAt:Date.now()};t(Zr=>[...Zr,ma]),r(ma.id),V(`Base de datos "${bn.name}" importada exitosamente`,"success")}else V("Formato de base de datos invlido","error")}catch(bn){console.error(bn),V("Error al leer el archivo","error")}},je.readAsText(Oe),Ne.target.value=""},Hn=Ne=>{const Oe={...S,id:Ut(),name:Ne,createdAt:Date.now()};I(je=>[...je,Oe]),V("Plantilla guardada","success")},te=Ne=>{window.confirm("Eliminar esta plantilla?")&&(I(Oe=>Oe.filter(je=>je.id!==Ne)),V("Plantilla eliminada","success"))},Pe=Ne=>{var Qe;const Oe=(Qe=Ne.target.files)==null?void 0:Qe[0];if(!Oe)return;const je=new FileReader;je.onload=lt=>{var gr;try{const bn=(gr=lt.target)==null?void 0:gr.result,ma=Sh(bn,{type:"array"}),Zr=ma.SheetNames[0],ni=ma.Sheets[Zr],Ca=Lu.sheet_to_json(ni);if(Ca.length===0){V("El archivo Excel parece vaco","error");return}const ir=Ca.map(yt=>{const Gn=yt.Gnero||yt.Genero||yt.gender||yt.Gender||yt.sex||yt.sexo;return{id:Ut(),name:yt.Nombre||yt.name||"Sin Nombre",email:yt.Correo||yt.email||"",gender:wB(Gn),title:yt.Titulo||"Sr./Sra.",department:yt.Departamento||yt.department||"",position:yt.Cargo||yt.position||"",stament:yt.Estamento||"",bossName:yt.Jefatura||"",bossPosition:yt.CargoJefatura||"",bossEmail:yt.CorreoJefatura||""}}),ea=[],ta=[],bo=yt=>{if(yt.email&&yt.email.includes("@")){const Gn=l.find(na=>na.email.trim().toLowerCase()===yt.email.trim().toLowerCase());if(Gn)return Gn}if(!yt.email||!yt.email.includes("@")){const Gn=l.find(na=>na.name.trim().toLowerCase()===yt.name.trim().toLowerCase());if(Gn)return Gn}};ir.forEach(yt=>{const Gn=bo(yt);Gn?ta.push({existing:Gn,incoming:yt}):ea.push(yt)}),ta.length>0?Ce({newOfficials:ea,duplicates:ta}):(se(yt=>[...yt,...ea]),V(`${ea.length} funcionarios importados a "${o.name}"`,"success"))}catch(bn){console.error(bn),V("Error al procesar el archivo Excel","error")}},je.readAsArrayBuffer(Oe),Ne.target.value=""},Me=Ne=>{if(ee){if(Ne==="skip")ee.newOfficials.length>0?(se(Oe=>[...Oe,...ee.newOfficials]),V(`${ee.newOfficials.length} funcionarios nuevos importados`,"success")):V("No se importaron registros (todos eran duplicados)","info");else if(Ne==="overwrite"){const Oe=new Map;ee.duplicates.forEach(je=>{Oe.set(je.existing.id,je.incoming)}),se(je=>[...je.map(lt=>Oe.has(lt.id)?{...Oe.get(lt.id),id:lt.id}:lt),...ee.newOfficials]),V(`${ee.newOfficials.length} nuevos y ${ee.duplicates.length} actualizados`,"success")}Ce(null)}},Ye=()=>{const Ne=l.map(Qe=>({Nombre:Qe.name,Correo:Qe.email,Gnero:Qe.gender,Titulo:Qe.title,Departamento:Qe.department,Cargo:Qe.position,Estamento:Qe.stament,Jefatura:Qe.bossName,CargoJefatura:Qe.bossPosition,CorreoJefatura:Qe.bossEmail})),Oe=Lu.json_to_sheet(Ne),je=Lu.book_new();Lu.book_append_sheet(je,Oe,o.name.substring(0,30)),P5(je,`${o.name.replace(/\s+/g,"_")}_Export.xlsx`),V("Archivo Excel exportado","success")},Le=()=>{const Ne={timestamp:Date.now(),databases:e,activeDbId:n,template:S,savedTemplates:k,sentHistory:F},Oe=new Blob([JSON.stringify(Ne)],{type:"application/json"}),je=URL.createObjectURL(Oe),Qe=document.createElement("a");Qe.href=je,Qe.download=`backup_gestor_completo_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(Qe),Qe.click(),document.body.removeChild(Qe),V("Copia de seguridad completa descargada","success")},pt=Ne=>{const Oe=new FileReader;Oe.onload=je=>{var Qe;try{const lt=JSON.parse((Qe=je.target)==null?void 0:Qe.result);if(lt.officials&&!lt.databases){const gr={id:Ut(),name:"Restaurado (Legacy)",officials:lt.officials,createdAt:Date.now()};t(bn=>[...bn,gr]),r(gr.id)}else lt.databases&&(t(lt.databases),lt.activeDbId&&r(lt.activeDbId));lt.template&&A(lt.template),lt.savedTemplates&&I(lt.savedTemplates),lt.sentHistory&&Y(lt.sentHistory),V("Sistema restaurado exitosamente","success")}catch{V("Archivo de respaldo invlido","error")}},Oe.readAsText(Ne)};return E.jsxs("div",{className:"flex h-screen bg-slate-50 overflow-hidden font-sans",children:[E.jsx(EB,{toasts:D,removeToast:q}),E.jsx("input",{type:"file",ref:G,onChange:Pe,className:"hidden",accept:".xlsx, .xls"}),E.jsx("input",{type:"file",ref:U,onChange:Mt,className:"hidden",accept:".json"}),E.jsxs("aside",{className:`fixed inset-y-0 left-0 z-30 w-64 bg-slate-900 text-slate-300 transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-auto flex flex-col ${B?"translate-x-0":"-translate-x-full"}`,children:[E.jsxs("div",{className:"p-6 border-b border-slate-800 flex items-center gap-3",children:[E.jsx("div",{className:"w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center shadow-lg shadow-indigo-900/50",children:E.jsx(ju,{className:"text-white w-6 h-6"})}),E.jsxs("div",{children:[E.jsx("h1",{className:"text-white font-bold text-lg leading-tight",children:"Gestor AI"}),E.jsx("p",{className:"text-xs text-slate-500",children:"Correos Corporativos"})]})]}),E.jsxs("div",{className:"px-4 py-4 border-b border-slate-800",children:[E.jsxs("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2 flex items-center justify-between",children:[E.jsx("span",{children:"Base de Datos"}),E.jsx("button",{onClick:()=>Te(!le),className:"hover:text-white transition-colors",children:E.jsx(kC,{className:"w-3 h-3"})})]}),E.jsxs("div",{className:"relative",children:[E.jsxs("button",{onClick:()=>Te(!le),className:"w-full bg-slate-800 hover:bg-slate-700 text-white p-2 rounded-lg flex items-center justify-between text-sm transition-colors border border-slate-700",children:[E.jsx("span",{className:"truncate flex-1 text-left font-medium",children:o.name}),E.jsx(F2,{className:"w-4 h-4 text-slate-400"})]}),le&&E.jsxs("div",{className:"absolute top-full left-0 w-full mt-2 bg-slate-800 rounded-lg shadow-xl border border-slate-700 overflow-hidden z-20 animate-in fade-in zoom-in-95 duration-100",children:[E.jsx("div",{className:"max-h-48 overflow-y-auto",children:e.map(Ne=>E.jsxs("button",{onClick:()=>{r(Ne.id),Te(!1)},className:`w-full text-left px-3 py-2 text-sm flex items-center justify-between ${n===Ne.id?"bg-indigo-600 text-white":"text-slate-300 hover:bg-slate-700"}`,children:[E.jsx("span",{className:"truncate",children:Ne.name}),n===Ne.id&&E.jsx(Hh,{className:"w-3 h-3"})]},Ne.id))}),E.jsxs("div",{className:"border-t border-slate-700 p-1 space-y-1",children:[E.jsxs("button",{onClick:()=>{tn(),Te(!1)},className:"w-full text-left px-2 py-1.5 text-xs text-indigo-400 hover:bg-slate-700 rounded flex items-center gap-2",children:[E.jsx(B1,{className:"w-3 h-3"})," Crear Nueva BD"]}),E.jsxs("button",{onClick:()=>{var Ne;(Ne=U.current)==null||Ne.click(),Te(!1)},className:"w-full text-left px-2 py-1.5 text-xs text-slate-400 hover:bg-slate-700 rounded flex items-center gap-2",children:[E.jsx(rC,{className:"w-3 h-3"})," Importar BD (JSON)"]}),E.jsx("div",{className:"border-t border-slate-700 my-1"}),E.jsxs("button",{onClick:()=>{Tn(),Te(!1)},className:"w-full text-left px-2 py-1.5 text-xs text-slate-400 hover:bg-slate-700 rounded flex items-center gap-2",children:[E.jsx(_C,{className:"w-3 h-3"})," Renombrar Actual"]}),E.jsxs("button",{onClick:()=>{Qn(),Te(!1)},className:"w-full text-left px-2 py-1.5 text-xs text-slate-400 hover:bg-slate-700 rounded flex items-center gap-2",children:[E.jsx(iC,{className:"w-3 h-3"})," Exportar Actual (JSON)"]}),e.length>1&&E.jsxs("button",{onClick:()=>{Qr(),Te(!1)},className:"w-full text-left px-2 py-1.5 text-xs text-red-400 hover:bg-slate-700 rounded flex items-center gap-2",children:[E.jsx(Ri,{className:"w-3 h-3"})," Eliminar Actual"]})]})]})]}),E.jsxs("p",{className:"text-[10px] text-slate-500 mt-2 text-right",children:[l.length," registros"]})]}),E.jsxs("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:[E.jsxs("button",{onClick:()=>ge("dashboard"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-all ${u==="dashboard"?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/20":"hover:bg-slate-800 hover:text-white"}`,children:[E.jsx(uC,{className:"w-5 h-5"}),"Dashboard"]}),E.jsxs("button",{onClick:()=>ge("database"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-all ${u==="database"?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/20":"hover:bg-slate-800 hover:text-white"}`,children:[E.jsx(O2,{className:"w-5 h-5"}),"Base de Datos"]}),E.jsxs("button",{onClick:()=>ge("template"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-all ${u==="template"?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/20":"hover:bg-slate-800 hover:text-white"}`,children:[E.jsx(QA,{className:"w-5 h-5"}),"Editor Plantilla"]}),E.jsxs("button",{onClick:()=>ge("generate"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-all ${u==="generate"?"bg-indigo-600 text-white shadow-lg shadow-indigo-900/20":"hover:bg-slate-800 hover:text-white"}`,children:[E.jsx(Xu,{className:"w-5 h-5"}),"Generar y Enviar"]})]}),E.jsx("div",{className:"p-4 border-t border-slate-800",children:E.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700",children:[E.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Estado del Sistema"}),E.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[E.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),E.jsxs("span",{className:"text-xs font-medium text-slate-300",children:["BD: ",o.name]})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),E.jsx("span",{className:"text-xs font-medium text-slate-300",children:"v1.3.1 Multi-DB"})]})]})})]}),E.jsxs("main",{className:"flex-1 flex flex-col min-w-0 overflow-hidden relative",children:[E.jsxs("div",{className:"lg:hidden bg-white border-b border-slate-200 p-4 flex items-center justify-between",children:[E.jsxs("div",{className:"flex items-center gap-2 font-bold text-slate-800",children:[E.jsx(ju,{className:"w-5 h-5 text-indigo-600"}),"Gestor AI (",o.name,")"]}),E.jsx("button",{onClick:()=>ae(!B),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg",children:E.jsx(gC,{className:"w-6 h-6"})})]}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-4 lg:p-8",children:[B&&E.jsx("div",{className:"fixed inset-0 bg-black/50 z-20 lg:hidden",onClick:()=>ae(!1)}),E.jsxs("div",{className:"max-w-7xl mx-auto",children:[u==="dashboard"&&E.jsx(_B,{officials:l,sentHistory:F,onNavigate:ge,onImport:()=>{var Ne;return(Ne=G.current)==null?void 0:Ne.click()},onExportExcel:Ye,onNewOfficial:()=>{d("database"),y(!0),m(null)},onExportBackup:Le,onImportBackup:pt,onClearDatabase:rt}),u==="database"&&E.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[E.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[E.jsxs("div",{children:[E.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:["Base de Datos: ",E.jsx("span",{className:"text-indigo-600",children:o.name})]}),E.jsxs("p",{className:"text-slate-500",children:["Administrando registros para ",o.name,"."]})]}),!v&&E.jsxs("div",{className:"flex gap-2",children:[E.jsxs("button",{onClick:()=>{var Ne;return(Ne=G.current)==null?void 0:Ne.click()},className:"px-3 py-2 bg-white text-slate-600 border border-slate-300 rounded-lg hover:bg-slate-50 flex items-center gap-2 text-sm font-medium transition-colors",title:"Importar Excel a esta BD",children:[E.jsx(Vh,{className:"w-4 h-4"}),E.jsx("span",{className:"hidden sm:inline",children:"Importar"})]}),E.jsxs("button",{onClick:Ye,className:"px-3 py-2 bg-white text-slate-600 border border-slate-300 rounded-lg hover:bg-slate-50 flex items-center gap-2 text-sm font-medium transition-colors",title:"Exportar Excel de esta BD",children:[E.jsx(P2,{className:"w-4 h-4"}),E.jsx("span",{className:"hidden sm:inline",children:"Exportar"})]}),E.jsxs("button",{onClick:()=>{m(null),y(!0)},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 flex items-center gap-2 font-medium shadow-sm transition-all hover:shadow-md",children:[E.jsx(B1,{className:"w-4 h-4"}),"Nuevo"]})]})]}),v?E.jsx(dB,{initialData:f,existingOfficials:l,onSave:we,onCancel:()=>{y(!1),m(null)}}):E.jsx(mB,{officials:l,onEdit:Ge,onDelete:Je,onBulkDelete:wt,onBulkUpdate:at,sortOption:re,onSortChange:Fe,initialFilter:W,onClearFilter:ve})]}),u==="template"&&E.jsxs("div",{className:"h-[calc(100vh-8rem)]",children:[E.jsxs("div",{className:"mb-4",children:[E.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Editor de Plantilla"}),E.jsx("p",{className:"text-slate-500",children:"Disea el correo base. (La plantilla se comparte entre bases de datos)."})]}),E.jsx(pB,{template:S,onChange:A,files:b,onFilesChange:P,officials:l,onToast:(Ne,Oe)=>V(Ne,Oe),savedTemplates:k,onSaveTemplate:Hn,onDeleteTemplate:te})]}),u==="generate"&&E.jsxs("div",{className:"space-y-6",children:[E.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:E.jsxs("div",{children:[E.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Generador de Correos"}),E.jsxs("p",{className:"text-slate-500",children:["Enviando a base de datos: ",E.jsx("strong",{className:"text-indigo-600",children:o.name})]})]})}),E.jsx(yB,{officials:l,template:S,files:b,sentHistory:F,onMarkAsSent:Ft,onToast:(Ne,Oe)=>V(Ne,Oe)})]})]})]})]}),ye.isOpen&&E.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:E.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full overflow-hidden border border-slate-200 animate-in zoom-in-95 duration-200",children:[E.jsx("div",{className:"bg-slate-50 p-4 border-b border-slate-200",children:E.jsx("h3",{className:"text-lg font-bold text-slate-800",children:ye.mode==="create"?"Nueva Base de Datos":"Renombrar Base de Datos"})}),E.jsxs("form",{onSubmit:Cn,className:"p-6",children:[E.jsxs("div",{className:"mb-4",children:[E.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nombre"}),E.jsx("input",{autoFocus:!0,type:"text",value:ye.value,onChange:Ne=>H({...ye,value:Ne.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Ej. Honorarios 2024"})]}),E.jsxs("div",{className:"flex gap-3 justify-end",children:[E.jsx("button",{type:"button",onClick:()=>H({...ye,isOpen:!1}),className:"px-4 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 font-medium text-sm transition-colors",children:"Cancelar"}),E.jsx("button",{type:"submit",disabled:!ye.value.trim(),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium text-sm shadow-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:ye.mode==="create"?"Crear":"Guardar"})]})]})]})}),ie&&E.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:E.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full overflow-hidden border border-red-100 animate-in zoom-in-95 duration-200",children:[E.jsxs("div",{className:"bg-red-50 p-6 flex flex-col items-center text-center border-b border-red-100",children:[E.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:E.jsx(Nl,{className:"w-8 h-8 text-red-600"})}),E.jsx("h3",{className:"text-xl font-bold text-red-900",children:"Vaciar Base de Datos?"}),E.jsxs("p",{className:"text-red-700 mt-2 text-sm",children:["Ests a punto de eliminar todos los registros de ",E.jsxs("strong",{children:['"',o.name,'"']}),"."]})]}),E.jsxs("div",{className:"p-6",children:[E.jsxs("p",{className:"text-slate-600 text-sm mb-6 leading-relaxed text-center",children:["Se eliminarn ",E.jsxs("strong",{children:[l.length," registros"]}),". Esta accin es irreversible para esta lista especfica."]}),E.jsxs("div",{className:"flex gap-3",children:[E.jsx("button",{onClick:()=>Z(!1),className:"flex-1 px-4 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 font-medium transition-colors",children:"Cancelar"}),E.jsxs("button",{onClick:vt,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium shadow-md transition-colors flex items-center justify-center gap-2",children:[E.jsx(Ri,{className:"w-4 h-4"}),"Vaciar Lista"]})]})]})]})}),ee&&E.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:E.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full overflow-hidden border border-amber-100 animate-in zoom-in-95 duration-200",children:[E.jsxs("div",{className:"bg-amber-50 p-6 flex items-start gap-4 border-b border-amber-100",children:[E.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0",children:E.jsx(Nl,{className:"w-6 h-6 text-amber-600"})}),E.jsxs("div",{children:[E.jsx("h3",{className:"text-lg font-bold text-amber-900",children:"Conflicto de Importacin"}),E.jsxs("p",{className:"text-amber-700 mt-1 text-sm",children:["El archivo contiene registros que ya existen en ",E.jsx("strong",{children:o.name}),"."]})]})]}),E.jsxs("div",{className:"p-6",children:[E.jsxs("div",{className:"flex gap-4 mb-6",children:[E.jsxs("div",{className:"flex-1 bg-slate-50 p-3 rounded-lg border border-slate-200 text-center",children:[E.jsx("span",{className:"block text-2xl font-bold text-slate-700",children:ee.newOfficials.length}),E.jsx("span",{className:"text-xs text-slate-500 font-medium uppercase tracking-wide",children:"Nuevos"})]}),E.jsxs("div",{className:"flex-1 bg-amber-50 p-3 rounded-lg border border-amber-200 text-center",children:[E.jsx("span",{className:"block text-2xl font-bold text-amber-700",children:ee.duplicates.length}),E.jsx("span",{className:"text-xs text-amber-600 font-medium uppercase tracking-wide",children:"Duplicados"})]})]}),E.jsxs("p",{className:"text-slate-600 text-sm mb-6 leading-relaxed",children:["Qu deseas hacer con los ",E.jsxs("strong",{children:[ee.duplicates.length," registros duplicados"]}),"?"]}),E.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[E.jsx("button",{onClick:()=>Ce(null),className:"px-4 py-2 bg-white border border-slate-300 text-slate-600 rounded-lg hover:bg-slate-50 font-medium text-sm transition-colors",children:"Cancelar"}),E.jsxs("div",{className:"flex-1 flex gap-2",children:[E.jsxs("button",{onClick:()=>Me("skip"),className:"flex-1 px-4 py-2 bg-indigo-50 text-indigo-700 border border-indigo-100 rounded-lg hover:bg-indigo-100 font-medium text-sm transition-colors flex items-center justify-center gap-2",children:[E.jsx(IC,{className:"w-4 h-4"}),"Omitir"]}),E.jsxs("button",{onClick:()=>Me("overwrite"),className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium text-sm shadow-sm transition-colors flex items-center justify-center gap-2",children:[E.jsx(U2,{className:"w-4 h-4"}),"Actualizar"]})]})]})]})]})}),T&&E.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:E.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full overflow-hidden border border-red-100 animate-in zoom-in-95 duration-200",children:[E.jsxs("div",{className:"bg-red-50 p-6 flex flex-col items-center text-center border-b border-red-100",children:[E.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-3",children:E.jsx(Ri,{className:"w-6 h-6 text-red-600"})}),E.jsx("h3",{className:"text-lg font-bold text-red-900",children:"Eliminar Funcionario?"}),E.jsxs("p",{className:"text-red-700 mt-1 text-sm",children:["Esta accin solo afecta a la base ",E.jsx("strong",{children:o.name}),"."]})]}),E.jsxs("div",{className:"p-4 flex gap-3",children:[E.jsx("button",{onClick:()=>w(null),className:"flex-1 px-4 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 font-medium transition-colors text-sm",children:"Cancelar"}),E.jsx("button",{onClick:J,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium shadow-md transition-colors text-sm",children:"Eliminar"})]})]})})]})}const bB=({onLogin:e,loading:t=!1})=>E.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-indigo-900 to-slate-900 flex items-center justify-center p-4",children:E.jsxs("div",{className:"max-w-md w-full",children:[E.jsxs("div",{className:"text-center mb-8",children:[E.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-indigo-600 rounded-2xl shadow-2xl mb-4",children:E.jsx(Bl,{className:"w-10 h-10 text-white"})}),E.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Gestor AI"}),E.jsx("p",{className:"text-indigo-200",children:"Correos Corporativos"})]}),E.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8",children:[E.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Bienvenido"}),E.jsx("p",{className:"text-slate-500 mb-6",children:"Inicia sesin con tu cuenta de Google para acceder al sistema"}),E.jsx("button",{onClick:e,disabled:t,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-3 px-4 rounded-lg flex items-center justify-center gap-3 transition-colors shadow-md hover:shadow-lg disabled:opacity-60 disabled:cursor-not-allowed",children:t?E.jsxs(E.Fragment,{children:[E.jsx("span",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Conectando..."]}):E.jsxs(E.Fragment,{children:[E.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[E.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),E.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),E.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),E.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuar con Google"]})}),E.jsx("div",{className:"mt-6 pt-6 border-t border-slate-100",children:E.jsx("p",{className:"text-xs text-slate-400 text-center mb-4",children:"Al iniciar sesin, se crear automticamente tu perfil de usuario"})})]}),E.jsxs("div",{className:"mt-8 grid grid-cols-3 gap-4",children:[E.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 text-center",children:[E.jsx(Hl,{className:"w-6 h-6 text-indigo-300 mx-auto mb-2"}),E.jsx("p",{className:"text-xs text-white font-medium",children:"IA Integrada"})]}),E.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 text-center",children:[E.jsx(O2,{className:"w-6 h-6 text-indigo-300 mx-auto mb-2"}),E.jsx("p",{className:"text-xs text-white font-medium",children:"Multi-Base"})]}),E.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 text-center",children:[E.jsx(DC,{className:"w-6 h-6 text-indigo-300 mx-auto mb-2"}),E.jsx("p",{className:"text-xs text-white font-medium",children:"Seguro"})]})]}),E.jsx("p",{className:"text-center text-indigo-200 text-xs mt-6",children:"v1.4.0 Multi-User"})]})}),uc="/api/user",NB=async()=>{const e=await fetch(`${uc}/databases`,{credentials:"include"});if(!e.ok)throw new Error("fetch_failed");return e.json()},kB=async(e,t)=>{const n=await fetch(`${uc}/databases`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:e,name:t})});if(!n.ok)throw new Error("create_failed");return n.json()},RB=async(e,t)=>{const n=await fetch(`${uc}/databases/${e}/officials`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!n.ok)throw new Error("create_failed");return n.json()},DB=async e=>{const t=await fetch(`${uc}/templates`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok)throw new Error("create_failed");return t.json()},MB=async(e,t)=>{const n=await fetch(`${uc}/current-template`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({subject:e,body:t})});if(!n.ok)throw new Error("save_failed");return n.json()};function IB(){const[e,t]=Re.useState({loading:!0,authenticated:!1,loggingIn:!1}),[n,r]=Re.useState(!1),a=async()=>{try{const u=await VT();t({loading:!1,authenticated:u.authenticated,loggingIn:!1}),u.authenticated&&!n&&(await o(),r(!0))}catch(u){console.error("Auth check failed",u),t({loading:!1,authenticated:!1,loggingIn:!1})}},o=async()=>{try{if((await NB()).length>0){console.log("User already has data in backend, skipping migration");return}const d=localStorage.getItem("app_databases");if(d){const v=JSON.parse(d);for(const y of v){await kB(y.id,y.name);for(const T of y.officials)await RB(y.id,T)}console.log("Migrated databases from localStorage")}const f=localStorage.getItem("saved_templates");if(f){const v=JSON.parse(f);for(const y of v)await DB(y);console.log("Migrated templates from localStorage")}const m=localStorage.getItem("current_template");if(m){const v=JSON.parse(m);await MB(v.subject,v.body),console.log("Migrated current template from localStorage")}}catch(u){console.error("Migration failed",u)}};Re.useEffect(()=>{a()},[]),Re.useEffect(()=>{const d=new URLSearchParams(window.location.search).get("gmail");(d==="connected"||d==="error")&&a()},[]);const l=()=>{t(u=>({...u,loggingIn:!0})),zT()};return e.loading?E.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:E.jsxs("div",{className:"text-center",children:[E.jsx("div",{className:"w-16 h-16 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),E.jsx("p",{className:"text-slate-600 font-medium",children:"Cargando..."})]})}):e.authenticated?E.jsx(CB,{}):E.jsx(bB,{onLogin:l,loading:e.loggingIn})}const qT=document.getElementById("root");if(!qT)throw new Error("Could not find root element to mount to");const FB=lA.createRoot(qT);FB.render(E.jsx(D2.StrictMode,{children:E.jsx(IB,{})}));
